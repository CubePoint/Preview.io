var Gu=Object.defineProperty,$u=Object.defineProperties;var Wu=Object.getOwnPropertyDescriptors;var qs=Object.getOwnPropertySymbols;var Yu=Object.prototype.hasOwnProperty,Xu=Object.prototype.propertyIsEnumerable;var Ua=(h,a,t)=>a in h?Gu(h,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):h[a]=t,Ti=(h,a)=>{for(var t in a||(a={}))Yu.call(a,t)&&Ua(h,t,a[t]);if(qs)for(var t of qs(a))Xu.call(a,t)&&Ua(h,t,a[t]);return h},Hn=(h,a)=>$u(h,Wu(a));var ve=(h,a,t)=>(Ua(h,typeof a!="symbol"?a+"":a,t),t);var oe=(h,a,t)=>new Promise((i,r)=>{var n=c=>{try{o(t.next(c))}catch(g){r(g)}},u=c=>{try{o(t.throw(c))}catch(g){r(g)}},o=c=>c.done?i(c.value):Promise.resolve(c.value).then(n,u);o((t=t.apply(h,a)).next())});import{p as Zs,i as Js,j as Qs,k as $e,l as li,r as $t,o as nt,m as ft,n as Ye,q as Ku,s as We,w as at,F as Wi,a as hn,T as Oe,t as pn,u as qu,v as jn,x as gn,y as eo,A as La,B as Zu,C as Ju,D as Qu,E as _t,G as je,d as Si,f as Pt,H as Gn,I as $n,J as Pa,M as Gr,N as lr,O as ki,P as br,Q as Yi,R as Wn,S as ef}from"./vendor.8c1ac885.js";import{i as st,C as Xi,d as to,w as tf,t as rf,b as io,a as nf,c as af,h as ro}from"./index.028472af.js";const sf=60*1e3,of=60*sf,ur=24*of;var Li={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(h){(function(a,t,i,r){var n=["","webkit","Moz","MS","ms","o"],u=t.createElement("div"),o="function",c=Math.round,g=Math.abs,v=Date.now;function p(M,V,Z){return setTimeout(_(M,Z),V)}function e(M,V,Z){return Array.isArray(M)?(s(M,Z[V],Z),!0):!1}function s(M,V,Z){var le;if(!!M)if(M.forEach)M.forEach(V,Z);else if(M.length!==r)for(le=0;le<M.length;)V.call(Z,M[le],le,M),le++;else for(le in M)M.hasOwnProperty(le)&&V.call(Z,M[le],le,M)}function l(M,V,Z){var le="DEPRECATED METHOD: "+V+`
`+Z+` AT 
`;return function(){var be=new Error("get-stack-trace"),Ue=be&&be.stack?be.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",tt=a.console&&(a.console.warn||a.console.log);return tt&&tt.call(a.console,le,Ue),M.apply(this,arguments)}}var f;typeof Object.assign!="function"?f=function(V){if(V===r||V===null)throw new TypeError("Cannot convert undefined or null to object");for(var Z=Object(V),le=1;le<arguments.length;le++){var be=arguments[le];if(be!==r&&be!==null)for(var Ue in be)be.hasOwnProperty(Ue)&&(Z[Ue]=be[Ue])}return Z}:f=Object.assign;var d=l(function(V,Z,le){for(var be=Object.keys(Z),Ue=0;Ue<be.length;)(!le||le&&V[be[Ue]]===r)&&(V[be[Ue]]=Z[be[Ue]]),Ue++;return V},"extend","Use `assign`."),y=l(function(V,Z){return d(V,Z,!0)},"merge","Use `assign`.");function m(M,V,Z){var le=V.prototype,be;be=M.prototype=Object.create(le),be.constructor=M,be._super=le,Z&&f(be,Z)}function _(M,V){return function(){return M.apply(V,arguments)}}function E(M,V){return typeof M==o?M.apply(V&&V[0]||r,V):M}function w(M,V){return M===r?V:M}function k(M,V,Z){s(U(V),function(le){M.addEventListener(le,Z,!1)})}function x(M,V,Z){s(U(V),function(le){M.removeEventListener(le,Z,!1)})}function S(M,V){for(;M;){if(M==V)return!0;M=M.parentNode}return!1}function P(M,V){return M.indexOf(V)>-1}function U(M){return M.trim().split(/\s+/g)}function R(M,V,Z){if(M.indexOf&&!Z)return M.indexOf(V);for(var le=0;le<M.length;){if(Z&&M[le][Z]==V||!Z&&M[le]===V)return le;le++}return-1}function C(M){return Array.prototype.slice.call(M,0)}function A(M,V,Z){for(var le=[],be=[],Ue=0;Ue<M.length;){var tt=V?M[Ue][V]:M[Ue];R(be,tt)<0&&le.push(M[Ue]),be[Ue]=tt,Ue++}return Z&&(V?le=le.sort(function(dt,St){return dt[V]>St[V]}):le=le.sort()),le}function b(M,V){for(var Z,le,be=V[0].toUpperCase()+V.slice(1),Ue=0;Ue<n.length;){if(Z=n[Ue],le=Z?Z+be:V,le in M)return le;Ue++}return r}var O=1;function W(){return O++}function K(M){var V=M.ownerDocument||M;return V.defaultView||V.parentWindow||a}var G=/mobile|tablet|ip(ad|hone|od)|android/i,B="ontouchstart"in a,j=b(a,"PointerEvent")!==r,z=B&&G.test(navigator.userAgent),$="touch",J="pen",Q="mouse",ne="kinect",Ee=25,we=1,Ae=2,De=4,Ve=8,Ce=1,Me=2,Ge=4,D=8,fe=16,ae=Me|Ge,X=D|fe,H=ae|X,q=["x","y"],ce=["clientX","clientY"];function he(M,V){var Z=this;this.manager=M,this.callback=V,this.element=M.element,this.target=M.options.inputTarget,this.domHandler=function(le){E(M.options.enable,[M])&&Z.handler(le)},this.init()}he.prototype={handler:function(){},init:function(){this.evEl&&k(this.element,this.evEl,this.domHandler),this.evTarget&&k(this.target,this.evTarget,this.domHandler),this.evWin&&k(K(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&x(this.element,this.evEl,this.domHandler),this.evTarget&&x(this.target,this.evTarget,this.domHandler),this.evWin&&x(K(this.element),this.evWin,this.domHandler)}};function te(M){var V,Z=M.options.inputClass;return Z?V=Z:j?V=qt:z?V=xi:B?V=ir:V=ci,new V(M,Te)}function Te(M,V,Z){var le=Z.pointers.length,be=Z.changedPointers.length,Ue=V&we&&le-be==0,tt=V&(De|Ve)&&le-be==0;Z.isFirst=!!Ue,Z.isFinal=!!tt,Ue&&(M.session={}),Z.eventType=V,Le(M,Z),M.emit("hammer.input",Z),M.recognize(Z),M.session.prevInput=Z}function Le(M,V){var Z=M.session,le=V.pointers,be=le.length;Z.firstInput||(Z.firstInput=Xe(V)),be>1&&!Z.firstMultiple?Z.firstMultiple=Xe(V):be===1&&(Z.firstMultiple=!1);var Ue=Z.firstInput,tt=Z.firstMultiple,ut=tt?tt.center:Ue.center,dt=V.center=it(le);V.timeStamp=v(),V.deltaTime=V.timeStamp-Ue.timeStamp,V.angle=Bt(ut,dt),V.distance=yt(ut,dt),Se(Z,V),V.offsetDirection=Ft(V.deltaX,V.deltaY);var St=Je(V.deltaTime,V.deltaX,V.deltaY);V.overallVelocityX=St.x,V.overallVelocityY=St.y,V.overallVelocity=g(St.x)>g(St.y)?St.x:St.y,V.scale=tt?Ci(tt.pointers,le):1,V.rotation=tt?ot(tt.pointers,le):0,V.maxPointers=Z.prevInput?V.pointers.length>Z.prevInput.maxPointers?V.pointers.length:Z.prevInput.maxPointers:V.pointers.length,ze(Z,V);var Ut=M.element;S(V.srcEvent.target,Ut)&&(Ut=V.srcEvent.target),V.target=Ut}function Se(M,V){var Z=V.center,le=M.offsetDelta||{},be=M.prevDelta||{},Ue=M.prevInput||{};(V.eventType===we||Ue.eventType===De)&&(be=M.prevDelta={x:Ue.deltaX||0,y:Ue.deltaY||0},le=M.offsetDelta={x:Z.x,y:Z.y}),V.deltaX=be.x+(Z.x-le.x),V.deltaY=be.y+(Z.y-le.y)}function ze(M,V){var Z=M.lastInterval||V,le=V.timeStamp-Z.timeStamp,be,Ue,tt,ut;if(V.eventType!=Ve&&(le>Ee||Z.velocity===r)){var dt=V.deltaX-Z.deltaX,St=V.deltaY-Z.deltaY,Ut=Je(le,dt,St);Ue=Ut.x,tt=Ut.y,be=g(Ut.x)>g(Ut.y)?Ut.x:Ut.y,ut=Ft(dt,St),M.lastInterval=V}else be=Z.velocity,Ue=Z.velocityX,tt=Z.velocityY,ut=Z.direction;V.velocity=be,V.velocityX=Ue,V.velocityY=tt,V.direction=ut}function Xe(M){for(var V=[],Z=0;Z<M.pointers.length;)V[Z]={clientX:c(M.pointers[Z].clientX),clientY:c(M.pointers[Z].clientY)},Z++;return{timeStamp:v(),pointers:V,center:it(V),deltaX:M.deltaX,deltaY:M.deltaY}}function it(M){var V=M.length;if(V===1)return{x:c(M[0].clientX),y:c(M[0].clientY)};for(var Z=0,le=0,be=0;be<V;)Z+=M[be].clientX,le+=M[be].clientY,be++;return{x:c(Z/V),y:c(le/V)}}function Je(M,V,Z){return{x:V/M||0,y:Z/M||0}}function Ft(M,V){return M===V?Ce:g(M)>=g(V)?M<0?Me:Ge:V<0?D:fe}function yt(M,V,Z){Z||(Z=q);var le=V[Z[0]]-M[Z[0]],be=V[Z[1]]-M[Z[1]];return Math.sqrt(le*le+be*be)}function Bt(M,V,Z){Z||(Z=q);var le=V[Z[0]]-M[Z[0]],be=V[Z[1]]-M[Z[1]];return Math.atan2(be,le)*180/Math.PI}function ot(M,V){return Bt(V[1],V[0],ce)+Bt(M[1],M[0],ce)}function Ci(M,V){return yt(V[0],V[1],ce)/yt(M[0],M[1],ce)}var Nt={mousedown:we,mousemove:Ae,mouseup:De},Wt="mousedown",Di="mousemove mouseup";function ci(){this.evEl=Wt,this.evWin=Di,this.pressed=!1,he.apply(this,arguments)}m(ci,he,{handler:function(V){var Z=Nt[V.type];Z&we&&V.button===0&&(this.pressed=!0),Z&Ae&&V.which!==1&&(Z=De),!!this.pressed&&(Z&De&&(this.pressed=!1),this.callback(this.manager,Z,{pointers:[V],changedPointers:[V],pointerType:Q,srcEvent:V}))}});var vr={pointerdown:we,pointermove:Ae,pointerup:De,pointercancel:Ve,pointerout:Ve},yr={2:$,3:J,4:Q,5:ne},Ji="pointerdown",Kt="pointermove pointerup pointercancel";a.MSPointerEvent&&!a.PointerEvent&&(Ji="MSPointerDown",Kt="MSPointerMove MSPointerUp MSPointerCancel");function qt(){this.evEl=Ji,this.evWin=Kt,he.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}m(qt,he,{handler:function(V){var Z=this.store,le=!1,be=V.type.toLowerCase().replace("ms",""),Ue=vr[be],tt=yr[V.pointerType]||V.pointerType,ut=tt==$,dt=R(Z,V.pointerId,"pointerId");Ue&we&&(V.button===0||ut)?dt<0&&(Z.push(V),dt=Z.length-1):Ue&(De|Ve)&&(le=!0),!(dt<0)&&(Z[dt]=V,this.callback(this.manager,Ue,{pointers:Z,changedPointers:[V],pointerType:tt,srcEvent:V}),le&&Z.splice(dt,1))}});var Oi={touchstart:we,touchmove:Ae,touchend:De,touchcancel:Ve},Qi="touchstart",Fr="touchstart touchmove touchend touchcancel";function er(){this.evTarget=Qi,this.evWin=Fr,this.started=!1,he.apply(this,arguments)}m(er,he,{handler:function(V){var Z=Oi[V.type];if(Z===we&&(this.started=!0),!!this.started){var le=Ii.call(this,V,Z);Z&(De|Ve)&&le[0].length-le[1].length==0&&(this.started=!1),this.callback(this.manager,Z,{pointers:le[0],changedPointers:le[1],pointerType:$,srcEvent:V})}}});function Ii(M,V){var Z=C(M.touches),le=C(M.changedTouches);return V&(De|Ve)&&(Z=A(Z.concat(le),"identifier",!0)),[Z,le]}var Br={touchstart:we,touchmove:Ae,touchend:De,touchcancel:Ve},mr="touchstart touchmove touchend touchcancel";function xi(){this.evTarget=mr,this.targetIds={},he.apply(this,arguments)}m(xi,he,{handler:function(V){var Z=Br[V.type],le=ri.call(this,V,Z);!le||this.callback(this.manager,Z,{pointers:le[0],changedPointers:le[1],pointerType:$,srcEvent:V})}});function ri(M,V){var Z=C(M.touches),le=this.targetIds;if(V&(we|Ae)&&Z.length===1)return le[Z[0].identifier]=!0,[Z,Z];var be,Ue,tt=C(M.changedTouches),ut=[],dt=this.target;if(Ue=Z.filter(function(St){return S(St.target,dt)}),V===we)for(be=0;be<Ue.length;)le[Ue[be].identifier]=!0,be++;for(be=0;be<tt.length;)le[tt[be].identifier]&&ut.push(tt[be]),V&(De|Ve)&&delete le[tt[be].identifier],be++;if(!!ut.length)return[A(Ue.concat(ut),"identifier",!0),ut]}var wt=2500,tr=25;function ir(){he.apply(this,arguments);var M=_(this.handler,this);this.touch=new xi(this.manager,M),this.mouse=new ci(this.manager,M),this.primaryTouch=null,this.lastTouches=[]}m(ir,he,{handler:function(V,Z,le){var be=le.pointerType==$,Ue=le.pointerType==Q;if(!(Ue&&le.sourceCapabilities&&le.sourceCapabilities.firesTouchEvents)){if(be)Ei.call(this,Z,le);else if(Ue&&Or.call(this,le))return;this.callback(V,Z,le)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Ei(M,V){M&we?(this.primaryTouch=V.changedPointers[0].identifier,rr.call(this,V)):M&(De|Ve)&&rr.call(this,V)}function rr(M){var V=M.changedPointers[0];if(V.identifier===this.primaryTouch){var Z={x:V.clientX,y:V.clientY};this.lastTouches.push(Z);var le=this.lastTouches,be=function(){var Ue=le.indexOf(Z);Ue>-1&&le.splice(Ue,1)};setTimeout(be,wt)}}function Or(M){for(var V=M.srcEvent.clientX,Z=M.srcEvent.clientY,le=0;le<this.lastTouches.length;le++){var be=this.lastTouches[le],Ue=Math.abs(V-be.x),tt=Math.abs(Z-be.y);if(Ue<=tr&&tt<=tr)return!0}return!1}var Mi=b(u.style,"touchAction"),Ni=Mi!==r,Ir="compute",_r="auto",nr="manipulation",Zt="none",Ot="pan-x",di="pan-y",bi=zi();function ni(M,V){this.manager=M,this.set(V)}ni.prototype={set:function(M){M==Ir&&(M=this.compute()),Ni&&this.manager.element.style&&bi[M]&&(this.manager.element.style[Mi]=M),this.actions=M.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var M=[];return s(this.manager.recognizers,function(V){E(V.options.enable,[V])&&(M=M.concat(V.getTouchAction()))}),Mr(M.join(" "))},preventDefaults:function(M){var V=M.srcEvent,Z=M.offsetDirection;if(this.manager.session.prevented){V.preventDefault();return}var le=this.actions,be=P(le,Zt)&&!bi[Zt],Ue=P(le,di)&&!bi[di],tt=P(le,Ot)&&!bi[Ot];if(be){var ut=M.pointers.length===1,dt=M.distance<2,St=M.deltaTime<250;if(ut&&dt&&St)return}if(!(tt&&Ue)&&(be||Ue&&Z&ae||tt&&Z&X))return this.preventSrc(V)},preventSrc:function(M){this.manager.session.prevented=!0,M.preventDefault()}};function Mr(M){if(P(M,Zt))return Zt;var V=P(M,Ot),Z=P(M,di);return V&&Z?Zt:V||Z?V?Ot:di:P(M,nr)?nr:_r}function zi(){if(!Ni)return!1;var M={},V=a.CSS&&a.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Z){M[Z]=V?a.CSS.supports("touch-action",Z):!0}),M}var ai=1,xt=2,Jt=4,zt=8,si=zt,mt=16,Tt=32;function gt(M){this.options=f({},this.defaults,M||{}),this.id=W(),this.manager=null,this.options.enable=w(this.options.enable,!0),this.state=ai,this.simultaneous={},this.requireFail=[]}gt.prototype={defaults:{},set:function(M){return f(this.options,M),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(M){if(e(M,"recognizeWith",this))return this;var V=this.simultaneous;return M=pt(M,this),V[M.id]||(V[M.id]=M,M.recognizeWith(this)),this},dropRecognizeWith:function(M){return e(M,"dropRecognizeWith",this)?this:(M=pt(M,this),delete this.simultaneous[M.id],this)},requireFailure:function(M){if(e(M,"requireFailure",this))return this;var V=this.requireFail;return M=pt(M,this),R(V,M)===-1&&(V.push(M),M.requireFailure(this)),this},dropRequireFailure:function(M){if(e(M,"dropRequireFailure",this))return this;M=pt(M,this);var V=R(this.requireFail,M);return V>-1&&this.requireFail.splice(V,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(M){return!!this.simultaneous[M.id]},emit:function(M){var V=this,Z=this.state;function le(be){V.manager.emit(be,M)}Z<zt&&le(V.options.event+hi(Z)),le(V.options.event),M.additionalEvent&&le(M.additionalEvent),Z>=zt&&le(V.options.event+hi(Z))},tryEmit:function(M){if(this.canEmit())return this.emit(M);this.state=Tt},canEmit:function(){for(var M=0;M<this.requireFail.length;){if(!(this.requireFail[M].state&(Tt|ai)))return!1;M++}return!0},recognize:function(M){var V=f({},M);if(!E(this.options.enable,[this,V])){this.reset(),this.state=Tt;return}this.state&(si|mt|Tt)&&(this.state=ai),this.state=this.process(V),this.state&(xt|Jt|zt|mt)&&this.tryEmit(V)},process:function(M){},getTouchAction:function(){},reset:function(){}};function hi(M){return M&mt?"cancel":M&zt?"end":M&Jt?"move":M&xt?"start":""}function ar(M){return M==fe?"down":M==D?"up":M==Me?"left":M==Ge?"right":""}function pt(M,V){var Z=V.manager;return Z?Z.get(M):M}function Vt(){gt.apply(this,arguments)}m(Vt,gt,{defaults:{pointers:1},attrTest:function(M){var V=this.options.pointers;return V===0||M.pointers.length===V},process:function(M){var V=this.state,Z=M.eventType,le=V&(xt|Jt),be=this.attrTest(M);return le&&(Z&Ve||!be)?V|mt:le||be?Z&De?V|zt:V&xt?V|Jt:xt:Tt}});function Vi(){Vt.apply(this,arguments),this.pX=null,this.pY=null}m(Vi,Vt,{defaults:{event:"pan",threshold:10,pointers:1,direction:H},getTouchAction:function(){var M=this.options.direction,V=[];return M&ae&&V.push(di),M&X&&V.push(Ot),V},directionTest:function(M){var V=this.options,Z=!0,le=M.distance,be=M.direction,Ue=M.deltaX,tt=M.deltaY;return be&V.direction||(V.direction&ae?(be=Ue===0?Ce:Ue<0?Me:Ge,Z=Ue!=this.pX,le=Math.abs(M.deltaX)):(be=tt===0?Ce:tt<0?D:fe,Z=tt!=this.pY,le=Math.abs(M.deltaY))),M.direction=be,Z&&le>V.threshold&&be&V.direction},attrTest:function(M){return Vt.prototype.attrTest.call(this,M)&&(this.state&xt||!(this.state&xt)&&this.directionTest(M))},emit:function(M){this.pX=M.deltaX,this.pY=M.deltaY;var V=ar(M.direction);V&&(M.additionalEvent=this.options.event+V),this._super.emit.call(this,M)}});function Hi(){Vt.apply(this,arguments)}m(Hi,Vt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Zt]},attrTest:function(M){return this._super.attrTest.call(this,M)&&(Math.abs(M.scale-1)>this.options.threshold||this.state&xt)},emit:function(M){if(M.scale!==1){var V=M.scale<1?"in":"out";M.additionalEvent=this.options.event+V}this._super.emit.call(this,M)}});function ji(){gt.apply(this,arguments),this._timer=null,this._input=null}m(ji,gt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[_r]},process:function(M){var V=this.options,Z=M.pointers.length===V.pointers,le=M.distance<V.threshold,be=M.deltaTime>V.time;if(this._input=M,!le||!Z||M.eventType&(De|Ve)&&!be)this.reset();else if(M.eventType&we)this.reset(),this._timer=p(function(){this.state=si,this.tryEmit()},V.time,this);else if(M.eventType&De)return si;return Tt},reset:function(){clearTimeout(this._timer)},emit:function(M){this.state===si&&(M&&M.eventType&De?this.manager.emit(this.options.event+"up",M):(this._input.timeStamp=v(),this.manager.emit(this.options.event,this._input)))}});function pi(){Vt.apply(this,arguments)}m(pi,Vt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Zt]},attrTest:function(M){return this._super.attrTest.call(this,M)&&(Math.abs(M.rotation)>this.options.threshold||this.state&xt)}});function Ri(){Vt.apply(this,arguments)}m(Ri,Vt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:ae|X,pointers:1},getTouchAction:function(){return Vi.prototype.getTouchAction.call(this)},attrTest:function(M){var V=this.options.direction,Z;return V&(ae|X)?Z=M.overallVelocity:V&ae?Z=M.overallVelocityX:V&X&&(Z=M.overallVelocityY),this._super.attrTest.call(this,M)&&V&M.offsetDirection&&M.distance>this.options.threshold&&M.maxPointers==this.options.pointers&&g(Z)>this.options.velocity&&M.eventType&De},emit:function(M){var V=ar(M.offsetDirection);V&&this.manager.emit(this.options.event+V,M),this.manager.emit(this.options.event,M)}});function gi(){gt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}m(gi,gt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[nr]},process:function(M){var V=this.options,Z=M.pointers.length===V.pointers,le=M.distance<V.threshold,be=M.deltaTime<V.time;if(this.reset(),M.eventType&we&&this.count===0)return this.failTimeout();if(le&&be&&Z){if(M.eventType!=De)return this.failTimeout();var Ue=this.pTime?M.timeStamp-this.pTime<V.interval:!0,tt=!this.pCenter||yt(this.pCenter,M.center)<V.posThreshold;this.pTime=M.timeStamp,this.pCenter=M.center,!tt||!Ue?this.count=1:this.count+=1,this._input=M;var ut=this.count%V.taps;if(ut===0)return this.hasRequireFailures()?(this._timer=p(function(){this.state=si,this.tryEmit()},V.interval,this),xt):si}return Tt},failTimeout:function(){return this._timer=p(function(){this.state=Tt},this.options.interval,this),Tt},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==si&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Rt(M,V){return V=V||{},V.recognizers=w(V.recognizers,Rt.defaults.preset),new oi(M,V)}Rt.VERSION="2.0.7",Rt.defaults={domEvents:!1,touchAction:Ir,enable:!0,inputTarget:null,inputClass:null,preset:[[pi,{enable:!1}],[Hi,{enable:!1},["rotate"]],[Ri,{direction:ae}],[Vi,{direction:ae},["swipe"]],[gi],[gi,{event:"doubletap",taps:2},["tap"]],[ji]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var tn=1,xr=2;function oi(M,V){this.options=f({},Rt.defaults,V||{}),this.options.inputTarget=this.options.inputTarget||M,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=M,this.input=te(this),this.touchAction=new ni(this,this.options.touchAction),sr(this,!0),s(this.options.recognizers,function(Z){var le=this.add(new Z[0](Z[1]));Z[2]&&le.recognizeWith(Z[2]),Z[3]&&le.requireFailure(Z[3])},this)}oi.prototype={set:function(M){return f(this.options,M),M.touchAction&&this.touchAction.update(),M.inputTarget&&(this.input.destroy(),this.input.target=M.inputTarget,this.input.init()),this},stop:function(M){this.session.stopped=M?xr:tn},recognize:function(M){var V=this.session;if(!V.stopped){this.touchAction.preventDefaults(M);var Z,le=this.recognizers,be=V.curRecognizer;(!be||be&&be.state&si)&&(be=V.curRecognizer=null);for(var Ue=0;Ue<le.length;)Z=le[Ue],V.stopped!==xr&&(!be||Z==be||Z.canRecognizeWith(be))?Z.recognize(M):Z.reset(),!be&&Z.state&(xt|Jt|zt)&&(be=V.curRecognizer=Z),Ue++}},get:function(M){if(M instanceof gt)return M;for(var V=this.recognizers,Z=0;Z<V.length;Z++)if(V[Z].options.event==M)return V[Z];return null},add:function(M){if(e(M,"add",this))return this;var V=this.get(M.options.event);return V&&this.remove(V),this.recognizers.push(M),M.manager=this,this.touchAction.update(),M},remove:function(M){if(e(M,"remove",this))return this;if(M=this.get(M),M){var V=this.recognizers,Z=R(V,M);Z!==-1&&(V.splice(Z,1),this.touchAction.update())}return this},on:function(M,V){if(M!==r&&V!==r){var Z=this.handlers;return s(U(M),function(le){Z[le]=Z[le]||[],Z[le].push(V)}),this}},off:function(M,V){if(M!==r){var Z=this.handlers;return s(U(M),function(le){V?Z[le]&&Z[le].splice(R(Z[le],V),1):delete Z[le]}),this}},emit:function(M,V){this.options.domEvents&&Ht(M,V);var Z=this.handlers[M]&&this.handlers[M].slice();if(!(!Z||!Z.length)){V.type=M,V.preventDefault=function(){V.srcEvent.preventDefault()};for(var le=0;le<Z.length;)Z[le](V),le++}},destroy:function(){this.element&&sr(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function sr(M,V){var Z=M.element;if(!!Z.style){var le;s(M.options.cssProps,function(be,Ue){le=b(Z.style,Ue),V?(M.oldCssProps[le]=Z.style[le],Z.style[le]=be):Z.style[le]=M.oldCssProps[le]||""}),V||(M.oldCssProps={})}}function Ht(M,V){var Z=t.createEvent("Event");Z.initEvent(M,!0,!0),Z.gesture=V,V.target.dispatchEvent(Z)}f(Rt,{INPUT_START:we,INPUT_MOVE:Ae,INPUT_END:De,INPUT_CANCEL:Ve,STATE_POSSIBLE:ai,STATE_BEGAN:xt,STATE_CHANGED:Jt,STATE_ENDED:zt,STATE_RECOGNIZED:si,STATE_CANCELLED:mt,STATE_FAILED:Tt,DIRECTION_NONE:Ce,DIRECTION_LEFT:Me,DIRECTION_RIGHT:Ge,DIRECTION_UP:D,DIRECTION_DOWN:fe,DIRECTION_HORIZONTAL:ae,DIRECTION_VERTICAL:X,DIRECTION_ALL:H,Manager:oi,Input:he,TouchAction:ni,TouchInput:xi,MouseInput:ci,PointerEventInput:qt,TouchMouseInput:ir,SingleTouchInput:er,Recognizer:gt,AttrRecognizer:Vt,Tap:gi,Pan:Vi,Swipe:Ri,Pinch:Hi,Rotate:pi,Press:ji,on:k,off:x,each:s,merge:y,extend:d,assign:f,inherit:m,bindFn:_,prefixed:b});var et=typeof a!="undefined"?a:typeof self!="undefined"?self:{};et.Hammer=Rt,typeof r=="function"&&r.amd?r(function(){return Rt}):h.exports?h.exports=Rt:a[i]=Rt})(window,document,"Hammer")})(Li);var no={};(function(h){const a=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",t=a+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",i="["+a+"]["+t+"]*",r=new RegExp("^"+i+"$"),n=function(o,c){const g=[];let v=c.exec(o);for(;v;){const p=[];p.startIndex=c.lastIndex-v[0].length;const e=v.length;for(let s=0;s<e;s++)p.push(v[s]);g.push(p),v=c.exec(o)}return g},u=function(o){const c=r.exec(o);return!(c===null||typeof c=="undefined")};h.isExist=function(o){return typeof o!="undefined"},h.isEmptyObject=function(o){return Object.keys(o).length===0},h.merge=function(o,c,g){if(c){const v=Object.keys(c),p=v.length;for(let e=0;e<p;e++)g==="strict"?o[v[e]]=[c[v[e]]]:o[v[e]]=c[v[e]]}},h.getValue=function(o){return h.isExist(o)?o:""},h.isName=u,h.getAllMatches=n,h.nameRegexp=i})(no);!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt);!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const lf=no;"<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,lf.nameRegexp);Zs("data-v-ec8edf16");const uf={key:0,class:"placeholder"};Js();var ao=Qs({props:{modelValue:String,labelKey:{type:String,default:"label"},valueKey:{type:String,default:"key"},columns:{type:Array,required:!0}},emits:["update:modelValue"],setup(h,{emit:a}){const t=h,i=$e(!1),r=$e(null);li(()=>t.modelValue,()=>{if(t.modelValue!=null&&t.modelValue!=null){let u=t.columns.find(o=>o[t.valueKey]==t.modelValue);u?r.value=u[t.labelKey]:r.value=t.modelValue}else r.value=null},{immediate:!0});const n=u=>{r.value=u[t.labelKey],a("update:modelValue",u[t.valueKey]),i.value=!1};return(u,o)=>{const c=$t("van-picker"),g=$t("van-popup");return nt(),ft(Wi,null,[Ye("div",{onClick:o[0]||(o[0]=v=>i.value=!0)},[r.value==null?(nt(),ft("div",uf,"\u8BF7\u9009\u62E9")):Ku(u.$slots,"default",{key:1,label:r.value},void 0,!0)]),We(g,{show:i.value,"onUpdate:show":o[2]||(o[2]=v=>i.value=v),round:"",position:"bottom",teleport:"#app"},{default:at(()=>[We(c,{columns:h.columns,"columns-field-names":{text:h.labelKey},onCancel:o[1]||(o[1]=v=>i.value=!1),onConfirm:n},null,8,["columns","columns-field-names"])]),_:1},8,["show"])],64)}}});ao.__scopeId="data-v-ec8edf16";class ff{constructor(){this.startGcService()}startGcService(){return oe(this,null,function*(){let a=()=>oe(this,null,function*(){setTimeout(()=>oe(this,null,function*(){let t=yield st.getAllByIndex("fetch_cache","expire_time",IDBKeyRange.upperBound(Date.now()));for(let i=0;i<t.length;i++){const r=t[i];yield st.delRow("fetch_cache",r.id)}t.length>0&&console.log(`FetchCacheGcService \u6E05\u9664\u8FC7\u671F\u7F13\u5B58${t.length}\u4E2A`),a()}),1e4)});a()})}get(a){return oe(this,null,function*(){let t=yield st.getOneByIndex("fetch_cache","markurl",a);return!t||t.expire_time<=Date.now()?null:t})}set(a,t,i,r){return oe(this,null,function*(){let n=Date.now(),u=n+r;yield st.addOrUpdateRow("fetch_cache",{markurl:a,create_time:n,expire_time:u,req:t,res:i},"markurl")})}setBody(a,t,i){return oe(this,null,function*(){yield this.set(a,{url:"",method:"",headers:{},body:""},{status:200,statusText:"",headers:{},body:t},i)})}getBody(a){return oe(this,null,function*(){let t=yield this.get(a);return t?t.res.body:null})}clear(){return oe(this,null,function*(){yield st.clearStore("fetch_cache")})}}var It=new ff;const so=()=>location.href.startsWith("http://vsong.cpomelo")||location.href.startsWith("http://192.168.")||location.href.startsWith("http://127.0.0.1"),cf=h=>{let a=0,t=[],i=0,r=v=>{let p=Array.isArray(v)?[]:{};return Object.keys(v).forEach(e=>{let s=v[e];s instanceof ArrayBuffer?(p[e]=`[ArrayBuffer]${a},${s.byteLength}`,t.push(s),a+=s.byteLength,i+=s.byteLength):Array.isArray(s)?p[e]=r(s):s===null?p[e]=s:typeof s=="object"?p[e]=r(s):p[e]=s}),p},n=r(h),u=new TextEncoder().encode(JSON.stringify(n)),o=new Uint8Array(6+u.byteLength+i),c=new DataView(o.buffer);c.setUint16(0,23156),c.setUint32(2,u.byteLength);let g=6;return o.set(u,6),g+=u.byteLength,t.forEach(v=>{o.set(new Uint8Array(v),g),g+=v.byteLength}),o.buffer},df=h=>{let a=new DataView(h);a.getUint16(0);let t=a.getUint32(2),i=6,r=new TextDecoder().decode(h.slice(i,i+t)),n=JSON.parse(r);i+=t;let u=o=>{Object.keys(o).forEach(c=>{let g=o[c];if(typeof g=="string"&&g.startsWith("[ArrayBuffer]")){let[v,p]=g.slice("[ArrayBuffer]".length).split(",");o[c]=h.slice(i+Number(v),i+Number(v)+Number(p))}else g&&typeof g=="object"&&u(g)})};return u(n),n};class hf{constructor(){ve(this,"peer");ve(this,"channel");ve(this,"localUfrag");ve(this,"localPwd");ve(this,"remoteIp");ve(this,"remotePort");ve(this,"connectCpl");ve(this,"isClosed");ve(this,"channelMsgMap");ve(this,"channelPackBuffers");ve(this,"requestWaitMap");this.isClosed=!0,this.localPwd="cuntoufangyidaduinidejia",this.remoteIp="127.0.0.1",this.remotePort=28443,this.channelMsgMap=new Map,this.channelPackBuffers=[],this.requestWaitMap=new Map}connect(a){return oe(this,null,function*(){if(this.connectCpl!=null)throw new Error("\u5F53\u524D\u5904\u4E8E\u8FDE\u63A5\u72B6\u6001\u4E2D\uFF01");this.isClosed=!1,(a==null?void 0:a.ip)!==void 0&&(this.remoteIp=a.ip),(a==null?void 0:a.port)!==void 0&&(this.remotePort=a.port),this.connectCpl=new Xi,this.peer=new RTCPeerConnection({iceServers:[]}),this.peer.addEventListener("connectionstatechange",()=>{this.log(`connectionstatechange [${this.peer.connectionState}]`),(this.peer.connectionState=="disconnected"||this.peer.connectionState=="failed")&&this.close()}),this.peer.addEventListener("iceconnectionstatechange",()=>{this.log(`iceconnectionstatechange [${this.peer.iceConnectionState}]`)}),this.channel=this.peer.createDataChannel("HttpOverRtc"),this.channel.binaryType="arraybuffer",this.channel.bufferedAmountLowThreshold=0,this.channel.addEventListener("message",r=>{this.log("channelMessage: ",r),this.handleData(r)}),this.channel.addEventListener("close",()=>{this.log("channelClose"),this.close()}),this.channel.addEventListener("open",()=>{this.log("channelOpen"),this.connectCpl.resolve(!0)}),this.channel.addEventListener("bufferedamountlow",()=>{this.channelPackBuffers.length!=0&&this.channel.send(this.channelPackBuffers.shift())});let t=yield this.peer.createOffer();this.localUfrag=Math.random().toString().slice(2,14),t.sdp=t.sdp.replace(/\r\na=ice-ufrag:.*\r\n/g,`\r
a=ice-ufrag:`+this.localUfrag+`\r
`),t.sdp=t.sdp.replace(/\r\na=ice-pwd:.*\r\n/g,`\r
a=ice-pwd:`+this.localPwd+`\r
`),yield this.peer.setLocalDescription(t);let i={type:"answer",sdp:`v=0\r
o=- 2610138035504400085 1668707003 IN IP4 0.0.0.0\r
s=-\r
t=0 0\r
a=fingerprint:sha-256 F5:14:05:E2:C2:03:16:7C:E8:83:B2:F0:E9:FE:36:47:8E:3C:43:96:17:71:4F:89:2C:E7:DB:2F:E8:70:25:E7\r
a=extmap-allow-mixed\r
a=group:BUNDLE 0\r
m=application 9 UDP/DTLS/SCTP webrtc-datachannel\r
c=IN IP4 0.0.0.0\r
a=setup:active\r
a=mid:0\r
a=sendrecv\r
a=sctp-port:5000\r
a=ice-ufrag:${this.localUfrag}\r
a=ice-pwd:${this.localPwd}\r
a=candidate:2887945528 1 udp 2130706431 ${this.remoteIp} ${this.remotePort} typ host\r
a=end-of-candidates\r
`};return yield this.peer.setRemoteDescription(i),this.connectCpl.toPromise()})}close(){return oe(this,null,function*(){if(!this.isClosed){if(this.isClosed=!0,this.connectCpl==null)throw new Error("\u5F53\u524D\u5904\u4E8E\u672A\u8FDE\u63A5\u72B6\u6001\u4E2D\uFF01");this.connectCpl.reject(!1),this.channel.close(),this.peer.close(),this.peer=null,this.channel=null,this.localUfrag=null,this.connectCpl=null,this.channelMsgMap.clear(),this.channelPackBuffers=[],this.requestWaitMap.forEach(a=>{a.responseCpl.reject(!1)})}})}handleData(a){let t=a.data,i=this.decodeChannelMsgPack(t),r=this.channelMsgMap.get(i.id);if(r||(r={id:i.id,isEof:!1,bufferLength:0,buffers:[]},this.channelMsgMap.set(i.id,r)),r.bufferLength+=i.bodyBuffer.byteLength,r.buffers.push(i.bodyBuffer),r.isEof=i.isEof,r.isEof){this.channelMsgMap.delete(r.id);let n=new Uint8Array(r.bufferLength),u=0;r.buffers.forEach(c=>{n.set(new Uint8Array(c),u),u+=c.byteLength});let o=df(n.buffer);if(o.ResId){let c=this.requestWaitMap.get(o.ResId);if(!c)throw new Error(`\u672A\u77E5\u7684ResId\uFF1A${o.ResId}`);if(this.log("response",o),o.Err)c.responseCpl.reject(o.Err),this.requestWaitMap.delete(c.reqId);else if(c.responseCpl.status=="pending"&&c.responseCpl.resolve({Status:o.Res.Status,StatusCode:o.Res.StatusCode,Headers:o.Res.Headers,arrayBuffer:()=>c.responseBodyCpl.toPromise()}),c.responseBodys.push(o.Res.Body),o.Res.BodyEnd){let g=new Uint8Array(c.responseBodys.reduce((p,e)=>p+e.byteLength,0)),v=0;c.responseBodys.forEach(p=>{g.set(new Uint8Array(p),v),v+=p.byteLength}),c.responseBodyCpl.resolve(g.buffer),this.requestWaitMap.delete(c.reqId)}}}}sendData(a){const t=63*1024-10;let i=parseInt(Math.random().toString().slice(2,10))+1,r=!1,n=0;for(;!r;){let u;a.byteLength-n>t?(u=a.slice(n,n+t),n+=t,r=!1):(u=a.slice(n),n=a.byteLength,r=!0);let o=this.encodeChannelMsgPack({type:1,id:i,isEof:r,length:u.byteLength,bodyBuffer:u});this.channel.bufferedAmount==0&&this.channelPackBuffers.length==0?this.channel.send(o):this.channelPackBuffers.push(o)}}decodeChannelMsgPack(a){const t=10;let i=new DataView(a),r=i.getUint8(0),n=i.getUint32(1),u=i.getUint8(5),o=i.getUint32(6),c=a.slice(t);return{type:r,id:n,isEof:!!u,length:o,bodyBuffer:c}}encodeChannelMsgPack(a){const t=10;let i=new ArrayBuffer(t),r=new DataView(i);r.setUint8(0,a.type),r.setUint32(1,a.id),r.setUint8(5,a.isEof?1:0),r.setUint32(6,a.length);let n=new Uint8Array(i.byteLength+a.bodyBuffer.byteLength);return n.set(new Uint8Array(i),0),n.set(new Uint8Array(a.bodyBuffer),i.byteLength),n.buffer}request(a){return oe(this,null,function*(){if(!this.connectCpl)throw new Error("\u5F53\u524D\u5904\u4E8E\u672A\u8FDE\u63A5\u72B6\u6001\u4E2D\uFF01");yield this.connectCpl.toPromise(),this.log("request",a);let t=Math.random().toString().slice(2,12),i=new Xi;this.requestWaitMap.set(t,{reqId:t,requestOptions:a,responseCpl:i,responseBodys:[],responseBodyCpl:new Xi});let r=a.data;return r&&!(r instanceof ArrayBuffer)&&(r=new TextEncoder().encode(JSON.stringify(r)).buffer),this.sendData(cf({ReqId:t,Req:{Method:a.method.toUpperCase(),Url:a.url,Headers:a.headers,Body:r}})),i.toPromise()})}log(...a){this._xbl===!0&&console.log("hrtc:",...a)}}var pf=new hf;class oo{constructor(){ve(this,"requestInterceptor",{onFulfilled:null,onRejected:null});ve(this,"responseInterceptor",{onFulfilled:null,onRejected:null})}request(a){return oe(this,null,function*(){a.headers||(a.headers={});try{this.requestInterceptor.onFulfilled&&(a=this.requestInterceptor.onFulfilled(a))}catch(t){return this.requestInterceptor.onRejected?Promise.reject(this.requestInterceptor.onRejected(t)):Promise.reject(t)}try{let t=yield pf.request({url:a.url,method:a.method,data:a.data,headers:a.headers});t.Body=yield t.arrayBuffer();let i={};Object.keys(t.Headers).forEach(n=>{i[n.toLowerCase()]=t.Headers[n][0]});let r;if(a.responseType=="blob")r=new Blob([new Uint8Array(t.Body)]);else if(a.responseType=="arraybuffer")r=t.Body;else{r=new TextDecoder().decode(t.Body);try{r=JSON.parse(r)}catch(n){}}if(t.StatusCode>=200&&t.StatusCode<400)return Promise.resolve({data:r,headers:i,status:t.StatusCode,statusText:t.Status});{let n={config:a,response:{data:r,headers:i,status:t.StatusCode,statusText:t.Status},error:{message:"",stack:""}};return this.responseInterceptor.onRejected&&(n=this.responseInterceptor.onRejected(n)),Promise.reject(n)}}catch(t){return t={message:t.Message,stack:""},this.responseInterceptor.onRejected&&(t=this.responseInterceptor.onRejected(t)),Promise.reject(t)}})}get(i){return oe(this,arguments,function*(a,t={}){return t=Ti({},t),t.method="GET",t.url=a,this.request(t)})}post(r,n){return oe(this,arguments,function*(a,t,i={}){return i=Ti({},i),i.method="POST",i.url=a,i.data=t,this.request(i)})}setRequestInterceptor(a,t){this.requestInterceptor.onFulfilled=a,this.requestInterceptor.onRejected=t}setResponseInterceptor(a,t){this.responseInterceptor.onFulfilled=a,this.responseInterceptor.onRejected=t}}const Fa="http://service.vsong.cpomelo.com:8077/api/cross";class gf{constructor(){ve(this,"crossToken","");ve(this,"crossType","default");ve(this,"crossUrl",Fa);ve(this,"defaultAxios");ve(this,"bridgeAxios");ve(this,"proxyAxios");ve(this,"hrtcAxios");ve(this,"getAxios",()=>this.crossType=="proxy"?this.proxyAxios:this.crossType=="bridge"?this.bridgeAxios:this.crossType=="hrtc"?this.hrtcAxios:this.defaultAxios);this.defaultAxios=hn.create({timeout:24e4}),this.defaultAxios.interceptors.request.use(a=>(a.headers["cross-token"]=this.crossToken,a)),this.defaultAxios.interceptors.response.use(a=>a,a=>{if(a.config.noErrorToast)return a;if(a.response){const t=a.response.data;Oe.fail(t.msg)}else Oe.fail(`\u7F51\u7EDC\u9519\u8BEF\uFF1A${a.message}`);return Promise.reject(a)})}init(a,t){return oe(this,null,function*(){if(a){let i=a.split(";").map(u=>u.trim()),r=[],n=[];i.forEach(u=>{!so()&&(u.startsWith("http://192.168")||u.startsWith("http://127.0.0.1"))?n.push(u):r.push(u)}),r.forEach(u=>{this.tryProxyAxios(u).then(()=>t("proxy"))}),n.forEach(u=>{this.tryHrtcAxios(u).then(()=>t("hrtc"))})}yield this.tryDefaultAxios(Fa).then(i=>t(i))})}tryDefaultAxios(a){return oe(this,null,function*(){let t=document.createElement("iframe");return t.src=a+"/bridge",t.setAttribute("style","font-size: 0;width: 0;height: 0;border: none;display:block;"),new Promise((i,r)=>{let n=u=>{u.source==t.contentWindow&&(window.removeEventListener("message",n),this.tryBridgeAxios(a).then(()=>{i("default")}).catch(()=>{i("failed")}))};window.addEventListener("message",n),document.body.appendChild(t),setTimeout(()=>{i("failed")},1e3)})})}tryBridgeAxios(a){return oe(this,null,function*(){try{yield this.initBridgeAxios(a);let t=yield this.getCrossToken(this.bridgeAxios,a);if(!t)throw new Error("Empty Token!");if(this.crossType!="default")throw new Error("Allready Has Proxy!");this.crossType="bridge",this.crossUrl=a,this.crossToken=t,this.overrideXgPlayerFetch(),console.log("\u5DF2\u5207\u6362\u4EE3\u7406: "+a)}catch(t){throw console.log("\u65E0\u6548\u4EE3\u7406\u5730\u5740: "+a),t}})}tryProxyAxios(a){return oe(this,null,function*(){try{let t=hn.create({}),i=yield this.getCrossToken(t,a);if(!i)throw new Error("Empty Token!");if(this.crossType!="default")throw new Error("Allready Has Proxy!");this.proxyAxios=t,this.proxyAxios.interceptors.request.use(r=>(r.headers["cross-token"]=this.crossToken,r)),this.proxyAxios.interceptors.response.use(r=>r,r=>{if(r.config.noErrorToast)return r;if(r.response){const n=r.response.data;Oe.fail(n.msg)}else Oe.fail(`\u7F51\u7EDC\u9519\u8BEF\uFF1A${r.message}`);return Promise.reject(r)}),this.crossType="proxy",this.crossUrl=a,this.crossToken=i,this.overrideXgPlayerFetch(),console.log("\u5DF2\u5207\u6362\u4EE3\u7406: "+a)}catch(t){throw console.log("\u65E0\u6548\u4EE3\u7406\u5730\u5740: "+a),t}})}tryHrtcAxios(a){return oe(this,null,function*(){try{let t=new oo,i=yield this.getCrossToken(t,a);if(!i)throw new Error("Empty Token!");if(this.crossType!="default")throw new Error("Allready Has Proxy!");this.hrtcAxios=t,this.hrtcAxios.setRequestInterceptor(r=>(r.headers["cross-token"]=this.crossToken,r)),this.hrtcAxios.setResponseInterceptor(r=>r,r=>{if(r.config.noErrorToast)return r;if(r.response){const n=r.response.data;Oe.fail(n.msg)}else Oe.fail(`\u7F51\u7EDC\u9519\u8BEF\uFF1A${r.message}`);return Promise.reject(r)}),this.crossType="hrtc",this.crossUrl=a,this.crossToken=i,this.overrideXgPlayerFetch(),console.log("\u5DF2\u5207\u6362\u4EE3\u7406: "+a)}catch(t){throw console.log("\u65E0\u6548\u4EE3\u7406\u5730\u5740: "+a),t}})}overrideXgPlayerFetch(){return oe(this,null,function*(){let a;this.crossType!="default"&&(a=(t,i)=>this.getAxios().get(t,{responseType:"arraybuffer"}).then(r=>new Response(r.data))),window.overrideXgFetch=a})}getCrossToken(a,t){return oe(this,null,function*(){let i=localStorage.getItem("vsong_token");return(yield a.get(t+"/token",{headers:{Authorization:"Bearer "+i},timeout:500,noErrorToast:!0})).data.data})}initBridgeAxios(a){return oe(this,null,function*(){const t=document.getElementById("bridgeIframe");this.bridgeAxios=new vf({bridgeIframe:t,bridgeSrc:a+"/bridge"}),this.bridgeAxios.setRequestInterceptor(i=>(!i.url.startsWith("http://")&&!i.url.startsWith("https://")?i.url="http://service.vsong.cpomelo.com:8077/api"+i.url:i.headers["cross-token"]=this.crossToken,i)),this.bridgeAxios.setResponseInterceptor(i=>i.config.url.startsWith(Fa)?i:i.config.url.startsWith("http://service.vsong.cpomelo.com:8077/api")?i.data:i,i=>{if(i.config.noErrorToast)return i;if(i.response){const r=i.response.data;Oe.fail(r.msg)}else Oe.fail(`\u7F51\u7EDC\u9519\u8BEF\uFF1A${i.message}`);return i})})}buildCrossUrl({url:a,referer:t=void 0,cache:i=void 0,withToken:r=void 0}){let n=this.crossUrl+`?agent=pc&url=${encodeURIComponent(a)}`;return t||(t=new URL(a).origin),n+=`&ref=${encodeURIComponent(t)}`,i&&(n+=`&cache=${encodeURIComponent(i)}`),r&&(n+="&token="+this.crossToken),n}buildCustomCrossUrl({url:a,method:t,headers:i,cache:r=void 0,withToken:n=!1}){let u=`${this.crossUrl}/custom?url=${encodeURIComponent(a)}&method=${t}&headers=${encodeURIComponent(JSON.stringify(i))}`;return r!=null&&(u+=`&cache=${encodeURIComponent(r)}`),n===!0&&(u+=`&token=${this.crossToken}`),u}buildCrossM3u8({url:a,method:t,headers:i,cache:r=void 0,withToken:n=!1}){let u=`${this.crossUrl}/m3u8/file?url=${encodeURIComponent(a)}&method=${t}&headers=${encodeURIComponent(JSON.stringify(i))}`;return r!=null&&(u+=`&cache=${encodeURIComponent(r)}`),n===!0&&(u+=`&token=${this.crossToken}`),u}getCrossUrl(){return this.crossUrl}getCrossType(){return this.crossType}getRedirectInfo(a){return oe(this,null,function*(){return(yield this.getAxios().get(this.crossUrl+`/redirect-info?url=${a}`)).data.data.headers.location})}}class vf{constructor({bridgeIframe:a,bridgeSrc:t}){ve(this,"requestPool",{});ve(this,"bridgeIframe");ve(this,"bridgeWindow");ve(this,"bridgeSrc");ve(this,"bridgeOrigin");ve(this,"initCpt",new Xi);ve(this,"requestInterceptor",{onFulfilled:null,onRejected:null});ve(this,"responseInterceptor",{onFulfilled:null,onRejected:null});this.bridgeIframe=a,this.bridgeSrc=t,this.bridgeOrigin=this.bridgeSrc.match(/(http|https):\/\/[A-Za-z0-9_\-\+.:@]*/)[0],this.bridgeIframe.setAttribute("src",this.bridgeSrc),window.addEventListener("message",i=>{if(i.origin!=this.bridgeOrigin)return;let r=i.data;if(r.event==="ready")this.bridgeWindow=this.bridgeIframe.contentWindow,this.initCpt.resolve(!0);else if(r.event==="response"){let n=r.data.resId,u=this.requestPool[n];if(!u)return;if(r.data.success){let o=r.data.response;this.responseInterceptor.onFulfilled&&(o=this.responseInterceptor.onFulfilled(o)),u.cpl.resolve(o)}else{let o=new Error(r.data.error.message);o.stack=r.data.error.stack,o.response=r.data.response,o.config=r.data.config,this.responseInterceptor.onRejected&&(o=this.responseInterceptor.onRejected(o)),u.cpl.reject(o)}delete this.requestPool[n]}})}request(a){return oe(this,null,function*(){yield this.initCpt.toPromise();let t="r"+Math.random().toString().slice(2,10);a.headers||(a.headers={});try{this.requestInterceptor.onFulfilled&&(a=this.requestInterceptor.onFulfilled(a))}catch(r){return this.requestInterceptor.onRejected?Promise.reject(this.requestInterceptor.onRejected(r)):Promise.reject(r)}this.bridgeWindow.postMessage({event:"request",data:{reqId:t,requestConfig:a}},this.bridgeOrigin);let i=new Xi;return this.requestPool[t]={cpl:i},i.toPromise()})}get(i){return oe(this,arguments,function*(a,t={}){return t=Ti({},t),t.method="GET",t.url=a,this.request(t)})}post(r,n){return oe(this,arguments,function*(a,t,i={}){return i=Ti({},i),i.method="POST",i.url=a,i.data=t,this.request(i)})}setRequestInterceptor(a,t){this.requestInterceptor.onFulfilled=a,this.requestInterceptor.onRejected=t}setResponseInterceptor(a,t){this.responseInterceptor.onFulfilled=a,this.responseInterceptor.onRejected=t}}var Et=new gf;class yf{constructor(){ve(this,"axios")}getUserInfo(t){return oe(this,arguments,function*({sec_uid:a}){try{let i=yield this.getAwemeList({sec_uid:a},{order:"pubdate",max_cursor:"",count:50,forceRefresh:!1,isPageEnd:!1});return{face:i[0].author_avatar,name:i[0].author}}catch(i){return{face:"",name:"\u4E00\u4E00"}}})}getAwemeList(i,r){return oe(this,arguments,function*({sec_uid:a},t){let n=`/douyin/aweme-list?sec_uid=${a}&max_cursor=${t.max_cursor}&count=${t.count}`,u;try{t.forceRefresh||(u=yield It.getBody(n)),u||(u=yield this.axios.get(n,{headers:{"Cache-Control":"max-age=0"}}),yield It.setBody(n,u,180*ur)),t.max_cursor=u.data.max_cursor;let o=u.data.aweme_list;return o.map((c,g)=>{let v=u.data.request_item_cursor.toString();return g>=1&&!o[g-1].is_top&&(v=o[g-1].create_time+"000"),{vsongId:`dyAweme_${c.aweme_id}`,vsongType:"dyAweme",author:c.author.nickname,title:c.desc,coverUrl:c.video.cover.url_list[0],originUrl:`https://www.douyin.com/video/${c.aweme_id}`,sec_uid:a,aweme_id:c.aweme_id,videoUrl:c.video.play_addr.url_list[0],min_cursor:v,created:c.create_time,digg_count:c.statistics.digg_count,aweme_type:c.aweme_type,author_avatar:c.author.avatar_thumb.url_list[0]}}).filter(c=>c.aweme_type!=2)}catch(o){throw o}})}getAwemeList111(i,r){return oe(this,arguments,function*({sec_uid:a},t){let n=`https://www.douyin.com/aweme/v1/web/aweme/post/?aid=6383&sec_user_id=${a}&max_cursor=${t.max_cursor}&count=${t.count}`,u;if(t.forceRefresh||(u=yield It.getBody(n)),!u){let c=yield this.signUrl(n,"max-age=0");u=yield Et.getAxios().get(Et.buildCustomCrossUrl({url:c.url,method:"GET",headers:{accept:"application/json, text/plain, */*","user-agent":c.userAgent,"sec-fetch-site":"same-origin","sec-fetch-mode":"cors","sec-fetch-dest":"empty",referer:"https://www.douyin.com/","accept-language":"zh-CN,zh;q=0.9",cookie:c.cookie},cache:"max-age=0"})),u=u.data,It.setBody(n,u,5*ur)}t.max_cursor=u.max_cursor;let o=u.aweme_list;return o.map((c,g)=>{let v=u.request_item_cursor.toString();return g>=1&&!o[g-1].is_top&&(v=o[g-1].create_time+"000"),{vsongId:`dyAweme_${c.aweme_id}`,vsongType:"dyAweme",author:c.author.nickname,title:c.desc,coverUrl:c.video.cover.url_list[0],originUrl:`https://www.douyin.com/video/${c.aweme_id}`,sec_uid:a,aweme_id:c.aweme_id,videoUrl:c.video.play_addr.url_list[0],min_cursor:v,created:c.create_time,digg_count:c.statistics.digg_count,aweme_type:c.aweme_type,author_avatar:c.author.avatar_thumb.url_list[0]}}).filter(c=>c.aweme_type!=2)})}signUrl(a,t){return oe(this,null,function*(){return(yield Et.getAxios().get(Et.buildCrossUrl({url:`https://www.cpomelo.com/tassa/api/parsedy/sign-url?url=${encodeURIComponent(a)}`,cache:t}))).data.data})}getMediaUrl(r){return oe(this,arguments,function*({sec_uid:a,min_cursor:t,aweme_id:i}){let n=yield this.getAwemeList({sec_uid:a},{max_cursor:t,count:5,forceRefresh:!0}),u=n.find(o=>i==o.aweme_id);return u||(n=yield this.getAwemeList({sec_uid:a},{max_cursor:t,count:50,forceRefresh:!0}),u=n.find(o=>i==o.aweme_id)),{videoUrl:u.videoUrl,coverUrl:u.coverUrl}})}makeCrossUrl(a,{cache:t="max-age="+3600*1,withToken:i=!1}){return Et.buildCrossUrl({url:a,cache:t,withToken:i,referer:"https://www.douyin.com"})}setAxios(a){this.axios=a}}var ei=new yf,Ba={exports:{}},lo={},Yn={ROOT:0,GROUP:1,POSITION:2,SET:3,RANGE:4,REPETITION:5,REFERENCE:6,CHAR:7},Ki={};const ct=Yn,Oa=()=>[{type:ct.RANGE,from:48,to:57}],uo=()=>[{type:ct.CHAR,value:95},{type:ct.RANGE,from:97,to:122},{type:ct.RANGE,from:65,to:90}].concat(Oa()),fo=()=>[{type:ct.CHAR,value:9},{type:ct.CHAR,value:10},{type:ct.CHAR,value:11},{type:ct.CHAR,value:12},{type:ct.CHAR,value:13},{type:ct.CHAR,value:32},{type:ct.CHAR,value:160},{type:ct.CHAR,value:5760},{type:ct.RANGE,from:8192,to:8202},{type:ct.CHAR,value:8232},{type:ct.CHAR,value:8233},{type:ct.CHAR,value:8239},{type:ct.CHAR,value:8287},{type:ct.CHAR,value:12288},{type:ct.CHAR,value:65279}],mf=()=>[{type:ct.CHAR,value:10},{type:ct.CHAR,value:13},{type:ct.CHAR,value:8232},{type:ct.CHAR,value:8233}];Ki.words=()=>({type:ct.SET,set:uo(),not:!1});Ki.notWords=()=>({type:ct.SET,set:uo(),not:!0});Ki.ints=()=>({type:ct.SET,set:Oa(),not:!1});Ki.notInts=()=>({type:ct.SET,set:Oa(),not:!0});Ki.whitespace=()=>({type:ct.SET,set:fo(),not:!1});Ki.notWhitespace=()=>({type:ct.SET,set:fo(),not:!0});Ki.anyChar=()=>({type:ct.SET,set:mf(),not:!0});(function(h){const a=Yn,t=Ki,i="@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^ ?",r={"0":0,t:9,n:10,v:11,f:12,r:13};h.strToChars=function(n){var u=/(\[\\b\])|(\\)?\\(?:u([A-F0-9]{4})|x([A-F0-9]{2})|(0?[0-7]{2})|c([@A-Z[\\\]^?])|([0tnvfr]))/g;return n=n.replace(u,function(o,c,g,v,p,e,s,l){if(g)return o;var f=c?8:v?parseInt(v,16):p?parseInt(p,16):e?parseInt(e,8):s?i.indexOf(s):r[l],d=String.fromCharCode(f);return/[[\]{}^$.|?*+()]/.test(d)&&(d="\\"+d),d}),n},h.tokenizeClass=(n,u)=>{for(var o=[],c=/\\(?:(w)|(d)|(s)|(W)|(D)|(S))|((?:(?:\\)(.)|([^\]\\]))-(?:\\)?([^\]]))|(\])|(?:\\)?([^])/g,g,v;(g=c.exec(n))!=null;)if(g[1])o.push(t.words());else if(g[2])o.push(t.ints());else if(g[3])o.push(t.whitespace());else if(g[4])o.push(t.notWords());else if(g[5])o.push(t.notInts());else if(g[6])o.push(t.notWhitespace());else if(g[7])o.push({type:a.RANGE,from:(g[8]||g[9]).charCodeAt(0),to:g[10].charCodeAt(0)});else if(v=g[12])o.push({type:a.CHAR,value:v.charCodeAt(0)});else return[o,c.lastIndex];h.error(u,"Unterminated character class")},h.error=(n,u)=>{throw new SyntaxError("Invalid regular expression: /"+n+"/: "+u)}})(lo);var vn={};const Xn=Yn;vn.wordBoundary=()=>({type:Xn.POSITION,value:"b"});vn.nonWordBoundary=()=>({type:Xn.POSITION,value:"B"});vn.begin=()=>({type:Xn.POSITION,value:"^"});vn.end=()=>({type:Xn.POSITION,value:"$"});const $r=lo,yi=Yn,wr=Ki,Kn=vn;Ba.exports=h=>{var a=0,t,i,r={type:yi.ROOT,stack:[]},n=r,u=r.stack,o=[],c=y=>{$r.error(h,`Nothing to repeat at column ${y-1}`)},g=$r.strToChars(h);for(t=g.length;a<t;)switch(i=g[a++],i){case"\\":switch(i=g[a++],i){case"b":u.push(Kn.wordBoundary());break;case"B":u.push(Kn.nonWordBoundary());break;case"w":u.push(wr.words());break;case"W":u.push(wr.notWords());break;case"d":u.push(wr.ints());break;case"D":u.push(wr.notInts());break;case"s":u.push(wr.whitespace());break;case"S":u.push(wr.notWhitespace());break;default:/\d/.test(i)?u.push({type:yi.REFERENCE,value:parseInt(i,10)}):u.push({type:yi.CHAR,value:i.charCodeAt(0)})}break;case"^":u.push(Kn.begin());break;case"$":u.push(Kn.end());break;case"[":var v;g[a]==="^"?(v=!0,a++):v=!1;var p=$r.tokenizeClass(g.slice(a),h);a+=p[1],u.push({type:yi.SET,set:p[0],not:v});break;case".":u.push(wr.anyChar());break;case"(":var e={type:yi.GROUP,stack:[],remember:!0};i=g[a],i==="?"&&(i=g[a+1],a+=2,i==="="?e.followedBy=!0:i==="!"?e.notFollowedBy=!0:i!==":"&&$r.error(h,`Invalid group, character '${i}' after '?' at column ${a-1}`),e.remember=!1),u.push(e),o.push(n),n=e,u=e.stack;break;case")":o.length===0&&$r.error(h,`Unmatched ) at column ${a-1}`),n=o.pop(),u=n.options?n.options[n.options.length-1]:n.stack;break;case"|":n.options||(n.options=[n.stack],delete n.stack);var s=[];n.options.push(s),u=s;break;case"{":var l=/^(\d+)(,(\d+)?)?\}/.exec(g.slice(a)),f,d;l!==null?(u.length===0&&c(a),f=parseInt(l[1],10),d=l[2]?l[3]?parseInt(l[3],10):1/0:f,a+=l[0].length,u.push({type:yi.REPETITION,min:f,max:d,value:u.pop()})):u.push({type:yi.CHAR,value:123});break;case"?":u.length===0&&c(a),u.push({type:yi.REPETITION,min:0,max:1,value:u.pop()});break;case"+":u.length===0&&c(a),u.push({type:yi.REPETITION,min:1,max:1/0,value:u.pop()});break;case"*":u.length===0&&c(a),u.push({type:yi.REPETITION,min:0,max:1/0,value:u.pop()});break;default:u.push({type:yi.CHAR,value:i.charCodeAt(0)})}return o.length!==0&&$r.error(h,"Unterminated group"),r};Ba.exports.types=yi;class Pi{constructor(a,t){this.low=a,this.high=t,this.length=1+t-a}overlaps(a){return!(this.high<a.low||this.low>a.high)}touches(a){return!(this.high+1<a.low||this.low-1>a.high)}add(a){return new Pi(Math.min(this.low,a.low),Math.max(this.high,a.high))}subtract(a){return a.low<=this.low&&a.high>=this.high?[]:a.low>this.low&&a.high<this.high?[new Pi(this.low,a.low-1),new Pi(a.high+1,this.high)]:a.low<=this.low?[new Pi(a.high+1,this.high)]:[new Pi(this.low,a.low-1)]}toString(){return this.low==this.high?this.low.toString():this.low+"-"+this.high}}class Wr{constructor(a,t){this.ranges=[],this.length=0,a!=null&&this.add(a,t)}_update_length(){this.length=this.ranges.reduce((a,t)=>a+t.length,0)}add(a,t){var i=r=>{for(var n=0;n<this.ranges.length&&!r.touches(this.ranges[n]);)n++;for(var u=this.ranges.slice(0,n);n<this.ranges.length&&r.touches(this.ranges[n]);)r=r.add(this.ranges[n]),n++;u.push(r),this.ranges=u.concat(this.ranges.slice(n)),this._update_length()};return a instanceof Wr?a.ranges.forEach(i):(t==null&&(t=a),i(new Pi(a,t))),this}subtract(a,t){var i=r=>{for(var n=0;n<this.ranges.length&&!r.overlaps(this.ranges[n]);)n++;for(var u=this.ranges.slice(0,n);n<this.ranges.length&&r.overlaps(this.ranges[n]);)u=u.concat(this.ranges[n].subtract(r)),n++;this.ranges=u.concat(this.ranges.slice(n)),this._update_length()};return a instanceof Wr?a.ranges.forEach(i):(t==null&&(t=a),i(new Pi(a,t))),this}intersect(a,t){var i=[],r=n=>{for(var u=0;u<this.ranges.length&&!n.overlaps(this.ranges[u]);)u++;for(;u<this.ranges.length&&n.overlaps(this.ranges[u]);){var o=Math.max(this.ranges[u].low,n.low),c=Math.min(this.ranges[u].high,n.high);i.push(new Pi(o,c)),u++}};return a instanceof Wr?a.ranges.forEach(r):(t==null&&(t=a),r(new Pi(a,t))),this.ranges=i,this._update_length(),this}index(a){for(var t=0;t<this.ranges.length&&this.ranges[t].length<=a;)a-=this.ranges[t].length,t++;return this.ranges[t].low+a}toString(){return"[ "+this.ranges.join(", ")+" ]"}clone(){return new Wr(this)}numbers(){return this.ranges.reduce((a,t)=>{for(var i=t.low;i<=t.high;)a.push(i),i++;return a},[])}subranges(){return this.ranges.map(a=>({low:a.low,high:a.high,length:1+a.high-a.low}))}}var _f=Wr;const qn=Ba.exports,yn=_f,Tr=qn.types;var xf=class Ia{constructor(a,t){if(this._setDefaults(a),a instanceof RegExp)this.ignoreCase=a.ignoreCase,this.multiline=a.multiline,a=a.source;else if(typeof a=="string")this.ignoreCase=t&&t.indexOf("i")!==-1,this.multiline=t&&t.indexOf("m")!==-1;else throw new Error("Expected a regexp or string");this.tokens=qn(a)}_setDefaults(a){this.max=a.max!=null?a.max:100,this.defaultRange=a.defaultRange?a.defaultRange:this.defaultRange.clone(),a.randInt&&(this.randInt=a.randInt)}gen(){return this._gen(this.tokens,[])}_gen(a,t){var i,r,n,u,o;switch(a.type){case Tr.ROOT:case Tr.GROUP:if(a.followedBy||a.notFollowedBy)return"";for(a.remember&&a.groupNumber===void 0&&(a.groupNumber=t.push(null)-1),i=a.options?this._randSelect(a.options):a.stack,r="",u=0,o=i.length;u<o;u++)r+=this._gen(i[u],t);return a.remember&&(t[a.groupNumber]=r),r;case Tr.POSITION:return"";case Tr.SET:var c=this._expand(a);return c.length?String.fromCharCode(this._randSelect(c)):"";case Tr.REPETITION:for(n=this.randInt(a.min,a.max===1/0?a.min+this.max:a.max),r="",u=0;u<n;u++)r+=this._gen(a.value,t);return r;case Tr.REFERENCE:return t[a.value-1]||"";case Tr.CHAR:var g=this.ignoreCase&&this._randBool()?this._toOtherCase(a.value):a.value;return String.fromCharCode(g)}}_toOtherCase(a){return a+(97<=a&&a<=122?-32:65<=a&&a<=90?32:0)}_randBool(){return!this.randInt(0,1)}_randSelect(a){return a instanceof yn?a.index(this.randInt(0,a.length-1)):a[this.randInt(0,a.length-1)]}_expand(a){if(a.type===qn.types.CHAR)return new yn(a.value);if(a.type===qn.types.RANGE)return new yn(a.from,a.to);{let t=new yn;for(let i=0;i<a.set.length;i++){let r=this._expand(a.set[i]);if(t.add(r),this.ignoreCase)for(let n=0;n<r.length;n++){let u=r.index(n),o=this._toOtherCase(u);u!==o&&t.add(o)}}return a.not?this.defaultRange.clone().subtract(t):this.defaultRange.clone().intersect(t)}}randInt(a,t){return a+Math.floor(Math.random()*(1+t-a))}get defaultRange(){return this._range=this._range||new yn(32,126)}set defaultRange(a){this._range=a}static randexp(a,t){var i;return typeof a=="string"&&(a=new RegExp(a,t)),a._randexp===void 0?(i=new Ia(a,t),a._randexp=i):(i=a._randexp,i._setDefaults(a)),i.gen()}static sugar(){RegExp.prototype.gen=function(){return Ia.randexp(this)}}};let co=!1;const Sr=h=>(h!==void 0&&(co=h),co),Ma=h=>(h!==void 0&&localStorage.setItem("isOfflineChange",JSON.stringify(h)),JSON.parse(localStorage.getItem("isOfflineChange")));let Ef=new xf(/Mozilla\/5\.0 \(Windows NT 1(0|0|1)\.0; Win64; x64\) AppleWebKit\/537\.36 \(KHTML, like Gecko\) Chrome\/__VER__ Safari\/537\.36/).gen().replace("__VER__",Math.floor(Math.random()*10+107).toString()+".0.0.0");const bf=()=>Ef,ho=(h,a,t)=>{let i=h.indexOf(a);if(i==-1)return null;i+=a.length;let r=h.indexOf(t,i);return r==-1&&(r=void 0),h.slice(i,r)};class wf{constructor(){ve(this,"disableCacheUrlFlags",{});ve(this,"axios");ve(this,"wbiStr","");ve(this,"wbiStrCpl",null)}getUserInfo(t){return oe(this,arguments,function*({mid:a}){try{if(Sr())throw new Error("Offline!");let i=yield this.axios.get(`/bilibili/user-info?mid=${a}`,{headers:{"Cache-Control":"max-age="+3600*24}});return{face:i.data.face,name:i.data.name}}catch(i){return{face:"",name:"\u4E00\u4E00"}}})}getAwemeList(i,r){return oe(this,arguments,function*({mid:a},t){let n=`/bilibili/aweme-list?mid=${a}&page=${t.page}&count=${t.count}&order=${t.order}`,u;try{return t.forceRefresh||(u=yield It.getBody(n)),u||(u=yield this.axios.get(n,{headers:{"Cache-Control":"max-age=0"}}),It.setBody(n,u,180*ur)),u.data.list.vlist.map(o=>({vsongId:`biAweme_${o.bvid}`,vsongType:"biAweme",author:o.author,title:o.title,coverUrl:o.pic,originUrl:`https://www.bilibili.com/video/${o.bvid}/`,bvid:o.bvid,mid:o.mid,created:o.created}))}catch(o){throw o}})}getPageList(i,r){return oe(this,arguments,function*({bvid:a},t){let n=`parseUrl|https://www.bilibili.com/video/${a}/`,u;t.forceRefresh||(u=yield It.getBody(n)),u||(u=yield this.parseUrl(`https://www.bilibili.com/video/${a}/`),It.setBody(n,u,180*ur));let o=u,c=[];return o.ugc_season?c=o.ugc_season.sections[0].episodes.map(g=>({vsongId:`biAweme_${g.bvid}_${g.page.page}`,vsongType:"biAweme",author:o.upName,title:g.title,coverUrl:g.arc.pic,originUrl:`https://www.bilibili.com/video/${g.bvid}/?p=${g.page.page}`,bvid:g.bvid,mid:o.vsongItem.mid,created:g.arc.ctime})):c=o.pages.map(g=>({vsongId:`biAweme_${o.bvid}_${g.page}`,vsongType:"biAweme",author:o.upName,title:g.part,coverUrl:o.coverUrl,originUrl:`https://www.bilibili.com/video/${a}/?p=${g.page}`,bvid:o.vsongItem.bvid,mid:o.vsongItem.mid,created:o.vsongItem.created})),{title:o.title,list:c}})}getDynamicList(){return oe(this,null,function*(){let a=yield this.axios.get(`/bilibili/dynamic-list?page=${1}`,{});return a.data==null?[]:a.data.items.map(i=>({vsongId:`biAweme_${i.modules.module_dynamic.major.archive.bvid}`,vsongType:"biAweme",author:i.modules.module_author.name,title:i.modules.module_dynamic.major.archive.title,coverUrl:i.modules.module_dynamic.major.archive.cover,originUrl:`https://www.bilibili.com/video/${i.modules.module_dynamic.major.archive.bvid}/`,bvid:i.modules.module_dynamic.major.archive.bvid,mid:i.modules.module_author.mid,created:i.modules.module_author.pub_ts}))})}parseShortUrl(a){return oe(this,null,function*(){return yield Et.getRedirectInfo(a)})}parseUrl(a){return oe(this,null,function*(){let t=this.disableCacheUrlFlags[a]||0;try{let i=yield Et.getAxios().get(Et.buildCustomCrossUrl({url:a,method:"get",headers:{"accept-language":"zh-CN,zh;q=0.9",origin:"https://www.bilibili.com",referer:"https://www.bilibili.com","user-agent":bf()},cache:"max-age="+(3600*2+t)})),r=JSON.parse(ho(i.data,"<script>window.__playinfo__=","<\/script>")),n=JSON.parse(ho(i.data,"<script>window.__INITIAL_STATE__=",";(function(){"));return console.log(n),console.log(r),{originUrl:a,coverUrl:n.videoData.pic,audioUrl:r.data.dash.audio[0].baseUrl,audioSegmentBase:r.data.dash.audio[0].segment_base,videoUrl:r.data.dash.video[0].baseUrl,videoSegmentBase:r.data.dash.video[0].segment_base,shareUrl:`https://www.bilibili.com/blackboard/html5mobileplayer.html?aid=${n.videoData.aid}&bvid=${n.videoData.bvid}&cid=${n.videoData.cid}&page=${n.p}&high_quality=1&posterFirst=1`,title:n.videoData.title,upName:n.upData.name,upAvatar:n.upData.face,aid:n.videoData.aid,cid:n.videoData.cid,bvid:n.bvid,mid:n.upData.mid,pages:n.videoData.pages,ugc_season:n.videoData.ugc_season,vsongItem:{vsongId:`biAweme_${n.bvid}`,vsongType:"biAweme",author:n.upData.name,title:n.videoData.title,coverUrl:n.videoData.pic,originUrl:`https://www.bilibili.com/video/${n.bvid}/`,bvid:n.bvid,mid:n.upData.mid,created:n.videoData.ctime}}}catch(i){throw this.disableCacheUrlFlags[t]=t+1,i}})}getMediaUrl(t){return oe(this,arguments,function*({url:a}){return(yield this.axios.get(`/bilibili/media-url?url=${a}`,{headers:{"Cache-Control":"max-age="+3600*3}})).data})}makeCrossUrl(a,{cache:t="max-age="+3600*1,withToken:i=!1}){return Et.buildCrossUrl({url:a,cache:t,withToken:i,referer:"https://www.bilibili.com"})}setAxios(a){this.axios=a}}var kt=new wf;class Tf{constructor(){ve(this,"axios")}getAwemeList(i,r){return oe(this,arguments,function*({folderId:a=""},t){let n=`/vsong/alipan-list?folderId=${a}&marker=${encodeURIComponent(t.nextMarker)}&keyword=${encodeURIComponent(t.keyword)}`,u;t.forceRefresh||(u=yield It.getBody(n)),u||(u=yield this.axios.get(n,{headers:{"Cache-Control":"max-age=0"}}),It.setBody(n,u,5*ur)),t.nextMarker=u.data.nextMarker,t.nextMarker==""&&(t.isPageEnd=!0);let o=u.data.fileList.map(g=>{let v={vsongId:`alipanAweme_${g.file_id}`,vsongType:"alipanAweme",author:"\u4E00\u4E00",title:g.name,coverUrl:"",originUrl:"",fileId:g.file_id,fileUrl:g.url,parentId:g.parent_file_id,category:g.category,mime_type:g.mime_type,audio_code_name:"",video_code_name:"",created:new Date(g.created_at).getTime()};return g.category==="audio"?(v.coverUrl=g.video_preview_metadata.audio_music_meta.cover_url,v.author=g.video_preview_metadata.audio_music_meta.artist||v.author):g.category==="video"&&(v.coverUrl=g.thumbnail,g.video_media_metadata.video_media_audio_stream.length>=1&&(v.audio_code_name=g.video_media_metadata.video_media_audio_stream[0].code_name),g.video_media_metadata.video_media_video_stream.length>=1&&(v.video_code_name=g.video_media_metadata.video_media_video_stream[0].code_name)),v}),c=u.data.folderList.map(g=>({vsongFolderId:`alipanAwemeFolder_${g.file_id}`,vsongFolderType:"alipanAwemeFolder",title:g.name,folderId:g.file_id}));return{awemeList:o,folderList:c}})}getMediaUrl(o){return oe(this,arguments,function*({fileId:a,category:t,fileName:i,mime_type:r,audio_code_name:n,video_code_name:u}){let c="",g=3600*1;t=="video"&&this.isSupportMime(r,n,u)?c="/vsong/alipan-file-url?fileId="+a:t=="video"?c=`/vsong/alipan-preview-url?fileId=${a}&category=${t}`:t=="audio"&&(i.endsWith(".wma")||i.endsWith(".ape"))?c=`/vsong/alipan-preview-url?fileId=${a}&category=${t}`:c="/vsong/alipan-file-url?fileId="+a;let v=yield this.axios.get(c,{headers:{"Cache-Control":"max-age="+g}});return{audioUrl:t=="audio"?v.data:null,videoUrl:t=="video"?v.data:null,coverUrl:null}})}makeCrossUrl(a,{cache:t="max-age="+3600*1,withToken:i=!1}){return Et.buildCustomCrossUrl({url:a,method:"GET",headers:{authority:"api.aliyundrive.com",accept:"application/json, text/plain, */*","accept-language":"zh-CN,zh;q=0.9",origin:"https://www.aliyundrive.com",referer:"https://www.aliyundrive.com/","sec-ch-ua":'"Chromium";v="104", " Not A;Brand";v="99", "Google Chrome";v="104"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-site","user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36"},cache:t,withToken:i})}makeCrossM3u8(a,{cache:t="max-age="+3600*1,withToken:i=!1}){return Et.buildCrossM3u8({url:a,method:"GET",headers:{authority:"api.aliyundrive.com",accept:"application/json, text/plain, */*","accept-language":"zh-CN,zh;q=0.9",origin:"https://www.aliyundrive.com",referer:"https://www.aliyundrive.com/","sec-ch-ua":'"Chromium";v="104", " Not A;Brand";v="99", "Google Chrome";v="104"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-site","user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36"},cache:t,withToken:i})}isSupportMime(a,t,i){return a=="video/mp4"&&(t==""||t=="aac")&&(i==""||i=="h264")}setAxios(a){this.axios=a}}var kr=new Tf;class Sf{constructor(){ve(this,"axios")}getAwemeList(i,r){return oe(this,arguments,function*({folderId:a=""},t){let n=`/vsong/alipan-open-list?folderId=${a}&marker=${encodeURIComponent(t.nextMarker)}`,u;t.forceRefresh||(u=yield It.getBody(n)),u||(u=yield this.axios.get(n,{headers:{"Cache-Control":"max-age=0"}}),It.setBody(n,u,5*ur)),t.nextMarker=u.data.nextMarker,t.nextMarker==""&&(t.isPageEnd=!0);let o=u.data.fileList.map(g=>{let v={vsongId:`alipanAweme_${g.file_id}`,vsongType:"alipanAweme",author:"\u4E00\u4E00",title:g.name,coverUrl:"",originUrl:"",fileId:g.file_id,fileUrl:g.url,parentId:g.parent_file_id,category:g.category,mime_type:g.mime_type,audio_code_name:"",video_code_name:"",created:new Date(g.created_at).getTime()};return v.coverUrl=g.thumbnail,v}),c=u.data.folderList.map(g=>({vsongFolderId:`alipanAwemeFolder_${g.file_id}`,vsongFolderType:"alipanAwemeFolder",title:g.name,folderId:g.file_id}));return{awemeList:o,folderList:c}})}getMediaUrl(o){return oe(this,arguments,function*({fileId:a,category:t,fileName:i,mime_type:r,audio_code_name:n,video_code_name:u}){let c="",g=3600*1;t=="video"&&!this.isSupportMime(r,n,u)?c=`/vsong/alipan-open-preview-url?fileId=${a}&category=${t}`:c="/vsong/alipan-open-file-url?fileId="+a;let v=yield this.axios.get(c,{headers:{"Cache-Control":"max-age="+g}});return{audioUrl:t=="audio"?v.data:null,videoUrl:t=="video"?v.data:null,coverUrl:null}})}makeCrossUrl(a,{cache:t="max-age="+3600*1,withToken:i=!1}){return Et.buildCustomCrossUrl({url:a,method:"GET",headers:{authority:"api.aliyundrive.com",accept:"application/json, text/plain, */*","accept-language":"zh-CN,zh;q=0.9",origin:"https://www.aliyundrive.com",referer:"https://www.aliyundrive.com/","sec-ch-ua":'"Chromium";v="104", " Not A;Brand";v="99", "Google Chrome";v="104"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-site","user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36"},cache:t,withToken:i})}makeCrossM3u8(a,{cache:t="max-age="+3600*1,withToken:i=!1}){return Et.buildCrossM3u8({url:a,method:"GET",headers:{authority:"api.aliyundrive.com",accept:"application/json, text/plain, */*","accept-language":"zh-CN,zh;q=0.9",origin:"https://www.aliyundrive.com",referer:"https://www.aliyundrive.com/","sec-ch-ua":'"Chromium";v="104", " Not A;Brand";v="99", "Google Chrome";v="104"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-site","user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36"},cache:t,withToken:i})}isSupportMime(a,t,i){return a=="video/mp4"&&(t==""||t=="aac")&&(i==""||i=="h264")}setAxios(a){this.axios=a}}var mi=new Sf;const kf=h=>{var a=h.split(".")[1],t=a.replace(/-/g,"+").replace(/_/g,"/"),i=decodeURIComponent(window.atob(t).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(i)};class Af{constructor(){ve(this,"axios");ve(this,"url");ve(this,"username");ve(this,"password")}getAwemeList(i,r){return oe(this,arguments,function*({path:a},t){if(!this.url||!this.username)throw new Error("\u672A\u914D\u7F6EAlist");let n=yield this.getToken(),u=yield Et.getAxios().post(`${this.url}/api/fs/list`,{page:t.page,password:"",path:a,per_page:t.count,refresh:!1},{headers:{"content-type":"application/json",authorization:n}});u=u.data,u.data.content==null&&(u.data.content=[]);let o=[],c=[];return u.data.content.forEach(g=>{let v=`${a}/${g.name}`,p=v.replaceAll("/","_");if(g.is_dir)c.push({vsongFolderId:`alistAwemeFolder_${p}`,vsongFolderType:"alistAwemeFolder",title:g.name,folderId:p,folderPath:v}),c.sort((e,s)=>e.title>s.title?1:-1);else{let e="other";if(g.type==2)e="video";else if(g.type==3)e="audio";else return;o.push({vsongId:`alistAweme_${p}`,vsongType:"alistAweme",author:"\u4E00\u4E00",title:g.name,coverUrl:"",originUrl:"",fileId:p,filePath:v,category:e,fileType:g.type,parentPath:a}),o.sort((s,l)=>s.title>l.title?1:-1)}}),{awemeList:o,folderList:c}})}getMediaUrl(r){return oe(this,arguments,function*({fileName:a,filePath:t,category:i}){if(i=="other")throw new Error(`\u4E0D\u652F\u6301\u7684\u8D44\u6E90\u7C7B\u578B(${a})`);let n=yield this.getToken(),u="";if(i=="video"&&!this.isSupportSuffix(a)){let o=yield Et.getAxios().post(`${this.url}/api/fs/other`,{method:"video_preview",password:"",path:t},{headers:{"content-type":"application/json",authorization:n}});o=o.data,u=o.data.video_preview_play_info.live_transcoding_task_list.pop().url}else{let o=yield Et.getAxios().post(`${this.url}/api/fs/get`,{password:"",path:t},{headers:{"content-type":"application/json",authorization:n}});o=o.data,u=o.data.raw_url}return{audioUrl:i=="audio"?u:null,videoUrl:i=="video"?u:null,coverUrl:null}})}setAxios(a){this.axios=a}setConfig({url:a,username:t,password:i}){this.url=a,this.username=t,this.password=i}getToken(){return oe(this,null,function*(){let a=localStorage.getItem("vsong_alist_token");try{if(kf(a).exp*1e3-Date.now()>6*60*60*1e3)return a}catch(i){}let t=yield Et.getAxios().post(`${this.url}/api/auth/login`,{username:this.username,password:this.password},{headers:{"content-type":"application/json"}});return t=t.data,a=t.data.token,localStorage.setItem("vsong_alist_token",a),a})}isSupportSuffix(a){return a.toLowerCase().endsWith(".mp4")}}var mn=new Af;class Cf{constructor(){ve(this,"ossAxios");ve(this,"isInit",!1);ve(this,"ossUrl","")}init(a){return oe(this,null,function*(){this.ossUrl=a,!so()&&this.ossUrl.startsWith("http://192.168")?this.ossAxios=new oo:this.ossAxios=hn.create({}),yield this.ossAxios.get(a+"/ok.txt"),this.isInit=!0,console.log("OssManager \u521D\u59CB\u5316\u5B8C\u6210")})}getAxios(){return this.ossAxios}getMediaUrl(a,t){return oe(this,null,function*(){if(!this.isInit)return null;try{let i=this.ossUrl+`/all/${a}/vsong_${t}.arraybuffer`;if((yield this.ossAxios.get(i,{headers:{Range:"bytes=0-1"}})).status>=400)throw new Error("Err Status!");return console.log(`\u547D\u4E2Doss: ${i}`),i}catch(i){return null}})}isOssMediaUrl(a){return a.startsWith(this.ossUrl)}}var Ai=new Cf;function Zn(h){return{all:h=h||new Map,on:function(a,t){var i=h.get(a);i?i.push(t):h.set(a,[t])},off:function(a,t){var i=h.get(a);i&&(t?i.splice(i.indexOf(t)>>>0,1):h.set(a,[]))},emit:function(a,t){var i=h.get(a);i&&i.slice().map(function(r){r(t)}),(i=h.get("*"))&&i.slice().map(function(r){r(a,t)})}}}var po={};/*! codem-isoboxer v0.3.7 https://github.com/madebyhiro/codem-isoboxer/blob/master/LICENSE.txt */(function(h){var a={};a.parseBuffer=function(r){return new t(r).parse()},a.addBoxProcessor=function(r,n){typeof r!="string"||typeof n!="function"||(i.prototype._boxProcessors[r]=n)},a.createFile=function(){return new t},a.createBox=function(r,n,u){var o=i.create(r);return n&&n.append(o,u),o},a.createFullBox=function(r,n,u){var o=a.createBox(r,n,u);return o.version=0,o.flags=0,o},a.Utils={},a.Utils.dataViewToString=function(r,n){var u=n||"utf-8";if(typeof TextDecoder!="undefined")return new TextDecoder(u).decode(r);var o=[],c=0;if(u==="utf-8")for(;c<r.byteLength;){var g=r.getUint8(c++);g<128||(g<224?(g=(g&31)<<6,g|=r.getUint8(c++)&63):g<240?(g=(g&15)<<12,g|=(r.getUint8(c++)&63)<<6,g|=r.getUint8(c++)&63):(g=(g&7)<<18,g|=(r.getUint8(c++)&63)<<12,g|=(r.getUint8(c++)&63)<<6,g|=r.getUint8(c++)&63)),o.push(String.fromCharCode(g))}else for(;c<r.byteLength;)o.push(String.fromCharCode(r.getUint8(c++)));return o.join("")},a.Utils.utf8ToByteArray=function(r){var n,u;if(typeof TextEncoder!="undefined")n=new TextEncoder().encode(r);else for(n=[],u=0;u<r.length;++u){var o=r.charCodeAt(u);o<128?n.push(o):o<2048?(n.push(192|o>>6),n.push(128|63&o)):o<65536?(n.push(224|o>>12),n.push(128|63&o>>6),n.push(128|63&o)):(n.push(240|o>>18),n.push(128|63&o>>12),n.push(128|63&o>>6),n.push(128|63&o))}return n},a.Utils.appendBox=function(r,n,u){if(n._offset=r._cursor.offset,n._root=r._root?r._root:r,n._raw=r._raw,n._parent=r,u!==-1){if(u==null){r.boxes.push(n);return}var o=-1,c;if(typeof u=="number")o=u;else{if(typeof u=="string")c=u;else if(typeof u=="object"&&u.type)c=u.type;else{r.boxes.push(n);return}for(var g=0;g<r.boxes.length;g++)if(c===r.boxes[g].type){o=g+1;break}}r.boxes.splice(o,0,n)}},h.parseBuffer=a.parseBuffer,h.addBoxProcessor=a.addBoxProcessor,h.createFile=a.createFile,h.createBox=a.createBox,h.createFullBox=a.createFullBox,h.Utils=a.Utils,a.Cursor=function(r){this.offset=typeof r=="undefined"?0:r};var t=function(r){this._cursor=new a.Cursor,this.boxes=[],r&&(this._raw=new DataView(r))};t.prototype.fetch=function(r){var n=this.fetchAll(r,!0);return n.length?n[0]:null},t.prototype.fetchAll=function(r,n){var u=[];return t._sweep.call(this,r,u,n),u},t.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var r=i.parse(this);if(typeof r.type=="undefined")break;this.boxes.push(r)}return this},t._sweep=function(r,n,u){this.type&&this.type==r&&n.push(this);for(var o in this.boxes){if(n.length&&u)return;t._sweep.call(this.boxes[o],r,n,u)}},t.prototype.write=function(){var r=0,n;for(n=0;n<this.boxes.length;n++)r+=this.boxes[n].getLength(!1);var u=new Uint8Array(r);for(this._rawo=new DataView(u.buffer),this.bytes=u,this._cursor.offset=0,n=0;n<this.boxes.length;n++)this.boxes[n].write();return u.buffer},t.prototype.append=function(r,n){a.Utils.appendBox(this,r,n)};var i=function(){this._cursor=new a.Cursor};i.parse=function(r){var n=new i;return n._offset=r._cursor.offset,n._root=r._root?r._root:r,n._raw=r._raw,n._parent=r,n._parseBox(),r._cursor.offset=n._raw.byteOffset+n._raw.byteLength,n},i.create=function(r){var n=new i;return n.type=r,n.boxes=[],n},i.prototype._boxContainers=["dinf","edts","mdia","meco","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak","tref","udta","vttc","sinf","schi","encv","enca"],i.prototype._boxProcessors={},i.prototype._procField=function(r,n,u){this._parsing?this[r]=this._readField(n,u):this._writeField(n,u,this[r])},i.prototype._procFieldArray=function(r,n,u,o){var c;if(this._parsing)for(this[r]=[],c=0;c<n;c++)this[r][c]=this._readField(u,o);else for(c=0;c<this[r].length;c++)this._writeField(u,o,this[r][c])},i.prototype._procFullBox=function(){this._procField("version","uint",8),this._procField("flags","uint",24)},i.prototype._procEntries=function(r,n,u){var o;if(this._parsing)for(this[r]=[],o=0;o<n;o++)this[r].push({}),u.call(this,this[r][o]);else for(o=0;o<n;o++)u.call(this,this[r][o])},i.prototype._procSubEntries=function(r,n,u,o){var c;if(this._parsing)for(r[n]=[],c=0;c<u;c++)r[n].push({}),o.call(this,r[n][c]);else for(c=0;c<u;c++)o.call(this,r[n][c])},i.prototype._procEntryField=function(r,n,u,o){this._parsing?r[n]=this._readField(u,o):this._writeField(u,o,r[n])},i.prototype._procSubBoxes=function(r,n){var u;if(this._parsing)for(this[r]=[],u=0;u<n;u++)this[r].push(i.parse(this));else for(u=0;u<n;u++)this._rawo?this[r][u].write():this.size+=this[r][u].getLength()},i.prototype._readField=function(r,n){switch(r){case"uint":return this._readUint(n);case"int":return this._readInt(n);case"template":return this._readTemplate(n);case"string":return n===-1?this._readTerminatedString():this._readString(n);case"data":return this._readData(n);case"utf8":return this._readUTF8String();default:return-1}},i.prototype._readInt=function(r){var n=null,u=this._cursor.offset-this._raw.byteOffset;switch(r){case 8:n=this._raw.getInt8(u);break;case 16:n=this._raw.getInt16(u);break;case 32:n=this._raw.getInt32(u);break;case 64:var o=this._raw.getInt32(u),c=this._raw.getInt32(u+4);n=o*Math.pow(2,32)+c;break}return this._cursor.offset+=r>>3,n},i.prototype._readUint=function(r){var n=null,u=this._cursor.offset-this._raw.byteOffset,o,c;switch(r){case 8:n=this._raw.getUint8(u);break;case 16:n=this._raw.getUint16(u);break;case 24:o=this._raw.getUint16(u),c=this._raw.getUint8(u+2),n=(o<<8)+c;break;case 32:n=this._raw.getUint32(u);break;case 64:o=this._raw.getUint32(u),c=this._raw.getUint32(u+4),n=o*Math.pow(2,32)+c;break}return this._cursor.offset+=r>>3,n},i.prototype._readString=function(r){for(var n="",u=0;u<r;u++){var o=this._readUint(8);n+=String.fromCharCode(o)}return n},i.prototype._readTemplate=function(r){var n=this._readUint(r/2),u=this._readUint(r/2);return n+u/Math.pow(2,r/2)},i.prototype._readTerminatedString=function(){for(var r="";this._cursor.offset-this._offset<this._raw.byteLength;){var n=this._readUint(8);if(n===0)break;r+=String.fromCharCode(n)}return r},i.prototype._readData=function(r){var n=r>0?r:this._raw.byteLength-(this._cursor.offset-this._offset);if(n>0){var u=new Uint8Array(this._raw.buffer,this._cursor.offset,n);return this._cursor.offset+=n,u}else return null},i.prototype._readUTF8String=function(){var r=this._raw.byteLength-(this._cursor.offset-this._offset),n=null;return r>0&&(n=new DataView(this._raw.buffer,this._cursor.offset,r),this._cursor.offset+=r),n&&a.Utils.dataViewToString(n)},i.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength){this._root._incomplete=!0;return}switch(this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset,this._raw.byteLength-this._cursor.offset+8);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1?this._parseContainerBox():this._data=this._readData())},i.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},i.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(i.parse(this))},i.prototype.append=function(r,n){a.Utils.appendBox(this,r,n)},i.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1)for(var r=0;r<this.boxes.length;r++)this.size+=this.boxes[r].getLength();return this._data&&this._writeData(this._data),this.size},i.prototype.write=function(){switch(this._parsing=!1,this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size)}if(this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1)for(var r=0;r<this.boxes.length;r++)this.boxes[r].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size},i.prototype._writeInt=function(r,n){if(this._rawo){var u=this._cursor.offset-this._rawo.byteOffset;switch(r){case 8:this._rawo.setInt8(u,n);break;case 16:this._rawo.setInt16(u,n);break;case 32:this._rawo.setInt32(u,n);break;case 64:var o=Math.floor(n/Math.pow(2,32)),c=n-o*Math.pow(2,32);this._rawo.setUint32(u,o),this._rawo.setUint32(u+4,c);break}this._cursor.offset+=r>>3}else this.size+=r>>3},i.prototype._writeUint=function(r,n){if(this._rawo){var u=this._cursor.offset-this._rawo.byteOffset,o,c;switch(r){case 8:this._rawo.setUint8(u,n);break;case 16:this._rawo.setUint16(u,n);break;case 24:o=(n&16776960)>>8,c=n&255,this._rawo.setUint16(u,o),this._rawo.setUint8(u+2,c);break;case 32:this._rawo.setUint32(u,n);break;case 64:o=Math.floor(n/Math.pow(2,32)),c=n-o*Math.pow(2,32),this._rawo.setUint32(u,o),this._rawo.setUint32(u+4,c);break}this._cursor.offset+=r>>3}else this.size+=r>>3},i.prototype._writeString=function(r,n){for(var u=0;u<r;u++)this._writeUint(8,n.charCodeAt(u))},i.prototype._writeTerminatedString=function(r){if(r.length!==0){for(var n=0;n<r.length;n++)this._writeUint(8,r.charCodeAt(n));this._writeUint(8,0)}},i.prototype._writeTemplate=function(r,n){var u=Math.floor(n),o=(n-u)*Math.pow(2,r/2);this._writeUint(r/2,u),this._writeUint(r/2,o)},i.prototype._writeData=function(r){var n;if(r)if(this._rawo){if(r instanceof Array){for(var u=this._cursor.offset-this._rawo.byteOffset,n=0;n<r.length;n++)this._rawo.setInt8(u+n,r[n]);this._cursor.offset+=r.length}r instanceof Uint8Array&&(this._root.bytes.set(r,this._cursor.offset),this._cursor.offset+=r.length)}else this.size+=r.length},i.prototype._writeUTF8String=function(r){var n=a.Utils.utf8ToByteArray(r);if(this._rawo)for(var u=new DataView(this._rawo.buffer,this._cursor.offset,n.length),o=0;o<n.length;o++)u.setUint8(o,n[o]);else this.size+=n.length},i.prototype._writeField=function(r,n,u){switch(r){case"uint":this._writeUint(n,u);break;case"int":this._writeInt(n,u);break;case"template":this._writeTemplate(n,u);break;case"string":n==-1?this._writeTerminatedString(u):this._writeString(n,u);break;case"data":this._writeData(u);break;case"utf8":this._writeUTF8String(u);break}},i.prototype._boxProcessors.avc1=i.prototype._boxProcessors.avc2=i.prototype._boxProcessors.avc3=i.prototype._boxProcessors.avc4=i.prototype._boxProcessors.hvc1=i.prototype._boxProcessors.hev1=i.prototype._boxProcessors.encv=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procField("pre_defined1","uint",16),this._procField("reserved2","uint",16),this._procFieldArray("pre_defined2",3,"uint",32),this._procField("width","uint",16),this._procField("height","uint",16),this._procField("horizresolution","template",32),this._procField("vertresolution","template",32),this._procField("reserved3","uint",32),this._procField("frame_count","uint",16),this._procFieldArray("compressorname",32,"uint",8),this._procField("depth","uint",16),this._procField("pre_defined3","int",16),this._procField("config","data",-1)},i.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},i.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(r){this._procEntryField(r,"segment_duration","uint",this.version===1?64:32),this._procEntryField(r,"media_time","int",this.version===1?64:32),this._procEntryField(r,"media_rate_integer","int",16),this._procEntryField(r,"media_rate_fraction","int",16)})},i.prototype._boxProcessors.emsg=function(){this._procFullBox(),this.version==1?(this._procField("timescale","uint",32),this._procField("presentation_time","uint",64),this._procField("event_duration","uint",32),this._procField("id","uint",32),this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1)):(this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1),this._procField("timescale","uint",32),this._procField("presentation_time_delta","uint",32),this._procField("event_duration","uint",32),this._procField("id","uint",32)),this._procField("message_data","data",-1)},i.prototype._boxProcessors.free=i.prototype._boxProcessors.skip=function(){this._procField("data","data",-1)},i.prototype._boxProcessors.frma=function(){this._procField("data_format","uint",32)},i.prototype._boxProcessors.ftyp=i.prototype._boxProcessors.styp=function(){this._procField("major_brand","string",4),this._procField("minor_version","uint",32);var r=-1;this._parsing&&(r=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray("compatible_brands",r,"string",4)},i.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1)},i.prototype._boxProcessors.mdat=function(){this._procField("data","data",-1)},i.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",this.version==1?64:32),!this._parsing&&typeof this.language=="string"&&(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField("language","uint",16),this._parsing&&(this.language=String.fromCharCode((this.language>>10&31)+96,(this.language>>5&31)+96,(this.language&31)+96)),this._procField("pre_defined","uint",16)},i.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField("fragment_duration","uint",this.version==1?64:32)},i.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField("sequence_number","uint",32)},i.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField("mfra_size","uint",32)},i.prototype._boxProcessors.mp4a=i.prototype._boxProcessors.enca=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channelcount","uint",16),this._procField("samplesize","uint",16),this._procField("pre_defined","uint",16),this._procField("reserved3","uint",16),this._procField("samplerate","template",32),this._procField("esds","data",-1)},i.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",this.version==1?64:32),this._procField("rate","template",32),this._procField("volume","template",16),this._procField("reserved1","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procFieldArray("matrix",9,"template",32),this._procFieldArray("pre_defined",6,"uint",32),this._procField("next_track_ID","uint",32)},i.prototype._boxProcessors.payl=function(){this._procField("cue_text","utf8")},i.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray("SystemID",16,"uint",8),this._procField("DataSize","uint",32),this._procFieldArray("Data",this.DataSize,"uint",8)},i.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField("scheme_type","uint",32),this._procField("scheme_version","uint",32),this.flags&1&&this._procField("scheme_uri","string",-1)},i.prototype._boxProcessors.sdtp=function(){this._procFullBox();var r=-1;this._parsing&&(r=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray("sample_dependency_table",r,"uint",8)},i.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField("reference_ID","uint",32),this._procField("timescale","uint",32),this._procField("earliest_presentation_time","uint",this.version==1?64:32),this._procField("first_offset","uint",this.version==1?64:32),this._procField("reserved","uint",16),this._procField("reference_count","uint",16),this._procEntries("references",this.reference_count,function(r){this._parsing||(r.reference=(r.reference_type&1)<<31,r.reference|=r.referenced_size&2147483647,r.sap=(r.starts_with_SAP&1)<<31,r.sap|=(r.SAP_type&3)<<28,r.sap|=r.SAP_delta_time&268435455),this._procEntryField(r,"reference","uint",32),this._procEntryField(r,"subsegment_duration","uint",32),this._procEntryField(r,"sap","uint",32),this._parsing&&(r.reference_type=r.reference>>31&1,r.referenced_size=r.reference&2147483647,r.starts_with_SAP=r.sap>>31&1,r.SAP_type=r.sap>>28&7,r.SAP_delta_time=r.sap&268435455)})},i.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField("balance","uint",16),this._procField("reserved","uint",16)},i.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField("subsegment_count","uint",32),this._procEntries("subsegments",this.subsegment_count,function(r){this._procEntryField(r,"ranges_count","uint",32),this._procSubEntries(r,"ranges",r.ranges_count,function(n){this._procEntryField(n,"level","uint",8),this._procEntryField(n,"range_size","uint",24)})})},i.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},i.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(r){this._procEntryField(r,"sample_delta","uint",32),this._procEntryField(r,"subsample_count","uint",16),this._procSubEntries(r,"subsamples",r.subsample_count,function(n){this._procEntryField(n,"subsample_size","uint",this.version===1?32:16),this._procEntryField(n,"subsample_priority","uint",8),this._procEntryField(n,"discardable","uint",8),this._procEntryField(n,"codec_specific_parameters","uint",32)})})},i.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField("default_IsEncrypted","uint",24),this._procField("default_IV_size","uint",8),this._procFieldArray("default_KID",16,"uint",8)},i.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField("baseMediaDecodeTime","uint",this.version==1?64:32)},i.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField("track_ID","uint",32),this.flags&1&&this._procField("base_data_offset","uint",64),this.flags&2&&this._procField("sample_description_offset","uint",32),this.flags&8&&this._procField("default_sample_duration","uint",32),this.flags&16&&this._procField("default_sample_size","uint",32),this.flags&32&&this._procField("default_sample_flags","uint",32)},i.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._parsing||(this.reserved=0,this.reserved|=(this.length_size_of_traf_num&48)<<4,this.reserved|=(this.length_size_of_trun_num&12)<<2,this.reserved|=this.length_size_of_sample_num&3),this._procField("reserved","uint",32),this._parsing&&(this.length_size_of_traf_num=(this.reserved&48)>>4,this.length_size_of_trun_num=(this.reserved&12)>>2,this.length_size_of_sample_num=this.reserved&3),this._procField("number_of_entry","uint",32),this._procEntries("entries",this.number_of_entry,function(r){this._procEntryField(r,"time","uint",this.version===1?64:32),this._procEntryField(r,"moof_offset","uint",this.version===1?64:32),this._procEntryField(r,"traf_number","uint",(this.length_size_of_traf_num+1)*8),this._procEntryField(r,"trun_number","uint",(this.length_size_of_trun_num+1)*8),this._procEntryField(r,"sample_number","uint",(this.length_size_of_sample_num+1)*8)})},i.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("track_ID","uint",32),this._procField("reserved1","uint",32),this._procField("duration","uint",this.version==1?64:32),this._procFieldArray("reserved2",2,"uint",32),this._procField("layer","uint",16),this._procField("alternate_group","uint",16),this._procField("volume","template",16),this._procField("reserved3","uint",16),this._procFieldArray("matrix",9,"template",32),this._procField("width","template",32),this._procField("height","template",32)},i.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._procField("default_sample_description_index","uint",32),this._procField("default_sample_duration","uint",32),this._procField("default_sample_size","uint",32),this._procField("default_sample_flags","uint",32)},i.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField("sample_count","uint",32),this.flags&1&&this._procField("data_offset","int",32),this.flags&4&&this._procField("first_sample_flags","uint",32),this._procEntries("samples",this.sample_count,function(r){this.flags&256&&this._procEntryField(r,"sample_duration","uint",32),this.flags&512&&this._procEntryField(r,"sample_size","uint",32),this.flags&1024&&this._procEntryField(r,"sample_flags","uint",32),this.flags&2048&&this._procEntryField(r,"sample_composition_time_offset",this.version===1?"int":"uint",32)})},i.prototype._boxProcessors["url "]=i.prototype._boxProcessors["urn "]=function(){this._procFullBox(),this.type==="urn "&&this._procField("name","string",-1),this._procField("location","string",-1)},i.prototype._boxProcessors.vlab=function(){this._procField("source_label","utf8")},i.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField("graphicsmode","uint",16),this._procFieldArray("opcolor",3,"uint",16)},i.prototype._boxProcessors.vttC=function(){this._procField("config","utf8")},i.prototype._boxProcessors.vtte=function(){}})(po);const Df=h=>{const a=new Uint8Array(h.reduce((t,i)=>t+i.length,0));return h.reduce((t,i)=>(a.set(i,t),t+i.length),0),a};class go{constructor(a,t,i){ve(this,"eventListenerMg",[]);ve(this,"isDestory",!1);ve(this,"url");ve(this,"httpAxios");ve(this,"mediaSource",new MediaSource);ve(this,"sourceBuffer");ve(this,"mimeType");ve(this,"rangeStart",0);ve(this,"rangeEnd",-1);ve(this,"initSegEnd",28e3);ve(this,"subDuration",0);ve(this,"duration",0);ve(this,"bytesTotal",0);ve(this,"segList",[]);ve(this,"segCache",[]);ve(this,"lastCanPlayTime",0);ve(this,"isSidxBoxReady",!1);ve(this,"sidxBoxData",new ArrayBuffer(0));ve(this,"initCpl",new Xi);this.httpAxios=a,this.url=t,this.mimeType=i,this.addTargetEventListener(this.mediaSource,"sourceopen",this.onSourceOpen.bind(this),{once:!0})}getMediaBuffer(){return oe(this,null,function*(){if(console.log(`getMediaBuffer rangeStart:${this.rangeStart}`),this.segCache.includes(this.rangeStart))return;this.segCache.push(this.rangeStart);let a=yield this.httpAxios.get(this.url,{headers:{Range:`bytes=${this.rangeStart}-${this.rangeEnd}`},responseType:"arraybuffer"});if(!this.isDestory){if(this.isSidxBoxReady)this.sourceBuffer.appendBuffer(a.data);else{this.sidxBoxData=Df([new Uint8Array(this.sidxBoxData),new Uint8Array(a.data)]).buffer;let t=po.parseBuffer(this.sidxBoxData).fetch("sidx");if(!t.references)return this.rangeStart=this.rangeEnd+1,this.rangeEnd=this.rangeStart+this.initSegEnd,yield this.getMediaBuffer();this.duration=0,this.bytesTotal=0,this.subDuration=t.references[0].subsegment_duration/t.timescale,this.segList=[],t.references.forEach(i=>{if(this.duration+=i.subsegment_duration,this.bytesTotal+=i.referenced_size,this.segList.length==0){let r=t._cursor.offset;this.segList.push({rangeStart:r,rangeEnd:r+i.referenced_size-1,timeStart:0,timeEnd:i.subsegment_duration/t.timescale})}else{let r=this.segList[this.segList.length-1],n=r.rangeEnd+1;this.segList.push({rangeStart:n,rangeEnd:n+i.referenced_size-1,timeStart:r.timeEnd,timeEnd:r.timeEnd+i.subsegment_duration/t.timescale})}}),this.duration=this.duration/t.timescale,this.bytesTotal+=t._cursor.offset,this.sidxBoxData=this.sidxBoxData.slice(0,t._cursor.offset),this.rangeEnd=t._cursor.offset-1,this.isSidxBoxReady=!0,this.sourceBuffer.appendBuffer(this.sidxBoxData),console.log(`duration:${this.duration} bytesTotal:${this.bytesTotal}`)}return new Promise((t,i)=>{this.addTargetEventListener(this.sourceBuffer,"updateend",()=>{this.rangeStart===this.segList[this.segList.length-1].rangeStart&&this.mediaSource.endOfStream(),t(!0)},{once:!0})})}})}onSourceOpen(){this.sourceBuffer=this.mediaSource.addSourceBuffer(this.mimeType),this.rangeStart=0,this.rangeEnd=this.initSegEnd,this.getMediaBuffer().then(()=>{this.initCpl.resolve(!0),this.onMediaWaiting(0)})}onMediaWaiting(a){return oe(this,null,function*(){yield this.initCpl.toPromise();let t=this.segList.find(i=>a>=i.timeStart&&a<i.timeEnd);!t||this.segCache.includes(t.rangeStart)||(this.rangeStart=t.rangeStart,this.rangeEnd=t.rangeEnd,yield this.getMediaBuffer(),this.lastCanPlayTime=t.timeEnd)})}onMediaTimeupdate(a){return oe(this,null,function*(){if(yield this.initCpl.toPromise(),this.lastCanPlayTime!=0&&a+this.subDuration*1.8>=this.lastCanPlayTime){let t=this.segList.find(i=>this.lastCanPlayTime>=i.timeStart&&this.lastCanPlayTime<i.timeEnd);if(!t||this.segCache.includes(t.rangeStart))return;this.rangeStart=t.rangeStart,this.rangeEnd=t.rangeEnd,yield this.getMediaBuffer(),this.lastCanPlayTime=t.timeEnd}})}addTargetEventListener(a,t,i,r){return oe(this,null,function*(){a.addEventListener(t,i,r),this.eventListenerMg.push({target:a,type:t,callback:i,options:r})})}removeAllTargetEventListener(){return oe(this,null,function*(){this.eventListenerMg.forEach(a=>{a.target.removeEventListener(a.type,a.callback,a.options)}),this.eventListenerMg=[]})}destory(){this.removeAllTargetEventListener(),this.initCpl.reject(!1),this.sourceBuffer=null,this.mediaSource=null,this.isDestory=!0}}var vo={};(function(h){var a=function(){var e=new Date,s=4,l=3,f=2,d=1,y=s,m={setLogLevel:function(_){_==this.debug?y=d:_==this.info?y=f:_==this.warn?y=l:(_==this.error,y=s)},debug:function(_,E){console.debug===void 0&&(console.debug=console.log),d>=y&&console.debug("["+a.getDurationString(new Date-e,1e3)+"]","["+_+"]",E)},log:function(_,E){this.debug(_.msg)},info:function(_,E){f>=y&&console.info("["+a.getDurationString(new Date-e,1e3)+"]","["+_+"]",E)},warn:function(_,E){l>=y&&console.warn("["+a.getDurationString(new Date-e,1e3)+"]","["+_+"]",E)},error:function(_,E){s>=y&&console.error("["+a.getDurationString(new Date-e,1e3)+"]","["+_+"]",E)}};return m}();a.getDurationString=function(e,s){var l;function f(w,k){for(var x=""+w,S=x.split(".");S[0].length<k;)S[0]="0"+S[0];return S.join(".")}e<0?(l=!0,e=-e):l=!1;var d=s||1,y=e/d,m=Math.floor(y/3600);y-=m*3600;var _=Math.floor(y/60);y-=_*60;var E=y*1e3;return y=Math.floor(y),E-=y*1e3,E=Math.floor(E),(l?"-":"")+m+":"+f(_,2)+":"+f(y,2)+"."+f(E,3)},a.printRanges=function(e){var s=e.length;if(s>0){for(var l="",f=0;f<s;f++)f>0&&(l+=","),l+="["+a.getDurationString(e.start(f))+","+a.getDurationString(e.end(f))+"]";return l}else return"(empty)"},h.Log=a;var t=function(e){if(e instanceof ArrayBuffer)this.buffer=e,this.dataview=new DataView(e);else throw"Needs an array buffer";this.position=0};t.prototype.getPosition=function(){return this.position},t.prototype.getEndPosition=function(){return this.buffer.byteLength},t.prototype.getLength=function(){return this.buffer.byteLength},t.prototype.seek=function(e){var s=Math.max(0,Math.min(this.buffer.byteLength,e));return this.position=isNaN(s)||!isFinite(s)?0:s,!0},t.prototype.isEos=function(){return this.getPosition()>=this.getEndPosition()},t.prototype.readAnyInt=function(e,s){var l=0;if(this.position+e<=this.buffer.byteLength){switch(e){case 1:s?l=this.dataview.getInt8(this.position):l=this.dataview.getUint8(this.position);break;case 2:s?l=this.dataview.getInt16(this.position):l=this.dataview.getUint16(this.position);break;case 3:if(s)throw"No method for reading signed 24 bits values";l=this.dataview.getUint8(this.position)<<16,l|=this.dataview.getUint8(this.position+1)<<8,l|=this.dataview.getUint8(this.position+2);break;case 4:s?l=this.dataview.getInt32(this.position):l=this.dataview.getUint32(this.position);break;case 8:if(s)throw"No method for reading signed 64 bits values";l=this.dataview.getUint32(this.position)<<32,l|=this.dataview.getUint32(this.position+4);break;default:throw"readInt method not implemented for size: "+e}return this.position+=e,l}else throw"Not enough bytes in buffer"},t.prototype.readUint8=function(){return this.readAnyInt(1,!1)},t.prototype.readUint16=function(){return this.readAnyInt(2,!1)},t.prototype.readUint24=function(){return this.readAnyInt(3,!1)},t.prototype.readUint32=function(){return this.readAnyInt(4,!1)},t.prototype.readUint64=function(){return this.readAnyInt(8,!1)},t.prototype.readString=function(e){if(this.position+e<=this.buffer.byteLength){for(var s="",l=0;l<e;l++)s+=String.fromCharCode(this.readUint8());return s}else throw"Not enough bytes in buffer"},t.prototype.readCString=function(){for(var e=[];;){var s=this.readUint8();if(s!==0)e.push(s);else break}return String.fromCharCode.apply(null,e)},t.prototype.readInt8=function(){return this.readAnyInt(1,!0)},t.prototype.readInt16=function(){return this.readAnyInt(2,!0)},t.prototype.readInt32=function(){return this.readAnyInt(4,!0)},t.prototype.readInt64=function(){return this.readAnyInt(8,!1)},t.prototype.readUint8Array=function(e){for(var s=new Uint8Array(e),l=0;l<e;l++)s[l]=this.readUint8();return s},t.prototype.readInt16Array=function(e){for(var s=new Int16Array(e),l=0;l<e;l++)s[l]=this.readInt16();return s},t.prototype.readUint16Array=function(e){for(var s=new Int16Array(e),l=0;l<e;l++)s[l]=this.readUint16();return s},t.prototype.readUint32Array=function(e){for(var s=new Uint32Array(e),l=0;l<e;l++)s[l]=this.readUint32();return s},t.prototype.readInt32Array=function(e){for(var s=new Int32Array(e),l=0;l<e;l++)s[l]=this.readInt32();return s},h.MP4BoxStream=t;var i=function(e,s,l){this._byteOffset=s||0,e instanceof ArrayBuffer?this.buffer=e:typeof e=="object"?(this.dataView=e,s&&(this._byteOffset+=s)):this.buffer=new ArrayBuffer(e||0),this.position=0,this.endianness=l==null?i.LITTLE_ENDIAN:l};i.prototype={},i.prototype.getPosition=function(){return this.position},i.prototype._realloc=function(e){if(!!this._dynamicSize){var s=this._byteOffset+this.position+e,l=this._buffer.byteLength;if(s<=l){s>this._byteLength&&(this._byteLength=s);return}for(l<1&&(l=1);s>l;)l*=2;var f=new ArrayBuffer(l),d=new Uint8Array(this._buffer),y=new Uint8Array(f,0,d.length);y.set(d),this.buffer=f,this._byteLength=s}},i.prototype._trimAlloc=function(){if(this._byteLength!=this._buffer.byteLength){var e=new ArrayBuffer(this._byteLength),s=new Uint8Array(e),l=new Uint8Array(this._buffer,0,s.length);s.set(l),this.buffer=e}},i.BIG_ENDIAN=!1,i.LITTLE_ENDIAN=!0,i.prototype._byteLength=0,Object.defineProperty(i.prototype,"byteLength",{get:function(){return this._byteLength-this._byteOffset}}),Object.defineProperty(i.prototype,"buffer",{get:function(){return this._trimAlloc(),this._buffer},set:function(e){this._buffer=e,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength}}),Object.defineProperty(i.prototype,"byteOffset",{get:function(){return this._byteOffset},set:function(e){this._byteOffset=e,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength}}),Object.defineProperty(i.prototype,"dataView",{get:function(){return this._dataView},set:function(e){this._byteOffset=e.byteOffset,this._buffer=e.buffer,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._byteOffset+e.byteLength}}),i.prototype.seek=function(e){var s=Math.max(0,Math.min(this.byteLength,e));this.position=isNaN(s)||!isFinite(s)?0:s},i.prototype.isEof=function(){return this.position>=this._byteLength},i.prototype.mapUint8Array=function(e){this._realloc(e*1);var s=new Uint8Array(this._buffer,this.byteOffset+this.position,e);return this.position+=e*1,s},i.prototype.readInt32Array=function(e,s){e=e==null?this.byteLength-this.position/4:e;var l=new Int32Array(e);return i.memcpy(l.buffer,0,this.buffer,this.byteOffset+this.position,e*l.BYTES_PER_ELEMENT),i.arrayToNative(l,s==null?this.endianness:s),this.position+=l.byteLength,l},i.prototype.readInt16Array=function(e,s){e=e==null?this.byteLength-this.position/2:e;var l=new Int16Array(e);return i.memcpy(l.buffer,0,this.buffer,this.byteOffset+this.position,e*l.BYTES_PER_ELEMENT),i.arrayToNative(l,s==null?this.endianness:s),this.position+=l.byteLength,l},i.prototype.readInt8Array=function(e){e=e==null?this.byteLength-this.position:e;var s=new Int8Array(e);return i.memcpy(s.buffer,0,this.buffer,this.byteOffset+this.position,e*s.BYTES_PER_ELEMENT),this.position+=s.byteLength,s},i.prototype.readUint32Array=function(e,s){e=e==null?this.byteLength-this.position/4:e;var l=new Uint32Array(e);return i.memcpy(l.buffer,0,this.buffer,this.byteOffset+this.position,e*l.BYTES_PER_ELEMENT),i.arrayToNative(l,s==null?this.endianness:s),this.position+=l.byteLength,l},i.prototype.readUint16Array=function(e,s){e=e==null?this.byteLength-this.position/2:e;var l=new Uint16Array(e);return i.memcpy(l.buffer,0,this.buffer,this.byteOffset+this.position,e*l.BYTES_PER_ELEMENT),i.arrayToNative(l,s==null?this.endianness:s),this.position+=l.byteLength,l},i.prototype.readUint8Array=function(e){e=e==null?this.byteLength-this.position:e;var s=new Uint8Array(e);return i.memcpy(s.buffer,0,this.buffer,this.byteOffset+this.position,e*s.BYTES_PER_ELEMENT),this.position+=s.byteLength,s},i.prototype.readFloat64Array=function(e,s){e=e==null?this.byteLength-this.position/8:e;var l=new Float64Array(e);return i.memcpy(l.buffer,0,this.buffer,this.byteOffset+this.position,e*l.BYTES_PER_ELEMENT),i.arrayToNative(l,s==null?this.endianness:s),this.position+=l.byteLength,l},i.prototype.readFloat32Array=function(e,s){e=e==null?this.byteLength-this.position/4:e;var l=new Float32Array(e);return i.memcpy(l.buffer,0,this.buffer,this.byteOffset+this.position,e*l.BYTES_PER_ELEMENT),i.arrayToNative(l,s==null?this.endianness:s),this.position+=l.byteLength,l},i.prototype.readInt32=function(e){var s=this._dataView.getInt32(this.position,e==null?this.endianness:e);return this.position+=4,s},i.prototype.readInt16=function(e){var s=this._dataView.getInt16(this.position,e==null?this.endianness:e);return this.position+=2,s},i.prototype.readInt8=function(){var e=this._dataView.getInt8(this.position);return this.position+=1,e},i.prototype.readUint32=function(e){var s=this._dataView.getUint32(this.position,e==null?this.endianness:e);return this.position+=4,s},i.prototype.readUint16=function(e){var s=this._dataView.getUint16(this.position,e==null?this.endianness:e);return this.position+=2,s},i.prototype.readUint8=function(){var e=this._dataView.getUint8(this.position);return this.position+=1,e},i.prototype.readFloat32=function(e){var s=this._dataView.getFloat32(this.position,e==null?this.endianness:e);return this.position+=4,s},i.prototype.readFloat64=function(e){var s=this._dataView.getFloat64(this.position,e==null?this.endianness:e);return this.position+=8,s},i.endianness=new Int8Array(new Int16Array([1]).buffer)[0]>0,i.memcpy=function(e,s,l,f,d){var y=new Uint8Array(e,s,d),m=new Uint8Array(l,f,d);y.set(m)},i.arrayToNative=function(e,s){return s==this.endianness?e:this.flipArrayEndianness(e)},i.nativeToEndian=function(e,s){return this.endianness==s?e:this.flipArrayEndianness(e)},i.flipArrayEndianness=function(e){for(var s=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),l=0;l<e.byteLength;l+=e.BYTES_PER_ELEMENT)for(var f=l+e.BYTES_PER_ELEMENT-1,d=l;f>d;f--,d++){var y=s[d];s[d]=s[f],s[f]=y}return e},i.prototype.failurePosition=0,String.fromCharCodeUint8=function(e){for(var s=[],l=0;l<e.length;l++)s[l]=e[l];return String.fromCharCode.apply(null,s)},i.prototype.readString=function(e,s){return s==null||s=="ASCII"?String.fromCharCodeUint8.apply(null,[this.mapUint8Array(e==null?this.byteLength-this.position:e)]):new TextDecoder(s).decode(this.mapUint8Array(e))},i.prototype.readCString=function(e){var s=this.byteLength-this.position,l=new Uint8Array(this._buffer,this._byteOffset+this.position),f=s;e!=null&&(f=Math.min(e,s));for(var d=0;d<f&&l[d]!==0;d++);var y=String.fromCharCodeUint8.apply(null,[this.mapUint8Array(d)]);return e!=null?this.position+=f-d:d!=s&&(this.position+=1),y};var r=Math.pow(2,32);i.prototype.readInt64=function(){return this.readInt32()*r+this.readUint32()},i.prototype.readUint64=function(){return this.readUint32()*r+this.readUint32()},i.prototype.readInt64=function(){return this.readUint32()*r+this.readUint32()},i.prototype.readUint24=function(){return(this.readUint8()<<16)+(this.readUint8()<<8)+this.readUint8()},h.DataStream=i,i.prototype.save=function(e){var s=new Blob([this.buffer]);if(window.URL&&URL.createObjectURL){var l=window.URL.createObjectURL(s),f=document.createElement("a");document.body.appendChild(f),f.setAttribute("href",l),f.setAttribute("download",e),f.setAttribute("target","_self"),f.click(),window.URL.revokeObjectURL(l)}else throw"DataStream.save: Can't create object URL."},i.prototype._dynamicSize=!0,Object.defineProperty(i.prototype,"dynamicSize",{get:function(){return this._dynamicSize},set:function(e){e||this._trimAlloc(),this._dynamicSize=e}}),i.prototype.shift=function(e){var s=new ArrayBuffer(this._byteLength-e),l=new Uint8Array(s),f=new Uint8Array(this._buffer,e,l.length);l.set(f),this.buffer=s,this.position-=e},i.prototype.writeInt32Array=function(e,s){if(this._realloc(e.length*4),e instanceof Int32Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)i.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapInt32Array(e.length,s);else for(var l=0;l<e.length;l++)this.writeInt32(e[l],s)},i.prototype.writeInt16Array=function(e,s){if(this._realloc(e.length*2),e instanceof Int16Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)i.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapInt16Array(e.length,s);else for(var l=0;l<e.length;l++)this.writeInt16(e[l],s)},i.prototype.writeInt8Array=function(e){if(this._realloc(e.length*1),e instanceof Int8Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)i.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapInt8Array(e.length);else for(var s=0;s<e.length;s++)this.writeInt8(e[s])},i.prototype.writeUint32Array=function(e,s){if(this._realloc(e.length*4),e instanceof Uint32Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)i.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapUint32Array(e.length,s);else for(var l=0;l<e.length;l++)this.writeUint32(e[l],s)},i.prototype.writeUint16Array=function(e,s){if(this._realloc(e.length*2),e instanceof Uint16Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)i.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapUint16Array(e.length,s);else for(var l=0;l<e.length;l++)this.writeUint16(e[l],s)},i.prototype.writeUint8Array=function(e){if(this._realloc(e.length*1),e instanceof Uint8Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)i.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapUint8Array(e.length);else for(var s=0;s<e.length;s++)this.writeUint8(e[s])},i.prototype.writeFloat64Array=function(e,s){if(this._realloc(e.length*8),e instanceof Float64Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)i.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapFloat64Array(e.length,s);else for(var l=0;l<e.length;l++)this.writeFloat64(e[l],s)},i.prototype.writeFloat32Array=function(e,s){if(this._realloc(e.length*4),e instanceof Float32Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)i.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapFloat32Array(e.length,s);else for(var l=0;l<e.length;l++)this.writeFloat32(e[l],s)},i.prototype.writeInt32=function(e,s){this._realloc(4),this._dataView.setInt32(this.position,e,s==null?this.endianness:s),this.position+=4},i.prototype.writeInt16=function(e,s){this._realloc(2),this._dataView.setInt16(this.position,e,s==null?this.endianness:s),this.position+=2},i.prototype.writeInt8=function(e){this._realloc(1),this._dataView.setInt8(this.position,e),this.position+=1},i.prototype.writeUint32=function(e,s){this._realloc(4),this._dataView.setUint32(this.position,e,s==null?this.endianness:s),this.position+=4},i.prototype.writeUint16=function(e,s){this._realloc(2),this._dataView.setUint16(this.position,e,s==null?this.endianness:s),this.position+=2},i.prototype.writeUint8=function(e){this._realloc(1),this._dataView.setUint8(this.position,e),this.position+=1},i.prototype.writeFloat32=function(e,s){this._realloc(4),this._dataView.setFloat32(this.position,e,s==null?this.endianness:s),this.position+=4},i.prototype.writeFloat64=function(e,s){this._realloc(8),this._dataView.setFloat64(this.position,e,s==null?this.endianness:s),this.position+=8},i.prototype.writeUCS2String=function(e,s,l){l==null&&(l=e.length);for(var f=0;f<e.length&&f<l;f++)this.writeUint16(e.charCodeAt(f),s);for(;f<l;f++)this.writeUint16(0)},i.prototype.writeString=function(e,s,l){var f=0;if(s==null||s=="ASCII")if(l!=null){var d=Math.min(e.length,l);for(f=0;f<d;f++)this.writeUint8(e.charCodeAt(f));for(;f<l;f++)this.writeUint8(0)}else for(f=0;f<e.length;f++)this.writeUint8(e.charCodeAt(f));else this.writeUint8Array(new TextEncoder(s).encode(e.substring(0,l)))},i.prototype.writeCString=function(e,s){var l=0;if(s!=null){var f=Math.min(e.length,s);for(l=0;l<f;l++)this.writeUint8(e.charCodeAt(l));for(;l<s;l++)this.writeUint8(0)}else{for(l=0;l<e.length;l++)this.writeUint8(e.charCodeAt(l));this.writeUint8(0)}},i.prototype.writeStruct=function(e,s){for(var l=0;l<e.length;l+=2){var f=e[l+1];this.writeType(f,s[e[l]],s)}},i.prototype.writeType=function(e,s,l){var f;if(typeof e=="function")return e(this,s);if(typeof e=="object"&&!(e instanceof Array))return e.set(this,s,l);var d=null,y="ASCII",m=this.position;switch(typeof e=="string"&&/:/.test(e)&&(f=e.split(":"),e=f[0],d=parseInt(f[1])),typeof e=="string"&&/,/.test(e)&&(f=e.split(","),e=f[0],y=parseInt(f[1])),e){case"uint8":this.writeUint8(s);break;case"int8":this.writeInt8(s);break;case"uint16":this.writeUint16(s,this.endianness);break;case"int16":this.writeInt16(s,this.endianness);break;case"uint32":this.writeUint32(s,this.endianness);break;case"int32":this.writeInt32(s,this.endianness);break;case"float32":this.writeFloat32(s,this.endianness);break;case"float64":this.writeFloat64(s,this.endianness);break;case"uint16be":this.writeUint16(s,i.BIG_ENDIAN);break;case"int16be":this.writeInt16(s,i.BIG_ENDIAN);break;case"uint32be":this.writeUint32(s,i.BIG_ENDIAN);break;case"int32be":this.writeInt32(s,i.BIG_ENDIAN);break;case"float32be":this.writeFloat32(s,i.BIG_ENDIAN);break;case"float64be":this.writeFloat64(s,i.BIG_ENDIAN);break;case"uint16le":this.writeUint16(s,i.LITTLE_ENDIAN);break;case"int16le":this.writeInt16(s,i.LITTLE_ENDIAN);break;case"uint32le":this.writeUint32(s,i.LITTLE_ENDIAN);break;case"int32le":this.writeInt32(s,i.LITTLE_ENDIAN);break;case"float32le":this.writeFloat32(s,i.LITTLE_ENDIAN);break;case"float64le":this.writeFloat64(s,i.LITTLE_ENDIAN);break;case"cstring":this.writeCString(s,d);break;case"string":this.writeString(s,y,d);break;case"u16string":this.writeUCS2String(s,this.endianness,d);break;case"u16stringle":this.writeUCS2String(s,i.LITTLE_ENDIAN,d);break;case"u16stringbe":this.writeUCS2String(s,i.BIG_ENDIAN,d);break;default:if(e.length==3){for(var _=e[1],E=0;E<s.length;E++)this.writeType(_,s[E]);break}else{this.writeStruct(e,s);break}}d!=null&&(this.position=m,this._realloc(d),this.position=m+d)},i.prototype.writeUint64=function(e){var s=Math.floor(e/r);this.writeUint32(s),this.writeUint32(e&4294967295)},i.prototype.writeUint24=function(e){this.writeUint8((e&16711680)>>16),this.writeUint8((e&65280)>>8),this.writeUint8(e&255)},i.prototype.adjustUint32=function(e,s){var l=this.position;this.seek(e),this.writeUint32(s),this.seek(l)},i.prototype.mapInt32Array=function(e,s){this._realloc(e*4);var l=new Int32Array(this._buffer,this.byteOffset+this.position,e);return i.arrayToNative(l,s==null?this.endianness:s),this.position+=e*4,l},i.prototype.mapInt16Array=function(e,s){this._realloc(e*2);var l=new Int16Array(this._buffer,this.byteOffset+this.position,e);return i.arrayToNative(l,s==null?this.endianness:s),this.position+=e*2,l},i.prototype.mapInt8Array=function(e){this._realloc(e*1);var s=new Int8Array(this._buffer,this.byteOffset+this.position,e);return this.position+=e*1,s},i.prototype.mapUint32Array=function(e,s){this._realloc(e*4);var l=new Uint32Array(this._buffer,this.byteOffset+this.position,e);return i.arrayToNative(l,s==null?this.endianness:s),this.position+=e*4,l},i.prototype.mapUint16Array=function(e,s){this._realloc(e*2);var l=new Uint16Array(this._buffer,this.byteOffset+this.position,e);return i.arrayToNative(l,s==null?this.endianness:s),this.position+=e*2,l},i.prototype.mapFloat64Array=function(e,s){this._realloc(e*8);var l=new Float64Array(this._buffer,this.byteOffset+this.position,e);return i.arrayToNative(l,s==null?this.endianness:s),this.position+=e*8,l},i.prototype.mapFloat32Array=function(e,s){this._realloc(e*4);var l=new Float32Array(this._buffer,this.byteOffset+this.position,e);return i.arrayToNative(l,s==null?this.endianness:s),this.position+=e*4,l};var n=function(e){this.buffers=[],this.bufferIndex=-1,e&&(this.insertBuffer(e),this.bufferIndex=0)};n.prototype=new i(new ArrayBuffer,0,i.BIG_ENDIAN),n.prototype.initialized=function(){var e;return this.bufferIndex>-1?!0:this.buffers.length>0?(e=this.buffers[0],e.fileStart===0?(this.buffer=e,this.bufferIndex=0,a.debug("MultiBufferStream","Stream ready for parsing"),!0):(a.warn("MultiBufferStream","The first buffer should have a fileStart of 0"),this.logBufferLevel(),!1)):(a.warn("MultiBufferStream","No buffer to start parsing from"),this.logBufferLevel(),!1)},ArrayBuffer.concat=function(e,s){a.debug("ArrayBuffer","Trying to create a new buffer of size: "+(e.byteLength+s.byteLength));var l=new Uint8Array(e.byteLength+s.byteLength);return l.set(new Uint8Array(e),0),l.set(new Uint8Array(s),e.byteLength),l.buffer},n.prototype.reduceBuffer=function(e,s,l){var f;return f=new Uint8Array(l),f.set(new Uint8Array(e,s,l)),f.buffer.fileStart=e.fileStart+s,f.buffer.usedBytes=0,f.buffer},n.prototype.insertBuffer=function(e){for(var s=!0,l=0;l<this.buffers.length;l++){var f=this.buffers[l];if(e.fileStart<=f.fileStart){if(e.fileStart===f.fileStart)if(e.byteLength>f.byteLength){this.buffers.splice(l,1),l--;continue}else a.warn("MultiBufferStream","Buffer (fileStart: "+e.fileStart+" - Length: "+e.byteLength+") already appended, ignoring");else e.fileStart+e.byteLength<=f.fileStart||(e=this.reduceBuffer(e,0,f.fileStart-e.fileStart)),a.debug("MultiBufferStream","Appending new buffer (fileStart: "+e.fileStart+" - Length: "+e.byteLength+")"),this.buffers.splice(l,0,e),l===0&&(this.buffer=e);s=!1;break}else if(e.fileStart<f.fileStart+f.byteLength){var d=f.fileStart+f.byteLength-e.fileStart,y=e.byteLength-d;if(y>0)e=this.reduceBuffer(e,d,y);else{s=!1;break}}}s&&(a.debug("MultiBufferStream","Appending new buffer (fileStart: "+e.fileStart+" - Length: "+e.byteLength+")"),this.buffers.push(e),l===0&&(this.buffer=e))},n.prototype.logBufferLevel=function(e){var s,l,f,d,y=[],m,_="";for(f=0,d=0,s=0;s<this.buffers.length;s++)l=this.buffers[s],s===0?(m={},y.push(m),m.start=l.fileStart,m.end=l.fileStart+l.byteLength,_+="["+m.start+"-"):m.end===l.fileStart?m.end=l.fileStart+l.byteLength:(m={},m.start=l.fileStart,_+=y[y.length-1].end-1+"], ["+m.start+"-",m.end=l.fileStart+l.byteLength,y.push(m)),f+=l.usedBytes,d+=l.byteLength;y.length>0&&(_+=m.end-1+"]");var E=e?a.info:a.debug;this.buffers.length===0?E("MultiBufferStream","No more buffer in memory"):E("MultiBufferStream",""+this.buffers.length+" stored buffer(s) ("+f+"/"+d+" bytes), continuous ranges: "+_)},n.prototype.cleanBuffers=function(){var e,s;for(e=0;e<this.buffers.length;e++)s=this.buffers[e],s.usedBytes===s.byteLength&&(a.debug("MultiBufferStream","Removing buffer #"+e),this.buffers.splice(e,1),e--)},n.prototype.mergeNextBuffer=function(){var e;if(this.bufferIndex+1<this.buffers.length)if(e=this.buffers[this.bufferIndex+1],e.fileStart===this.buffer.fileStart+this.buffer.byteLength){var s=this.buffer.byteLength,l=this.buffer.usedBytes,f=this.buffer.fileStart;return this.buffers[this.bufferIndex]=ArrayBuffer.concat(this.buffer,e),this.buffer=this.buffers[this.bufferIndex],this.buffers.splice(this.bufferIndex+1,1),this.buffer.usedBytes=l,this.buffer.fileStart=f,a.debug("ISOFile","Concatenating buffer for box parsing (length: "+s+"->"+this.buffer.byteLength+")"),!0}else return!1;else return!1},n.prototype.findPosition=function(e,s,l){var f,d=null,y=-1;for(e===!0?f=0:f=this.bufferIndex;f<this.buffers.length&&(d=this.buffers[f],d.fileStart<=s);){y=f,l&&(d.fileStart+d.byteLength<=s?d.usedBytes=d.byteLength:d.usedBytes=s-d.fileStart,this.logBufferLevel());f++}return y!==-1?(d=this.buffers[y],d.fileStart+d.byteLength>=s?(a.debug("MultiBufferStream","Found position in existing buffer #"+y),y):-1):-1},n.prototype.findEndContiguousBuf=function(e){var s,l,f,d=e!==void 0?e:this.bufferIndex;if(l=this.buffers[d],this.buffers.length>d+1)for(s=d+1;s<this.buffers.length&&(f=this.buffers[s],f.fileStart===l.fileStart+l.byteLength);s++)l=f;return l.fileStart+l.byteLength},n.prototype.getEndFilePositionAfter=function(e){var s=this.findPosition(!0,e,!1);return s!==-1?this.findEndContiguousBuf(s):e},n.prototype.addUsedBytes=function(e){this.buffer.usedBytes+=e,this.logBufferLevel()},n.prototype.setAllUsedBytes=function(){this.buffer.usedBytes=this.buffer.byteLength,this.logBufferLevel()},n.prototype.seek=function(e,s,l){var f;return f=this.findPosition(s,e,l),f!==-1?(this.buffer=this.buffers[f],this.bufferIndex=f,this.position=e-this.buffer.fileStart,a.debug("MultiBufferStream","Repositioning parser at buffer position: "+this.position),!0):(a.debug("MultiBufferStream","Position "+e+" not found in buffered data"),!1)},n.prototype.getPosition=function(){if(this.bufferIndex===-1||this.buffers[this.bufferIndex]===null)throw"Error accessing position in the MultiBufferStream";return this.buffers[this.bufferIndex].fileStart+this.position},n.prototype.getLength=function(){return this.byteLength},n.prototype.getEndPosition=function(){if(this.bufferIndex===-1||this.buffers[this.bufferIndex]===null)throw"Error accessing position in the MultiBufferStream";return this.buffers[this.bufferIndex].fileStart+this.byteLength},h.MultiBufferStream=n;var u=function(){var e=3,s=4,l=5,f=6,d=[];d[e]="ES_Descriptor",d[s]="DecoderConfigDescriptor",d[l]="DecoderSpecificInfo",d[f]="SLConfigDescriptor",this.getDescriptorName=function(_){return d[_]};var y=this,m={};return this.parseOneDescriptor=function(_){var E=0,w,k,x;for(w=_.readUint8(),x=_.readUint8();x&128;)E=(x&127)<<7,x=_.readUint8();return E+=x&127,a.debug("MPEG4DescriptorParser","Found "+(d[w]||"Descriptor "+w)+", size "+E+" at position "+_.getPosition()),d[w]?k=new m[d[w]](E):k=new m.Descriptor(E),k.parse(_),k},m.Descriptor=function(_,E){this.tag=_,this.size=E,this.descs=[]},m.Descriptor.prototype.parse=function(_){this.data=_.readUint8Array(this.size)},m.Descriptor.prototype.findDescriptor=function(_){for(var E=0;E<this.descs.length;E++)if(this.descs[E].tag==_)return this.descs[E];return null},m.Descriptor.prototype.parseRemainingDescriptors=function(_){for(var E=_.position;_.position<E+this.size;){var w=y.parseOneDescriptor(_);this.descs.push(w)}},m.ES_Descriptor=function(_){m.Descriptor.call(this,e,_)},m.ES_Descriptor.prototype=new m.Descriptor,m.ES_Descriptor.prototype.parse=function(_){if(this.ES_ID=_.readUint16(),this.flags=_.readUint8(),this.size-=3,this.flags&128?(this.dependsOn_ES_ID=_.readUint16(),this.size-=2):this.dependsOn_ES_ID=0,this.flags&64){var E=_.readUint8();this.URL=_.readString(E),this.size-=E+1}else this.URL="";this.flags&32?(this.OCR_ES_ID=_.readUint16(),this.size-=2):this.OCR_ES_ID=0,this.parseRemainingDescriptors(_)},m.ES_Descriptor.prototype.getOTI=function(_){var E=this.findDescriptor(s);return E?E.oti:0},m.ES_Descriptor.prototype.getAudioConfig=function(_){var E=this.findDescriptor(s);if(!E)return null;var w=E.findDescriptor(l);if(w&&w.data){var k=(w.data[0]&248)>>3;return k===31&&w.data.length>=2&&(k=32+((w.data[0]&7)<<3)+((w.data[1]&224)>>5)),k}else return null},m.DecoderConfigDescriptor=function(_){m.Descriptor.call(this,s,_)},m.DecoderConfigDescriptor.prototype=new m.Descriptor,m.DecoderConfigDescriptor.prototype.parse=function(_){this.oti=_.readUint8(),this.streamType=_.readUint8(),this.bufferSize=_.readUint24(),this.maxBitrate=_.readUint32(),this.avgBitrate=_.readUint32(),this.size-=13,this.parseRemainingDescriptors(_)},m.DecoderSpecificInfo=function(_){m.Descriptor.call(this,l,_)},m.DecoderSpecificInfo.prototype=new m.Descriptor,m.SLConfigDescriptor=function(_){m.Descriptor.call(this,f,_)},m.SLConfigDescriptor.prototype=new m.Descriptor,this};h.MPEG4DescriptorParser=u;var o={ERR_INVALID_DATA:-1,ERR_NOT_ENOUGH_DATA:0,OK:1,BASIC_BOXES:["mdat","idat","free","skip","meco","strk"],FULL_BOXES:["hmhd","nmhd","iods","xml ","bxml","ipro","mere"],CONTAINER_BOXES:[["moov",["trak","pssh"]],["trak"],["edts"],["mdia"],["minf"],["dinf"],["stbl",["sgpd","sbgp"]],["mvex",["trex"]],["moof",["traf"]],["traf",["trun","sgpd","sbgp"]],["vttc"],["tref"],["iref"],["mfra",["tfra"]],["meco"],["hnti"],["hinf"],["strk"],["strd"],["sinf"],["rinf"],["schi"],["trgr"],["udta",["kind"]],["iprp",["ipma"]],["ipco"]],boxCodes:[],fullBoxCodes:[],containerBoxCodes:[],sampleEntryCodes:{},sampleGroupEntryCodes:[],trackGroupTypes:[],UUIDBoxes:{},UUIDs:[],initialize:function(){o.FullBox.prototype=new o.Box,o.ContainerBox.prototype=new o.Box,o.SampleEntry.prototype=new o.Box,o.TrackGroupTypeBox.prototype=new o.FullBox,o.BASIC_BOXES.forEach(function(e){o.createBoxCtor(e)}),o.FULL_BOXES.forEach(function(e){o.createFullBoxCtor(e)}),o.CONTAINER_BOXES.forEach(function(e){o.createContainerBoxCtor(e[0],null,e[1])})},Box:function(e,s,l){this.type=e,this.size=s,this.uuid=l},FullBox:function(e,s,l){o.Box.call(this,e,s,l),this.flags=0,this.version=0},ContainerBox:function(e,s,l){o.Box.call(this,e,s,l),this.boxes=[]},SampleEntry:function(e,s,l,f){o.ContainerBox.call(this,e,s),this.hdr_size=l,this.start=f},SampleGroupEntry:function(e){this.grouping_type=e},TrackGroupTypeBox:function(e,s){o.FullBox.call(this,e,s)},createBoxCtor:function(e,s){o.boxCodes.push(e),o[e+"Box"]=function(l){o.Box.call(this,e,l)},o[e+"Box"].prototype=new o.Box,s&&(o[e+"Box"].prototype.parse=s)},createFullBoxCtor:function(e,s){o[e+"Box"]=function(l){o.FullBox.call(this,e,l)},o[e+"Box"].prototype=new o.FullBox,o[e+"Box"].prototype.parse=function(l){this.parseFullHeader(l),s&&s.call(this,l)}},addSubBoxArrays:function(e){if(e){this.subBoxNames=e;for(var s=e.length,l=0;l<s;l++)this[e[l]+"s"]=[]}},createContainerBoxCtor:function(e,s,l){o[e+"Box"]=function(f){o.ContainerBox.call(this,e,f),o.addSubBoxArrays.call(this,l)},o[e+"Box"].prototype=new o.ContainerBox,s&&(o[e+"Box"].prototype.parse=s)},createMediaSampleEntryCtor:function(e,s,l){o.sampleEntryCodes[e]=[],o[e+"SampleEntry"]=function(f,d){o.SampleEntry.call(this,f,d),o.addSubBoxArrays.call(this,l)},o[e+"SampleEntry"].prototype=new o.SampleEntry,s&&(o[e+"SampleEntry"].prototype.parse=s)},createSampleEntryCtor:function(e,s,l,f){o.sampleEntryCodes[e].push(s),o[s+"SampleEntry"]=function(d){o[e+"SampleEntry"].call(this,s,d),o.addSubBoxArrays.call(this,f)},o[s+"SampleEntry"].prototype=new o[e+"SampleEntry"],l&&(o[s+"SampleEntry"].prototype.parse=l)},createEncryptedSampleEntryCtor:function(e,s,l){o.createSampleEntryCtor.call(this,e,s,l,["sinf"])},createSampleGroupCtor:function(e,s){o[e+"SampleGroupEntry"]=function(l){o.SampleGroupEntry.call(this,e,l)},o[e+"SampleGroupEntry"].prototype=new o.SampleGroupEntry,s&&(o[e+"SampleGroupEntry"].prototype.parse=s)},createTrackGroupCtor:function(e,s){o[e+"TrackGroupTypeBox"]=function(l){o.TrackGroupTypeBox.call(this,e,l)},o[e+"TrackGroupTypeBox"].prototype=new o.TrackGroupTypeBox,s&&(o[e+"TrackGroupTypeBox"].prototype.parse=s)},createUUIDBox:function(e,s,l,f){o.UUIDs.push(e),o.UUIDBoxes[e]=function(d){s?o.FullBox.call(this,"uuid",d,e):l?o.ContainerBox.call(this,"uuid",d,e):o.Box.call(this,"uuid",d,e)},o.UUIDBoxes[e].prototype=s?new o.FullBox:l?new o.ContainerBox:new o.Box,f&&(s?o.UUIDBoxes[e].prototype.parse=function(d){this.parseFullHeader(d),f&&f.call(this,d)}:o.UUIDBoxes[e].prototype.parse=f)}};o.initialize(),o.TKHD_FLAG_ENABLED=1,o.TKHD_FLAG_IN_MOVIE=2,o.TKHD_FLAG_IN_PREVIEW=4,o.TFHD_FLAG_BASE_DATA_OFFSET=1,o.TFHD_FLAG_SAMPLE_DESC=2,o.TFHD_FLAG_SAMPLE_DUR=8,o.TFHD_FLAG_SAMPLE_SIZE=16,o.TFHD_FLAG_SAMPLE_FLAGS=32,o.TFHD_FLAG_DUR_EMPTY=65536,o.TFHD_FLAG_DEFAULT_BASE_IS_MOOF=131072,o.TRUN_FLAGS_DATA_OFFSET=1,o.TRUN_FLAGS_FIRST_FLAG=4,o.TRUN_FLAGS_DURATION=256,o.TRUN_FLAGS_SIZE=512,o.TRUN_FLAGS_FLAGS=1024,o.TRUN_FLAGS_CTS_OFFSET=2048,o.Box.prototype.add=function(e){return this.addBox(new o[e+"Box"])},o.Box.prototype.addBox=function(e){return this.boxes.push(e),this[e.type+"s"]?this[e.type+"s"].push(e):this[e.type]=e,e},o.Box.prototype.set=function(e,s){return this[e]=s,this},o.Box.prototype.addEntry=function(e,s){var l=s||"entries";return this[l]||(this[l]=[]),this[l].push(e),this},h.BoxParser=o,o.parseUUID=function(e){return o.parseHex16(e)},o.parseHex16=function(e){for(var s="",l=0;l<16;l++){var f=e.readUint8().toString(16);s+=f.length===1?"0"+f:f}return s},o.parseOneBox=function(e,s,l){var f,d=e.getPosition(),y=0,m,_;if(e.getEndPosition()-d<8)return a.debug("BoxParser","Not enough data in stream to parse the type and size of the box"),{code:o.ERR_NOT_ENOUGH_DATA};if(l&&l<8)return a.debug("BoxParser","Not enough bytes left in the parent box to parse a new box"),{code:o.ERR_NOT_ENOUGH_DATA};var E=e.readUint32(),w=e.readString(4),k=w;if(a.debug("BoxParser","Found box of type '"+w+"' and size "+E+" at position "+d),y=8,w=="uuid"){if(e.getEndPosition()-e.getPosition()<16||l-y<16)return e.seek(d),a.debug("BoxParser","Not enough bytes left in the parent box to parse a UUID box"),{code:o.ERR_NOT_ENOUGH_DATA};_=o.parseUUID(e),y+=16,k=_}if(E==1){if(e.getEndPosition()-e.getPosition()<8||l&&l-y<8)return e.seek(d),a.warn("BoxParser",'Not enough data in stream to parse the extended size of the "'+w+'" box'),{code:o.ERR_NOT_ENOUGH_DATA};E=e.readUint64(),y+=8}else if(E===0){if(l)E=l;else if(w!=="mdat")return a.error("BoxParser","Unlimited box size not supported for type: '"+w+"'"),f=new o.Box(w,E),{code:o.OK,box:f,size:f.size}}return E!==0&&E<y?(a.error("BoxParser","Box of type "+w+" has an invalid size "+E+" (too small to be a box)"),{code:o.ERR_NOT_ENOUGH_DATA,type:w,size:E,hdr_size:y,start:d}):E!==0&&l&&E>l?(a.error("BoxParser","Box of type '"+w+"' has a size "+E+" greater than its container size "+l),{code:o.ERR_NOT_ENOUGH_DATA,type:w,size:E,hdr_size:y,start:d}):E!==0&&d+E>e.getEndPosition()?(e.seek(d),a.info("BoxParser","Not enough data in stream to parse the entire '"+w+"' box"),{code:o.ERR_NOT_ENOUGH_DATA,type:w,size:E,hdr_size:y,start:d}):s?{code:o.OK,type:w,size:E,hdr_size:y,start:d}:(o[w+"Box"]?f=new o[w+"Box"](E):w!=="uuid"?(a.warn("BoxParser","Unknown box type: '"+w+"'"),f=new o.Box(w,E),f.has_unparsed_data=!0):o.UUIDBoxes[_]?f=new o.UUIDBoxes[_](E):(a.warn("BoxParser","Unknown uuid type: '"+_+"'"),f=new o.Box(w,E),f.uuid=_,f.has_unparsed_data=!0),f.hdr_size=y,f.start=d,f.write===o.Box.prototype.write&&f.type!=="mdat"&&(a.info("BoxParser","'"+k+"' box writing not yet implemented, keeping unparsed data in memory for later write"),f.parseDataAndRewind(e)),f.parse(e),m=e.getPosition()-(f.start+f.size),m<0?(a.warn("BoxParser","Parsing of box '"+k+"' did not read the entire indicated box data size (missing "+-m+" bytes), seeking forward"),e.seek(f.start+f.size)):m>0&&(a.error("BoxParser","Parsing of box '"+k+"' read "+m+" more bytes than the indicated box data size, seeking backwards"),f.size!==0&&e.seek(f.start+f.size)),{code:o.OK,box:f,size:f.size})},o.Box.prototype.parse=function(e){this.type!="mdat"?this.data=e.readUint8Array(this.size-this.hdr_size):this.size===0?e.seek(e.getEndPosition()):e.seek(this.start+this.size)},o.Box.prototype.parseDataAndRewind=function(e){this.data=e.readUint8Array(this.size-this.hdr_size),e.position-=this.size-this.hdr_size},o.FullBox.prototype.parseDataAndRewind=function(e){this.parseFullHeader(e),this.data=e.readUint8Array(this.size-this.hdr_size),this.hdr_size-=4,e.position-=this.size-this.hdr_size},o.FullBox.prototype.parseFullHeader=function(e){this.version=e.readUint8(),this.flags=e.readUint24(),this.hdr_size+=4},o.FullBox.prototype.parse=function(e){this.parseFullHeader(e),this.data=e.readUint8Array(this.size-this.hdr_size)},o.ContainerBox.prototype.parse=function(e){for(var s,l;e.getPosition()<this.start+this.size;)if(s=o.parseOneBox(e,!1,this.size-(e.getPosition()-this.start)),s.code===o.OK)if(l=s.box,this.boxes.push(l),this.subBoxNames&&this.subBoxNames.indexOf(l.type)!=-1)this[this.subBoxNames[this.subBoxNames.indexOf(l.type)]+"s"].push(l);else{var f=l.type!=="uuid"?l.type:l.uuid;this[f]?a.warn("Box of type "+f+" already stored in field of this type"):this[f]=l}else return},o.Box.prototype.parseLanguage=function(e){this.language=e.readUint16();var s=[];s[0]=this.language>>10&31,s[1]=this.language>>5&31,s[2]=this.language&31,this.languageString=String.fromCharCode(s[0]+96,s[1]+96,s[2]+96)},o.SAMPLE_ENTRY_TYPE_VISUAL="Visual",o.SAMPLE_ENTRY_TYPE_AUDIO="Audio",o.SAMPLE_ENTRY_TYPE_HINT="Hint",o.SAMPLE_ENTRY_TYPE_METADATA="Metadata",o.SAMPLE_ENTRY_TYPE_SUBTITLE="Subtitle",o.SAMPLE_ENTRY_TYPE_SYSTEM="System",o.SAMPLE_ENTRY_TYPE_TEXT="Text",o.SampleEntry.prototype.parseHeader=function(e){e.readUint8Array(6),this.data_reference_index=e.readUint16(),this.hdr_size+=8},o.SampleEntry.prototype.parse=function(e){this.parseHeader(e),this.data=e.readUint8Array(this.size-this.hdr_size)},o.SampleEntry.prototype.parseDataAndRewind=function(e){this.parseHeader(e),this.data=e.readUint8Array(this.size-this.hdr_size),this.hdr_size-=8,e.position-=this.size-this.hdr_size},o.SampleEntry.prototype.parseFooter=function(e){o.ContainerBox.prototype.parse.call(this,e)},o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_HINT),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_METADATA),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SYSTEM),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_TEXT),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,function(e){var s;this.parseHeader(e),e.readUint16(),e.readUint16(),e.readUint32Array(3),this.width=e.readUint16(),this.height=e.readUint16(),this.horizresolution=e.readUint32(),this.vertresolution=e.readUint32(),e.readUint32(),this.frame_count=e.readUint16(),s=Math.min(31,e.readUint8()),this.compressorname=e.readString(s),s<31&&e.readString(31-s),this.depth=e.readUint16(),e.readUint16(),this.parseFooter(e)}),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,function(e){this.parseHeader(e),e.readUint32Array(2),this.channel_count=e.readUint16(),this.samplesize=e.readUint16(),e.readUint16(),e.readUint16(),this.samplerate=e.readUint32()/(1<<16),this.parseFooter(e)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"avc1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"avc2"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"avc3"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"avc4"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"av01"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"hvc1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"hev1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vvc1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vvi1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vvs1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vvcN"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vp08"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vp09"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"mp4a"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"ac-3"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"ec-3"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"Opus"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"encv"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"enca"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE,"encu"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SYSTEM,"encs"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_TEXT,"enct"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_METADATA,"encm"),o.createBoxCtor("a1lx",function(e){var s=e.readUint8()&1,l=((s&1)+1)*16;this.layer_size=[];for(var f=0;f<3;f++)l==16?this.layer_size[f]=e.readUint16():this.layer_size[f]=e.readUint32()}),o.createBoxCtor("a1op",function(e){this.op_index=e.readUint8()}),o.createFullBoxCtor("auxC",function(e){this.aux_type=e.readCString();var s=this.size-this.hdr_size-(this.aux_type.length+1);this.aux_subtype=e.readUint8Array(s)}),o.createBoxCtor("av1C",function(e){var s=e.readUint8();if(s>>7&!1){a.error("av1C marker problem");return}if(this.version=s&127,this.version!==1){a.error("av1C version "+this.version+" not supported");return}if(s=e.readUint8(),this.seq_profile=s>>5&7,this.seq_level_idx_0=s&31,s=e.readUint8(),this.seq_tier_0=s>>7&1,this.high_bitdepth=s>>6&1,this.twelve_bit=s>>5&1,this.monochrome=s>>4&1,this.chroma_subsampling_x=s>>3&1,this.chroma_subsampling_y=s>>2&1,this.chroma_sample_position=s&3,s=e.readUint8(),this.reserved_1=s>>5&7,this.reserved_1!==0){a.error("av1C reserved_1 parsing problem");return}if(this.initial_presentation_delay_present=s>>4&1,this.initial_presentation_delay_present===1)this.initial_presentation_delay_minus_one=s&15;else if(this.reserved_2=s&15,this.reserved_2!==0){a.error("av1C reserved_2 parsing problem");return}var l=this.size-this.hdr_size-4;this.configOBUs=e.readUint8Array(l)}),o.createBoxCtor("avcC",function(e){var s,l;for(this.configurationVersion=e.readUint8(),this.AVCProfileIndication=e.readUint8(),this.profile_compatibility=e.readUint8(),this.AVCLevelIndication=e.readUint8(),this.lengthSizeMinusOne=e.readUint8()&3,this.nb_SPS_nalus=e.readUint8()&31,l=this.size-this.hdr_size-6,this.SPS=[],s=0;s<this.nb_SPS_nalus;s++)this.SPS[s]={},this.SPS[s].length=e.readUint16(),this.SPS[s].nalu=e.readUint8Array(this.SPS[s].length),l-=2+this.SPS[s].length;for(this.nb_PPS_nalus=e.readUint8(),l--,this.PPS=[],s=0;s<this.nb_PPS_nalus;s++)this.PPS[s]={},this.PPS[s].length=e.readUint16(),this.PPS[s].nalu=e.readUint8Array(this.PPS[s].length),l-=2+this.PPS[s].length;l>0&&(this.ext=e.readUint8Array(l))}),o.createBoxCtor("btrt",function(e){this.bufferSizeDB=e.readUint32(),this.maxBitrate=e.readUint32(),this.avgBitrate=e.readUint32()}),o.createBoxCtor("clap",function(e){this.cleanApertureWidthN=e.readUint32(),this.cleanApertureWidthD=e.readUint32(),this.cleanApertureHeightN=e.readUint32(),this.cleanApertureHeightD=e.readUint32(),this.horizOffN=e.readUint32(),this.horizOffD=e.readUint32(),this.vertOffN=e.readUint32(),this.vertOffD=e.readUint32()}),o.createBoxCtor("clli",function(e){this.max_content_light_level=e.readUint16(),this.max_pic_average_light_level=e.readUint16()}),o.createFullBoxCtor("co64",function(e){var s,l;if(s=e.readUint32(),this.chunk_offsets=[],this.version===0)for(l=0;l<s;l++)this.chunk_offsets.push(e.readUint64())}),o.createFullBoxCtor("CoLL",function(e){this.maxCLL=e.readUint16(),this.maxFALL=e.readUint16()}),o.createBoxCtor("colr",function(e){if(this.colour_type=e.readString(4),this.colour_type==="nclx"){this.colour_primaries=e.readUint16(),this.transfer_characteristics=e.readUint16(),this.matrix_coefficients=e.readUint16();var s=e.readUint8();this.full_range_flag=s>>7}else this.colour_type==="rICC"?this.ICC_profile=e.readUint8Array(this.size-4):this.colour_type==="prof"&&(this.ICC_profile=e.readUint8Array(this.size-4))}),o.createFullBoxCtor("cprt",function(e){this.parseLanguage(e),this.notice=e.readCString()}),o.createFullBoxCtor("cslg",function(e){this.version===0&&(this.compositionToDTSShift=e.readInt32(),this.leastDecodeToDisplayDelta=e.readInt32(),this.greatestDecodeToDisplayDelta=e.readInt32(),this.compositionStartTime=e.readInt32(),this.compositionEndTime=e.readInt32())}),o.createFullBoxCtor("ctts",function(e){var s,l;if(s=e.readUint32(),this.sample_counts=[],this.sample_offsets=[],this.version===0)for(l=0;l<s;l++){this.sample_counts.push(e.readUint32());var f=e.readInt32();f<0&&a.warn("BoxParser","ctts box uses negative values without using version 1"),this.sample_offsets.push(f)}else if(this.version==1)for(l=0;l<s;l++)this.sample_counts.push(e.readUint32()),this.sample_offsets.push(e.readInt32())}),o.createBoxCtor("dac3",function(e){var s=e.readUint8(),l=e.readUint8(),f=e.readUint8();this.fscod=s>>6,this.bsid=s>>1&31,this.bsmod=(s&1)<<2|l>>6&3,this.acmod=l>>3&7,this.lfeon=l>>2&1,this.bit_rate_code=l&3|f>>5&7}),o.createBoxCtor("dec3",function(e){var s=e.readUint16();this.data_rate=s>>3,this.num_ind_sub=s&7,this.ind_subs=[];for(var l=0;l<this.num_ind_sub+1;l++){var f={};this.ind_subs.push(f);var d=e.readUint8(),y=e.readUint8(),m=e.readUint8();f.fscod=d>>6,f.bsid=d>>1&31,f.bsmod=(d&1)<<4|y>>4&15,f.acmod=y>>1&7,f.lfeon=y&1,f.num_dep_sub=m>>1&15,f.num_dep_sub>0&&(f.chan_loc=(m&1)<<8|e.readUint8())}}),o.createFullBoxCtor("dfLa",function(e){var s=127,l=128,f=[],d=["STREAMINFO","PADDING","APPLICATION","SEEKTABLE","VORBIS_COMMENT","CUESHEET","PICTURE","RESERVED"];this.parseFullHeader(e);do{var y=e.readUint8(),m=Math.min(y&s,d.length-1);if(m?e.readUint8Array(e.readUint24()):(e.readUint8Array(13),this.samplerate=e.readUint32()>>12,e.readUint8Array(20)),f.push(d[m]),y&l)break}while(!0);this.numMetadataBlocks=f.length+" ("+f.join(", ")+")"}),o.createBoxCtor("dimm",function(e){this.bytessent=e.readUint64()}),o.createBoxCtor("dmax",function(e){this.time=e.readUint32()}),o.createBoxCtor("dmed",function(e){this.bytessent=e.readUint64()}),o.createBoxCtor("dOps",function(e){if(this.Version=e.readUint8(),this.OutputChannelCount=e.readUint8(),this.PreSkip=e.readUint16(),this.InputSampleRate=e.readUint32(),this.OutputGain=e.readInt16(),this.ChannelMappingFamily=e.readUint8(),this.ChannelMappingFamily!==0){this.StreamCount=e.readUint8(),this.CoupledCount=e.readUint8(),this.ChannelMapping=[];for(var s=0;s<this.OutputChannelCount;s++)this.ChannelMapping[s]=e.readUint8()}}),o.createFullBoxCtor("dref",function(e){var s,l;this.entries=[];for(var f=e.readUint32(),d=0;d<f;d++)if(s=o.parseOneBox(e,!1,this.size-(e.getPosition()-this.start)),s.code===o.OK)l=s.box,this.entries.push(l);else return}),o.createBoxCtor("drep",function(e){this.bytessent=e.readUint64()}),o.createFullBoxCtor("elng",function(e){this.extended_language=e.readString(this.size-this.hdr_size)}),o.createFullBoxCtor("elst",function(e){this.entries=[];for(var s=e.readUint32(),l=0;l<s;l++){var f={};this.entries.push(f),this.version===1?(f.segment_duration=e.readUint64(),f.media_time=e.readInt64()):(f.segment_duration=e.readUint32(),f.media_time=e.readInt32()),f.media_rate_integer=e.readInt16(),f.media_rate_fraction=e.readInt16()}}),o.createFullBoxCtor("emsg",function(e){this.version==1?(this.timescale=e.readUint32(),this.presentation_time=e.readUint64(),this.event_duration=e.readUint32(),this.id=e.readUint32(),this.scheme_id_uri=e.readCString(),this.value=e.readCString()):(this.scheme_id_uri=e.readCString(),this.value=e.readCString(),this.timescale=e.readUint32(),this.presentation_time_delta=e.readUint32(),this.event_duration=e.readUint32(),this.id=e.readUint32());var s=this.size-this.hdr_size-(4*4+(this.scheme_id_uri.length+1)+(this.value.length+1));this.version==1&&(s-=4),this.message_data=e.readUint8Array(s)}),o.createFullBoxCtor("esds",function(e){var s=e.readUint8Array(this.size-this.hdr_size);if(typeof u!="undefined"){var l=new u;this.esd=l.parseOneDescriptor(new i(s.buffer,0,i.BIG_ENDIAN))}}),o.createBoxCtor("fiel",function(e){this.fieldCount=e.readUint8(),this.fieldOrdering=e.readUint8()}),o.createBoxCtor("frma",function(e){this.data_format=e.readString(4)}),o.createBoxCtor("ftyp",function(e){var s=this.size-this.hdr_size;this.major_brand=e.readString(4),this.minor_version=e.readUint32(),s-=8,this.compatible_brands=[];for(var l=0;s>=4;)this.compatible_brands[l]=e.readString(4),s-=4,l++}),o.createFullBoxCtor("hdlr",function(e){this.version===0&&(e.readUint32(),this.handler=e.readString(4),e.readUint32Array(3),this.name=e.readString(this.size-this.hdr_size-20),this.name[this.name.length-1]==="\0"&&(this.name=this.name.slice(0,-1)))}),o.createBoxCtor("hvcC",function(e){var s,l,f,d;this.configurationVersion=e.readUint8(),d=e.readUint8(),this.general_profile_space=d>>6,this.general_tier_flag=(d&32)>>5,this.general_profile_idc=d&31,this.general_profile_compatibility=e.readUint32(),this.general_constraint_indicator=e.readUint8Array(6),this.general_level_idc=e.readUint8(),this.min_spatial_segmentation_idc=e.readUint16()&4095,this.parallelismType=e.readUint8()&3,this.chroma_format_idc=e.readUint8()&3,this.bit_depth_luma_minus8=e.readUint8()&7,this.bit_depth_chroma_minus8=e.readUint8()&7,this.avgFrameRate=e.readUint16(),d=e.readUint8(),this.constantFrameRate=d>>6,this.numTemporalLayers=(d&13)>>3,this.temporalIdNested=(d&4)>>2,this.lengthSizeMinusOne=d&3,this.nalu_arrays=[];var y=e.readUint8();for(s=0;s<y;s++){var m=[];this.nalu_arrays.push(m),d=e.readUint8(),m.completeness=(d&128)>>7,m.nalu_type=d&63;var _=e.readUint16();for(l=0;l<_;l++){var E={};m.push(E),f=e.readUint16(),E.data=e.readUint8Array(f)}}}),o.createFullBoxCtor("iinf",function(e){var s;this.version===0?this.entry_count=e.readUint16():this.entry_count=e.readUint32(),this.item_infos=[];for(var l=0;l<this.entry_count;l++)if(s=o.parseOneBox(e,!1,this.size-(e.getPosition()-this.start)),s.code===o.OK)s.box.type!=="infe"&&a.error("BoxParser","Expected 'infe' box, got "+s.box.type),this.item_infos[l]=s.box;else return}),o.createFullBoxCtor("iloc",function(e){var s;s=e.readUint8(),this.offset_size=s>>4&15,this.length_size=s&15,s=e.readUint8(),this.base_offset_size=s>>4&15,this.version===1||this.version===2?this.index_size=s&15:this.index_size=0,this.items=[];var l=0;if(this.version<2)l=e.readUint16();else if(this.version===2)l=e.readUint32();else throw"version of iloc box not supported";for(var f=0;f<l;f++){var d={};if(this.items.push(d),this.version<2)d.item_ID=e.readUint16();else if(this.version===2)d.item_ID=e.readUint16();else throw"version of iloc box not supported";switch(this.version===1||this.version===2?d.construction_method=e.readUint16()&15:d.construction_method=0,d.data_reference_index=e.readUint16(),this.base_offset_size){case 0:d.base_offset=0;break;case 4:d.base_offset=e.readUint32();break;case 8:d.base_offset=e.readUint64();break;default:throw"Error reading base offset size"}var y=e.readUint16();d.extents=[];for(var m=0;m<y;m++){var _={};if(d.extents.push(_),this.version===1||this.version===2)switch(this.index_size){case 0:_.extent_index=0;break;case 4:_.extent_index=e.readUint32();break;case 8:_.extent_index=e.readUint64();break;default:throw"Error reading extent index"}switch(this.offset_size){case 0:_.extent_offset=0;break;case 4:_.extent_offset=e.readUint32();break;case 8:_.extent_offset=e.readUint64();break;default:throw"Error reading extent index"}switch(this.length_size){case 0:_.extent_length=0;break;case 4:_.extent_length=e.readUint32();break;case 8:_.extent_length=e.readUint64();break;default:throw"Error reading extent index"}}}}),o.createBoxCtor("imir",function(e){var s=e.readUint8();this.reserved=s>>7,this.axis=s&1}),o.createFullBoxCtor("infe",function(e){if((this.version===0||this.version===1)&&(this.item_ID=e.readUint16(),this.item_protection_index=e.readUint16(),this.item_name=e.readCString(),this.content_type=e.readCString(),this.content_encoding=e.readCString()),this.version===1){this.extension_type=e.readString(4),a.warn("BoxParser","Cannot parse extension type"),e.seek(this.start+this.size);return}this.version>=2&&(this.version===2?this.item_ID=e.readUint16():this.version===3&&(this.item_ID=e.readUint32()),this.item_protection_index=e.readUint16(),this.item_type=e.readString(4),this.item_name=e.readCString(),this.item_type==="mime"?(this.content_type=e.readCString(),this.content_encoding=e.readCString()):this.item_type==="uri "&&(this.item_uri_type=e.readCString()))}),o.createFullBoxCtor("ipma",function(e){var s,l;for(entry_count=e.readUint32(),this.associations=[],s=0;s<entry_count;s++){var f={};this.associations.push(f),this.version<1?f.id=e.readUint16():f.id=e.readUint32();var d=e.readUint8();for(f.props=[],l=0;l<d;l++){var y=e.readUint8(),m={};f.props.push(m),m.essential=(y&128)>>7==1,this.flags&1?m.property_index=(y&127)<<8|e.readUint8():m.property_index=y&127}}}),o.createFullBoxCtor("iref",function(e){var s,l;for(this.references=[];e.getPosition()<this.start+this.size;)if(s=o.parseOneBox(e,!0,this.size-(e.getPosition()-this.start)),s.code===o.OK)this.version===0?l=new o.SingleItemTypeReferenceBox(s.type,s.size,s.hdr_size,s.start):l=new o.SingleItemTypeReferenceBoxLarge(s.type,s.size,s.hdr_size,s.start),l.write===o.Box.prototype.write&&l.type!=="mdat"&&(a.warn("BoxParser",l.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),l.parseDataAndRewind(e)),l.parse(e),this.references.push(l);else return}),o.createBoxCtor("irot",function(e){this.angle=e.readUint8()&3}),o.createFullBoxCtor("ispe",function(e){this.image_width=e.readUint32(),this.image_height=e.readUint32()}),o.createFullBoxCtor("kind",function(e){this.schemeURI=e.readCString(),this.value=e.readCString()}),o.createFullBoxCtor("leva",function(e){var s=e.readUint8();this.levels=[];for(var l=0;l<s;l++){var f={};this.levels[l]=f,f.track_ID=e.readUint32();var d=e.readUint8();switch(f.padding_flag=d>>7,f.assignment_type=d&127,f.assignment_type){case 0:f.grouping_type=e.readString(4);break;case 1:f.grouping_type=e.readString(4),f.grouping_type_parameter=e.readUint32();break;case 2:break;case 3:break;case 4:f.sub_track_id=e.readUint32();break;default:a.warn("BoxParser","Unknown leva assignement type")}}}),o.createBoxCtor("lsel",function(e){this.layer_id=e.readUint16()}),o.createBoxCtor("maxr",function(e){this.period=e.readUint32(),this.bytes=e.readUint32()}),o.createBoxCtor("mdcv",function(e){this.display_primaries=[],this.display_primaries[0]={},this.display_primaries[0].x=e.readUint16(),this.display_primaries[0].y=e.readUint16(),this.display_primaries[1]={},this.display_primaries[1].x=e.readUint16(),this.display_primaries[1].y=e.readUint16(),this.display_primaries[2]={},this.display_primaries[2].x=e.readUint16(),this.display_primaries[2].y=e.readUint16(),this.white_point={},this.white_point.x=e.readUint16(),this.white_point.y=e.readUint16(),this.max_display_mastering_luminance=e.readUint32(),this.min_display_mastering_luminance=e.readUint32()}),o.createFullBoxCtor("mdhd",function(e){this.version==1?(this.creation_time=e.readUint64(),this.modification_time=e.readUint64(),this.timescale=e.readUint32(),this.duration=e.readUint64()):(this.creation_time=e.readUint32(),this.modification_time=e.readUint32(),this.timescale=e.readUint32(),this.duration=e.readUint32()),this.parseLanguage(e),e.readUint16()}),o.createFullBoxCtor("mehd",function(e){this.flags&1&&(a.warn("BoxParser","mehd box incorrectly uses flags set to 1, converting version to 1"),this.version=1),this.version==1?this.fragment_duration=e.readUint64():this.fragment_duration=e.readUint32()}),o.createFullBoxCtor("meta",function(e){this.boxes=[],o.ContainerBox.prototype.parse.call(this,e)}),o.createFullBoxCtor("mfhd",function(e){this.sequence_number=e.readUint32()}),o.createFullBoxCtor("mfro",function(e){this._size=e.readUint32()}),o.createFullBoxCtor("mvhd",function(e){this.version==1?(this.creation_time=e.readUint64(),this.modification_time=e.readUint64(),this.timescale=e.readUint32(),this.duration=e.readUint64()):(this.creation_time=e.readUint32(),this.modification_time=e.readUint32(),this.timescale=e.readUint32(),this.duration=e.readUint32()),this.rate=e.readUint32(),this.volume=e.readUint16()>>8,e.readUint16(),e.readUint32Array(2),this.matrix=e.readUint32Array(9),e.readUint32Array(6),this.next_track_id=e.readUint32()}),o.createBoxCtor("npck",function(e){this.packetssent=e.readUint32()}),o.createBoxCtor("nump",function(e){this.packetssent=e.readUint64()}),o.createFullBoxCtor("padb",function(e){var s=e.readUint32();this.padbits=[];for(var l=0;l<Math.floor((s+1)/2);l++)this.padbits=e.readUint8()}),o.createBoxCtor("pasp",function(e){this.hSpacing=e.readUint32(),this.vSpacing=e.readUint32()}),o.createBoxCtor("payl",function(e){this.text=e.readString(this.size-this.hdr_size)}),o.createBoxCtor("payt",function(e){this.payloadID=e.readUint32();var s=e.readUint8();this.rtpmap_string=e.readString(s)}),o.createFullBoxCtor("pdin",function(e){var s=(this.size-this.hdr_size)/8;this.rate=[],this.initial_delay=[];for(var l=0;l<s;l++)this.rate[l]=e.readUint32(),this.initial_delay[l]=e.readUint32()}),o.createFullBoxCtor("pitm",function(e){this.version===0?this.item_id=e.readUint16():this.item_id=e.readUint32()}),o.createFullBoxCtor("pixi",function(e){var s;for(this.num_channels=e.readUint8(),this.bits_per_channels=[],s=0;s<this.num_channels;s++)this.bits_per_channels[s]=e.readUint8()}),o.createBoxCtor("pmax",function(e){this.bytes=e.readUint32()}),o.createFullBoxCtor("prft",function(e){this.ref_track_id=e.readUint32(),this.ntp_timestamp=e.readUint64(),this.version===0?this.media_time=e.readUint32():this.media_time=e.readUint64()}),o.createFullBoxCtor("pssh",function(e){if(this.system_id=o.parseHex16(e),this.version>0){var s=e.readUint32();this.kid=[];for(var l=0;l<s;l++)this.kid[l]=o.parseHex16(e)}var f=e.readUint32();f>0&&(this.data=e.readUint8Array(f))}),o.createFullBoxCtor("clef",function(e){this.width=e.readUint32(),this.height=e.readUint32()}),o.createFullBoxCtor("enof",function(e){this.width=e.readUint32(),this.height=e.readUint32()}),o.createFullBoxCtor("prof",function(e){this.width=e.readUint32(),this.height=e.readUint32()}),o.createContainerBoxCtor("tapt",null,["clef","prof","enof"]),o.createBoxCtor("rtp ",function(e){this.descriptionformat=e.readString(4),this.sdptext=e.readString(this.size-this.hdr_size-4)}),o.createFullBoxCtor("saio",function(e){this.flags&1&&(this.aux_info_type=e.readUint32(),this.aux_info_type_parameter=e.readUint32());var s=e.readUint32();this.offset=[];for(var l=0;l<s;l++)this.version===0?this.offset[l]=e.readUint32():this.offset[l]=e.readUint64()}),o.createFullBoxCtor("saiz",function(e){this.flags&1&&(this.aux_info_type=e.readUint32(),this.aux_info_type_parameter=e.readUint32()),this.default_sample_info_size=e.readUint8();var s=e.readUint32();if(this.sample_info_size=[],this.default_sample_info_size===0)for(var l=0;l<s;l++)this.sample_info_size[l]=e.readUint8()}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_METADATA,"mett",function(e){this.parseHeader(e),this.content_encoding=e.readCString(),this.mime_format=e.readCString(),this.parseFooter(e)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_METADATA,"metx",function(e){this.parseHeader(e),this.content_encoding=e.readCString(),this.namespace=e.readCString(),this.schema_location=e.readCString(),this.parseFooter(e)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE,"sbtt",function(e){this.parseHeader(e),this.content_encoding=e.readCString(),this.mime_format=e.readCString(),this.parseFooter(e)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE,"stpp",function(e){this.parseHeader(e),this.namespace=e.readCString(),this.schema_location=e.readCString(),this.auxiliary_mime_types=e.readCString(),this.parseFooter(e)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE,"stxt",function(e){this.parseHeader(e),this.content_encoding=e.readCString(),this.mime_format=e.readCString(),this.parseFooter(e)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE,"tx3g",function(e){this.parseHeader(e),this.displayFlags=e.readUint32(),this.horizontal_justification=e.readInt8(),this.vertical_justification=e.readInt8(),this.bg_color_rgba=e.readUint8Array(4),this.box_record=e.readInt16Array(4),this.style_record=e.readUint8Array(12),this.parseFooter(e)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_METADATA,"wvtt",function(e){this.parseHeader(e),this.parseFooter(e)}),o.createSampleGroupCtor("alst",function(e){var s,l=e.readUint16();for(this.first_output_sample=e.readUint16(),this.sample_offset=[],s=0;s<l;s++)this.sample_offset[s]=e.readUint32();var f=this.description_length-4-4*l;for(this.num_output_samples=[],this.num_total_samples=[],s=0;s<f/4;s++)this.num_output_samples[s]=e.readUint16(),this.num_total_samples[s]=e.readUint16()}),o.createSampleGroupCtor("avll",function(e){this.layerNumber=e.readUint8(),this.accurateStatisticsFlag=e.readUint8(),this.avgBitRate=e.readUint16(),this.avgFrameRate=e.readUint16()}),o.createSampleGroupCtor("avss",function(e){this.subSequenceIdentifier=e.readUint16(),this.layerNumber=e.readUint8();var s=e.readUint8();this.durationFlag=s>>7,this.avgRateFlag=s>>6&1,this.durationFlag&&(this.duration=e.readUint32()),this.avgRateFlag&&(this.accurateStatisticsFlag=e.readUint8(),this.avgBitRate=e.readUint16(),this.avgFrameRate=e.readUint16()),this.dependency=[];for(var l=e.readUint8(),f=0;f<l;f++){var d={};this.dependency.push(d),d.subSeqDirectionFlag=e.readUint8(),d.layerNumber=e.readUint8(),d.subSequenceIdentifier=e.readUint16()}}),o.createSampleGroupCtor("dtrt",function(e){a.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("mvif",function(e){a.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("prol",function(e){this.roll_distance=e.readInt16()}),o.createSampleGroupCtor("rap ",function(e){var s=e.readUint8();this.num_leading_samples_known=s>>7,this.num_leading_samples=s&127}),o.createSampleGroupCtor("rash",function(e){if(this.operation_point_count=e.readUint16(),this.description_length!==2+(this.operation_point_count===1?2:this.operation_point_count*6)+9)a.warn("BoxParser","Mismatch in "+this.grouping_type+" sample group length"),this.data=e.readUint8Array(this.description_length-2);else{if(this.operation_point_count===1)this.target_rate_share=e.readUint16();else{this.target_rate_share=[],this.available_bitrate=[];for(var s=0;s<this.operation_point_count;s++)this.available_bitrate[s]=e.readUint32(),this.target_rate_share[s]=e.readUint16()}this.maximum_bitrate=e.readUint32(),this.minimum_bitrate=e.readUint32(),this.discard_priority=e.readUint8()}}),o.createSampleGroupCtor("roll",function(e){this.roll_distance=e.readInt16()}),o.SampleGroupEntry.prototype.parse=function(e){a.warn("BoxParser","Unknown Sample Group type: "+this.grouping_type),this.data=e.readUint8Array(this.description_length)},o.createSampleGroupCtor("scif",function(e){a.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("scnm",function(e){a.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("seig",function(e){this.reserved=e.readUint8();var s=e.readUint8();this.crypt_byte_block=s>>4,this.skip_byte_block=s&15,this.isProtected=e.readUint8(),this.Per_Sample_IV_Size=e.readUint8(),this.KID=o.parseHex16(e),this.constant_IV_size=0,this.constant_IV=0,this.isProtected===1&&this.Per_Sample_IV_Size===0&&(this.constant_IV_size=e.readUint8(),this.constant_IV=e.readUint8Array(this.constant_IV_size))}),o.createSampleGroupCtor("stsa",function(e){a.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("sync",function(e){var s=e.readUint8();this.NAL_unit_type=s&63}),o.createSampleGroupCtor("tele",function(e){var s=e.readUint8();this.level_independently_decodable=s>>7}),o.createSampleGroupCtor("tsas",function(e){a.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("tscl",function(e){a.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("vipr",function(e){a.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createFullBoxCtor("sbgp",function(e){this.grouping_type=e.readString(4),this.version===1?this.grouping_type_parameter=e.readUint32():this.grouping_type_parameter=0,this.entries=[];for(var s=e.readUint32(),l=0;l<s;l++){var f={};this.entries.push(f),f.sample_count=e.readInt32(),f.group_description_index=e.readInt32()}}),o.createFullBoxCtor("schm",function(e){this.scheme_type=e.readString(4),this.scheme_version=e.readUint32(),this.flags&1&&(this.scheme_uri=e.readString(this.size-this.hdr_size-8))}),o.createBoxCtor("sdp ",function(e){this.sdptext=e.readString(this.size-this.hdr_size)}),o.createFullBoxCtor("sdtp",function(e){var s,l=this.size-this.hdr_size;this.is_leading=[],this.sample_depends_on=[],this.sample_is_depended_on=[],this.sample_has_redundancy=[];for(var f=0;f<l;f++)s=e.readUint8(),this.is_leading[f]=s>>6,this.sample_depends_on[f]=s>>4&3,this.sample_is_depended_on[f]=s>>2&3,this.sample_has_redundancy[f]=s&3}),o.createFullBoxCtor("senc"),o.createFullBoxCtor("sgpd",function(e){this.grouping_type=e.readString(4),a.debug("BoxParser","Found Sample Groups of type "+this.grouping_type),this.version===1?this.default_length=e.readUint32():this.default_length=0,this.version>=2&&(this.default_group_description_index=e.readUint32()),this.entries=[];for(var s=e.readUint32(),l=0;l<s;l++){var f;o[this.grouping_type+"SampleGroupEntry"]?f=new o[this.grouping_type+"SampleGroupEntry"](this.grouping_type):f=new o.SampleGroupEntry(this.grouping_type),this.entries.push(f),this.version===1?this.default_length===0?f.description_length=e.readUint32():f.description_length=this.default_length:f.description_length=this.default_length,f.write===o.SampleGroupEntry.prototype.write&&(a.info("BoxParser","SampleGroup for type "+this.grouping_type+" writing not yet implemented, keeping unparsed data in memory for later write"),f.data=e.readUint8Array(f.description_length),e.position-=f.description_length),f.parse(e)}}),o.createFullBoxCtor("sidx",function(e){this.reference_ID=e.readUint32(),this.timescale=e.readUint32(),this.version===0?(this.earliest_presentation_time=e.readUint32(),this.first_offset=e.readUint32()):(this.earliest_presentation_time=e.readUint64(),this.first_offset=e.readUint64()),e.readUint16(),this.references=[];for(var s=e.readUint16(),l=0;l<s;l++){var f={};this.references.push(f);var d=e.readUint32();f.reference_type=d>>31&1,f.referenced_size=d&2147483647,f.subsegment_duration=e.readUint32(),d=e.readUint32(),f.starts_with_SAP=d>>31&1,f.SAP_type=d>>28&7,f.SAP_delta_time=d&268435455}}),o.SingleItemTypeReferenceBox=function(e,s,l,f){o.Box.call(this,e,s),this.hdr_size=l,this.start=f},o.SingleItemTypeReferenceBox.prototype=new o.Box,o.SingleItemTypeReferenceBox.prototype.parse=function(e){this.from_item_ID=e.readUint16();var s=e.readUint16();this.references=[];for(var l=0;l<s;l++)this.references[l]=e.readUint16()},o.SingleItemTypeReferenceBoxLarge=function(e,s,l,f){o.Box.call(this,e,s),this.hdr_size=l,this.start=f},o.SingleItemTypeReferenceBoxLarge.prototype=new o.Box,o.SingleItemTypeReferenceBoxLarge.prototype.parse=function(e){this.from_item_ID=e.readUint32();var s=e.readUint16();this.references=[];for(var l=0;l<s;l++)this.references[l]=e.readUint32()},o.createFullBoxCtor("SmDm",function(e){this.primaryRChromaticity_x=e.readUint16(),this.primaryRChromaticity_y=e.readUint16(),this.primaryGChromaticity_x=e.readUint16(),this.primaryGChromaticity_y=e.readUint16(),this.primaryBChromaticity_x=e.readUint16(),this.primaryBChromaticity_y=e.readUint16(),this.whitePointChromaticity_x=e.readUint16(),this.whitePointChromaticity_y=e.readUint16(),this.luminanceMax=e.readUint32(),this.luminanceMin=e.readUint32()}),o.createFullBoxCtor("smhd",function(e){this.balance=e.readUint16(),e.readUint16()}),o.createFullBoxCtor("ssix",function(e){this.subsegments=[];for(var s=e.readUint32(),l=0;l<s;l++){var f={};this.subsegments.push(f),f.ranges=[];for(var d=e.readUint32(),y=0;y<d;y++){var m={};f.ranges.push(m),m.level=e.readUint8(),m.range_size=e.readUint24()}}}),o.createFullBoxCtor("stco",function(e){var s;if(s=e.readUint32(),this.chunk_offsets=[],this.version===0)for(var l=0;l<s;l++)this.chunk_offsets.push(e.readUint32())}),o.createFullBoxCtor("stdp",function(e){var s=(this.size-this.hdr_size)/2;this.priority=[];for(var l=0;l<s;l++)this.priority[l]=e.readUint16()}),o.createFullBoxCtor("sthd"),o.createFullBoxCtor("stri",function(e){this.switch_group=e.readUint16(),this.alternate_group=e.readUint16(),this.sub_track_id=e.readUint32();var s=(this.size-this.hdr_size-8)/4;this.attribute_list=[];for(var l=0;l<s;l++)this.attribute_list[l]=e.readUint32()}),o.createFullBoxCtor("stsc",function(e){var s,l;if(s=e.readUint32(),this.first_chunk=[],this.samples_per_chunk=[],this.sample_description_index=[],this.version===0)for(l=0;l<s;l++)this.first_chunk.push(e.readUint32()),this.samples_per_chunk.push(e.readUint32()),this.sample_description_index.push(e.readUint32())}),o.createFullBoxCtor("stsd",function(e){var s,l,f,d;for(this.entries=[],f=e.readUint32(),s=1;s<=f;s++)if(l=o.parseOneBox(e,!0,this.size-(e.getPosition()-this.start)),l.code===o.OK)o[l.type+"SampleEntry"]?(d=new o[l.type+"SampleEntry"](l.size),d.hdr_size=l.hdr_size,d.start=l.start):(a.warn("BoxParser","Unknown sample entry type: "+l.type),d=new o.SampleEntry(l.type,l.size,l.hdr_size,l.start)),d.write===o.SampleEntry.prototype.write&&(a.info("BoxParser","SampleEntry "+d.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),d.parseDataAndRewind(e)),d.parse(e),this.entries.push(d);else return}),o.createFullBoxCtor("stsg",function(e){this.grouping_type=e.readUint32();var s=e.readUint16();this.group_description_index=[];for(var l=0;l<s;l++)this.group_description_index[l]=e.readUint32()}),o.createFullBoxCtor("stsh",function(e){var s,l;if(s=e.readUint32(),this.shadowed_sample_numbers=[],this.sync_sample_numbers=[],this.version===0)for(l=0;l<s;l++)this.shadowed_sample_numbers.push(e.readUint32()),this.sync_sample_numbers.push(e.readUint32())}),o.createFullBoxCtor("stss",function(e){var s,l;if(l=e.readUint32(),this.version===0)for(this.sample_numbers=[],s=0;s<l;s++)this.sample_numbers.push(e.readUint32())}),o.createFullBoxCtor("stsz",function(e){var s;if(this.sample_sizes=[],this.version===0)for(this.sample_size=e.readUint32(),this.sample_count=e.readUint32(),s=0;s<this.sample_count;s++)this.sample_size===0?this.sample_sizes.push(e.readUint32()):this.sample_sizes[s]=this.sample_size}),o.createFullBoxCtor("stts",function(e){var s,l,f;if(s=e.readUint32(),this.sample_counts=[],this.sample_deltas=[],this.version===0)for(l=0;l<s;l++)this.sample_counts.push(e.readUint32()),f=e.readInt32(),f<0&&(a.warn("BoxParser","File uses negative stts sample delta, using value 1 instead, sync may be lost!"),f=1),this.sample_deltas.push(f)}),o.createFullBoxCtor("stvi",function(e){var s=e.readUint32();this.single_view_allowed=s&3,this.stereo_scheme=e.readUint32();var l=e.readUint32();this.stereo_indication_type=e.readString(l);var f,d;for(this.boxes=[];e.getPosition()<this.start+this.size;)if(f=o.parseOneBox(e,!1,this.size-(e.getPosition()-this.start)),f.code===o.OK)d=f.box,this.boxes.push(d),this[d.type]=d;else return}),o.createBoxCtor("styp",function(e){o.ftypBox.prototype.parse.call(this,e)}),o.createFullBoxCtor("stz2",function(e){var s,l;if(this.sample_sizes=[],this.version===0)if(this.reserved=e.readUint24(),this.field_size=e.readUint8(),l=e.readUint32(),this.field_size===4)for(s=0;s<l;s+=2){var f=e.readUint8();this.sample_sizes[s]=f>>4&15,this.sample_sizes[s+1]=f&15}else if(this.field_size===8)for(s=0;s<l;s++)this.sample_sizes[s]=e.readUint8();else if(this.field_size===16)for(s=0;s<l;s++)this.sample_sizes[s]=e.readUint16();else a.error("BoxParser","Error in length field in stz2 box")}),o.createFullBoxCtor("subs",function(e){var s,l,f,d;for(f=e.readUint32(),this.entries=[],s=0;s<f;s++){var y={};if(this.entries[s]=y,y.sample_delta=e.readUint32(),y.subsamples=[],d=e.readUint16(),d>0)for(l=0;l<d;l++){var m={};y.subsamples.push(m),this.version==1?m.size=e.readUint32():m.size=e.readUint16(),m.priority=e.readUint8(),m.discardable=e.readUint8(),m.codec_specific_parameters=e.readUint32()}}}),o.createFullBoxCtor("tenc",function(e){if(e.readUint8(),this.version===0)e.readUint8();else{var s=e.readUint8();this.default_crypt_byte_block=s>>4&15,this.default_skip_byte_block=s&15}this.default_isProtected=e.readUint8(),this.default_Per_Sample_IV_Size=e.readUint8(),this.default_KID=o.parseHex16(e),this.default_isProtected===1&&this.default_Per_Sample_IV_Size===0&&(this.default_constant_IV_size=e.readUint8(),this.default_constant_IV=e.readUint8Array(this.default_constant_IV_size))}),o.createFullBoxCtor("tfdt",function(e){this.version==1?this.baseMediaDecodeTime=e.readUint64():this.baseMediaDecodeTime=e.readUint32()}),o.createFullBoxCtor("tfhd",function(e){var s=0;this.track_id=e.readUint32(),this.size-this.hdr_size>s&&this.flags&o.TFHD_FLAG_BASE_DATA_OFFSET?(this.base_data_offset=e.readUint64(),s+=8):this.base_data_offset=0,this.size-this.hdr_size>s&&this.flags&o.TFHD_FLAG_SAMPLE_DESC?(this.default_sample_description_index=e.readUint32(),s+=4):this.default_sample_description_index=0,this.size-this.hdr_size>s&&this.flags&o.TFHD_FLAG_SAMPLE_DUR?(this.default_sample_duration=e.readUint32(),s+=4):this.default_sample_duration=0,this.size-this.hdr_size>s&&this.flags&o.TFHD_FLAG_SAMPLE_SIZE?(this.default_sample_size=e.readUint32(),s+=4):this.default_sample_size=0,this.size-this.hdr_size>s&&this.flags&o.TFHD_FLAG_SAMPLE_FLAGS?(this.default_sample_flags=e.readUint32(),s+=4):this.default_sample_flags=0}),o.createFullBoxCtor("tfra",function(e){this.track_ID=e.readUint32(),e.readUint24();var s=e.readUint8();this.length_size_of_traf_num=s>>4&3,this.length_size_of_trun_num=s>>2&3,this.length_size_of_sample_num=s&3,this.entries=[];for(var l=e.readUint32(),f=0;f<l;f++)this.version===1?(this.time=e.readUint64(),this.moof_offset=e.readUint64()):(this.time=e.readUint32(),this.moof_offset=e.readUint32()),this.traf_number=e["readUint"+8*(this.length_size_of_traf_num+1)](),this.trun_number=e["readUint"+8*(this.length_size_of_trun_num+1)](),this.sample_number=e["readUint"+8*(this.length_size_of_sample_num+1)]()}),o.createFullBoxCtor("tkhd",function(e){this.version==1?(this.creation_time=e.readUint64(),this.modification_time=e.readUint64(),this.track_id=e.readUint32(),e.readUint32(),this.duration=e.readUint64()):(this.creation_time=e.readUint32(),this.modification_time=e.readUint32(),this.track_id=e.readUint32(),e.readUint32(),this.duration=e.readUint32()),e.readUint32Array(2),this.layer=e.readInt16(),this.alternate_group=e.readInt16(),this.volume=e.readInt16()>>8,e.readUint16(),this.matrix=e.readInt32Array(9),this.width=e.readUint32(),this.height=e.readUint32()}),o.createBoxCtor("tmax",function(e){this.time=e.readUint32()}),o.createBoxCtor("tmin",function(e){this.time=e.readUint32()}),o.createBoxCtor("totl",function(e){this.bytessent=e.readUint32()}),o.createBoxCtor("tpay",function(e){this.bytessent=e.readUint32()}),o.createBoxCtor("tpyl",function(e){this.bytessent=e.readUint64()}),o.TrackGroupTypeBox.prototype.parse=function(e){this.parseFullHeader(e),this.track_group_id=e.readUint32()},o.createTrackGroupCtor("msrc"),o.TrackReferenceTypeBox=function(e,s,l,f){o.Box.call(this,e,s),this.hdr_size=l,this.start=f},o.TrackReferenceTypeBox.prototype=new o.Box,o.TrackReferenceTypeBox.prototype.parse=function(e){this.track_ids=e.readUint32Array((this.size-this.hdr_size)/4)},o.trefBox.prototype.parse=function(e){for(var s,l;e.getPosition()<this.start+this.size;)if(s=o.parseOneBox(e,!0,this.size-(e.getPosition()-this.start)),s.code===o.OK)l=new o.TrackReferenceTypeBox(s.type,s.size,s.hdr_size,s.start),l.write===o.Box.prototype.write&&l.type!=="mdat"&&(a.info("BoxParser","TrackReference "+l.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),l.parseDataAndRewind(e)),l.parse(e),this.boxes.push(l);else return},o.createFullBoxCtor("trep",function(e){for(this.track_ID=e.readUint32(),this.boxes=[];e.getPosition()<this.start+this.size;)if(ret=o.parseOneBox(e,!1,this.size-(e.getPosition()-this.start)),ret.code===o.OK)box=ret.box,this.boxes.push(box);else return}),o.createFullBoxCtor("trex",function(e){this.track_id=e.readUint32(),this.default_sample_description_index=e.readUint32(),this.default_sample_duration=e.readUint32(),this.default_sample_size=e.readUint32(),this.default_sample_flags=e.readUint32()}),o.createBoxCtor("trpy",function(e){this.bytessent=e.readUint64()}),o.createFullBoxCtor("trun",function(e){var s=0;if(this.sample_count=e.readUint32(),s+=4,this.size-this.hdr_size>s&&this.flags&o.TRUN_FLAGS_DATA_OFFSET?(this.data_offset=e.readInt32(),s+=4):this.data_offset=0,this.size-this.hdr_size>s&&this.flags&o.TRUN_FLAGS_FIRST_FLAG?(this.first_sample_flags=e.readUint32(),s+=4):this.first_sample_flags=0,this.sample_duration=[],this.sample_size=[],this.sample_flags=[],this.sample_composition_time_offset=[],this.size-this.hdr_size>s)for(var l=0;l<this.sample_count;l++)this.flags&o.TRUN_FLAGS_DURATION&&(this.sample_duration[l]=e.readUint32()),this.flags&o.TRUN_FLAGS_SIZE&&(this.sample_size[l]=e.readUint32()),this.flags&o.TRUN_FLAGS_FLAGS&&(this.sample_flags[l]=e.readUint32()),this.flags&o.TRUN_FLAGS_CTS_OFFSET&&(this.version===0?this.sample_composition_time_offset[l]=e.readUint32():this.sample_composition_time_offset[l]=e.readInt32())}),o.createFullBoxCtor("tsel",function(e){this.switch_group=e.readUint32();var s=(this.size-this.hdr_size-4)/4;this.attribute_list=[];for(var l=0;l<s;l++)this.attribute_list[l]=e.readUint32()}),o.createFullBoxCtor("txtC",function(e){this.config=e.readCString()}),o.createFullBoxCtor("url ",function(e){this.flags!==1&&(this.location=e.readCString())}),o.createFullBoxCtor("urn ",function(e){this.name=e.readCString(),this.size-this.hdr_size-this.name.length-1>0&&(this.location=e.readCString())}),o.createUUIDBox("a5d40b30e81411ddba2f0800200c9a66",!0,!1,function(e){this.LiveServerManifest=e.readString(this.size-this.hdr_size).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}),o.createUUIDBox("d08a4f1810f34a82b6c832d8aba183d3",!0,!1,function(e){this.system_id=o.parseHex16(e);var s=e.readUint32();s>0&&(this.data=e.readUint8Array(s))}),o.createUUIDBox("a2394f525a9b4f14a2446c427c648df4",!0,!1),o.createUUIDBox("8974dbce7be74c5184f97148f9882554",!0,!1,function(e){this.default_AlgorithmID=e.readUint24(),this.default_IV_size=e.readUint8(),this.default_KID=o.parseHex16(e)}),o.createUUIDBox("d4807ef2ca3946958e5426cb9e46a79f",!0,!1,function(e){this.fragment_count=e.readUint8(),this.entries=[];for(var s=0;s<this.fragment_count;s++){var l={},f=0,d=0;this.version===1?(f=e.readUint64(),d=e.readUint64()):(f=e.readUint32(),d=e.readUint32()),l.absolute_time=f,l.absolute_duration=d,this.entries.push(l)}}),o.createUUIDBox("6d1d9b0542d544e680e2141daff757b2",!0,!1,function(e){this.version===1?(this.absolute_time=e.readUint64(),this.duration=e.readUint64()):(this.absolute_time=e.readUint32(),this.duration=e.readUint32())}),o.createFullBoxCtor("vmhd",function(e){this.graphicsmode=e.readUint16(),this.opcolor=e.readUint16Array(3)}),o.createFullBoxCtor("vpcC",function(e){var s;this.version===1?(this.profile=e.readUint8(),this.level=e.readUint8(),s=e.readUint8(),this.bitDepth=s>>4,this.chromaSubsampling=s>>1&7,this.videoFullRangeFlag=s&1,this.colourPrimaries=e.readUint8(),this.transferCharacteristics=e.readUint8(),this.matrixCoefficients=e.readUint8(),this.codecIntializationDataSize=e.readUint16(),this.codecIntializationData=e.readUint8Array(this.codecIntializationDataSize)):(this.profile=e.readUint8(),this.level=e.readUint8(),s=e.readUint8(),this.bitDepth=s>>4&15,this.colorSpace=s&15,s=e.readUint8(),this.chromaSubsampling=s>>4&15,this.transferFunction=s>>1&7,this.videoFullRangeFlag=s&1,this.codecIntializationDataSize=e.readUint16(),this.codecIntializationData=e.readUint8Array(this.codecIntializationDataSize))}),o.createBoxCtor("vttC",function(e){this.text=e.readString(this.size-this.hdr_size)}),o.createFullBoxCtor("vvcC",function(e){var s,l,f={held_bits:void 0,num_held_bits:0,stream_read_1_bytes:function(P){this.held_bits=P.readUint8(),this.num_held_bits=1*8},stream_read_2_bytes:function(P){this.held_bits=P.readUint16(),this.num_held_bits=2*8},extract_bits:function(P){var U=this.held_bits>>this.num_held_bits-P&(1<<P)-1;return this.num_held_bits-=P,U}};if(f.stream_read_1_bytes(e),f.extract_bits(5),this.lengthSizeMinusOne=f.extract_bits(2),this.ptl_present_flag=f.extract_bits(1),this.ptl_present_flag){f.stream_read_2_bytes(e),this.ols_idx=f.extract_bits(9),this.num_sublayers=f.extract_bits(3),this.constant_frame_rate=f.extract_bits(2),this.chroma_format_idc=f.extract_bits(2),f.stream_read_1_bytes(e),this.bit_depth_minus8=f.extract_bits(3),f.extract_bits(5);{if(f.stream_read_2_bytes(e),f.extract_bits(2),this.num_bytes_constraint_info=f.extract_bits(6),this.general_profile_idc=f.extract_bits(7),this.general_tier_flag=f.extract_bits(1),this.general_level_idc=e.readUint8(),f.stream_read_1_bytes(e),this.ptl_frame_only_constraint_flag=f.extract_bits(1),this.ptl_multilayer_enabled_flag=f.extract_bits(1),this.general_constraint_info=new Uint8Array(this.num_bytes_constraint_info),this.num_bytes_constraint_info){for(s=0;s<this.num_bytes_constraint_info-1;s++){var d=f.extract_bits(6);f.stream_read_1_bytes(e);var y=f.extract_bits(2);this.general_constraint_info[s]=d<<2|y}this.general_constraint_info[this.num_bytes_constraint_info-1]=f.extract_bits(6)}else f.extract_bits(6);for(f.stream_read_1_bytes(e),this.ptl_sublayer_present_mask=0,l=this.num_sublayers-2;l>=0;--l){var m=f.extract_bits(1);this.ptl_sublayer_present_mask|=m<<l}for(l=this.num_sublayers;l<=8&&this.num_sublayers>1;++l)f.extract_bits(1);for(l=this.num_sublayers-2;l>=0;--l)this.ptl_sublayer_present_mask&1<<l&&(this.sublayer_level_idc[l]=e.readUint8());if(this.ptl_num_sub_profiles=e.readUint8(),this.general_sub_profile_idc=[],this.ptl_num_sub_profiles)for(s=0;s<this.ptl_num_sub_profiles;s++)this.general_sub_profile_idc.push(e.readUint32())}this.max_picture_width=e.readUint16(),this.max_picture_height=e.readUint16(),this.avg_frame_rate=e.readUint16()}var _=12,E=13;this.nalu_arrays=[];var w=e.readUint8();for(s=0;s<w;s++){var k=[];this.nalu_arrays.push(k),f.stream_read_1_bytes(e),k.completeness=f.extract_bits(1),f.extract_bits(2),k.nalu_type=f.extract_bits(5);var x=1;for(k.nalu_type!=E&&k.nalu_type!=_&&(x=e.readUint16()),l=0;l<x;l++){var S=e.readUint16();k.push({data:e.readUint8Array(S),length:S})}}}),o.createFullBoxCtor("vvnC",function(e){var s=strm.readUint8();this.lengthSizeMinusOne=s&3}),o.SampleEntry.prototype.isVideo=function(){return!1},o.SampleEntry.prototype.isAudio=function(){return!1},o.SampleEntry.prototype.isSubtitle=function(){return!1},o.SampleEntry.prototype.isMetadata=function(){return!1},o.SampleEntry.prototype.isHint=function(){return!1},o.SampleEntry.prototype.getCodec=function(){return this.type.replace(".","")},o.SampleEntry.prototype.getWidth=function(){return""},o.SampleEntry.prototype.getHeight=function(){return""},o.SampleEntry.prototype.getChannelCount=function(){return""},o.SampleEntry.prototype.getSampleRate=function(){return""},o.SampleEntry.prototype.getSampleSize=function(){return""},o.VisualSampleEntry.prototype.isVideo=function(){return!0},o.VisualSampleEntry.prototype.getWidth=function(){return this.width},o.VisualSampleEntry.prototype.getHeight=function(){return this.height},o.AudioSampleEntry.prototype.isAudio=function(){return!0},o.AudioSampleEntry.prototype.getChannelCount=function(){return this.channel_count},o.AudioSampleEntry.prototype.getSampleRate=function(){return this.samplerate},o.AudioSampleEntry.prototype.getSampleSize=function(){return this.samplesize},o.SubtitleSampleEntry.prototype.isSubtitle=function(){return!0},o.MetadataSampleEntry.prototype.isMetadata=function(){return!0},o.decimalToHex=function(e,s){var l=Number(e).toString(16);for(s=typeof s=="undefined"||s===null?s=2:s;l.length<s;)l="0"+l;return l},o.avc1SampleEntry.prototype.getCodec=o.avc2SampleEntry.prototype.getCodec=o.avc3SampleEntry.prototype.getCodec=o.avc4SampleEntry.prototype.getCodec=function(){var e=o.SampleEntry.prototype.getCodec.call(this);return this.avcC?e+"."+o.decimalToHex(this.avcC.AVCProfileIndication)+""+o.decimalToHex(this.avcC.profile_compatibility)+""+o.decimalToHex(this.avcC.AVCLevelIndication):e},o.hev1SampleEntry.prototype.getCodec=o.hvc1SampleEntry.prototype.getCodec=function(){var e,s=o.SampleEntry.prototype.getCodec.call(this);if(this.hvcC){switch(s+=".",this.hvcC.general_profile_space){case 0:s+="";break;case 1:s+="A";break;case 2:s+="B";break;case 3:s+="C";break}s+=this.hvcC.general_profile_idc,s+=".";var l=this.hvcC.general_profile_compatibility,f=0;for(e=0;e<32&&(f|=l&1,e!=31);e++)f<<=1,l>>=1;s+=o.decimalToHex(f,0),s+=".",this.hvcC.general_tier_flag===0?s+="L":s+="H",s+=this.hvcC.general_level_idc;var d=!1,y="";for(e=5;e>=0;e--)(this.hvcC.general_constraint_indicator[e]||d)&&(y="."+o.decimalToHex(this.hvcC.general_constraint_indicator[e],0)+y,d=!0);s+=y}return s},o.vvc1SampleEntry.prototype.getCodec=o.vvi1SampleEntry.prototype.getCodec=function(){var e,s=o.SampleEntry.prototype.getCodec.call(this);if(this.vvcC){s+="."+this.vvcC.general_profile_idc,this.vvcC.general_tier_flag?s+=".H":s+=".L",s+=this.vvcC.general_level_idc;var l="";if(this.vvcC.general_constraint_info){var f=[],d=0;d|=this.vvcC.ptl_frame_only_constraint<<7,d|=this.vvcC.ptl_multilayer_enabled<<6;var y;for(e=0;e<this.vvcC.general_constraint_info.length;++e)d|=this.vvcC.general_constraint_info[e]>>2&63,f.push(d),d&&(y=e),d=this.vvcC.general_constraint_info[e]>>2&3;if(y===void 0)l=".CA";else{l=".C";var m="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",_=0,E=0;for(e=0;e<=y;++e)for(_=_<<8|f[e],E+=8;E>=5;){var w=_>>E-5&31;l+=m[w],E-=5,_&=(1<<E)-1}E&&(_<<=5-E,l+=m[_&31])}}s+=l}return s},o.mp4aSampleEntry.prototype.getCodec=function(){var e=o.SampleEntry.prototype.getCodec.call(this);if(this.esds&&this.esds.esd){var s=this.esds.esd.getOTI(),l=this.esds.esd.getAudioConfig();return e+"."+o.decimalToHex(s)+(l?"."+l:"")}else return e},o.stxtSampleEntry.prototype.getCodec=function(){var e=o.SampleEntry.prototype.getCodec.call(this);return this.mime_format?e+"."+this.mime_format:e},o.vp08SampleEntry.prototype.getCodec=o.vp09SampleEntry.prototype.getCodec=function(){var e=o.SampleEntry.prototype.getCodec.call(this),s=this.vpcC.level;s==0&&(s="00");var l=this.vpcC.bitDepth;return l==8&&(l="08"),e+".0"+this.vpcC.profile+"."+s+"."+l},o.av01SampleEntry.prototype.getCodec=function(){var e=o.SampleEntry.prototype.getCodec.call(this),s=this.av1C.seq_level_idx_0;s<10&&(s="0"+s);var l;return this.av1C.seq_profile===2&&this.av1C.high_bitdepth===1?l=this.av1C.twelve_bit===1?"12":"10":this.av1C.seq_profile<=2&&(l=this.av1C.high_bitdepth===1?"10":"08"),e+"."+this.av1C.seq_profile+"."+s+(this.av1C.seq_tier_0?"H":"M")+"."+l},o.Box.prototype.writeHeader=function(e,s){this.size+=8,this.size>r&&(this.size+=8),this.type==="uuid"&&(this.size+=16),a.debug("BoxWriter","Writing box "+this.type+" of size: "+this.size+" at position "+e.getPosition()+(s||"")),this.size>r?e.writeUint32(1):(this.sizePosition=e.getPosition(),e.writeUint32(this.size)),e.writeString(this.type,null,4),this.type==="uuid"&&e.writeUint8Array(this.uuid),this.size>r&&e.writeUint64(this.size)},o.FullBox.prototype.writeHeader=function(e){this.size+=4,o.Box.prototype.writeHeader.call(this,e," v="+this.version+" f="+this.flags),e.writeUint8(this.version),e.writeUint24(this.flags)},o.Box.prototype.write=function(e){this.type==="mdat"?this.data&&(this.size=this.data.length,this.writeHeader(e),e.writeUint8Array(this.data)):(this.size=this.data?this.data.length:0,this.writeHeader(e),this.data&&e.writeUint8Array(this.data))},o.ContainerBox.prototype.write=function(e){this.size=0,this.writeHeader(e);for(var s=0;s<this.boxes.length;s++)this.boxes[s]&&(this.boxes[s].write(e),this.size+=this.boxes[s].size);a.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),e.adjustUint32(this.sizePosition,this.size)},o.TrackReferenceTypeBox.prototype.write=function(e){this.size=this.track_ids.length*4,this.writeHeader(e),e.writeUint32Array(this.track_ids)},o.avcCBox.prototype.write=function(e){var s;for(this.size=7,s=0;s<this.SPS.length;s++)this.size+=2+this.SPS[s].length;for(s=0;s<this.PPS.length;s++)this.size+=2+this.PPS[s].length;for(this.ext&&(this.size+=this.ext.length),this.writeHeader(e),e.writeUint8(this.configurationVersion),e.writeUint8(this.AVCProfileIndication),e.writeUint8(this.profile_compatibility),e.writeUint8(this.AVCLevelIndication),e.writeUint8(this.lengthSizeMinusOne+(63<<2)),e.writeUint8(this.SPS.length+(7<<5)),s=0;s<this.SPS.length;s++)e.writeUint16(this.SPS[s].length),e.writeUint8Array(this.SPS[s].nalu);for(e.writeUint8(this.PPS.length),s=0;s<this.PPS.length;s++)e.writeUint16(this.PPS[s].length),e.writeUint8Array(this.PPS[s].nalu);this.ext&&e.writeUint8Array(this.ext)},o.co64Box.prototype.write=function(e){var s;for(this.version=0,this.flags=0,this.size=4+8*this.chunk_offsets.length,this.writeHeader(e),e.writeUint32(this.chunk_offsets.length),s=0;s<this.chunk_offsets.length;s++)e.writeUint64(this.chunk_offsets[s])},o.cslgBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4*5,this.writeHeader(e),e.writeInt32(this.compositionToDTSShift),e.writeInt32(this.leastDecodeToDisplayDelta),e.writeInt32(this.greatestDecodeToDisplayDelta),e.writeInt32(this.compositionStartTime),e.writeInt32(this.compositionEndTime)},o.cttsBox.prototype.write=function(e){var s;for(this.version=0,this.flags=0,this.size=4+8*this.sample_counts.length,this.writeHeader(e),e.writeUint32(this.sample_counts.length),s=0;s<this.sample_counts.length;s++)e.writeUint32(this.sample_counts[s]),this.version===1?e.writeInt32(this.sample_offsets[s]):e.writeUint32(this.sample_offsets[s])},o.drefBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4,this.writeHeader(e),e.writeUint32(this.entries.length);for(var s=0;s<this.entries.length;s++)this.entries[s].write(e),this.size+=this.entries[s].size;a.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),e.adjustUint32(this.sizePosition,this.size)},o.elngBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=this.extended_language.length,this.writeHeader(e),e.writeString(this.extended_language)},o.elstBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4+12*this.entries.length,this.writeHeader(e),e.writeUint32(this.entries.length);for(var s=0;s<this.entries.length;s++){var l=this.entries[s];e.writeUint32(l.segment_duration),e.writeInt32(l.media_time),e.writeInt16(l.media_rate_integer),e.writeInt16(l.media_rate_fraction)}},o.emsgBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4*4+this.message_data.length+(this.scheme_id_uri.length+1)+(this.value.length+1),this.writeHeader(e),e.writeCString(this.scheme_id_uri),e.writeCString(this.value),e.writeUint32(this.timescale),e.writeUint32(this.presentation_time_delta),e.writeUint32(this.event_duration),e.writeUint32(this.id),e.writeUint8Array(this.message_data)},o.ftypBox.prototype.write=function(e){this.size=8+4*this.compatible_brands.length,this.writeHeader(e),e.writeString(this.major_brand,null,4),e.writeUint32(this.minor_version);for(var s=0;s<this.compatible_brands.length;s++)e.writeString(this.compatible_brands[s],null,4)},o.hdlrBox.prototype.write=function(e){this.size=5*4+this.name.length+1,this.version=0,this.flags=0,this.writeHeader(e),e.writeUint32(0),e.writeString(this.handler,null,4),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeCString(this.name)},o.kindBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=this.schemeURI.length+1+(this.value.length+1),this.writeHeader(e),e.writeCString(this.schemeURI),e.writeCString(this.value)},o.mdhdBox.prototype.write=function(e){this.size=4*4+2*2,this.flags=0,this.version=0,this.writeHeader(e),e.writeUint32(this.creation_time),e.writeUint32(this.modification_time),e.writeUint32(this.timescale),e.writeUint32(this.duration),e.writeUint16(this.language),e.writeUint16(0)},o.mehdBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4,this.writeHeader(e),e.writeUint32(this.fragment_duration)},o.mfhdBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4,this.writeHeader(e),e.writeUint32(this.sequence_number)},o.mvhdBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=23*4+2*2,this.writeHeader(e),e.writeUint32(this.creation_time),e.writeUint32(this.modification_time),e.writeUint32(this.timescale),e.writeUint32(this.duration),e.writeUint32(this.rate),e.writeUint16(this.volume<<8),e.writeUint16(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32Array(this.matrix),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(this.next_track_id)},o.SampleEntry.prototype.writeHeader=function(e){this.size=8,o.Box.prototype.writeHeader.call(this,e),e.writeUint8(0),e.writeUint8(0),e.writeUint8(0),e.writeUint8(0),e.writeUint8(0),e.writeUint8(0),e.writeUint16(this.data_reference_index)},o.SampleEntry.prototype.writeFooter=function(e){for(var s=0;s<this.boxes.length;s++)this.boxes[s].write(e),this.size+=this.boxes[s].size;a.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),e.adjustUint32(this.sizePosition,this.size)},o.SampleEntry.prototype.write=function(e){this.writeHeader(e),e.writeUint8Array(this.data),this.size+=this.data.length,a.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),e.adjustUint32(this.sizePosition,this.size)},o.VisualSampleEntry.prototype.write=function(e){this.writeHeader(e),this.size+=2*7+6*4+32,e.writeUint16(0),e.writeUint16(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint16(this.width),e.writeUint16(this.height),e.writeUint32(this.horizresolution),e.writeUint32(this.vertresolution),e.writeUint32(0),e.writeUint16(this.frame_count),e.writeUint8(Math.min(31,this.compressorname.length)),e.writeString(this.compressorname,null,31),e.writeUint16(this.depth),e.writeInt16(-1),this.writeFooter(e)},o.AudioSampleEntry.prototype.write=function(e){this.writeHeader(e),this.size+=2*4+3*4,e.writeUint32(0),e.writeUint32(0),e.writeUint16(this.channel_count),e.writeUint16(this.samplesize),e.writeUint16(0),e.writeUint16(0),e.writeUint32(this.samplerate<<16),this.writeFooter(e)},o.stppSampleEntry.prototype.write=function(e){this.writeHeader(e),this.size+=this.namespace.length+1+this.schema_location.length+1+this.auxiliary_mime_types.length+1,e.writeCString(this.namespace),e.writeCString(this.schema_location),e.writeCString(this.auxiliary_mime_types),this.writeFooter(e)},o.SampleGroupEntry.prototype.write=function(e){e.writeUint8Array(this.data)},o.sbgpBox.prototype.write=function(e){this.version=1,this.flags=0,this.size=12+8*this.entries.length,this.writeHeader(e),e.writeString(this.grouping_type,null,4),e.writeUint32(this.grouping_type_parameter),e.writeUint32(this.entries.length);for(var s=0;s<this.entries.length;s++){var l=this.entries[s];e.writeInt32(l.sample_count),e.writeInt32(l.group_description_index)}},o.sgpdBox.prototype.write=function(e){var s,l;for(this.flags=0,this.size=12,s=0;s<this.entries.length;s++)l=this.entries[s],this.version===1&&(this.default_length===0&&(this.size+=4),this.size+=l.data.length);for(this.writeHeader(e),e.writeString(this.grouping_type,null,4),this.version===1&&e.writeUint32(this.default_length),this.version>=2&&e.writeUint32(this.default_sample_description_index),e.writeUint32(this.entries.length),s=0;s<this.entries.length;s++)l=this.entries[s],this.version===1&&this.default_length===0&&e.writeUint32(l.description_length),l.write(e)},o.sidxBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4*4+2+2+12*this.references.length,this.writeHeader(e),e.writeUint32(this.reference_ID),e.writeUint32(this.timescale),e.writeUint32(this.earliest_presentation_time),e.writeUint32(this.first_offset),e.writeUint16(0),e.writeUint16(this.references.length);for(var s=0;s<this.references.length;s++){var l=this.references[s];e.writeUint32(l.reference_type<<31|l.referenced_size),e.writeUint32(l.subsegment_duration),e.writeUint32(l.starts_with_SAP<<31|l.SAP_type<<28|l.SAP_delta_time)}},o.smhdBox.prototype.write=function(e){this.version=0,this.flags=1,this.size=4,this.writeHeader(e),e.writeUint16(this.balance),e.writeUint16(0)},o.stcoBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4+4*this.chunk_offsets.length,this.writeHeader(e),e.writeUint32(this.chunk_offsets.length),e.writeUint32Array(this.chunk_offsets)},o.stscBox.prototype.write=function(e){var s;for(this.version=0,this.flags=0,this.size=4+12*this.first_chunk.length,this.writeHeader(e),e.writeUint32(this.first_chunk.length),s=0;s<this.first_chunk.length;s++)e.writeUint32(this.first_chunk[s]),e.writeUint32(this.samples_per_chunk[s]),e.writeUint32(this.sample_description_index[s])},o.stsdBox.prototype.write=function(e){var s;for(this.version=0,this.flags=0,this.size=0,this.writeHeader(e),e.writeUint32(this.entries.length),this.size+=4,s=0;s<this.entries.length;s++)this.entries[s].write(e),this.size+=this.entries[s].size;a.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),e.adjustUint32(this.sizePosition,this.size)},o.stshBox.prototype.write=function(e){var s;for(this.version=0,this.flags=0,this.size=4+8*this.shadowed_sample_numbers.length,this.writeHeader(e),e.writeUint32(this.shadowed_sample_numbers.length),s=0;s<this.shadowed_sample_numbers.length;s++)e.writeUint32(this.shadowed_sample_numbers[s]),e.writeUint32(this.sync_sample_numbers[s])},o.stssBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4+4*this.sample_numbers.length,this.writeHeader(e),e.writeUint32(this.sample_numbers.length),e.writeUint32Array(this.sample_numbers)},o.stszBox.prototype.write=function(e){var s,l=!0;if(this.version=0,this.flags=0,this.sample_sizes.length>0)for(s=0;s+1<this.sample_sizes.length;)if(this.sample_sizes[s+1]!==this.sample_sizes[0]){l=!1;break}else s++;else l=!1;this.size=8,l||(this.size+=4*this.sample_sizes.length),this.writeHeader(e),l?e.writeUint32(this.sample_sizes[0]):e.writeUint32(0),e.writeUint32(this.sample_sizes.length),l||e.writeUint32Array(this.sample_sizes)},o.sttsBox.prototype.write=function(e){var s;for(this.version=0,this.flags=0,this.size=4+8*this.sample_counts.length,this.writeHeader(e),e.writeUint32(this.sample_counts.length),s=0;s<this.sample_counts.length;s++)e.writeUint32(this.sample_counts[s]),e.writeUint32(this.sample_deltas[s])},o.tfdtBox.prototype.write=function(e){var s=Math.pow(2,32)-1;this.version=this.baseMediaDecodeTime>s?1:0,this.flags=0,this.size=4,this.version===1&&(this.size+=4),this.writeHeader(e),this.version===1?e.writeUint64(this.baseMediaDecodeTime):e.writeUint32(this.baseMediaDecodeTime)},o.tfhdBox.prototype.write=function(e){this.version=0,this.size=4,this.flags&o.TFHD_FLAG_BASE_DATA_OFFSET&&(this.size+=8),this.flags&o.TFHD_FLAG_SAMPLE_DESC&&(this.size+=4),this.flags&o.TFHD_FLAG_SAMPLE_DUR&&(this.size+=4),this.flags&o.TFHD_FLAG_SAMPLE_SIZE&&(this.size+=4),this.flags&o.TFHD_FLAG_SAMPLE_FLAGS&&(this.size+=4),this.writeHeader(e),e.writeUint32(this.track_id),this.flags&o.TFHD_FLAG_BASE_DATA_OFFSET&&e.writeUint64(this.base_data_offset),this.flags&o.TFHD_FLAG_SAMPLE_DESC&&e.writeUint32(this.default_sample_description_index),this.flags&o.TFHD_FLAG_SAMPLE_DUR&&e.writeUint32(this.default_sample_duration),this.flags&o.TFHD_FLAG_SAMPLE_SIZE&&e.writeUint32(this.default_sample_size),this.flags&o.TFHD_FLAG_SAMPLE_FLAGS&&e.writeUint32(this.default_sample_flags)},o.tkhdBox.prototype.write=function(e){this.version=0,this.size=4*18+2*4,this.writeHeader(e),e.writeUint32(this.creation_time),e.writeUint32(this.modification_time),e.writeUint32(this.track_id),e.writeUint32(0),e.writeUint32(this.duration),e.writeUint32(0),e.writeUint32(0),e.writeInt16(this.layer),e.writeInt16(this.alternate_group),e.writeInt16(this.volume<<8),e.writeUint16(0),e.writeInt32Array(this.matrix),e.writeUint32(this.width),e.writeUint32(this.height)},o.trexBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4*5,this.writeHeader(e),e.writeUint32(this.track_id),e.writeUint32(this.default_sample_description_index),e.writeUint32(this.default_sample_duration),e.writeUint32(this.default_sample_size),e.writeUint32(this.default_sample_flags)},o.trunBox.prototype.write=function(e){this.version=0,this.size=4,this.flags&o.TRUN_FLAGS_DATA_OFFSET&&(this.size+=4),this.flags&o.TRUN_FLAGS_FIRST_FLAG&&(this.size+=4),this.flags&o.TRUN_FLAGS_DURATION&&(this.size+=4*this.sample_duration.length),this.flags&o.TRUN_FLAGS_SIZE&&(this.size+=4*this.sample_size.length),this.flags&o.TRUN_FLAGS_FLAGS&&(this.size+=4*this.sample_flags.length),this.flags&o.TRUN_FLAGS_CTS_OFFSET&&(this.size+=4*this.sample_composition_time_offset.length),this.writeHeader(e),e.writeUint32(this.sample_count),this.flags&o.TRUN_FLAGS_DATA_OFFSET&&(this.data_offset_position=e.getPosition(),e.writeInt32(this.data_offset)),this.flags&o.TRUN_FLAGS_FIRST_FLAG&&e.writeUint32(this.first_sample_flags);for(var s=0;s<this.sample_count;s++)this.flags&o.TRUN_FLAGS_DURATION&&e.writeUint32(this.sample_duration[s]),this.flags&o.TRUN_FLAGS_SIZE&&e.writeUint32(this.sample_size[s]),this.flags&o.TRUN_FLAGS_FLAGS&&e.writeUint32(this.sample_flags[s]),this.flags&o.TRUN_FLAGS_CTS_OFFSET&&(this.version===0?e.writeUint32(this.sample_composition_time_offset[s]):e.writeInt32(this.sample_composition_time_offset[s]))},o["url Box"].prototype.write=function(e){this.version=0,this.location?(this.flags=0,this.size=this.location.length+1):(this.flags=1,this.size=0),this.writeHeader(e),this.location&&e.writeCString(this.location)},o["urn Box"].prototype.write=function(e){this.version=0,this.flags=0,this.size=this.name.length+1+(this.location?this.location.length+1:0),this.writeHeader(e),e.writeCString(this.name),this.location&&e.writeCString(this.location)},o.vmhdBox.prototype.write=function(e){this.version=0,this.flags=1,this.size=8,this.writeHeader(e),e.writeUint16(this.graphicsmode),e.writeUint16Array(this.opcolor)},o.cttsBox.prototype.unpack=function(e){var s,l,f;for(f=0,s=0;s<this.sample_counts.length;s++)for(l=0;l<this.sample_counts[s];l++)e[f].pts=e[f].dts+this.sample_offsets[s],f++},o.sttsBox.prototype.unpack=function(e){var s,l,f;for(f=0,s=0;s<this.sample_counts.length;s++)for(l=0;l<this.sample_counts[s];l++)f===0?e[f].dts=0:e[f].dts=e[f-1].dts+this.sample_deltas[s],f++},o.stcoBox.prototype.unpack=function(e){var s;for(s=0;s<this.chunk_offsets.length;s++)e[s].offset=this.chunk_offsets[s]},o.stscBox.prototype.unpack=function(e){var s,l,f,d,y;for(d=0,y=0,s=0;s<this.first_chunk.length;s++)for(l=0;l<(s+1<this.first_chunk.length?this.first_chunk[s+1]:1/0);l++)for(y++,f=0;f<this.samples_per_chunk[s];f++){if(e[d])e[d].description_index=this.sample_description_index[s],e[d].chunk_index=y;else return;d++}},o.stszBox.prototype.unpack=function(e){var s;for(s=0;s<this.sample_sizes.length;s++)e[s].size=this.sample_sizes[s]},o.DIFF_BOXES_PROP_NAMES=["boxes","entries","references","subsamples","items","item_infos","extents","associations","subsegments","ranges","seekLists","seekPoints","esd","levels"],o.DIFF_PRIMITIVE_ARRAY_PROP_NAMES=["compatible_brands","matrix","opcolor","sample_counts","sample_counts","sample_deltas","first_chunk","samples_per_chunk","sample_sizes","chunk_offsets","sample_offsets","sample_description_index","sample_duration"],o.boxEqualFields=function(e,s){if(e&&!s)return!1;var l;for(l in e)if(!(o.DIFF_BOXES_PROP_NAMES.indexOf(l)>-1)){if(e[l]instanceof o.Box||s[l]instanceof o.Box)continue;if(typeof e[l]=="undefined"||typeof s[l]=="undefined")continue;if(typeof e[l]=="function"||typeof s[l]=="function")continue;if(e.subBoxNames&&e.subBoxNames.indexOf(l.slice(0,4))>-1||s.subBoxNames&&s.subBoxNames.indexOf(l.slice(0,4))>-1)continue;if(l==="data"||l==="start"||l==="size"||l==="creation_time"||l==="modification_time")continue;if(o.DIFF_PRIMITIVE_ARRAY_PROP_NAMES.indexOf(l)>-1)continue;if(e[l]!==s[l])return!1}return!0},o.boxEqual=function(e,s){if(!o.boxEqualFields(e,s))return!1;for(var l=0;l<o.DIFF_BOXES_PROP_NAMES.length;l++){var f=o.DIFF_BOXES_PROP_NAMES[l];if(e[f]&&s[f]&&!o.boxEqual(e[f],s[f]))return!1}return!0};var c=function(){};c.prototype.parseSample=function(e){var s={},l;s.resources=[];var f=new t(e.data.buffer);if(!e.subsamples||e.subsamples.length===0)s.documentString=f.readString(e.data.length);else if(s.documentString=f.readString(e.subsamples[0].size),e.subsamples.length>1)for(l=1;l<e.subsamples.length;l++)s.resources[l]=f.readUint8Array(e.subsamples[l].size);return typeof DOMParser!="undefined"&&(s.document=new DOMParser().parseFromString(s.documentString,"application/xml")),s};var g=function(){};g.prototype.parseSample=function(e){var s,l=new t(e.data.buffer);return s=l.readString(e.data.length),s},g.prototype.parseConfig=function(e){var s,l=new t(e.buffer);return l.readUint32(),s=l.readCString(),s},h.XMLSubtitlein4Parser=c,h.Textin4Parser=g;var v=function(e){this.stream=e||new n,this.boxes=[],this.mdats=[],this.moofs=[],this.isProgressive=!1,this.moovStartFound=!1,this.onMoovStart=null,this.moovStartSent=!1,this.onReady=null,this.readySent=!1,this.onSegment=null,this.onSamples=null,this.onError=null,this.sampleListBuilt=!1,this.fragmentedTracks=[],this.extractedTracks=[],this.isFragmentationInitialized=!1,this.sampleProcessingStarted=!1,this.nextMoofNumber=0,this.itemListBuilt=!1,this.onSidx=null,this.sidxSent=!1};v.prototype.setSegmentOptions=function(e,s,l){var f=this.getTrackById(e);if(f){var d={};this.fragmentedTracks.push(d),d.id=e,d.user=s,d.trak=f,f.nextSample=0,d.segmentStream=null,d.nb_samples=1e3,d.rapAlignement=!0,l&&(l.nbSamples&&(d.nb_samples=l.nbSamples),l.rapAlignement&&(d.rapAlignement=l.rapAlignement))}},v.prototype.unsetSegmentOptions=function(e){for(var s=-1,l=0;l<this.fragmentedTracks.length;l++){var f=this.fragmentedTracks[l];f.id==e&&(s=l)}s>-1&&this.fragmentedTracks.splice(s,1)},v.prototype.setExtractionOptions=function(e,s,l){var f=this.getTrackById(e);if(f){var d={};this.extractedTracks.push(d),d.id=e,d.user=s,d.trak=f,f.nextSample=0,d.nb_samples=1e3,d.samples=[],l&&l.nbSamples&&(d.nb_samples=l.nbSamples)}},v.prototype.unsetExtractionOptions=function(e){for(var s=-1,l=0;l<this.extractedTracks.length;l++){var f=this.extractedTracks[l];f.id==e&&(s=l)}s>-1&&this.extractedTracks.splice(s,1)},v.prototype.parse=function(){var e,s,l=!1;if(!(this.restoreParsePosition&&!this.restoreParsePosition()))for(;;)if(this.hasIncompleteMdat&&this.hasIncompleteMdat()){if(this.processIncompleteMdat())continue;return}else if(this.saveParsePosition&&this.saveParsePosition(),e=o.parseOneBox(this.stream,l),e.code===o.ERR_NOT_ENOUGH_DATA)if(this.processIncompleteBox){if(this.processIncompleteBox(e))continue;return}else return;else{var f;switch(s=e.box,f=s.type!=="uuid"?s.type:s.uuid,this.boxes.push(s),f){case"mdat":this.mdats.push(s);break;case"moof":this.moofs.push(s);break;case"moov":this.moovStartFound=!0,this.mdats.length===0&&(this.isProgressive=!0);default:this[f]!==void 0&&a.warn("ISOFile","Duplicate Box of type: "+f+", overriding previous occurrence"),this[f]=s;break}this.updateUsedBytes&&this.updateUsedBytes(s,e)}},v.prototype.checkBuffer=function(e){if(e==null)throw"Buffer must be defined and non empty";if(e.fileStart===void 0)throw"Buffer must have a fileStart property";return e.byteLength===0?(a.warn("ISOFile","Ignoring empty buffer (fileStart: "+e.fileStart+")"),this.stream.logBufferLevel(),!1):(a.info("ISOFile","Processing buffer (fileStart: "+e.fileStart+")"),e.usedBytes=0,this.stream.insertBuffer(e),this.stream.logBufferLevel(),this.stream.initialized()?!0:(a.warn("ISOFile","Not ready to start parsing"),!1))},v.prototype.appendBuffer=function(e,s){var l;if(!!this.checkBuffer(e))return this.parse(),this.moovStartFound&&!this.moovStartSent&&(this.moovStartSent=!0,this.onMoovStart&&this.onMoovStart()),this.moov?(this.sampleListBuilt||(this.buildSampleLists(),this.sampleListBuilt=!0),this.updateSampleLists(),this.onReady&&!this.readySent&&(this.readySent=!0,this.onReady(this.getInfo())),this.processSamples(s),this.nextSeekPosition?(l=this.nextSeekPosition,this.nextSeekPosition=void 0):l=this.nextParsePosition,this.stream.getEndFilePositionAfter&&(l=this.stream.getEndFilePositionAfter(l))):this.nextParsePosition?l=this.nextParsePosition:l=0,this.sidx&&this.onSidx&&!this.sidxSent&&(this.onSidx(this.sidx),this.sidxSent=!0),this.meta&&(this.flattenItemInfo&&!this.itemListBuilt&&(this.flattenItemInfo(),this.itemListBuilt=!0),this.processItems&&this.processItems(this.onItem)),this.stream.cleanBuffers&&(a.info("ISOFile","Done processing buffer (fileStart: "+e.fileStart+") - next buffer to fetch should have a fileStart position of "+l),this.stream.logBufferLevel(),this.stream.cleanBuffers(),this.stream.logBufferLevel(!0),a.info("ISOFile","Sample data size in memory: "+this.getAllocatedSampleDataSize())),l},v.prototype.getInfo=function(){var e,s,l={},f,d,y,m,_=new Date("1904-01-01T00:00:00Z").getTime();if(this.moov)for(l.hasMoov=!0,l.duration=this.moov.mvhd.duration,l.timescale=this.moov.mvhd.timescale,l.isFragmented=this.moov.mvex!=null,l.isFragmented&&this.moov.mvex.mehd&&(l.fragment_duration=this.moov.mvex.mehd.fragment_duration),l.isProgressive=this.isProgressive,l.hasIOD=this.moov.iods!=null,l.brands=[],l.brands.push(this.ftyp.major_brand),l.brands=l.brands.concat(this.ftyp.compatible_brands),l.created=new Date(_+this.moov.mvhd.creation_time*1e3),l.modified=new Date(_+this.moov.mvhd.modification_time*1e3),l.tracks=[],l.audioTracks=[],l.videoTracks=[],l.subtitleTracks=[],l.metadataTracks=[],l.hintTracks=[],l.otherTracks=[],e=0;e<this.moov.traks.length;e++){if(f=this.moov.traks[e],m=f.mdia.minf.stbl.stsd.entries[0],d={},l.tracks.push(d),d.id=f.tkhd.track_id,d.name=f.mdia.hdlr.name,d.references=[],f.tref)for(s=0;s<f.tref.boxes.length;s++)y={},d.references.push(y),y.type=f.tref.boxes[s].type,y.track_ids=f.tref.boxes[s].track_ids;f.edts&&(d.edits=f.edts.elst.entries),d.created=new Date(_+f.tkhd.creation_time*1e3),d.modified=new Date(_+f.tkhd.modification_time*1e3),d.movie_duration=f.tkhd.duration,d.movie_timescale=l.timescale,d.layer=f.tkhd.layer,d.alternate_group=f.tkhd.alternate_group,d.volume=f.tkhd.volume,d.matrix=f.tkhd.matrix,d.track_width=f.tkhd.width/(1<<16),d.track_height=f.tkhd.height/(1<<16),d.timescale=f.mdia.mdhd.timescale,d.cts_shift=f.mdia.minf.stbl.cslg,d.duration=f.mdia.mdhd.duration,d.samples_duration=f.samples_duration,d.codec=m.getCodec(),d.kind=f.udta&&f.udta.kinds.length?f.udta.kinds[0]:{schemeURI:"",value:""},d.language=f.mdia.elng?f.mdia.elng.extended_language:f.mdia.mdhd.languageString,d.nb_samples=f.samples.length,d.size=f.samples_size,d.bitrate=d.size*8*d.timescale/d.samples_duration,m.isAudio()?(d.type="audio",l.audioTracks.push(d),d.audio={},d.audio.sample_rate=m.getSampleRate(),d.audio.channel_count=m.getChannelCount(),d.audio.sample_size=m.getSampleSize()):m.isVideo()?(d.type="video",l.videoTracks.push(d),d.video={},d.video.width=m.getWidth(),d.video.height=m.getHeight()):m.isSubtitle()?(d.type="subtitles",l.subtitleTracks.push(d)):m.isHint()?(d.type="metadata",l.hintTracks.push(d)):m.isMetadata()?(d.type="metadata",l.metadataTracks.push(d)):(d.type="metadata",l.otherTracks.push(d))}else l.hasMoov=!1;if(l.mime="",l.hasMoov&&l.tracks){for(l.videoTracks&&l.videoTracks.length>0?l.mime+='video/mp4; codecs="':l.audioTracks&&l.audioTracks.length>0?l.mime+='audio/mp4; codecs="':l.mime+='application/mp4; codecs="',e=0;e<l.tracks.length;e++)e!==0&&(l.mime+=","),l.mime+=l.tracks[e].codec;l.mime+='"; profiles="',l.mime+=this.ftyp.compatible_brands.join(),l.mime+='"'}return l},v.prototype.processSamples=function(e){var s,l;if(!!this.sampleProcessingStarted){if(this.isFragmentationInitialized&&this.onSegment!==null)for(s=0;s<this.fragmentedTracks.length;s++){var f=this.fragmentedTracks[s];for(l=f.trak;l.nextSample<l.samples.length&&this.sampleProcessingStarted;){a.debug("ISOFile","Creating media fragment on track #"+f.id+" for sample "+l.nextSample);var d=this.createFragment(f.id,l.nextSample,f.segmentStream);if(d)f.segmentStream=d,l.nextSample++;else break;if((l.nextSample%f.nb_samples==0||e||l.nextSample>=l.samples.length)&&(a.info("ISOFile","Sending fragmented data on track #"+f.id+" for samples ["+Math.max(0,l.nextSample-f.nb_samples)+","+(l.nextSample-1)+"]"),a.info("ISOFile","Sample data size in memory: "+this.getAllocatedSampleDataSize()),this.onSegment&&this.onSegment(f.id,f.user,f.segmentStream.buffer,l.nextSample,e||l.nextSample>=l.samples.length),f.segmentStream=null,f!==this.fragmentedTracks[s]))break}}if(this.onSamples!==null)for(s=0;s<this.extractedTracks.length;s++){var y=this.extractedTracks[s];for(l=y.trak;l.nextSample<l.samples.length&&this.sampleProcessingStarted;){a.debug("ISOFile","Exporting on track #"+y.id+" sample #"+l.nextSample);var m=this.getSample(l,l.nextSample);if(m)l.nextSample++,y.samples.push(m);else break;if((l.nextSample%y.nb_samples==0||l.nextSample>=l.samples.length)&&(a.debug("ISOFile","Sending samples on track #"+y.id+" for sample "+l.nextSample),this.onSamples&&this.onSamples(y.id,y.user,y.samples),y.samples=[],y!==this.extractedTracks[s]))break}}}},v.prototype.getBox=function(e){var s=this.getBoxes(e,!0);return s.length?s[0]:null},v.prototype.getBoxes=function(e,s){var l=[];return v._sweep.call(this,e,l,s),l},v._sweep=function(e,s,l){this.type&&this.type==e&&s.push(this);for(var f in this.boxes){if(s.length&&l)return;v._sweep.call(this.boxes[f],e,s,l)}},v.prototype.getTrackSamplesInfo=function(e){var s=this.getTrackById(e);if(s)return s.samples},v.prototype.getTrackSample=function(e,s){var l=this.getTrackById(e),f=this.getSample(l,s);return f},v.prototype.releaseUsedSamples=function(e,s){var l=0,f=this.getTrackById(e);f.lastValidSample||(f.lastValidSample=0);for(var d=f.lastValidSample;d<s;d++)l+=this.releaseSample(f,d);a.info("ISOFile","Track #"+e+" released samples up to "+s+" (released size: "+l+", remaining: "+this.samplesDataSize+")"),f.lastValidSample=s},v.prototype.start=function(){this.sampleProcessingStarted=!0,this.processSamples(!1)},v.prototype.stop=function(){this.sampleProcessingStarted=!1},v.prototype.flush=function(){a.info("ISOFile","Flushing remaining samples"),this.updateSampleLists(),this.processSamples(!0),this.stream.cleanBuffers(),this.stream.logBufferLevel(!0)},v.prototype.seekTrack=function(e,s,l){var f,d,y=1/0,m=0,_=0,E;if(l.samples.length===0)return a.info("ISOFile","No sample in track, cannot seek! Using time "+a.getDurationString(0,1)+" and offset: "+0),{offset:0,time:0};for(f=0;f<l.samples.length;f++){if(d=l.samples[f],f===0)_=0,E=d.timescale;else if(d.cts>e*d.timescale){_=f-1;break}s&&d.is_sync&&(m=f)}for(s&&(_=m),e=l.samples[_].cts,l.nextSample=_;l.samples[_].alreadyRead===l.samples[_].size&&l.samples[_+1];)_++;return y=l.samples[_].offset+l.samples[_].alreadyRead,a.info("ISOFile","Seeking to "+(s?"RAP":"")+" sample #"+l.nextSample+" on track "+l.tkhd.track_id+", time "+a.getDurationString(e,E)+" and offset: "+y),{offset:y,time:e/E}},v.prototype.seek=function(e,s){var l=this.moov,f,d,y,m={offset:1/0,time:1/0};if(this.moov){for(y=0;y<l.traks.length;y++)f=l.traks[y],d=this.seekTrack(e,s,f),d.offset<m.offset&&(m.offset=d.offset),d.time<m.time&&(m.time=d.time);return a.info("ISOFile","Seeking at time "+a.getDurationString(m.time,1)+" needs a buffer with a fileStart position of "+m.offset),m.offset===1/0?m={offset:this.nextParsePosition,time:0}:m.offset=this.stream.getEndFilePositionAfter(m.offset),a.info("ISOFile","Adjusted seek position (after checking data already in buffer): "+m.offset),m}else throw"Cannot seek: moov not received!"},v.prototype.equal=function(e){for(var s=0;s<this.boxes.length&&s<e.boxes.length;){var l=this.boxes[s],f=e.boxes[s];if(!o.boxEqual(l,f))return!1;s++}return!0},h.ISOFile=v,v.prototype.lastBoxStartPosition=0,v.prototype.parsingMdat=null,v.prototype.nextParsePosition=0,v.prototype.discardMdatData=!1,v.prototype.processIncompleteBox=function(e){var s,l,f;return e.type==="mdat"?(s=new o[e.type+"Box"](e.size),this.parsingMdat=s,this.boxes.push(s),this.mdats.push(s),s.start=e.start,s.hdr_size=e.hdr_size,this.stream.addUsedBytes(s.hdr_size),this.lastBoxStartPosition=s.start+s.size,f=this.stream.seek(s.start+s.size,!1,this.discardMdatData),f?(this.parsingMdat=null,!0):(this.moovStartFound?this.nextParsePosition=this.stream.findEndContiguousBuf():this.nextParsePosition=s.start+s.size,!1)):(e.type==="moov"&&(this.moovStartFound=!0,this.mdats.length===0&&(this.isProgressive=!0)),l=this.stream.mergeNextBuffer?this.stream.mergeNextBuffer():!1,l?(this.nextParsePosition=this.stream.getEndPosition(),!0):(e.type?this.moovStartFound?this.nextParsePosition=this.stream.getEndPosition():this.nextParsePosition=this.stream.getPosition()+e.size:this.nextParsePosition=this.stream.getEndPosition(),!1))},v.prototype.hasIncompleteMdat=function(){return this.parsingMdat!==null},v.prototype.processIncompleteMdat=function(){var e,s;return e=this.parsingMdat,s=this.stream.seek(e.start+e.size,!1,this.discardMdatData),s?(a.debug("ISOFile","Found 'mdat' end in buffered data"),this.parsingMdat=null,!0):(this.nextParsePosition=this.stream.findEndContiguousBuf(),!1)},v.prototype.restoreParsePosition=function(){return this.stream.seek(this.lastBoxStartPosition,!0,this.discardMdatData)},v.prototype.saveParsePosition=function(){this.lastBoxStartPosition=this.stream.getPosition()},v.prototype.updateUsedBytes=function(e,s){this.stream.addUsedBytes&&(e.type==="mdat"?(this.stream.addUsedBytes(e.hdr_size),this.discardMdatData&&this.stream.addUsedBytes(e.size-e.hdr_size)):this.stream.addUsedBytes(e.size))},v.prototype.add=o.Box.prototype.add,v.prototype.addBox=o.Box.prototype.addBox,v.prototype.init=function(e){var s=e||{};this.add("ftyp").set("major_brand",s.brands&&s.brands[0]||"iso4").set("minor_version",0).set("compatible_brands",s.brands||["iso4"]);var l=this.add("moov");return l.add("mvhd").set("timescale",s.timescale||600).set("rate",s.rate||1<<16).set("creation_time",0).set("modification_time",0).set("duration",s.duration||0).set("volume",s.width?0:256).set("matrix",[1<<16,0,0,0,1<<16,0,0,0,1073741824]).set("next_track_id",1),l.add("mvex"),this},v.prototype.addTrack=function(e){this.moov||this.init(e);var s=e||{};s.width=s.width||320,s.height=s.height||320,s.id=s.id||this.moov.mvhd.next_track_id,s.type=s.type||"avc1";var l=this.moov.add("trak");this.moov.mvhd.next_track_id=s.id+1,l.add("tkhd").set("flags",o.TKHD_FLAG_ENABLED|o.TKHD_FLAG_IN_MOVIE|o.TKHD_FLAG_IN_PREVIEW).set("creation_time",0).set("modification_time",0).set("track_id",s.id).set("duration",s.duration||0).set("layer",s.layer||0).set("alternate_group",0).set("volume",1).set("matrix",[0,0,0,0,0,0,0,0,0]).set("width",s.width<<16).set("height",s.height<<16);var f=l.add("mdia");f.add("mdhd").set("creation_time",0).set("modification_time",0).set("timescale",s.timescale||1).set("duration",s.media_duration||0).set("language",s.language||"und"),f.add("hdlr").set("handler",s.hdlr||"vide").set("name",s.name||"Track created with MP4Box.js"),f.add("elng").set("extended_language",s.language||"fr-FR");var d=f.add("minf");if(o[s.type+"SampleEntry"]!==void 0){var y=new o[s.type+"SampleEntry"];y.data_reference_index=1;var m="";for(var _ in o.sampleEntryCodes)for(var E=o.sampleEntryCodes[_],w=0;w<E.length;w++)if(E.indexOf(s.type)>-1){m=_;break}switch(m){case"Visual":if(d.add("vmhd").set("graphicsmode",0).set("opcolor",[0,0,0]),y.set("width",s.width).set("height",s.height).set("horizresolution",72<<16).set("vertresolution",72<<16).set("frame_count",1).set("compressorname",s.type+" Compressor").set("depth",24),s.avcDecoderConfigRecord){var k=new o.avcCBox,x=new t(s.avcDecoderConfigRecord);k.parse(x),y.addBox(k)}break;case"Audio":d.add("smhd").set("balance",s.balance||0),y.set("channel_count",s.channel_count||2).set("samplesize",s.samplesize||16).set("samplerate",s.samplerate||1<<16);break;case"Hint":d.add("hmhd");break;case"Subtitle":switch(d.add("sthd"),s.type){case"stpp":y.set("namespace",s.namespace||"nonamespace").set("schema_location",s.schema_location||"").set("auxiliary_mime_types",s.auxiliary_mime_types||"");break}break;case"Metadata":d.add("nmhd");break;case"System":d.add("nmhd");break;default:d.add("nmhd");break}s.description&&y.addBox(s.description),s.description_boxes&&s.description_boxes.forEach(function(P){y.addBox(P)}),d.add("dinf").add("dref").addEntry(new o["url Box"]().set("flags",1));var S=d.add("stbl");return S.add("stsd").addEntry(y),S.add("stts").set("sample_counts",[]).set("sample_deltas",[]),S.add("stsc").set("first_chunk",[]).set("samples_per_chunk",[]).set("sample_description_index",[]),S.add("stco").set("chunk_offsets",[]),S.add("stsz").set("sample_sizes",[]),this.moov.mvex.add("trex").set("track_id",s.id).set("default_sample_description_index",s.default_sample_description_index||1).set("default_sample_duration",s.default_sample_duration||0).set("default_sample_size",s.default_sample_size||0).set("default_sample_flags",s.default_sample_flags||0),this.buildTrakSampleLists(l),s.id}},o.Box.prototype.computeSize=function(e){var s=e||new i;s.endianness=i.BIG_ENDIAN,this.write(s)},v.prototype.addSample=function(e,s,l){var f=l||{},d={},y=this.getTrackById(e);if(y!==null){d.number=y.samples.length,d.track_id=y.tkhd.track_id,d.timescale=y.mdia.mdhd.timescale,d.description_index=f.sample_description_index?f.sample_description_index-1:0,d.description=y.mdia.minf.stbl.stsd.entries[d.description_index],d.data=s,d.size=s.byteLength,d.alreadyRead=d.size,d.duration=f.duration||1,d.cts=f.cts||0,d.dts=f.dts||0,d.is_sync=f.is_sync||!1,d.is_leading=f.is_leading||0,d.depends_on=f.depends_on||0,d.is_depended_on=f.is_depended_on||0,d.has_redundancy=f.has_redundancy||0,d.degradation_priority=f.degradation_priority||0,d.offset=0,d.subsamples=f.subsamples,y.samples.push(d),y.samples_size+=d.size,y.samples_duration+=d.duration,y.first_dts||(y.first_dts=f.dts),this.processSamples();var m=this.createSingleSampleMoof(d);return this.addBox(m),m.computeSize(),m.trafs[0].truns[0].data_offset=m.size+8,this.add("mdat").data=new Uint8Array(s),d}},v.prototype.createSingleSampleMoof=function(e){var s=0;e.is_sync?s=1<<25:s=1<<16;var l=new o.moofBox;l.add("mfhd").set("sequence_number",this.nextMoofNumber),this.nextMoofNumber++;var f=l.add("traf"),d=this.getTrackById(e.track_id);return f.add("tfhd").set("track_id",e.track_id).set("flags",o.TFHD_FLAG_DEFAULT_BASE_IS_MOOF),f.add("tfdt").set("baseMediaDecodeTime",e.dts-(d.first_dts||0)),f.add("trun").set("flags",o.TRUN_FLAGS_DATA_OFFSET|o.TRUN_FLAGS_DURATION|o.TRUN_FLAGS_SIZE|o.TRUN_FLAGS_FLAGS|o.TRUN_FLAGS_CTS_OFFSET).set("data_offset",0).set("first_sample_flags",0).set("sample_count",1).set("sample_duration",[e.duration]).set("sample_size",[e.size]).set("sample_flags",[s]).set("sample_composition_time_offset",[e.cts-e.dts]),l},v.prototype.lastMoofIndex=0,v.prototype.samplesDataSize=0,v.prototype.resetTables=function(){var e,s,l,f,d,y,m,_;for(this.initial_duration=this.moov.mvhd.duration,this.moov.mvhd.duration=0,e=0;e<this.moov.traks.length;e++){s=this.moov.traks[e],s.tkhd.duration=0,s.mdia.mdhd.duration=0,l=s.mdia.minf.stbl.stco||s.mdia.minf.stbl.co64,l.chunk_offsets=[],f=s.mdia.minf.stbl.stsc,f.first_chunk=[],f.samples_per_chunk=[],f.sample_description_index=[],d=s.mdia.minf.stbl.stsz||s.mdia.minf.stbl.stz2,d.sample_sizes=[],y=s.mdia.minf.stbl.stts,y.sample_counts=[],y.sample_deltas=[],m=s.mdia.minf.stbl.ctts,m&&(m.sample_counts=[],m.sample_offsets=[]),_=s.mdia.minf.stbl.stss;var E=s.mdia.minf.stbl.boxes.indexOf(_);E!=-1&&(s.mdia.minf.stbl.boxes[E]=null)}},v.initSampleGroups=function(e,s,l,f,d){var y,m,_,E;function w(k,x,S){this.grouping_type=k,this.grouping_type_parameter=x,this.sbgp=S,this.last_sample_in_run=-1,this.entry_index=-1}for(s&&(s.sample_groups_info=[]),e.sample_groups_info||(e.sample_groups_info=[]),m=0;m<l.length;m++){for(E=l[m].grouping_type+"/"+l[m].grouping_type_parameter,_=new w(l[m].grouping_type,l[m].grouping_type_parameter,l[m]),s&&(s.sample_groups_info[E]=_),e.sample_groups_info[E]||(e.sample_groups_info[E]=_),y=0;y<f.length;y++)f[y].grouping_type===l[m].grouping_type&&(_.description=f[y],_.description.used=!0);if(d)for(y=0;y<d.length;y++)d[y].grouping_type===l[m].grouping_type&&(_.fragment_description=d[y],_.fragment_description.used=!0,_.is_fragment=!0)}if(s){if(d)for(m=0;m<d.length;m++)!d[m].used&&d[m].version>=2&&(E=d[m].grouping_type+"/0",_=new w(d[m].grouping_type,0),_.is_fragment=!0,s.sample_groups_info[E]||(s.sample_groups_info[E]=_))}else for(m=0;m<f.length;m++)!f[m].used&&f[m].version>=2&&(E=f[m].grouping_type+"/0",_=new w(f[m].grouping_type,0),e.sample_groups_info[E]||(e.sample_groups_info[E]=_))},v.setSampleGroupProperties=function(e,s,l,f){var d,y;s.sample_groups=[];for(d in f)if(s.sample_groups[d]={},s.sample_groups[d].grouping_type=f[d].grouping_type,s.sample_groups[d].grouping_type_parameter=f[d].grouping_type_parameter,l>=f[d].last_sample_in_run&&(f[d].last_sample_in_run<0&&(f[d].last_sample_in_run=0),f[d].entry_index++,f[d].entry_index<=f[d].sbgp.entries.length-1&&(f[d].last_sample_in_run+=f[d].sbgp.entries[f[d].entry_index].sample_count)),f[d].entry_index<=f[d].sbgp.entries.length-1?s.sample_groups[d].group_description_index=f[d].sbgp.entries[f[d].entry_index].group_description_index:s.sample_groups[d].group_description_index=-1,s.sample_groups[d].group_description_index!==0){var m;f[d].fragment_description?m=f[d].fragment_description:m=f[d].description,s.sample_groups[d].group_description_index>0?(s.sample_groups[d].group_description_index>65535?y=(s.sample_groups[d].group_description_index>>16)-1:y=s.sample_groups[d].group_description_index-1,m&&y>=0&&(s.sample_groups[d].description=m.entries[y])):m&&m.version>=2&&m.default_group_description_index>0&&(s.sample_groups[d].description=m.entries[m.default_group_description_index-1])}},v.process_sdtp=function(e,s,l){!s||(e?(s.is_leading=e.is_leading[l],s.depends_on=e.sample_depends_on[l],s.is_depended_on=e.sample_is_depended_on[l],s.has_redundancy=e.sample_has_redundancy[l]):(s.is_leading=0,s.depends_on=0,s.is_depended_on=0,s.has_redundancy=0))},v.prototype.buildSampleLists=function(){var e,s;for(e=0;e<this.moov.traks.length;e++)s=this.moov.traks[e],this.buildTrakSampleLists(s)},v.prototype.buildTrakSampleLists=function(e){var s,l,f,d,y,m,_,E,w,k,x,S,P,U,R,C,A,b,O,W,K,G,B,j;if(e.samples=[],e.samples_duration=0,e.samples_size=0,l=e.mdia.minf.stbl.stco||e.mdia.minf.stbl.co64,f=e.mdia.minf.stbl.stsc,d=e.mdia.minf.stbl.stsz||e.mdia.minf.stbl.stz2,y=e.mdia.minf.stbl.stts,m=e.mdia.minf.stbl.ctts,_=e.mdia.minf.stbl.stss,E=e.mdia.minf.stbl.stsd,w=e.mdia.minf.stbl.subs,S=e.mdia.minf.stbl.stdp,k=e.mdia.minf.stbl.sbgps,x=e.mdia.minf.stbl.sgpds,b=-1,O=-1,W=-1,K=-1,G=0,B=0,j=0,v.initSampleGroups(e,null,k,x),typeof d!="undefined"){for(s=0;s<d.sample_sizes.length;s++){var z={};z.number=s,z.track_id=e.tkhd.track_id,z.timescale=e.mdia.mdhd.timescale,z.alreadyRead=0,e.samples[s]=z,z.size=d.sample_sizes[s],e.samples_size+=z.size,s===0?(U=1,P=0,z.chunk_index=U,z.chunk_run_index=P,A=f.samples_per_chunk[P],C=0,P+1<f.first_chunk.length?R=f.first_chunk[P+1]-1:R=1/0):s<A?(z.chunk_index=U,z.chunk_run_index=P):(U++,z.chunk_index=U,C=0,U<=R||(P++,P+1<f.first_chunk.length?R=f.first_chunk[P+1]-1:R=1/0),z.chunk_run_index=P,A+=f.samples_per_chunk[P]),z.description_index=f.sample_description_index[z.chunk_run_index]-1,z.description=E.entries[z.description_index],z.offset=l.chunk_offsets[z.chunk_index-1]+C,C+=z.size,s>b&&(O++,b<0&&(b=0),b+=y.sample_counts[O]),s>0?(e.samples[s-1].duration=y.sample_deltas[O],e.samples_duration+=e.samples[s-1].duration,z.dts=e.samples[s-1].dts+e.samples[s-1].duration):z.dts=0,m?(s>=W&&(K++,W<0&&(W=0),W+=m.sample_counts[K]),z.cts=e.samples[s].dts+m.sample_offsets[K]):z.cts=z.dts,_?(s==_.sample_numbers[G]-1?(z.is_sync=!0,G++):(z.is_sync=!1,z.degradation_priority=0),w&&w.entries[B].sample_delta+j==s+1&&(z.subsamples=w.entries[B].subsamples,j+=w.entries[B].sample_delta,B++)):z.is_sync=!0,v.process_sdtp(e.mdia.minf.stbl.sdtp,z,z.number),S?z.degradation_priority=S.priority[s]:z.degradation_priority=0,w&&w.entries[B].sample_delta+j==s&&(z.subsamples=w.entries[B].subsamples,j+=w.entries[B].sample_delta),(k.length>0||x.length>0)&&v.setSampleGroupProperties(e,z,s,e.sample_groups_info)}s>0&&(e.samples[s-1].duration=Math.max(e.mdia.mdhd.duration-e.samples[s-1].dts,0),e.samples_duration+=e.samples[s-1].duration)}},v.prototype.updateSampleLists=function(){var e,s,l,f,d,y,m,_,E,w,k,x,S,P,U;if(this.moov!==void 0){for(;this.lastMoofIndex<this.moofs.length;)if(E=this.moofs[this.lastMoofIndex],this.lastMoofIndex++,E.type=="moof")for(w=E,e=0;e<w.trafs.length;e++){for(k=w.trafs[e],x=this.getTrackById(k.tfhd.track_id),S=this.getTrexById(k.tfhd.track_id),k.tfhd.flags&o.TFHD_FLAG_SAMPLE_DESC?f=k.tfhd.default_sample_description_index:f=S?S.default_sample_description_index:1,k.tfhd.flags&o.TFHD_FLAG_SAMPLE_DUR?d=k.tfhd.default_sample_duration:d=S?S.default_sample_duration:0,k.tfhd.flags&o.TFHD_FLAG_SAMPLE_SIZE?y=k.tfhd.default_sample_size:y=S?S.default_sample_size:0,k.tfhd.flags&o.TFHD_FLAG_SAMPLE_FLAGS?m=k.tfhd.default_sample_flags:m=S?S.default_sample_flags:0,k.sample_number=0,k.sbgps.length>0&&v.initSampleGroups(x,k,k.sbgps,x.mdia.minf.stbl.sgpds,k.sgpds),s=0;s<k.truns.length;s++){var R=k.truns[s];for(l=0;l<R.sample_count;l++){P={},P.moof_number=this.lastMoofIndex,P.number_in_traf=k.sample_number,k.sample_number++,P.number=x.samples.length,k.first_sample_index=x.samples.length,x.samples.push(P),P.track_id=x.tkhd.track_id,P.timescale=x.mdia.mdhd.timescale,P.description_index=f-1,P.description=x.mdia.minf.stbl.stsd.entries[P.description_index],P.size=y,R.flags&o.TRUN_FLAGS_SIZE&&(P.size=R.sample_size[l]),x.samples_size+=P.size,P.duration=d,R.flags&o.TRUN_FLAGS_DURATION&&(P.duration=R.sample_duration[l]),x.samples_duration+=P.duration,x.first_traf_merged||l>0?P.dts=x.samples[x.samples.length-2].dts+x.samples[x.samples.length-2].duration:(k.tfdt?P.dts=k.tfdt.baseMediaDecodeTime:P.dts=0,x.first_traf_merged=!0),P.cts=P.dts,R.flags&o.TRUN_FLAGS_CTS_OFFSET&&(P.cts=P.dts+R.sample_composition_time_offset[l]),U=m,R.flags&o.TRUN_FLAGS_FLAGS?U=R.sample_flags[l]:l===0&&R.flags&o.TRUN_FLAGS_FIRST_FLAG&&(U=R.first_sample_flags),P.is_sync=!(U>>16&1),P.is_leading=U>>26&3,P.depends_on=U>>24&3,P.is_depended_on=U>>22&3,P.has_redundancy=U>>20&3,P.degradation_priority=U&65535;var C=!!(k.tfhd.flags&o.TFHD_FLAG_BASE_DATA_OFFSET),A=!!(k.tfhd.flags&o.TFHD_FLAG_DEFAULT_BASE_IS_MOOF),b=!!(R.flags&o.TRUN_FLAGS_DATA_OFFSET),O=0;C?O=k.tfhd.base_data_offset:A||s===0?O=w.start:O=_,s===0&&l===0?b?P.offset=O+R.data_offset:P.offset=O:P.offset=_,_=P.offset+P.size,(k.sbgps.length>0||k.sgpds.length>0||x.mdia.minf.stbl.sbgps.length>0||x.mdia.minf.stbl.sgpds.length>0)&&v.setSampleGroupProperties(x,P,P.number_in_traf,k.sample_groups_info)}}if(k.subs){x.has_fragment_subsamples=!0;var W=k.first_sample_index;for(s=0;s<k.subs.entries.length;s++)W+=k.subs.entries[s].sample_delta,P=x.samples[W-1],P.subsamples=k.subs.entries[s].subsamples}}}},v.prototype.getSample=function(e,s){var l,f=e.samples[s];if(!this.moov)return null;if(!f.data)f.data=new Uint8Array(f.size),f.alreadyRead=0,this.samplesDataSize+=f.size,a.debug("ISOFile","Allocating sample #"+s+" on track #"+e.tkhd.track_id+" of size "+f.size+" (total: "+this.samplesDataSize+")");else if(f.alreadyRead==f.size)return f;for(;;){var d=this.stream.findPosition(!0,f.offset+f.alreadyRead,!1);if(d>-1){l=this.stream.buffers[d];var y=l.byteLength-(f.offset+f.alreadyRead-l.fileStart);if(f.size-f.alreadyRead<=y)return a.debug("ISOFile","Getting sample #"+s+" data (alreadyRead: "+f.alreadyRead+" offset: "+(f.offset+f.alreadyRead-l.fileStart)+" read size: "+(f.size-f.alreadyRead)+" full size: "+f.size+")"),i.memcpy(f.data.buffer,f.alreadyRead,l,f.offset+f.alreadyRead-l.fileStart,f.size-f.alreadyRead),l.usedBytes+=f.size-f.alreadyRead,this.stream.logBufferLevel(),f.alreadyRead=f.size,f;if(y===0)return null;a.debug("ISOFile","Getting sample #"+s+" partial data (alreadyRead: "+f.alreadyRead+" offset: "+(f.offset+f.alreadyRead-l.fileStart)+" read size: "+y+" full size: "+f.size+")"),i.memcpy(f.data.buffer,f.alreadyRead,l,f.offset+f.alreadyRead-l.fileStart,y),f.alreadyRead+=y,l.usedBytes+=y,this.stream.logBufferLevel()}else return null}},v.prototype.releaseSample=function(e,s){var l=e.samples[s];return l.data?(this.samplesDataSize-=l.size,l.data=null,l.alreadyRead=0,l.size):0},v.prototype.getAllocatedSampleDataSize=function(){return this.samplesDataSize},v.prototype.getCodecs=function(){var e,s="";for(e=0;e<this.moov.traks.length;e++){var l=this.moov.traks[e];e>0&&(s+=","),s+=l.mdia.minf.stbl.stsd.entries[0].getCodec()}return s},v.prototype.getTrexById=function(e){var s;if(!this.moov||!this.moov.mvex)return null;for(s=0;s<this.moov.mvex.trexs.length;s++){var l=this.moov.mvex.trexs[s];if(l.track_id==e)return l}return null},v.prototype.getTrackById=function(e){if(this.moov===void 0)return null;for(var s=0;s<this.moov.traks.length;s++){var l=this.moov.traks[s];if(l.tkhd.track_id==e)return l}return null},v.prototype.items=[],v.prototype.itemsDataSize=0,v.prototype.flattenItemInfo=function(){var e=this.items,s,l,f,d=this.meta;if(d!=null&&d.hdlr!==void 0&&d.iinf!==void 0){for(s=0;s<d.iinf.item_infos.length;s++)f={},f.id=d.iinf.item_infos[s].item_ID,e[f.id]=f,f.ref_to=[],f.name=d.iinf.item_infos[s].item_name,d.iinf.item_infos[s].protection_index>0&&(f.protection=d.ipro.protections[d.iinf.item_infos[s].protection_index-1]),d.iinf.item_infos[s].item_type?f.type=d.iinf.item_infos[s].item_type:f.type="mime",f.content_type=d.iinf.item_infos[s].content_type,f.content_encoding=d.iinf.item_infos[s].content_encoding;if(d.iloc)for(s=0;s<d.iloc.items.length;s++){var y=d.iloc.items[s];switch(f=e[y.item_ID],y.data_reference_index!==0&&(a.warn("Item storage with reference to other files: not supported"),f.source=d.dinf.boxes[y.data_reference_index-1]),y.construction_method){case 0:break;case 1:a.warn("Item storage with construction_method : not supported");break;case 2:a.warn("Item storage with construction_method : not supported");break}for(f.extents=[],f.size=0,l=0;l<y.extents.length;l++)f.extents[l]={},f.extents[l].offset=y.extents[l].extent_offset+y.base_offset,f.extents[l].length=y.extents[l].extent_length,f.extents[l].alreadyRead=0,f.size+=f.extents[l].length}if(d.pitm&&(e[d.pitm.item_id].primary=!0),d.iref)for(s=0;s<d.iref.references.length;s++){var m=d.iref.references[s];for(l=0;l<m.references.length;l++)e[m.from_item_ID].ref_to.push({type:m.type,id:m.references[l]})}if(d.iprp)for(var _=0;_<d.iprp.ipmas.length;_++){var E=d.iprp.ipmas[_];for(s=0;s<E.associations.length;s++){var w=E.associations[s];for(f=e[w.id],f.properties===void 0&&(f.properties={},f.properties.boxes=[]),l=0;l<w.props.length;l++){var k=w.props[l];if(k.property_index>0&&k.property_index-1<d.iprp.ipco.boxes.length){var x=d.iprp.ipco.boxes[k.property_index-1];f.properties[x.type]=x,f.properties.boxes.push(x)}}}}}},v.prototype.getItem=function(e){var s,l;if(!this.meta)return null;if(l=this.items[e],!l.data&&l.size)l.data=new Uint8Array(l.size),l.alreadyRead=0,this.itemsDataSize+=l.size,a.debug("ISOFile","Allocating item #"+e+" of size "+l.size+" (total: "+this.itemsDataSize+")");else if(l.alreadyRead===l.size)return l;for(var f=0;f<l.extents.length;f++){var d=l.extents[f];if(d.alreadyRead!==d.length){var y=this.stream.findPosition(!0,d.offset+d.alreadyRead,!1);if(y>-1){s=this.stream.buffers[y];var m=s.byteLength-(d.offset+d.alreadyRead-s.fileStart);if(d.length-d.alreadyRead<=m)a.debug("ISOFile","Getting item #"+e+" extent #"+f+" data (alreadyRead: "+d.alreadyRead+" offset: "+(d.offset+d.alreadyRead-s.fileStart)+" read size: "+(d.length-d.alreadyRead)+" full extent size: "+d.length+" full item size: "+l.size+")"),i.memcpy(l.data.buffer,l.alreadyRead,s,d.offset+d.alreadyRead-s.fileStart,d.length-d.alreadyRead),s.usedBytes+=d.length-d.alreadyRead,this.stream.logBufferLevel(),l.alreadyRead+=d.length-d.alreadyRead,d.alreadyRead=d.length;else return a.debug("ISOFile","Getting item #"+e+" extent #"+f+" partial data (alreadyRead: "+d.alreadyRead+" offset: "+(d.offset+d.alreadyRead-s.fileStart)+" read size: "+m+" full extent size: "+d.length+" full item size: "+l.size+")"),i.memcpy(l.data.buffer,l.alreadyRead,s,d.offset+d.alreadyRead-s.fileStart,m),d.alreadyRead+=m,l.alreadyRead+=m,s.usedBytes+=m,this.stream.logBufferLevel(),null}else return null}}return l.alreadyRead===l.size?l:null},v.prototype.releaseItem=function(e){var s=this.items[e];if(s.data){this.itemsDataSize-=s.size,s.data=null,s.alreadyRead=0;for(var l=0;l<s.extents.length;l++){var f=s.extents[l];f.alreadyRead=0}return s.size}else return 0},v.prototype.processItems=function(e){for(var s in this.items){var l=this.items[s];this.getItem(l.id),e&&!l.sent&&(e(l),l.sent=!0,l.data=null)}},v.prototype.hasItem=function(e){for(var s in this.items){var l=this.items[s];if(l.name===e)return l.id}return-1},v.prototype.getMetaHandler=function(){return this.meta?this.meta.hdlr.handler:null},v.prototype.getPrimaryItem=function(){return!this.meta||!this.meta.pitm?null:this.getItem(this.meta.pitm.item_id)},v.prototype.itemToFragmentedTrackFile=function(e){var s=e||{},l=null;if(s.itemId?l=this.getItem(s.itemId):l=this.getPrimaryItem(),l==null)return null;var f=new v;f.discardMdatData=!1;var d={type:l.type,description_boxes:l.properties.boxes};l.properties.ispe&&(d.width=l.properties.ispe.image_width,d.height=l.properties.ispe.image_height);var y=f.addTrack(d);return y?(f.addSample(y,l.data),f):null},v.prototype.write=function(e){for(var s=0;s<this.boxes.length;s++)this.boxes[s].write(e)},v.prototype.createFragment=function(e,s,l){var f=this.getTrackById(e),d=this.getSample(f,s);if(d==null)return d=f.samples[s],this.nextSeekPosition?this.nextSeekPosition=Math.min(d.offset+d.alreadyRead,this.nextSeekPosition):this.nextSeekPosition=f.samples[s].offset+d.alreadyRead,null;var y=l||new i;y.endianness=i.BIG_ENDIAN;var m=this.createSingleSampleMoof(d);m.write(y),m.trafs[0].truns[0].data_offset=m.size+8,a.debug("MP4Box","Adjusting data_offset with new value "+m.trafs[0].truns[0].data_offset),y.adjustUint32(m.trafs[0].truns[0].data_offset_position,m.trafs[0].truns[0].data_offset);var _=new o.mdatBox;return _.data=d.data,_.write(y),y},v.writeInitializationSegment=function(e,s,l,f){var d;a.debug("ISOFile","Generating initialization segment");var y=new i;y.endianness=i.BIG_ENDIAN,e.write(y);var m=s.add("mvex");for(l&&m.add("mehd").set("fragment_duration",l),d=0;d<s.traks.length;d++)m.add("trex").set("track_id",s.traks[d].tkhd.track_id).set("default_sample_description_index",1).set("default_sample_duration",f).set("default_sample_size",0).set("default_sample_flags",1<<16);return s.write(y),y.buffer},v.prototype.save=function(e){var s=new i;s.endianness=i.BIG_ENDIAN,this.write(s),s.save(e)},v.prototype.getBuffer=function(){var e=new i;return e.endianness=i.BIG_ENDIAN,this.write(e),e.buffer},v.prototype.initializeSegmentation=function(){var e,s,l,f;for(this.onSegment===null&&a.warn("MP4Box","No segmentation callback set!"),this.isFragmentationInitialized||(this.isFragmentationInitialized=!0,this.nextMoofNumber=0,this.resetTables()),s=[],e=0;e<this.fragmentedTracks.length;e++){var d=new o.moovBox;d.mvhd=this.moov.mvhd,d.boxes.push(d.mvhd),l=this.getTrackById(this.fragmentedTracks[e].id),d.boxes.push(l),d.traks.push(l),f={},f.id=l.tkhd.track_id,f.user=this.fragmentedTracks[e].user,f.buffer=v.writeInitializationSegment(this.ftyp,d,this.moov.mvex&&this.moov.mvex.mehd?this.moov.mvex.mehd.fragment_duration:void 0,this.moov.traks[e].samples.length>0?this.moov.traks[e].samples[0].duration:0),s.push(f)}return s},o.Box.prototype.printHeader=function(e){this.size+=8,this.size>r&&(this.size+=8),this.type==="uuid"&&(this.size+=16),e.log(e.indent+"size:"+this.size),e.log(e.indent+"type:"+this.type)},o.FullBox.prototype.printHeader=function(e){this.size+=4,o.Box.prototype.printHeader.call(this,e),e.log(e.indent+"version:"+this.version),e.log(e.indent+"flags:"+this.flags)},o.Box.prototype.print=function(e){this.printHeader(e)},o.ContainerBox.prototype.print=function(e){this.printHeader(e);for(var s=0;s<this.boxes.length;s++)if(this.boxes[s]){var l=e.indent;e.indent+=" ",this.boxes[s].print(e),e.indent=l}},v.prototype.print=function(e){e.indent="";for(var s=0;s<this.boxes.length;s++)this.boxes[s]&&this.boxes[s].print(e)},o.mvhdBox.prototype.print=function(e){o.FullBox.prototype.printHeader.call(this,e),e.log(e.indent+"creation_time: "+this.creation_time),e.log(e.indent+"modification_time: "+this.modification_time),e.log(e.indent+"timescale: "+this.timescale),e.log(e.indent+"duration: "+this.duration),e.log(e.indent+"rate: "+this.rate),e.log(e.indent+"volume: "+(this.volume>>8)),e.log(e.indent+"matrix: "+this.matrix.join(", ")),e.log(e.indent+"next_track_id: "+this.next_track_id)},o.tkhdBox.prototype.print=function(e){o.FullBox.prototype.printHeader.call(this,e),e.log(e.indent+"creation_time: "+this.creation_time),e.log(e.indent+"modification_time: "+this.modification_time),e.log(e.indent+"track_id: "+this.track_id),e.log(e.indent+"duration: "+this.duration),e.log(e.indent+"volume: "+(this.volume>>8)),e.log(e.indent+"matrix: "+this.matrix.join(", ")),e.log(e.indent+"layer: "+this.layer),e.log(e.indent+"alternate_group: "+this.alternate_group),e.log(e.indent+"width: "+this.width),e.log(e.indent+"height: "+this.height)};var p={};p.createFile=function(e,s){var l=e!==void 0?e:!0,f=new v(s);return f.discardMdatData=!l,f},h.createFile=p.createFile})(vo);class Rf{constructor(a,t){ve(this,"emitter",Zn());ve(this,"eventListenerMg",[]);ve(this,"isDestory",!1);ve(this,"url");ve(this,"httpAxios");ve(this,"audioMediaSource");ve(this,"videoMediaSource");ve(this,"audioUrl");ve(this,"videoUrl");ve(this,"isKeepGetBuffer",!1);ve(this,"chunkStart",0);ve(this,"chunkSize",3e6);ve(this,"isEnd",!1);ve(this,"totalLength",0);ve(this,"chunkRanges",[]);ve(this,"mp4boxfile");ve(this,"movieInfo");ve(this,"pendingInits",0);ve(this,"isJumpMoov",!1);ve(this,"onMediaSeekingDebounce");ve(this,"initCpl",new Xi);ve(this,"isInit",!1);ve(this,"getMediaBufferLock",new Xi);this.httpAxios=a,this.url=t,this.initCpl.toPromise().then(()=>{this.isInit=!0}),this.getMediaBufferLock.resolve(!0),this.audioMediaSource=new MediaSource,this.videoMediaSource=new MediaSource,this.audioUrl=URL.createObjectURL(this.audioMediaSource),this.videoUrl=URL.createObjectURL(this.videoMediaSource);let i=2;this.addTargetEventListener(this.videoMediaSource,"sourceopen",()=>{i--,i==0&&this.onSourceOpen()},{once:!0}),this.addTargetEventListener(this.audioMediaSource,"sourceopen",()=>{i--,i==0&&this.onSourceOpen()},{once:!0}),this.onMediaSeekingDebounce=to(r=>{let n=r.currentTime;console.log("onMediaSeeking "+n);let u=!0;for(let o=0;o<r.buffered.length;o++){const c=r.buffered.start(o),g=r.buffered.end(o);if(n>=c&&n<=g){u=!1;break}}if(u){let{offset:o}=this.mp4boxfile.seek(n,!0);this.chunkStart=o}},500,!0)}getMediaBuffer(){return oe(this,null,function*(){yield this.getMediaBufferLock.toPromise();let a=this.chunkStart,t=this.chunkStart+this.chunkSize-1;if(this.totalLength&&a>=this.totalLength)return;this.totalLength&&t>=this.totalLength&&(t=this.totalLength-1),console.log(`getMediaBuffer rangeStart:${this.chunkStart}`),this.getMediaBufferLock=new Xi;let i=yield this.httpAxios.get(this.url,{headers:{Range:`bytes=${a}-${t}`},responseType:"arraybuffer"});if(this.isDestory){this.getMediaBufferLock.reject(!1);return}if(a==0)try{this.totalLength=parseInt(i.headers["content-range"].split("/")[1])}catch(u){}else this.totalLength||i.data.byteLength!==this.chunkSize&&(this.totalLength=a+i.data.byteLength);this.totalLength&&a+this.chunkSize>=this.totalLength&&!this.isJumpMoov&&(this.isEnd=!0);let r=i.data;r.fileStart=a;let n=this.mp4boxfile.appendBuffer(r);this.isJumpMoov&&this.movieInfo?(this.isJumpMoov=!1,this.chunkStart=this.chunkSize):this.chunkStart=n,!this.movieInfo&&a+r.byteLength!=n&&(this.isJumpMoov=!0),this.movieInfo&&this.totalLength,this.isEnd&&this.mp4boxfile.flush(),this.getMediaBufferLock.resolve(!0)})}keepGetMediaBuffer(){return oe(this,null,function*(){if(this.isKeepGetBuffer)return;this.isKeepGetBuffer=!0;let a=()=>oe(this,null,function*(){if(!!this.isKeepGetBuffer){if(this.isEnd||this.isDestory){this.isKeepGetBuffer=!1;return}yield this.getMediaBuffer(),setTimeout(()=>{a()},50)}});a()})}onSourceOpen(){this.initMp4boxfile(),this.chunkStart=0,this.isEnd=!1,this.totalLength=0,this.keepGetMediaBuffer()}onMediaPause(a){return oe(this,null,function*(){!this.isInit||(this.isKeepGetBuffer=!1)})}onMediaSeeking(a){return oe(this,null,function*(){!this.isInit||this.onMediaSeekingDebounce(a)})}onMediaWaiting(a){return oe(this,null,function*(){if(!this.isInit)return;let t=a.currentTime;console.log("onMediaWaiting "+t),this.isKeepGetBuffer||(console.log("keepGetMediaBuffer"),this.keepGetMediaBuffer())})}onMediaTimeupdate(a){return oe(this,null,function*(){if(!this.isInit||a.paused)return;let t=a.currentTime;console.log("onMediaTimeupdate "+t);let i=!0;for(let r=0;r<a.buffered.length;r++){const n=a.buffered.start(r),u=a.buffered.end(r);let o=t+10;if(o>a.duration&&(o=a.duration),t>=n&&o<=u){i=!1;break}}i&&!this.isKeepGetBuffer?(console.log(`needKeep\uFF1A${i}`),this.keepGetMediaBuffer()):!i&&this.isKeepGetBuffer&&(console.log(`needKeep\uFF1A${i}`),this.isKeepGetBuffer=!1)})}initMp4boxfile(){this.mp4boxfile=vo.createFile(),this.mp4boxfile.onMoovStart=()=>{console.log("mp4boxfile:onMoovStart")},this.mp4boxfile.onReady=a=>{console.log("mp4boxfile:onReady ",a),this.movieInfo=a,this.movieInfo.isFragmented?(this.videoMediaSource.duration=this.movieInfo.fragment_duration/this.movieInfo.timescale,this.audioMediaSource.duration=this.movieInfo.fragment_duration/this.movieInfo.timescale):(this.videoMediaSource.duration=this.movieInfo.duration/this.movieInfo.timescale,this.audioMediaSource.duration=this.movieInfo.duration/this.movieInfo.timescale),console.log(this.movieInfo),this.movieInfo.tracks.filter(i=>i.type=="video"||i.type=="audio").forEach(i=>{var r=i.id,n=`video/mp4; codecs="${i.codec}"`;if(!MediaSource.isTypeSupported(n))throw this.emitter.emit("error",new Error(`\u6D4F\u89C8\u5668\u4E0D\u652F\u6301${n}`)),new Error(`MSE MIME type ${n} not supported for creation of a SourceBuffer for track id ${r}`);try{var u=i.type=="video"?this.videoMediaSource:this.audioMediaSource,o={type:i.type,mediaSource:u,id:r,sourceBuffer:u.addSourceBuffer(n),pendingAppends:[],sampleNum:0,is_last:!1};this.mp4boxfile.setSegmentOptions(o.id,o,{nbSamples:Math.floor(100)})}catch(c){console.error(`MSE - SourceBuffer # ${r} Cannot create buffer with type ${n}`,c)}});var t=this.mp4boxfile.initializeSegmentation();t.forEach(i=>{var r=i.user,n=r.sourceBuffer;this.addTargetEventListener(n,"updateend",u=>{r.sampleNum=0,this.addTargetEventListener(n,"updateend",()=>{this.onSourceBufferUpdateend(r,!0)}),this.onSourceBufferUpdateend(r,!0),this.pendingInits--,this.pendingInits===0&&(this.mp4boxfile.seek(0,!0),this.mp4boxfile.start(),this.initCpl.resolve(!0))},{once:!0}),n.appendBuffer(i.buffer),this.pendingInits++})},this.mp4boxfile.onSidx=a=>{console.log("mp4boxfile:onSidx ",a)},this.mp4boxfile.onItem=a=>{console.log("mp4boxfile:onItem ",a)},this.mp4boxfile.onSegment=(a,t,i,r,n)=>{console.log("mp4boxfile:onSegment ",{id:a,user:t,buffer:i,sampleNum:r,is_last:n}),t.pendingAppends.push({id:a,buffer:i,sampleNum:r,is_last:n}),this.onSourceBufferUpdateend(t,!1)},this.mp4boxfile.onSamples=(a,t,i)=>{console.log("mp4boxfile:onSamples ",{id:a,user:t,samples:i})}}onSourceBufferUpdateend(a,t){if(t===!0&&(a.sampleNum&&(this.mp4boxfile.releaseUsedSamples(a.id,a.sampleNum),a.sampleNum=0),a.is_last&&a.mediaSource.endOfStream()),a.mediaSource.readyState==="open"&&a.sourceBuffer.updating===!1&&a.pendingAppends.length>0){var i=a.pendingAppends.shift();a.sampleNum=i.sampleNum,a.is_last=i.is_last,a.sourceBuffer.appendBuffer(i.buffer)}}addChunkRange(a,t){this.chunkRanges.push({start:a,end:t}),this.chunkRanges.sort((i,r)=>i.start-r.start);for(let i=0;i<this.chunkRanges.length-1;i++){const r=this.chunkRanges[i],n=this.chunkRanges[i+1];if(r.end+1==n.start){r.end=n.end,this.chunkRanges.splice(i+1,1),i--;continue}}}isInChunkRanges(a,t){return this.chunkRanges.some(i=>!!(a>=i.start&&a<=i.end||t&&t<=i.end&&t>=i.start))}addTargetEventListener(a,t,i,r){return oe(this,null,function*(){a.addEventListener(t,i,r),this.eventListenerMg.push({target:a,type:t,callback:i,options:r})})}removeAllTargetEventListener(){return oe(this,null,function*(){this.eventListenerMg.forEach(a=>{a.target.removeEventListener(a.type,a.callback,a.options)}),this.eventListenerMg=[]})}destory(){this.removeAllTargetEventListener(),this.emitter.off("*"),this.audioUrl&&URL.revokeObjectURL(this.audioUrl),this.videoUrl&&URL.revokeObjectURL(this.videoUrl),this.isKeepGetBuffer=!1,this.initCpl.reject(!1),this.mp4boxfile=null,this.videoMediaSource=null,this.audioMediaSource=null,this.isDestory=!0}on(a,t){this.emitter.on(a,t)}}class Uf{constructor(){ve(this,"emitter",Zn());ve(this,"bridgeIframe");ve(this,"bridgeWindow");ve(this,"bridgeOrigin");ve(this,"_src","");ve(this,"_currentTime",0);ve(this,"duration",0);ve(this,"paused",!0);ve(this,"buffered",[])}bind(a){this.bridgeIframe=a,this.bridgeOrigin=this.bridgeIframe.src.match(/(http|https):\/\/[A-Za-z0-9_\-\+.:@]*/)[0],this.bridgeWindow=this.bridgeIframe.contentWindow,window.addEventListener("message",t=>{if(t.origin!=this.bridgeOrigin)return;let i=t.data;i.event==="onElementEvent"&&(this._currentTime=i.data.eventData.currentTime,this.duration=i.data.eventData.duration,this.paused=i.data.eventData.paused,this.emitter.emit(i.data.eventName,i.data.eventData))})}get src(){return this._src}set src(a){this._src=a,this.setElementProperty("src",a)}get currentTime(){return this._currentTime}set currentTime(a){this._currentTime=a,this.setElementProperty("currentTime",a)}play(){this.invokeElementMethod("play")}pause(){this.invokeElementMethod("pause")}load(){this.invokeElementMethod("load")}invokeElementMethod(a,t=[]){this.bridgeWindow.postMessage({event:"invokeElementMethod",data:{name:a,args:t}},this.bridgeOrigin)}setElementProperty(a,t){this.bridgeWindow.postMessage({event:"setElementProperty",data:{name:a,value:t}},this.bridgeOrigin)}getElementProperty(a){}addEventListener(a,t,i={once:!1}){if(i.once){let r=n=>{this.emitter.off(a,r),t(n)};this.emitter.on(a,r)}else this.emitter.on(a,t)}removeEventListener(a,t){this.emitter.off(a,t)}isBridgeUrl(a){return this.bridgeOrigin?!!(a.startsWith("http://127.0.0.1")||a.startsWith("http://192.168.")):!1}}class Lf{constructor(){ve(this,"xgplayer");ve(this,"isFirstPlay",!1)}get duration(){return this.xgplayer.duration}get paused(){return this.xgplayer.paused}get buffered(){return this.xgplayer.buffered}bind(a){this.xgplayer=a}get src(){return this.xgplayer.root.style.opacity=="0"?"":this.xgplayer.src}set src(a){if(a==""){this.xgplayer.pause(),this.xgplayer.root.style.opacity="0",this.xgplayer.volume=0;return}this.xgplayer.started?this.xgplayer.src=a:this.xgplayer.start(a),this.xgplayer.once("canplay",()=>{this.xgplayer.root.style.opacity="1",this.xgplayer.volume=1,this.isFirstPlay||(this.isFirstPlay=!0,this.xgplayer.video.removeAttribute("tabindex"))})}get currentTime(){return this.xgplayer.currentTime}set currentTime(a){this.xgplayer.currentTime=a}play(){this.xgplayer.play()}pause(){this.xgplayer.pause()}load(){}addEventListener(a,t,i={once:!1}){i.once?this.xgplayer.once(a,t):this.xgplayer.on(a,t)}removeEventListener(a,t){this.xgplayer.off(a,t)}isXgplayerUrl(a){return a.includes("/m3u8/file")}}class Pf{constructor(){ve(this,"emitter",Zn());ve(this,"naviteAudioEl",new Audio);ve(this,"bridgeAudioEl",new Uf);ve(this,"xgplayerAudioEl",new Lf);ve(this,"activeType","navite")}bindBrigeIframe(a){this.bridgeAudioEl.bind(a)}bindXgplayer(a){this.xgplayerAudioEl.bind(a)}get src(){return this.getActiveAudio().src}set src(a){a&&(this.xgplayerAudioEl.isXgplayerUrl(a)?this.activeType="xgplayer":this.bridgeAudioEl.isBridgeUrl(a)?this.activeType="bridge":this.activeType="navite",this.activeType=="navite"&&this.isPrivateUrl(a)&&location.href.startsWith("https://")&&(a=a.replace("http://","https://"))),this.getActiveAudio().src=a}get currentTime(){return this.getActiveAudio().currentTime}set currentTime(a){this.getActiveAudio().currentTime=a}get duration(){return this.getActiveAudio().duration}get paused(){return this.getActiveAudio().paused}get buffered(){return this.getActiveAudio().buffered}play(){this.getActiveAudio().play()}pause(){this.getActiveAudio().pause()}load(){this.getActiveAudio().load()}addEventListener(a,t,i){let r=()=>{this.activeType==="navite"&&t()},n=()=>{this.activeType==="bridge"&&t()},u=()=>{this.activeType==="xgplayer"&&t()};this.naviteAudioEl.addEventListener(a,r,i),this.bridgeAudioEl.addEventListener(a,n,i),this.xgplayerAudioEl.addEventListener(a,u,i)}removeEventListener(a,t,i){}getActiveAudio(){if(this.activeType=="navite")return this.naviteAudioEl;if(this.activeType=="bridge")return this.bridgeAudioEl;if(this.activeType=="xgplayer")return this.xgplayerAudioEl}setMuted(a){try{this.getActiveAudio().muted=a}catch(t){}}isPrivateUrl(a){return!!(a.startsWith("http://127.0.0.1")||a.startsWith("http://192.168.")||a.startsWith("http://pi.lan."))}}var yo={exports:{}};(function(h,a){(function(i,r){h.exports=r()})(pn,function(){return function(t){var i={};function r(n){if(i[n])return i[n].exports;var u=i[n]={i:n,l:!1,exports:{}};return t[n].call(u.exports,u,u.exports,r),u.l=!0,u.exports}return r.m=t,r.c=i,r.d=function(n,u,o){r.o(n,u)||Object.defineProperty(n,u,{enumerable:!0,get:o})},r.r=function(n){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},r.t=function(n,u){if(u&1&&(n=r(n)),u&8||u&4&&typeof n=="object"&&n&&n.__esModule)return n;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:n}),u&2&&typeof n!="string")for(var c in n)r.d(o,c,function(g){return n[g]}.bind(null,c));return o},r.n=function(n){var u=n&&n.__esModule?function(){return n.default}:function(){return n};return r.d(u,"a",u),u},r.o=function(n,u){return Object.prototype.hasOwnProperty.call(n,u)},r.p="",r(r.s=79)}([function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.util=i.PresentationMode=void 0,i.createDom=c,i.hasClass=g,i.addClass=v,i.removeClass=p,i.toggleClass=e,i.findDom=s,i.padStart=l,i.format=f,i.event=d,i.typeOf=y,i.deepCopy=m,i.getBgImage=_,i.copyDom=E,i._setInterval=w,i._clearInterval=k,i.createImgBtn=x,i.isWeiXin=S,i.isUc=P,i.computeWatchDur=U,i.offInDestroy=R,i.on=C,i.once=A,i.getBuffered2=b,i.checkIsBrowser=O,i.setStyle=W,i.checkWebkitSetPresentationMode=K;var n=r(7),u=o(n);function o(G){return G&&G.__esModule?G:{default:G}}function c(){var G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"div",B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},z=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",$=document.createElement(G);return $.className=z,$.innerHTML=B,Object.keys(j).forEach(function(J){var Q=J,ne=j[J];G==="video"||G==="audio"?ne&&$.setAttribute(Q,ne):$.setAttribute(Q,ne)}),$}function g(G,B){return G?G.classList?Array.prototype.some.call(G.classList,function(j){return j===B}):G.className?!!G.className.match(new RegExp("(\\s|^)"+B+"(\\s|$)")):!1:!1}function v(G,B){!G||(G.classList?B.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(j){j&&G.classList.add(j)}):g(G,B)||(G.className+=" "+B))}function p(G,B){!G||(G.classList?B.split(/\s+/g).forEach(function(j){G.classList.remove(j)}):g(G,B)&&B.split(/\s+/g).forEach(function(j){var z=new RegExp("(\\s|^)"+j+"(\\s|$)");G.className=G.className.replace(z," ")}))}function e(G,B){!G||B.split(/\s+/g).forEach(function(j){g(G,j)?p(G,j):v(G,j)})}function s(){var G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,B=arguments[1],j=void 0;try{j=G.querySelector(B)}catch(z){B.indexOf("#")===0&&(j=G.getElementById(B.slice(1)))}return j}function l(G,B,j){for(var z=String(j),$=B>>0,J=Math.ceil($/z.length),Q=[],ne=String(G);J--;)Q.push(z);return Q.join("").substring(0,$-ne.length)+ne}function f(G){if(window.isNaN(G))return"";var B=l(Math.floor(G/3600),2,0),j=l(Math.floor((G-B*3600)/60),2,0),z=l(Math.floor(G-B*3600-j*60),2,0);return(B==="00"?[j,z]:[B,j,z]).join(":")}function d(G){if(G.touches){var B=G.touches[0]||G.changedTouches[0];G.clientX=B.clientX||0,G.clientY=B.clientY||0,G.offsetX=B.pageX-B.target.offsetLeft,G.offsetY=B.pageY-B.target.offsetTop}G._target=G.target||G.srcElement}function y(G){return Object.prototype.toString.call(G).match(/([^\s.*]+)(?=]$)/g)[0]}function m(G,B){if(y(B)==="Object"&&y(G)==="Object")return Object.keys(B).forEach(function(j){y(B[j])==="Object"&&!(B[j]instanceof Node)?G[j]?m(G[j],B[j]):G[j]=B[j]:y(B[j])==="Array"?G[j]=y(G[j])==="Array"?G[j].concat(B[j]):B[j]:G[j]=B[j]}),G}function _(G){var B=(G.currentStyle||window.getComputedStyle(G,null)).backgroundImage;if(!B||B==="none")return"";var j=document.createElement("a");return j.href=B.replace(/url\("|"\)/g,""),j.href}function E(G){if(G&&G.nodeType===1){var B=document.createElement(G.tagName);return Array.prototype.forEach.call(G.attributes,function(j){B.setAttribute(j.name,j.value)}),G.innerHTML&&(B.innerHTML=G.innerHTML),B}else return""}function w(G,B,j,z){G._interval[B]||(G._interval[B]=setInterval(j.bind(G),z))}function k(G,B){clearInterval(G._interval[B]),G._interval[B]=null}function x(G,B,j,z){var $=c("xg-"+G,"",{},"xgplayer-"+G+"-img");if($.style.backgroundImage='url("'+B+'")',j&&z){var J=void 0,Q=void 0,ne=void 0;["px","rem","em","pt","dp","vw","vh","vm","%"].every(function(Ee){return j.indexOf(Ee)>-1&&z.indexOf(Ee)>-1?(J=Number(j.slice(0,j.indexOf(Ee)).trim()),Q=Number(z.slice(0,z.indexOf(Ee)).trim()),ne=Ee,!1):!0}),$.style.width=""+J+ne,$.style.height=""+Q+ne,$.style.backgroundSize=""+J+ne+" "+Q+ne,G==="start"?$.style.margin="-"+Q/2+ne+" auto auto -"+J/2+ne:$.style.margin="auto 5px auto 5px"}return $}function S(){var G=window.navigator.userAgent.toLowerCase();return G.indexOf("micromessenger")>-1}function P(){var G=window.navigator.userAgent.toLowerCase();return G.indexOf("ucbrowser")>-1}function U(){for(var G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],B=[],j=0;j<G.length;j++)if(!(!G[j].end||G[j].begin<0||G[j].end<0||G[j].end<G[j].begin))if(B.length<1)B.push({begin:G[j].begin,end:G[j].end});else for(var z=0;z<B.length;z++){var $=G[j].begin,J=G[j].end;if(J<B[z].begin){B.splice(z,0,{begin:$,end:J});break}else if($>B[z].end){if(z>B.length-2){B.push({begin:$,end:J});break}}else{var Q=B[z].begin,ne=B[z].end;B[z].begin=Math.min($,Q),B[z].end=Math.max(J,ne);break}}for(var Ee=0,we=0;we<B.length;we++)Ee+=B[we].end-B[we].begin;return Ee}function R(G,B,j,z){function $(){G.off(B,j),G.off(z,$)}G.once(z,$)}function C(G,B,j,z){if(z)G.on(B,j),R(G,B,j,z);else{var $=function J(Q){j(Q),G.off(B,J)};G.on(B,$)}}function A(G,B,j,z){if(z)G.once(B,j),R(G,B,j,z);else{var $=function J(Q){j(Q),G.off(B,J)};G.once(B,$)}}function b(G){for(var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5,j=[],z=0;z<G.length;z++)j.push({start:G.start(z)<.5?0:G.start(z),end:G.end(z)});j.sort(function(Ee,we){var Ae=Ee.start-we.start;return Ae||we.end-Ee.end});var $=[];if(B)for(var J=0;J<j.length;J++){var Q=$.length;if(Q){var ne=$[Q-1].end;j[J].start-ne<B?j[J].end>ne&&($[Q-1].end=j[J].end):$.push(j[J])}else $.push(j[J])}else $=j;return new u.default($)}function O(){return!(typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined")}function W(G,B,j){var z=G.style;try{z[B]=j}catch($){z.setProperty(B,j)}}i.PresentationMode={PIP:"picture-in-picture",INLINE:"inline",FULLSCREEN:"fullscreen"};function K(G){return typeof G.webkitSetPresentationMode=="function"}i.util={createDom:c,hasClass:g,addClass:v,removeClass:p,toggleClass:e,findDom:s,padStart:l,format:f,event:d,typeOf:y,deepCopy:m,getBgImage:_,copyDom:E,setInterval:w,clearInterval:k,createImgBtn:x,isWeiXin:S,isUc:P,computeWatchDur:U,offInDestroy:R,on:C,once:A,getBuffered2:b,checkIsBrowser:O,setStyle:W}},function(t,i){t.exports=function(u){var o=[];return o.toString=function(){return this.map(function(g){var v=r(g,u);return g[2]?"@media "+g[2]+"{"+v+"}":v}).join("")},o.i=function(c,g){typeof c=="string"&&(c=[[null,c,""]]);for(var v={},p=0;p<this.length;p++){var e=this[p][0];typeof e=="number"&&(v[e]=!0)}for(p=0;p<c.length;p++){var s=c[p];(typeof s[0]!="number"||!v[s[0]])&&(g&&!s[2]?s[2]=g:g&&(s[2]="("+s[2]+") and ("+g+")"),o.push(s))}},o};function r(u,o){var c=u[1]||"",g=u[3];if(!g)return c;if(o&&typeof btoa=="function"){var v=n(g),p=g.sources.map(function(e){return"/*# sourceURL="+g.sourceRoot+e+" */"});return[c].concat(p).concat([v]).join(`
`)}return[c].join(`
`)}function n(u){var o=btoa(unescape(encodeURIComponent(JSON.stringify(u)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,"+o;return"/*# "+c+" */"}},function(t,i,r){var n={},u=function(U){var R;return function(){return typeof R=="undefined"&&(R=U.apply(this,arguments)),R}},o=u(function(){return window&&document&&document.all&&!window.atob}),c=function(U){return document.querySelector(U)},g=function(U){var R={};return function(C){if(typeof C=="function")return C();if(typeof R[C]=="undefined"){var A=c.call(this,C);if(window.HTMLIFrameElement&&A instanceof window.HTMLIFrameElement)try{A=A.contentDocument.head}catch(b){A=null}R[C]=A}return R[C]}}(),v=null,p=0,e=[],s=r(36);t.exports=function(U,R){if(typeof DEBUG!="undefined"&&DEBUG&&typeof document!="object")throw new Error("The style-loader cannot be used in a non-browser environment");R=R||{},R.attrs=typeof R.attrs=="object"?R.attrs:{},!R.singleton&&typeof R.singleton!="boolean"&&(R.singleton=o()),R.insertInto||(R.insertInto="head"),R.insertAt||(R.insertAt="bottom");var C=f(U,R);return l(C,R),function(b){for(var O=[],W=0;W<C.length;W++){var K=C[W],G=n[K.id];G.refs--,O.push(G)}if(b){var B=f(b,R);l(B,R)}for(var W=0;W<O.length;W++){var G=O[W];if(G.refs===0){for(var j=0;j<G.parts.length;j++)G.parts[j]();delete n[G.id]}}}};function l(U,R){for(var C=0;C<U.length;C++){var A=U[C],b=n[A.id];if(b){b.refs++;for(var O=0;O<b.parts.length;O++)b.parts[O](A.parts[O]);for(;O<A.parts.length;O++)b.parts.push(w(A.parts[O],R))}else{for(var W=[],O=0;O<A.parts.length;O++)W.push(w(A.parts[O],R));n[A.id]={id:A.id,refs:1,parts:W}}}}function f(U,R){for(var C=[],A={},b=0;b<U.length;b++){var O=U[b],W=R.base?O[0]+R.base:O[0],K=O[1],G=O[2],B=O[3],j={css:K,media:G,sourceMap:B};A[W]?A[W].parts.push(j):C.push(A[W]={id:W,parts:[j]})}return C}function d(U,R){var C=g(U.insertInto);if(!C)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var A=e[e.length-1];if(U.insertAt==="top")A?A.nextSibling?C.insertBefore(R,A.nextSibling):C.appendChild(R):C.insertBefore(R,C.firstChild),e.push(R);else if(U.insertAt==="bottom")C.appendChild(R);else if(typeof U.insertAt=="object"&&U.insertAt.before){var b=g(U.insertInto+" "+U.insertAt.before);C.insertBefore(R,b)}else throw new Error(`[Style Loader]

 Invalid value for parameter 'insertAt' ('options.insertAt') found.
 Must be 'top', 'bottom', or Object.
 (https://github.com/webpack-contrib/style-loader#insertat)
`)}function y(U){if(U.parentNode===null)return!1;U.parentNode.removeChild(U);var R=e.indexOf(U);R>=0&&e.splice(R,1)}function m(U){var R=document.createElement("style");return U.attrs.type="text/css",E(R,U.attrs),d(U,R),R}function _(U){var R=document.createElement("link");return U.attrs.type="text/css",U.attrs.rel="stylesheet",E(R,U.attrs),d(U,R),R}function E(U,R){Object.keys(R).forEach(function(C){U.setAttribute(C,R[C])})}function w(U,R){var C,A,b,O;if(R.transform&&U.css)if(O=R.transform(U.css),O)U.css=O;else return function(){};if(R.singleton){var W=p++;C=v||(v=m(R)),A=x.bind(null,C,W,!1),b=x.bind(null,C,W,!0)}else U.sourceMap&&typeof URL=="function"&&typeof URL.createObjectURL=="function"&&typeof URL.revokeObjectURL=="function"&&typeof Blob=="function"&&typeof btoa=="function"?(C=_(R),A=P.bind(null,C,R),b=function(){y(C),C.href&&URL.revokeObjectURL(C.href)}):(C=m(R),A=S.bind(null,C),b=function(){y(C)});return A(U),function(G){if(G){if(G.css===U.css&&G.media===U.media&&G.sourceMap===U.sourceMap)return;A(U=G)}else b()}}var k=function(){var U=[];return function(R,C){return U[R]=C,U.filter(Boolean).join(`
`)}}();function x(U,R,C,A){var b=C?"":A.css;if(U.styleSheet)U.styleSheet.cssText=k(R,b);else{var O=document.createTextNode(b),W=U.childNodes;W[R]&&U.removeChild(W[R]),W.length?U.insertBefore(O,W[R]):U.appendChild(O)}}function S(U,R){var C=R.css,A=R.media;if(A&&U.setAttribute("media",A),U.styleSheet)U.styleSheet.cssText=C;else{for(;U.firstChild;)U.removeChild(U.firstChild);U.appendChild(document.createTextNode(C))}}function P(U,R,C){var A=C.css,b=C.sourceMap,O=R.convertToAbsoluteUrls===void 0&&b;(R.convertToAbsoluteUrls||O)&&(A=s(A)),b&&(A+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(b))))+" */");var W=new Blob([A],{type:"text/css"}),K=U.href;U.href=URL.createObjectURL(W),K&&URL.revokeObjectURL(K)}},function(t,i,r){var n=r(24)();t.exports=function(u){return u!==n&&u!==null}},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(8);function u(g,v){if(!(g instanceof v))throw new TypeError("Cannot call a class as a function")}var o={network:{code:1,msg:"\u89C6\u9891\u4E0B\u8F7D\u9519\u8BEF",remark:"\u53EA\u8981\u89C6\u9891\u4E0B\u8F7D\u9519\u8BEF\u5C31\u4F7F\u7528\u6B64\u7C7B\u578B\uFF0C\u65E0\u8BBA\u662Fvideo\u672C\u8EAB\u7684\u8D85\u65F6\u8FD8\u662Fxhr\u7684\u5206\u6BB5\u8BF7\u6C42\u8D85\u65F6\u6216\u8005\u8D44\u6E90\u4E0D\u5B58\u5728"},mse:{code:2,msg:"\u6D41\u8FFD\u52A0\u9519\u8BEF",remark:"\u8FFD\u52A0\u6D41\u7684\u65F6\u5019\u5982\u679C\u7C7B\u578B\u4E0D\u5BF9\u3001\u65E0\u6CD5\u88AB\u6B63\u786E\u89E3\u7801\u5219\u4F1A\u89E6\u53D1\u6B64\u7C7B\u9519\u8BEF"},parse:{code:3,msg:"\u89E3\u6790\u9519\u8BEF",remark:"mp4\u3001hls\u3001flv\u6211\u4EEC\u90FD\u662F\u4F7F\u7528js\u8FDB\u884C\u683C\u5F0F\u89E3\u6790\uFF0C\u5982\u679C\u89E3\u6790\u5931\u8D25\u5219\u4F1A\u89E6\u53D1\u6B64\u7C7B\u9519\u8BEF"},format:{code:4,msg:"\u683C\u5F0F\u9519\u8BEF",remark:"\u5982\u679C\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u7684\u683C\u5F0F\u5BFC\u81F4\u64AD\u653E\u9519\u8BEF"},decoder:{code:5,msg:"\u89E3\u7801\u9519\u8BEF",remark:"\u6D4F\u89C8\u5668\u89E3\u7801\u5F02\u5E38\u4F1A\u629B\u51FA\u6B64\u7C7B\u578B\u9519\u8BEF"},runtime:{code:6,msg:"\u8BED\u6CD5\u9519\u8BEF",remark:"\u64AD\u653E\u5668\u8BED\u6CD5\u9519\u8BEF"},timeout:{code:7,msg:"\u64AD\u653E\u8D85\u65F6",remark:"\u64AD\u653E\u8FC7\u7A0B\u4E2D\u65E0\u6CD5\u6B63\u5E38\u8BF7\u6C42\u4E0B\u4E00\u4E2A\u5206\u6BB5\u5BFC\u81F4\u64AD\u653E\u4E2D\u65AD"},other:{code:8,msg:"\u5176\u4ED6\u9519\u8BEF",remark:"\u4E0D\u53EF\u77E5\u7684\u9519\u8BEF\u6216\u88AB\u5FFD\u7565\u7684\u9519\u8BEF\u7C7B\u578B"}},c=function g(v,p,e,s,l,f,d,y){var m=arguments.length>8&&arguments[8]!==void 0?arguments[8]:{line:"",handle:"",msg:"",version:""},_=arguments[9],E=arguments[10];u(this,g);var w={};if(arguments.length>1)w.playerVersion=n.version,w.errorType=v,w.domain=document.domain,w.duration=e,w.currentTime=p,w.networkState=s,w.readyState=l,w.currentSrc=d,w.src=f,w.ended=y,w.errd=m,w.ex=(o[v]||{}).msg,w.errorCode=_,w.mediaError=E;else{var k=arguments[0];Object.keys(k).map(function(x){w[x]=k[x]}),w.ex=(k.type&&o[k.type]||{}).msg}return w};i.default=c,t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n={};Object.defineProperty(n,"device",{get:function(){var o=n.os;return o.isPc?"pc":"mobile"}}),Object.defineProperty(n,"browser",{get:function(){var o=navigator.userAgent.toLowerCase(),c={ie:/rv:([\d.]+)\) like gecko/,firfox:/firefox\/([\d.]+)/,chrome:/chrome\/([\d.]+)/,opera:/opera.([\d.]+)/,safari:/version\/([\d.]+).*safari/};return[].concat(Object.keys(c).filter(function(g){return c[g].test(o)}))[0]||""}}),Object.defineProperty(n,"os",{get:function(){var o=navigator.userAgent,c=/(?:Windows Phone)/.test(o),g=/(?:SymbianOS)/.test(o)||c,v=/(?:Android)/.test(o),p=/(?:Firefox)/.test(o),e=/(?:iPad|PlayBook)/.test(o)||v&&!/(?:Mobile)/.test(o)||p&&/(?:Tablet)/.test(o),s=/(?:iPhone)/.test(o)&&!e,l=!s&&!v&&!g&&!e;return{isTablet:e,isPhone:s,isAndroid:v,isPc:l,isSymbian:g,isWindowsPhone:c,isFireFox:p}}}),i.default=n,t.exports=i.default},function(t,i,r){var n=void 0;t.exports=function(u){return u!==n&&u!==null}},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function c(g,v){for(var p=0;p<v.length;p++){var e=v[p];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(g,e.key,e)}}return function(g,v,p){return v&&c(g.prototype,v),p&&c(g,p),g}}();function u(c,g){if(!(c instanceof g))throw new TypeError("Cannot call a class as a function")}var o=function(){function c(g){u(this,c),this.bufferedList=g}return n(c,[{key:"start",value:function(v){return this.bufferedList[v].start}},{key:"end",value:function(v){return this.bufferedList[v].end}},{key:"length",get:function(){return this.bufferedList.length}}]),c}();i.default=o,t.exports=i.default},function(t){t.exports=JSON.parse('{"version":"2.32.2"}')},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function U(R,C){for(var A=0;A<C.length;A++){var b=C[A];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(R,b.key,b)}}return function(R,C,A){return C&&U(R.prototype,C),A&&U(R,A),R}}(),u=function U(R,C,A){R===null&&(R=Function.prototype);var b=Object.getOwnPropertyDescriptor(R,C);if(b===void 0){var O=Object.getPrototypeOf(R);return O===null?void 0:U(O,C,A)}else{if("value"in b)return b.value;var W=b.get;return W===void 0?void 0:W.call(A)}},o=r(11),c=w(o),g=r(0),v=r(5),p=w(v),e=r(7),s=w(e),l=r(4),f=w(l),d=r(31),y=w(d),m=r(10),_=w(m);r(34);var E=r(8);function w(U){return U&&U.__esModule?U:{default:U}}function k(U,R){if(!(U instanceof R))throw new TypeError("Cannot call a class as a function")}function x(U,R){if(!U)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R&&(typeof R=="object"||typeof R=="function")?R:U}function S(U,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof R);U.prototype=Object.create(R&&R.prototype,{constructor:{value:U,enumerable:!1,writable:!0,configurable:!0}}),R&&(Object.setPrototypeOf?Object.setPrototypeOf(U,R):U.__proto__=R)}var P=function(U){S(R,U);function R(C){k(this,R);var A=x(this,(R.__proto__||Object.getPrototypeOf(R)).call(this,C));if(A.config=(0,g.deepCopy)({width:600,height:337.5,ignores:[],whitelist:[],lang:(document.documentElement.getAttribute("lang")||navigator.language||"zh-cn").toLocaleLowerCase(),inactive:3e3,volume:.6,controls:!0,controlsList:["nodownload"]},C),A.version=E.version,A.userTimer=null,A.waitTimer=null,A.history=[],A.isProgressMoving=!1,A.root=(0,g.findDom)(document,"#"+A.config.id),A.controls=(0,g.createDom)("xg-controls","",{unselectable:"on",onselectstart:"return false"},"xgplayer-controls"),A.config.isShowControl&&(A.controls.style.display="none"),!A.root){var b=A.config.el;if(b&&b.nodeType===1)A.root=b;else{var O;return A.emit("error",new f.default({type:"use",errd:{line:45,handle:"Constructor",msg:"container id can't be empty"},vid:A.config.vid})),console.error("container id can't be empty"),O=!1,x(A,O)}}if((0,g.addClass)(A.root,"xgplayer xgplayer-"+p.default.device+" xgplayer-nostart xgplayer-pause "+(A.config.controls?"":"xgplayer-no-controls")),A.root.appendChild(A.controls),A.config.fluid?(A.root.style["max-width"]="100%",A.root.style.width="100%",A.root.style.height="0",A.root.style["padding-top"]=A.config.height*100/A.config.width+"%",A.video.style.position="absolute",A.video.style.top="0",A.video.style.left="0"):(A.config.width&&(typeof A.config.width!="number"?A.root.style.width=A.config.width:A.root.style.width=A.config.width+"px"),A.config.height&&(typeof A.config.height!="number"?A.root.style.height=A.config.height:A.root.style.height=A.config.height+"px")),A.config.execBeforePluginsCall&&A.config.execBeforePluginsCall.forEach(function(B){B.call(A,A)}),A.config.closeI18n||R.install(_.default.name,_.default.method),A.config.controlStyle&&(0,g.typeOf)(A.config.controlStyle)==="String"){var W=A;fetch(W.config.controlStyle,{method:"GET",headers:{Accept:"application/json"}}).then(function(B){B.ok&&B.json().then(function(j){for(var z in j)j.hasOwnProperty(z)&&(W.config[z]=j[z]);W.pluginsCall()})}).catch(function(B){console.log("Fetch\u9519\u8BEF:"+B)})}else A.pluginsCall();A.config.controlPlugins&&R.controlsRun(A.config.controlPlugins,A),A.ev.forEach(function(B){var j=Object.keys(B)[0],z=A[B[j]];z&&A.on(j,z)}),["focus","blur"].forEach(function(B){A.on(B,A["on"+B.charAt(0).toUpperCase()+B.slice(1)])});var K=A;A.mousemoveFunc=function(){K.emit("focus"),K.config.closeFocusVideoFocus||K.video.focus()},A.root.addEventListener("mousemove",A.mousemoveFunc),A.playFunc=function(){K.emit("focus"),K.config.closePlayVideoFocus||K.video.focus()},K.once("play",A.playFunc),A.getVideoSize=function(){if(this.video.videoWidth&&this.video.videoHeight){var B=K.root.getBoundingClientRect();K.config.fitVideoSize==="auto"?B.width/B.height>this.video.videoWidth/this.video.videoHeight?K.root.style.height=this.video.videoHeight/this.video.videoWidth*B.width+"px":K.root.style.width=this.video.videoWidth/this.video.videoHeight*B.height+"px":K.config.fitVideoSize==="fixWidth"?K.root.style.height=this.video.videoHeight/this.video.videoWidth*B.width+"px":K.config.fitVideoSize==="fixHeight"&&(K.root.style.width=this.video.videoWidth/this.video.videoHeight*B.height+"px")}},K.once("loadeddata",A.getVideoSize),setTimeout(function(){A.emit("ready"),A.isReady=!0},0),A.config.videoInit&&(0,g.hasClass)(A.root,"xgplayer-nostart")&&A.start(),K.config.rotate&&(K.on("requestFullscreen",A.updateRotateDeg),K.on("exitFullscreen",A.updateRotateDeg));function G(){K.root.removeEventListener("mousemove",K.mousemoveFunc),K.off("destroy",G)}return K.once("destroy",G),A}return n(R,[{key:"attachVideo",value:function(){var A=this;this.video&&this.video.nodeType===1&&this.root.insertBefore(this.video,this.root.firstChild),setTimeout(function(){A.emit("complete"),A.danmu&&typeof A.danmu.resize=="function"&&A.danmu.resize()},1)}},{key:"start",value:function(){var A=this,b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.url;if(!!this.video){var O=this;if(!b||b===""){this.emit("urlNull");return}this.canPlayFunc=function(){O.off("canplay",O.canPlayFunc);var W=O.video.play();W!==void 0&&W&&W.then(function(){O.emit("autoplay started")}).catch(function(){O.emit("autoplay was prevented"),(0,g.addClass)(O.root,"xgplayer-is-autoplay")})},(0,g.typeOf)(b)!=="Array"?(0,g.typeOf)(b)==="String"&&b.indexOf("blob:")>-1&&b===this.video.src||(this.video.src=b):b.forEach(function(W){A.video.appendChild((0,g.createDom)("source","",{src:""+W.src,type:""+(W.type||"")}))}),this.config.autoplay&&(p.default.os.isPhone?this.canPlayFunc():this.on("canplay",this.canPlayFunc)),this.config.disableStartLoad||this.video.load(),this.attachVideo()}}},{key:"reload",value:function(){this.video.load(),this.reloadFunc=function(){var A=this.play();A!==void 0&&A&&A.catch(function(b){})},this.once("loadeddata",this.reloadFunc)}},{key:"destroy",value:function(){var A=this,b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,O=this;clearInterval(this.bulletResizeTimer);for(var W in this._interval)clearInterval(this._interval[W]),this._interval[W]=null;this.checkTimer&&clearInterval(this.checkTimer),this.waitTimer&&clearTimeout(this.waitTimer),this.ev.forEach(function(G){var B=Object.keys(G)[0],j=A[G[B]];j&&A.off(B,j)}),this.loadeddataFunc&&this.off("loadeddata",this.loadeddataFunc),this.reloadFunc&&this.off("loadeddata",this.reloadFunc),this.replayFunc&&this.off("play",this.replayFunc),this.playFunc&&this.off("play",this.playFunc),this.getVideoSize&&this.off("loadeddata",this.getVideoSize),["focus","blur"].forEach(function(G){A.off(G,A["on"+G.charAt(0).toUpperCase()+G.slice(1)])}),(!this.config.keyShortcut||this.config.keyShortcut==="on")&&["video","controls"].forEach(function(G){A[G]&&A[G].removeEventListener("keydown",function(B){O.onKeydown(B,O)})});function K(){if(this.emit("destroy"),this.video.removeAttribute("src"),this.video.load(),b){this.root.innerHTML="";var G=this.root.className.split(" ");G.length>0?this.root.className=G.filter(function(j){return j.indexOf("xgplayer")<0}).join(" "):this.root.className=""}for(var B in this)delete this[B];(0,y.default)(this)}K.call(this),u(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"destroy",this).call(this)}},{key:"replay",value:function(){var A=this._replay;if((0,g.removeClass)(this.root,"xgplayer-ended"),p.default.browser.indexOf("ie")>-1&&(this.emit("play"),this.emit("playing")),A&&A instanceof Function)A();else{this.currentTime=0;var b=this.play();b!==void 0&&b&&b.catch(function(O){})}}},{key:"userGestureTrigEvent",value:function(A,b){var O=this,W=function(G,B){O.emit(G,B)};this.config.userGestureEventMiddleware&&typeof this.config.userGestureEventMiddleware[A]=="function"?this.config.userGestureEventMiddleware[A].call(this,this,A,b,W):W.call(this,A,b)}},{key:"pluginsCall",value:function(){var A=this;R.plugins.s_i18n&&R.plugins.s_i18n.call(this,this);var b=this;if(R.plugins){var O=this.config.ignores;Object.keys(R.plugins).forEach(function(W){var K=R.plugins[W];!K||typeof K!="function"?console.warn("plugin name",W,"is invalid"):!O.some(function(G){return W===G||W==="s_"+G})&&W!=="s_i18n"&&(["pc","tablet","mobile"].some(function(G){return G===W})?W===p.default.device&&setTimeout(function(){!b.video||K.call(b,b)},0):K.call(A,A))})}}},{key:"onFocus",value:function(){var A=this;(0,g.hasClass)(this.root,"xgplayer-inactive")&&A.emit("controlShow"),(0,g.removeClass)(this.root,"xgplayer-inactive"),A.userTimer&&clearTimeout(A.userTimer),A.userTimer=setTimeout(function(){A.emit("blur")},A.config.inactive)}},{key:"onBlur",value:function(){(this.config.enablePausedInactive||!this.paused)&&!this.ended&&!this.config.closeInactive&&((0,g.hasClass)(this.root,"xgplayer-inactive")||this.emit("controlHide"),(0,g.addClass)(this.root,"xgplayer-inactive"))}},{key:"onPlay",value:function(){(0,g.addClass)(this.root,"xgplayer-isloading"),(0,g.addClass)(this.root,"xgplayer-playing"),(0,g.removeClass)(this.root,"xgplayer-pause")}},{key:"onPause",value:function(){(0,g.addClass)(this.root,"xgplayer-pause"),this.userTimer&&clearTimeout(this.userTimer),this.emit("focus")}},{key:"onEnded",value:function(){(0,g.addClass)(this.root,"xgplayer-ended"),(0,g.removeClass)(this.root,"xgplayer-playing")}},{key:"onSeeking",value:function(){this.isSeeking=!0,this.onWaiting()}},{key:"onSeeked",value:function(){var A=this;this.once("timeupdate",function(){A.isSeeking=!1}),this.waitTimer&&clearTimeout(this.waitTimer),(0,g.removeClass)(this.root,"xgplayer-isloading")}},{key:"onWaiting",value:function(){var A=this;A.waitTimer&&clearTimeout(A.waitTimer),A.checkTimer&&(clearInterval(A.checkTimer),A.checkTimer=null);var b=A.currentTime;A.waitTimer=setTimeout(function(){(0,g.addClass)(A.root,"xgplayer-isloading"),A.checkTimer=setInterval(function(){A.currentTime!==b&&((0,g.removeClass)(A.root,"xgplayer-isloading"),clearInterval(A.checkTimer),A.checkTimer=null)},1e3)},500)}},{key:"onPlaying",value:function(){this.paused||(this.isSeeking=!1,this.waitTimer&&clearTimeout(this.waitTimer),(0,g.removeClass)(this.root,"xgplayer-isloading xgplayer-nostart xgplayer-pause xgplayer-ended xgplayer-is-error xgplayer-replay"),(0,g.addClass)(this.root,"xgplayer-playing"))}}],[{key:"install",value:function(A,b){!(0,g.checkIsBrowser)()||(R.plugins||(R.plugins={}),R.plugins[A]||(R.plugins[A]=b))}},{key:"installAll",value:function(A){for(var b=0;b<A.length;b++)R.install(A[b].name,A[b].method)}},{key:"use",value:function(A,b){R.plugins||(R.plugins={}),R.plugins[A]=b}},{key:"useAll",value:function(A){for(var b in A)R.use(A[b].name,A[b].method)}},{key:"controlsRun",value:function(A,b){A.forEach(function(O){O.method.call(b)})}}]),R}(c.default);P.util=g.util,P.sniffer=p.default,P.Errors=f.default,P.XgplayerTimeRange=s.default,i.default=P,t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var c=this,g={};g.en={HAVE_NOTHING:"There is no information on whether audio/video is ready",HAVE_METADATA:"Audio/video metadata is ready ",HAVE_CURRENT_DATA:"Data about the current play location is available, but there is not enough data to play the next frame/millisecond",HAVE_FUTURE_DATA:"Current and at least one frame of data is available",HAVE_ENOUGH_DATA:"The available data is sufficient to start playing",NETWORK_EMPTY:"Audio/video has not been initialized",NETWORK_IDLE:"Audio/video is active and has been selected for resources, but no network is used",NETWORK_LOADING:"The browser is downloading the data",NETWORK_NO_SOURCE:"No audio/video source was found",MEDIA_ERR_ABORTED:"The fetch process is aborted by the user",MEDIA_ERR_NETWORK:"An error occurred while downloading",MEDIA_ERR_DECODE:"An error occurred while decoding",MEDIA_ERR_SRC_NOT_SUPPORTED:"Audio/video is not supported",REPLAY:"Replay",ERROR:"Network is offline",PLAY_TIPS:"Play",PAUSE_TIPS:"Pause",PLAYNEXT_TIPS:"Play next",DOWNLOAD_TIPS:"Download",ROTATE_TIPS:"Rotate",RELOAD_TIPS:"Reload",FULLSCREEN_TIPS:"Fullscreen",EXITFULLSCREEN_TIPS:"Exit fullscreen",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:"Exit cssfullscreen",TEXTTRACK:"Caption",PIP:"Pip",MINIPLAYER:"Miniplayer",SCREENSHOT:"Screenshot",LIVE:"LIVE",OFF:"Off",MINIPLAYER_DRAG:"Click and hold to drag",AIRPLAY_TIPS:"Airplay"},g["zh-cn"]={HAVE_NOTHING:"\u6CA1\u6709\u5173\u4E8E\u97F3\u9891/\u89C6\u9891\u662F\u5426\u5C31\u7EEA\u7684\u4FE1\u606F",HAVE_METADATA:"\u97F3\u9891/\u89C6\u9891\u7684\u5143\u6570\u636E\u5DF2\u5C31\u7EEA",HAVE_CURRENT_DATA:"\u5173\u4E8E\u5F53\u524D\u64AD\u653E\u4F4D\u7F6E\u7684\u6570\u636E\u662F\u53EF\u7528\u7684\uFF0C\u4F46\u6CA1\u6709\u8DB3\u591F\u7684\u6570\u636E\u6765\u64AD\u653E\u4E0B\u4E00\u5E27/\u6BEB\u79D2",HAVE_FUTURE_DATA:"\u5F53\u524D\u53CA\u81F3\u5C11\u4E0B\u4E00\u5E27\u7684\u6570\u636E\u662F\u53EF\u7528\u7684",HAVE_ENOUGH_DATA:"\u53EF\u7528\u6570\u636E\u8DB3\u4EE5\u5F00\u59CB\u64AD\u653E",NETWORK_EMPTY:"\u97F3\u9891/\u89C6\u9891\u5C1A\u672A\u521D\u59CB\u5316",NETWORK_IDLE:"\u97F3\u9891/\u89C6\u9891\u662F\u6D3B\u52A8\u7684\u4E14\u5DF2\u9009\u53D6\u8D44\u6E90\uFF0C\u4F46\u5E76\u672A\u4F7F\u7528\u7F51\u7EDC",NETWORK_LOADING:"\u6D4F\u89C8\u5668\u6B63\u5728\u4E0B\u8F7D\u6570\u636E",NETWORK_NO_SOURCE:"\u672A\u627E\u5230\u97F3\u9891/\u89C6\u9891\u6765\u6E90",MEDIA_ERR_ABORTED:"\u53D6\u56DE\u8FC7\u7A0B\u88AB\u7528\u6237\u4E2D\u6B62",MEDIA_ERR_NETWORK:"\u5F53\u4E0B\u8F7D\u65F6\u53D1\u751F\u9519\u8BEF",MEDIA_ERR_DECODE:"\u5F53\u89E3\u7801\u65F6\u53D1\u751F\u9519\u8BEF",MEDIA_ERR_SRC_NOT_SUPPORTED:"\u4E0D\u652F\u6301\u7684\u97F3\u9891/\u89C6\u9891\u683C\u5F0F",REPLAY:"\u91CD\u64AD",ERROR:"\u7F51\u7EDC\u8FDE\u63A5\u4F3C\u4E4E\u51FA\u73B0\u4E86\u95EE\u9898",PLAY_TIPS:"\u64AD\u653E",PAUSE_TIPS:"\u6682\u505C",PLAYNEXT_TIPS:"\u4E0B\u4E00\u96C6",DOWNLOAD_TIPS:"\u4E0B\u8F7D",ROTATE_TIPS:"\u65CB\u8F6C",RELOAD_TIPS:"\u91CD\u65B0\u8F7D\u5165",FULLSCREEN_TIPS:"\u8FDB\u5165\u5168\u5C4F",EXITFULLSCREEN_TIPS:"\u9000\u51FA\u5168\u5C4F",CSSFULLSCREEN_TIPS:"\u8FDB\u5165\u6837\u5F0F\u5168\u5C4F",EXITCSSFULLSCREEN_TIPS:"\u9000\u51FA\u6837\u5F0F\u5168\u5C4F",TEXTTRACK:"\u5B57\u5E55",PIP:"\u753B\u4E2D\u753B",MINIPLAYER:"\u8FF7\u4F60\u64AD\u653E\u5668",SCREENSHOT:"\u622A\u56FE",LIVE:"\u6B63\u5728\u76F4\u64AD",OFF:"\u5173\u95ED",MINIPLAYER_DRAG:"\u70B9\u51FB\u6309\u4F4F\u53EF\u62D6\u52A8\u89C6\u9891",AIRPLAY_TIPS:"\u9694\u7A7A\u64AD\u653E"},g["zh-hk"]={HAVE_NOTHING:"\u6C92\u6709\u95DC\u65BC\u97F3\u983B/\u8996\u983B\u662F\u5426\u5C31\u7DD2\u7684\u4FE1\u606F",HAVE_METADATA:"\u97F3\u983B/\u8996\u983B\u7684\u5143\u6578\u64DA\u5DF2\u5C31\u7DD2",HAVE_CURRENT_DATA:"\u95DC\u65BC\u7576\u524D\u64AD\u653E\u4F4D\u7F6E\u7684\u6578\u64DA\u662F\u53EF\u7528\u7684\uFF0C\u4F46\u6C92\u6709\u8DB3\u5920\u7684\u6578\u64DA\u4F86\u64AD\u653E\u4E0B\u58F9\u5E40/\u6BEB\u79D2",HAVE_FUTURE_DATA:"\u7576\u524D\u53CA\u81F3\u5C11\u4E0B\u58F9\u5E40\u7684\u6578\u64DA\u662F\u53EF\u7528\u7684",HAVE_ENOUGH_DATA:"\u53EF\u7528\u6578\u64DA\u8DB3\u4EE5\u958B\u59CB\u64AD\u653E",NETWORK_EMPTY:"\u97F3\u983B/\u8996\u983B\u5C1A\u672A\u521D\u59CB\u5316",NETWORK_IDLE:"\u97F3\u983B/\u8996\u983B\u662F\u6D3B\u52D5\u7684\u4E14\u5DF2\u9078\u53D6\u8CC7\u6E90\uFF0C\u4F46\u4E26\u672A\u4F7F\u7528\u7DB2\u7D61",NETWORK_LOADING:"\u700F\u89BD\u5668\u6B63\u5728\u4E0B\u8F09\u6578\u64DA",NETWORK_NO_SOURCE:"\u672A\u627E\u5230\u97F3\u983B/\u8996\u983B\u4F86\u6E90",MEDIA_ERR_ABORTED:"\u53D6\u56DE\u904E\u7A0B\u88AB\u7528\u6236\u4E2D\u6B62",MEDIA_ERR_NETWORK:"\u7576\u4E0B\u8F09\u6642\u767C\u751F\u932F\u8AA4",MEDIA_ERR_DECODE:"\u7576\u89E3\u78BC\u6642\u767C\u751F\u932F\u8AA4",MEDIA_ERR_SRC_NOT_SUPPORTED:"\u4E0D\u652F\u6301\u7684\u97F3\u983B/\u8996\u983B\u683C\u5F0F",REPLAY:"\u91CD\u64AD",ERROR:"\u7DB2\u7D61\u9023\u63A5\u4F3C\u4E4E\u51FA\u73FE\u4E86\u554F\u984C",PLAY_TIPS:"\u64AD\u653E",PAUSE_TIPS:"\u66AB\u505C",PLAYNEXT_TIPS:"\u4E0B\u58F9\u96C6",DOWNLOAD_TIPS:"\u4E0B\u8F09",ROTATE_TIPS:"\u65CB\u8F49",RELOAD_TIPS:"\u91CD\u65B0\u8F09\u5165",FULLSCREEN_TIPS:"\u9032\u5165\u5168\u5C4F",EXITFULLSCREEN_TIPS:"\u9000\u51FA\u5168\u5C4F",CSSFULLSCREEN_TIPS:"\u9032\u5165\u6A23\u5F0F\u5168\u5C4F",EXITCSSFULLSCREEN_TIPS:"\u9000\u51FA\u6A23\u5F0F\u5168\u5C4F",TEXTTRACK:"\u5B57\u5E55",PIP:"\u756B\u4E2D\u756B",MINIPLAYER:"\u8FF7\u59B3\u64AD\u653E\u5668",SCREENSHOT:"\u622A\u5716",LIVE:"\u6B63\u5728\u76F4\u64AD",OFF:"\u95DC\u9589",MINIPLAYER_DRAG:"\u9EDE\u64CA\u6309\u4F4F\u53EF\u62D6\u52D5\u8996\u983B",AIRPLAY_TIPS:"\u9694\u7A7A\u64AD\u653E"},g.jp={HAVE_NOTHING:"\u30AA\u30FC\u30C7\u30A3\u30AA/\u30D3\u30C7\u30AA\u304C\u6E96\u5099\u3067\u304D\u3066\u3044\u308B\u304B\u60C5\u5831\u304C\u3042\u308A\u307E\u305B\u3093",HAVE_METADATA:"\u30AA\u30FC\u30C7\u30A3\u30AA/\u30D3\u30C7\u30AA\u306E\u30E1\u30BF\u30C7\u30FC\u30BF\u306F\u6E96\u5099\u3067\u304D\u3066\u3044\u307E\u3059",HAVE_CURRENT_DATA:"\u73FE\u5728\u306E\u518D\u751F\u4F4D\u7F6E\u306B\u95A2\u3059\u308B\u30C7\u30FC\u30BF\u306F\u5229\u7528\u53EF\u80FD\u3067\u3059\u304C\u3001\u6B21\u306E\u30D5\u30EC\u30FC\u30E0/\u30DF\u30EA\u79D2\u3092\u518D\u751F\u3059\u308B\u306E\u306B\u5341\u5206\u306A\u30C7\u30FC\u30BF\u304C\u3042\u308A\u307E\u305B\u3093",HAVE_FUTURE_DATA:"\u73FE\u5728\u3001\u5C11\u306A\u304F\u3068\u3082\u6B21\u306E\u30D5\u30EC\u30FC\u30E0\u306E\u30C7\u30FC\u30BF\u304C\u5229\u7528\u53EF\u80FD\u3067\u3059",HAVE_ENOUGH_DATA:"\u5229\u7528\u53EF\u80FD\u306A\u30C7\u30FC\u30BF\u306F\u518D\u751F\u3092\u958B\u59CB\u3059\u308B\u306E\u306B\u5341\u5206\u3067\u3059",NETWORK_EMPTY:"\u30AA\u30FC\u30C7\u30A3\u30AA/\u30D3\u30C7\u30AA\u304C\u521D\u671F\u5316\u3055\u308C\u3066\u3044\u307E\u305B\u3093",NETWORK_IDLE:"\u30AA\u30FC\u30C7\u30A3\u30AA/\u30D3\u30C7\u30AA\u306F\u30A2\u30AF\u30C6\u30A3\u30D6\u3067\u30EA\u30BD\u30FC\u30B9\u304C\u9078\u629E\u3055\u308C\u3066\u3044\u307E\u3059\u304C\u3001\u30CD\u30C3\u30C8\u30EF\u30FC\u30AF\u304C\u4F7F\u7528\u3055\u308C\u3066\u3044\u307E\u305B\u3093",NETWORK_LOADING:"\u30D6\u30E9\u30A6\u30B6\u30FC\u306F\u30C7\u30FC\u30BF\u3092\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9\u3057\u3066\u3044\u307E\u3059",NETWORK_NO_SOURCE:"\u30AA\u30FC\u30C7\u30A3\u30AA/\u30D3\u30C7\u30AA \u306E\u30BD\u30FC\u30B9\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093",MEDIA_ERR_ABORTED:"\u30E6\u30FC\u30B6\u30FC\u306B\u3088\u3063\u3066\u30D5\u30A7\u30C3\u30C1\u30D7\u30ED\u30BB\u30B9\u304C\u4E2D\u6B62\u3055\u308C\u307E\u3057\u305F",MEDIA_ERR_NETWORK:"\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9\u4E2D\u306B\u30A8\u30E9\u30FC\u304C\u767A\u751F\u3057\u307E\u3057\u305F",MEDIA_ERR_DECODE:"\u30C7\u30B3\u30FC\u30C9\u4E2D\u306B\u30A8\u30E9\u30FC\u304C\u767A\u751F\u3057\u307E\u3057\u305F",MEDIA_ERR_SRC_NOT_SUPPORTED:"\u30AA\u30FC\u30C7\u30A3\u30AA/\u30D3\u30C7\u30AA \u306E\u5F62\u5F0F\u304C\u30B5\u30DD\u30FC\u30C8\u3055\u308C\u3066\u3044\u307E\u305B\u3093",REPLAY:"\u30EA\u30D7\u30EC\u30A4",ERROR:"\u30CD\u30C3\u30C8\u30EF\u30FC\u30AF\u306E\u63A5\u7D9A\u306B\u554F\u984C\u304C\u767A\u751F\u3057\u307E\u3057\u305F",PLAY_TIPS:"\u30D7\u30EC\u30A4",PAUSE_TIPS:"\u4E00\u6642\u505C\u6B62",PLAYNEXT_TIPS:"\u6B21\u3092\u30D7\u30EC\u30A4",DOWNLOAD_TIPS:"\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9",ROTATE_TIPS:"\u56DE\u8EE2",RELOAD_TIPS:"\u518D\u8AAD\u307F\u8FBC\u307F",FULLSCREEN_TIPS:"\u30D5\u30EB\u30B9\u30AF\u30EA\u30FC\u30F3",EXITFULLSCREEN_TIPS:"\u30D5\u30EB\u30B9\u30AF\u30EA\u30FC\u30F3\u3092\u7D42\u4E86",CSSFULLSCREEN_TIPS:"\u30B7\u30A2\u30BF\u30FC\u30E2\u30FC\u30C9",EXITCSSFULLSCREEN_TIPS:"\u30B7\u30A2\u30BF\u30FC\u30E2\u30FC\u30C9\u3092\u7D42\u4E86",TEXTTRACK:"\u5B57\u5E55",PIP:"\u30DF\u30CB\u30D7\u30EC\u30FC\u30E4\u30FC",MINIPLAYER:"\u30DF\u30CB\u30D7\u30EC\u30FC\u30E4\u30FC",SCREENSHOT:"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8",LIVE:"\u751F\u653E\u9001",OFF:"\u30AA\u30D5",MINIPLAYER_DRAG:"\u30DC\u30BF\u30F3\u3092\u62BC\u3057\u3066\u50CD\u753B\u3092\u30C9\u30E9\u30C3\u30B0\u3059\u308B",AIRPLAY_TIPS:"\u9694\u7A7A\u653E\u9001"},Object.defineProperty(c,"lang",{get:function(){return c.config&&g[c.config.lang]||g.en},set:function(p){(0,n.typeOf)(p)==="Object"&&Object.keys(p).forEach(function(e){g[e]=p[e]})}})};i.default={name:"s_i18n",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function f(d,y){for(var m=0;m<y.length;m++){var _=y[m];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(d,_.key,_)}}return function(d,y,m){return y&&f(d.prototype,y),m&&f(d,m),d}}(),u=r(12),o=p(u),c=r(0),g=r(4),v=p(g);function p(f){return f&&f.__esModule?f:{default:f}}function e(f,d,y){return d in f?Object.defineProperty(f,d,{value:y,enumerable:!0,configurable:!0,writable:!0}):f[d]=y,f}function s(f,d){if(!(f instanceof d))throw new TypeError("Cannot call a class as a function")}var l=function(){function f(d){var y=this;s(this,f),this._hasStart=!1,this.videoConfig={controls:!!d.isShowControl,autoplay:d.autoplay,playsinline:d.playsinline,"webkit-playsinline":d.playsinline,"x5-playsinline":d.playsinline,"x5-video-player-type":d["x5-video-player-type"]||d.x5VideoPlayerType,"x5-video-player-fullscreen":d["x5-video-player-fullscreen"]||d.x5VideoPlayerFullscreen,"x5-video-orientation":d["x5-video-orientation"]||d.x5VideoOrientation,airplay:d.airplay,"webkit-airplay":d.airplay,tabindex:2,mediaType:d.mediaType||"video"},d.muted&&(this.videoConfig.muted="muted"),d.loop&&(this.videoConfig.loop="loop");var m="";if(this.textTrackShowDefault=!0,d.nativeTextTrack&&Array.isArray(d.nativeTextTrack)&&(d.nativeTextTrack.length>0&&!d.nativeTextTrack.some(function(b){return b.default})&&(d.nativeTextTrack[0].default=!0,this.textTrackShowDefault=!1),d.nativeTextTrack.some(function(b){if(b.src&&b.label&&b.default)return m+='<track src="'+b.src+'" ',b.kind&&(m+='kind="'+b.kind+'" '),m+='label="'+b.label+'" ',b.srclang&&(m+='srclang="'+b.srclang+'" '),m+=(b.default?"default":"")+">",!0}),this.videoConfig.crossorigin="anonymous"),d.textTrackStyle){var _=document.createElement("style");this.textTrackStyle=_,document.head.appendChild(_);var E="";for(var w in d.textTrackStyle)E+=w+": "+d.textTrackStyle[w]+";";var k=d.id?"#"+d.id:d.el.id?"#"+d.el.id:"."+d.el.className;_.sheet.insertRule?_.sheet.insertRule(k+" video::cue { "+E+" }",0):_.sheet.addRule&&_.sheet.addRule(k+" video::cue",E)}var x=d.el?d.el:(0,c.findDom)(document,"#"+d.id),S=this.constructor.XgVideoProxy;if(S&&this.videoConfig.mediaType===S.mediaType?this.video=new S(x,d):this.video=(0,c.createDom)(this.videoConfig.mediaType,m,this.videoConfig,""),d.videoStyle&&Object.keys(d.videoStyle).forEach(function(b){(0,c.setStyle)(y.video,b,d.videoStyle[b])}),!this.textTrackShowDefault&&m){var P=this.video.getElementsByTagName("Track");P[0].track.mode="hidden"}d.autoplay&&(this.video.autoplay=!0,d.autoplayMuted&&(this.video.muted=!0)),this.ev=["play","playing","pause","ended","error","seeking","seeked","progress","timeupdate","waiting","canplay","canplaythrough","durationchange","volumechange","ratechange","loadedmetadata","loadeddata","loadstart"].map(function(b){return e({},b,"on"+b.charAt(0).toUpperCase()+b.slice(1))}),(0,o.default)(this),this._interval={};var U="0,0",R=this,C=function(O){!y||(O==="play"?y.hasStart=!0:O==="canplay"?(0,c.removeClass)(y.root,"xgplayer-is-enter"):O==="waiting"?y.inWaitingStart=new Date().getTime():O==="playing"&&((0,c.removeClass)(y.root,"xgplayer-is-enter"),y.inWaitingStart&&(y.inWaitingStart=void 0)),O==="error"?y._onError(O):y.emit(O,y),y.hasOwnProperty("_interval")&&(["ended","error","timeupdate"].indexOf(O)<0?((0,c._clearInterval)(y,"bufferedChange"),(0,c._setInterval)(y,"bufferedChange",function(){if(this.video&&this.video.buffered){for(var W=[],K=0,G=this.video.buffered.length;K<G;K++)W.push([this.video.buffered.start(K),this.video.buffered.end(K)]);W.toString()!==U&&(U=W.toString(),this.emit("bufferedChange",W))}},200)):O!=="timeupdate"&&(0,c._clearInterval)(y,"bufferedChange")))},A=function(O){d.videoEventMiddleware&&typeof d.videoEventMiddleware[O]=="function"?d.videoEventMiddleware[O].call(y,y,O,C):C.call(y,O)};this.ev.forEach(function(b){R.evItem=Object.keys(b)[0];var O=Object.keys(b)[0];R.video.addEventListener(Object.keys(b)[0],A.bind(R,O))})}return n(f,[{key:"_onError",value:function(y){this.video&&this.video.error&&this.emit(y,new v.default("other",this.currentTime,this.duration,this.networkState,this.readyState,this.currentSrc,this.src,this.ended,{line:162,msg:this.error,handle:"Constructor"},this.video.error.code,this.video.error))}},{key:"destroy",value:function(){this.textTrackStyle&&this.textTrackStyle.parentNode.removeChild(this.textTrackStyle)}},{key:"play",value:function(){return this.video.play()}},{key:"pause",value:function(){this.video.pause()}},{key:"canPlayType",value:function(y){return this.video.canPlayType(y)}},{key:"getBufferedRange",value:function(y){var m=[0,0],_=this.video;y||(y=_.buffered);var E=_.currentTime;if(y)for(var w=0,k=y.length;w<k&&(m[0]=y.start(w),m[1]=y.end(w),!(m[0]<=E&&E<=m[1]));w++);return m[0]-E<=0&&E-m[1]<=0?m:[0,0]}},{key:"proxyOn",value:function(y,m){(0,c.on)(this,y,m,"destroy")}},{key:"proxyOnce",value:function(y,m){(0,c.once)(this,y,m,"destroy")}},{key:"hasStart",get:function(){return this._hasStart},set:function(y){typeof y=="boolean"&&y===!0&&!this._hasStart&&(this._hasStart=!0,this.emit("hasstart"))}},{key:"autoplay",set:function(y){this.video&&(this.video.autoplay=y)},get:function(){return this.video?this.video.autoplay:!1}},{key:"buffered",get:function(){if(this.video)return this.video.buffered}},{key:"buffered2",get:function(){return(0,c.getBuffered2)(this.video.buffered)}},{key:"crossOrigin",get:function(){return this.video?this.video.crossOrigin:!1},set:function(y){this.video&&(this.video.crossOrigin=y)}},{key:"currentSrc",get:function(){if(this.video)return this.video.currentSrc}},{key:"currentTime",get:function(){return this.video&&this.video.currentTime||0},set:function(y){var m=this;typeof isFinite=="function"&&!isFinite(y)||((0,c.hasClass)(this.root,"xgplayer-ended")?(this.once("playing",function(){m.video.currentTime=y}),this.replay()):this.video.currentTime=y,this.emit("currentTimeChange",y))}},{key:"defaultMuted",get:function(){return this.video?this.video.defaultMuted:!1},set:function(y){this.video&&(this.video.defaultMuted=y)}},{key:"duration",get:function(){return this.config.duration?this.video?Math.min(this.config.duration,this.video.duration):this.config.duration:this.video?this.video.duration:null}},{key:"ended",get:function(){return this.video?this.video.ended||!1:!0}},{key:"error",get:function(){var y=this.video.error;if(!y)return null;var m=[{en:"MEDIA_ERR_ABORTED",cn:"\u53D6\u56DE\u8FC7\u7A0B\u88AB\u7528\u6237\u4E2D\u6B62"},{en:"MEDIA_ERR_NETWORK",cn:"\u5F53\u4E0B\u8F7D\u65F6\u53D1\u751F\u9519\u8BEF"},{en:"MEDIA_ERR_DECODE",cn:"\u5F53\u89E3\u7801\u65F6\u53D1\u751F\u9519\u8BEF"},{en:"MEDIA_ERR_SRC_NOT_SUPPORTED",cn:"\u4E0D\u652F\u6301\u97F3\u9891/\u89C6\u9891"}];return this.lang?this.lang[m[y.code-1].en]:m[y.code-1].en}},{key:"loop",get:function(){return this.video?this.video.loop:!1},set:function(y){this.video&&(this.video.loop=y)}},{key:"muted",get:function(){return this.video?this.video.muted:!1},set:function(y){this.video&&(this.video.muted=y)}},{key:"networkState",get:function(){var y=[{en:"NETWORK_EMPTY",cn:"\u97F3\u9891/\u89C6\u9891\u5C1A\u672A\u521D\u59CB\u5316"},{en:"NETWORK_IDLE",cn:"\u97F3\u9891/\u89C6\u9891\u662F\u6D3B\u52A8\u7684\u4E14\u5DF2\u9009\u53D6\u8D44\u6E90\uFF0C\u4F46\u5E76\u672A\u4F7F\u7528\u7F51\u7EDC"},{en:"NETWORK_LOADING",cn:"\u6D4F\u89C8\u5668\u6B63\u5728\u4E0B\u8F7D\u6570\u636E"},{en:"NETWORK_NO_SOURCE",cn:"\u672A\u627E\u5230\u97F3\u9891/\u89C6\u9891\u6765\u6E90"}];return this.lang?this.lang[y[this.video.networkState].en]:y[this.video.networkState].en}},{key:"paused",get:function(){return(0,c.hasClass)(this.root,"xgplayer-pause")}},{key:"playbackRate",get:function(){return this.video?this.video.playbackRate:1},set:function(y){this.video&&(this.video.playbackRate=y)}},{key:"played",get:function(){if(this.video)return this.video.played}},{key:"preload",get:function(){return this.video?this.video.preload:!1},set:function(y){this.video&&(this.video.preload=y)}},{key:"readyState",get:function(){var y=[{en:"HAVE_NOTHING",cn:"\u6CA1\u6709\u5173\u4E8E\u97F3\u9891/\u89C6\u9891\u662F\u5426\u5C31\u7EEA\u7684\u4FE1\u606F"},{en:"HAVE_METADATA",cn:"\u5173\u4E8E\u97F3\u9891/\u89C6\u9891\u5C31\u7EEA\u7684\u5143\u6570\u636E"},{en:"HAVE_CURRENT_DATA",cn:"\u5173\u4E8E\u5F53\u524D\u64AD\u653E\u4F4D\u7F6E\u7684\u6570\u636E\u662F\u53EF\u7528\u7684\uFF0C\u4F46\u6CA1\u6709\u8DB3\u591F\u7684\u6570\u636E\u6765\u64AD\u653E\u4E0B\u4E00\u5E27/\u6BEB\u79D2"},{en:"HAVE_FUTURE_DATA",cn:"\u5F53\u524D\u53CA\u81F3\u5C11\u4E0B\u4E00\u5E27\u7684\u6570\u636E\u662F\u53EF\u7528\u7684"},{en:"HAVE_ENOUGH_DATA",cn:"\u53EF\u7528\u6570\u636E\u8DB3\u4EE5\u5F00\u59CB\u64AD\u653E"}];return this.lang?this.lang[y[this.video.readyState].en]:y[this.video.readyState]}},{key:"seekable",get:function(){return this.video?this.video.seekable:!1}},{key:"seeking",get:function(){return this.video?this.video.seeking:!1}},{key:"src",get:function(){if(this.video)return this.video.src},set:function(y){(0,c.hasClass)(this.root,"xgplayer-ended")||this.emit("urlchange",this.video.src),(0,c.removeClass)(this.root,"xgplayer-ended xgplayer-is-replay xgplayer-is-error"),this.video.pause(),this.emit("pause"),this.video.src=y,this.emit("srcChange")}},{key:"poster",set:function(y){var m=(0,c.findDom)(this.root,".xgplayer-poster");m&&(m.style.backgroundImage="url("+y+")")}},{key:"volume",get:function(){return this.video?this.video.volume:1},set:function(y){this.video&&(this.video.volume=y)}},{key:"fullscreen",get:function(){return(0,c.hasClass)(this.root,"xgplayer-is-fullscreen")||(0,c.hasClass)(this.root,"xgplayer-fullscreen-active")}},{key:"bullet",get:function(){return(0,c.findDom)(this.root,"xg-danmu")?(0,c.hasClass)((0,c.findDom)(this.root,"xg-danmu"),"xgplayer-has-danmu"):!1}},{key:"textTrack",get:function(){return(0,c.hasClass)(this.root,"xgplayer-is-textTrack")}},{key:"pip",get:function(){return(0,c.hasClass)(this.root,"xgplayer-pip-active")}},{key:"isMiniPlayer",get:function(){return(0,c.hasClass)(this.root,"xgplayer-miniplayer-active")}}]),f}();i.default=l,t.exports=i.default},function(t,i,r){var n=r(13),u=r(30),o=Function.prototype.apply,c=Function.prototype.call,g=Object.create,v=Object.defineProperty,p=Object.defineProperties,e=Object.prototype.hasOwnProperty,s={configurable:!0,enumerable:!1,writable:!0},l,f,d,y,m,_,E;l=function(w,k){var x;return u(k),e.call(this,"__ee__")?x=this.__ee__:(x=s.value=g(null),v(this,"__ee__",s),s.value=null),x[w]?typeof x[w]=="object"?x[w].push(k):x[w]=[x[w],k]:x[w]=k,this},f=function(w,k){var x,S;return u(k),S=this,l.call(this,w,x=function(){d.call(S,w,x),o.call(k,this,arguments)}),x.__eeOnceListener__=k,this},d=function(w,k){var x,S,P,U;if(u(k),!e.call(this,"__ee__"))return this;if(x=this.__ee__,!x[w])return this;if(S=x[w],typeof S=="object")for(U=0;P=S[U];++U)(P===k||P.__eeOnceListener__===k)&&(S.length===2?x[w]=S[U?0:1]:S.splice(U,1));else(S===k||S.__eeOnceListener__===k)&&delete x[w];return this},y=function(w){var k,x,S,P,U;if(!!e.call(this,"__ee__")&&(P=this.__ee__[w],!!P))if(typeof P=="object"){for(x=arguments.length,U=new Array(x-1),k=1;k<x;++k)U[k-1]=arguments[k];for(P=P.slice(),k=0;S=P[k];++k)o.call(S,this,U)}else switch(arguments.length){case 1:c.call(P,this);break;case 2:c.call(P,this,arguments[1]);break;case 3:c.call(P,this,arguments[1],arguments[2]);break;default:for(x=arguments.length,U=new Array(x-1),k=1;k<x;++k)U[k-1]=arguments[k];o.call(P,this,U)}},m={on:l,once:f,off:d,emit:y},_={on:n(l),once:n(f),off:n(d),emit:n(y)},E=p({},_),t.exports=i=function(w){return w==null?g(E):p(Object(w),_)},i.methods=m},function(t,i,r){var n=r(6),u=r(14),o=r(18),c=r(26),g=r(27),v=t.exports=function(p,e){var s,l,f,d,y;return arguments.length<2||typeof p!="string"?(d=e,e=p,p=null):d=arguments[2],n(p)?(s=g.call(p,"c"),l=g.call(p,"e"),f=g.call(p,"w")):(s=f=!0,l=!1),y={value:e,configurable:s,enumerable:l,writable:f},d?o(c(d),y):y};v.gs=function(p,e,s){var l,f,d,y;return typeof p!="string"?(d=s,s=e,e=p,p=null):d=arguments[3],n(e)?u(e)?n(s)?u(s)||(d=s,s=void 0):s=void 0:(d=e,e=s=void 0):e=void 0,n(p)?(l=g.call(p,"c"),f=g.call(p,"e")):(l=!0,f=!1),y={get:e,set:s,configurable:l,enumerable:f},d?o(c(d),y):y}},function(t,i,r){var n=r(15),u=/^\s*class[\s{/}]/,o=Function.prototype.toString;t.exports=function(c){return!(!n(c)||u.test(o.call(c)))}},function(t,i,r){var n=r(16);t.exports=function(u){if(typeof u!="function"||!hasOwnProperty.call(u,"length"))return!1;try{if(typeof u.length!="number"||typeof u.call!="function"||typeof u.apply!="function")return!1}catch(o){return!1}return!n(u)}},function(t,i,r){var n=r(17);t.exports=function(u){if(!n(u))return!1;try{return u.constructor?u.constructor.prototype===u:!1}catch(o){return!1}}},function(t,i,r){var n=r(6),u={object:!0,function:!0,undefined:!0};t.exports=function(o){return n(o)?hasOwnProperty.call(u,typeof o):!1}},function(t,i,r){t.exports=r(19)()?Object.assign:r(20)},function(t,i,r){t.exports=function(){var n=Object.assign,u;return typeof n!="function"?!1:(u={foo:"raz"},n(u,{bar:"dwa"},{trzy:"trzy"}),u.foo+u.bar+u.trzy==="razdwatrzy")}},function(t,i,r){var n=r(21),u=r(25),o=Math.max;t.exports=function(c,g){var v,p,e=o(arguments.length,2),s;for(c=Object(u(c)),s=function(l){try{c[l]=g[l]}catch(f){v||(v=f)}},p=1;p<e;++p)g=arguments[p],n(g).forEach(s);if(v!==void 0)throw v;return c}},function(t,i,r){t.exports=r(22)()?Object.keys:r(23)},function(t,i,r){t.exports=function(){try{return Object.keys("primitive"),!0}catch(n){return!1}}},function(t,i,r){var n=r(3),u=Object.keys;t.exports=function(o){return u(n(o)?Object(o):o)}},function(t,i,r){t.exports=function(){}},function(t,i,r){var n=r(3);t.exports=function(u){if(!n(u))throw new TypeError("Cannot use null or undefined");return u}},function(t,i,r){var n=r(3),u=Array.prototype.forEach,o=Object.create,c=function(g,v){var p;for(p in g)v[p]=g[p]};t.exports=function(g){var v=o(null);return u.call(arguments,function(p){!n(p)||c(Object(p),v)}),v}},function(t,i,r){t.exports=r(28)()?String.prototype.contains:r(29)},function(t,i,r){var n="razdwatrzy";t.exports=function(){return typeof n.contains!="function"?!1:n.contains("dwa")===!0&&n.contains("foo")===!1}},function(t,i,r){var n=String.prototype.indexOf;t.exports=function(u){return n.call(this,u,arguments[1])>-1}},function(t,i,r){t.exports=function(n){if(typeof n!="function")throw new TypeError(n+" is not a function");return n}},function(t,i,r){var n=r(32),u=Object.prototype.hasOwnProperty;t.exports=function(o){var c=arguments[1],g;if(n(o),c!==void 0){if(g=u.call(o,"__ee__")&&o.__ee__,!g)return;g[c]&&delete g[c];return}u.call(o,"__ee__")&&delete o.__ee__}},function(t,i,r){var n=r(33);t.exports=function(u){if(!n(u))throw new TypeError(u+" is not an Object");return u}},function(t,i,r){var n=r(3),u={function:!0,object:!0};t.exports=function(o){return n(o)&&u[typeof o]||!1}},function(t,i,r){var n=r(35);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default{background:#000;width:100%;height:100%;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;-ms-user-select:none}.xgplayer-skin-default *{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}.xgplayer-skin-default.xgplayer-rotate-fullscreen{position:absolute;top:0;left:100%;bottom:0;right:0;height:100vw!important;width:100vh!important;-webkit-transform-origin:top left;-ms-transform-origin:top left;transform-origin:top left;-webkit-transform:rotate(90deg);-ms-transform:rotate(90deg);transform:rotate(90deg)}.xgplayer-skin-default.xgplayer-is-fullscreen{width:100%!important;height:100%!important;padding-top:0!important;z-index:9999}.xgplayer-skin-default.xgplayer-is-fullscreen.xgplayer-inactive{cursor:none}.xgplayer-skin-default video{width:100%;height:100%;outline:none}.xgplayer-skin-default .xgplayer-none{display:none}@-webkit-keyframes loadingRotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes loadingRotate{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@-webkit-keyframes loadingDashOffset{0%{stroke-dashoffset:236}to{stroke-dashoffset:0}}@keyframes loadingDashOffset{0%{stroke-dashoffset:236}to{stroke-dashoffset:0}}.xgplayer-skin-default .xgplayer-controls{display:-webkit-flex;display:-moz-box;display:flex;position:absolute;bottom:0;left:0;right:0;height:40px;background-image:linear-gradient(180deg,transparent,rgba(0,0,0,.37),rgba(0,0,0,.75),rgba(0,0,0,.75));z-index:10}.xgplayer-skin-default.xgplayer-inactive .xgplayer-controls,.xgplayer-skin-default.xgplayer-is-live .xgplayer-controls .xgplayer-progress,.xgplayer-skin-default.xgplayer-is-live .xgplayer-controls .xgplayer-time,.xgplayer-skin-default.xgplayer-no-controls .xgplayer-controls,.xgplayer-skin-default.xgplayer-nostart .xgplayer-controls{display:none}.xgplayer-skin-default.xgplayer-is-live .xgplayer-controls .xgplayer-live{display:block}.xgplayer-skin-default .xgplayer-live{display:block;font-size:12px;color:#fff;line-height:40px;-webkit-order:1;-moz-box-ordinal-group:2;order:1}.xgplayer-skin-default .xgplayer-icon{display:block;width:40px;height:40px;overflow:hidden;fill:#fff}.xgplayer-skin-default .xgplayer-icon svg{position:absolute}.xgplayer-skin-default .xgplayer-tips{background:rgba(0,0,0,.54);border-radius:1px;display:none;position:absolute;font-family:PingFangSC-Regular;font-size:11px;color:#fff;padding:2px 4px;text-align:center;top:-30px;left:50%;margin-left:-16px;width:auto;white-space:nowrap}.xgplayer-skin-default.xgplayer-mobile .xgplayer-tips{display:none!important}.xgplayer-skin-default .xgplayer-screen-container{display:block;width:100%}",""])},function(t,i){t.exports=function(r){var n=typeof window!="undefined"&&window.location;if(!n)throw new Error("fixUrls requires window.location");if(!r||typeof r!="string")return r;var u=n.protocol+"//"+n.host,o=u+n.pathname.replace(/\/[^\/]*$/,"/"),c=r.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(g,v){var p=v.trim().replace(/^"(.*)"$/,function(s,l){return l}).replace(/^'(.*)'$/,function(s,l){return l});if(/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(p))return g;var e;return p.indexOf("//")===0?e=p:p.indexOf("/")===0?e=u+p:e=o+p.replace(/^\.\//,""),"url("+JSON.stringify(e)+")"});return c}},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var c=this,g=c.root,v=0,p=void 0,e={first:"",second:""};c.onElementTouchend=function(f,d){this.config.closeVideoPreventDefault||f.preventDefault(),this.config.closeVideoStopPropagation||f.stopPropagation();var y=this;if((0,n.hasClass)(g,"xgplayer-inactive")?y.emit("focus"):y.emit("blur"),!y.config.closeVideoTouch&&!y.isTouchMove){var m=function(){p=setTimeout(function(){if((0,n.hasClass)(y.root,"xgplayer-nostart"))return!1;if(!y.ended)if(y.paused){var E=y.play();E!==void 0&&E&&E.catch(function(w){})}else y.pause();v=0},200)};y.config.closeVideoClick||(v++,p&&clearTimeout(p),v===1?y.config.enableVideoDbltouch?e.first=new Date:m():v===2&&y.config.enableVideoDbltouch?(e.second=new Date,Math.abs(e.first-e.second)<400?m():(e.first=new Date,v=1)):v=0)}};function s(f){c.video.addEventListener("touchend",function(d){c.onElementTouchend(d,c.video)}),c.video.addEventListener("touchstart",function(){c.isTouchMove=!1}),c.video.addEventListener("touchmove",function(){c.isTouchMove=!0}),c.config.autoplay&&c.start()}c.once("ready",s);function l(){c.off("ready",s),c.off("destroy",l)}c.once("destroy",l)};i.default={name:"mobile",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var c=this;if(!c.controls||!c.video)return;var g=c.controls,v=c.root,p=0,e=void 0;c.onElementClick=function(E,w){this.config.closeVideoPreventDefault||E.preventDefault(),this.config.closeVideoStopPropagation||E.stopPropagation();var k=this;k.config.closeVideoClick||(p++,e&&clearTimeout(e),p===1?e=setTimeout(function(){if((0,n.hasClass)(k.root,"xgplayer-nostart"))return!1;if(!k.ended)if(k.paused){var x=k.play();x!==void 0&&x&&x.catch(function(S){})}else k.pause();p=0},200):p=0)},c.video.addEventListener("click",function(E){c.onElementClick(E,c.video)},!1),c.onElementDblclick=function(E,w){this.config.closeVideoPreventDefault||E.preventDefault(),this.config.closeVideoStopPropagation||E.stopPropagation();var k=this;if(!k.config.closeVideoDblclick){var x=g.querySelector(".xgplayer-fullscreen");if(x){var S=void 0;document.createEvent?(S=document.createEvent("Event"),S.initEvent("click",!0,!0)):S=new Event("click"),x.dispatchEvent(S)}}},c.video.addEventListener("dblclick",function(E){c.onElementDblclick(E,c.video)},!1);function s(){clearTimeout(c.leavePlayerTimer),c.emit("focus",c)}v.addEventListener("mouseenter",s);function l(){c.config.closePlayerBlur||(c.leavePlayerTimer=setTimeout(function(){c.emit("blur",c)},c.config.leavePlayerTime||0))}v.addEventListener("mouseleave",l);function f(E){c.userTimer&&clearTimeout(c.userTimer)}g.addEventListener("mouseenter",f);function d(E){c.config.closeControlsBlur||c.emit("focus",c)}g.addEventListener("mouseleave",d);function y(E){E.preventDefault(),E.stopPropagation()}g.addEventListener("click",y);function m(E){c.config.autoplay&&c.start()}c.once("ready",m);function _(){v.removeEventListener("mouseenter",s),v.removeEventListener("mouseleave",l),c.off("ready",m),c.off("destroy",_)}c.once("destroy",_)};i.default={name:"pc",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var c=this,g=c.root;function v(){c.off("canplay",v);var s=c.play();s!==void 0&&s&&s.catch(function(l){})}function p(){(0,n.hasClass)(g,"xgplayer-nostart")?((0,n.removeClass)(g,"xgplayer-nostart"),(0,n.addClass)(g,"xgplayer-is-enter"),typeof g.contains=="function"?c.video&&c.video.nodeType===1&&!g.contains(c.video)||c.video&&c.video.nodeType!==1&&c.video.mediaSource===void 0?(c.once("canplay",v),c.start()):v():c.video&&c.video.nodeType===1&&!g.querySelector(this.videoConfig.mediaType)||c.video&&c.video.nodeType!==1&&c.video.mediaSource===void 0?(c.once("canplay",v),c.start()):v()):c.paused&&((0,n.removeClass)(g,"xgplayer-nostart xgplayer-isloading"),setTimeout(function(){var s=c.play();s!==void 0&&s&&s.catch(function(l){})},10))}c.on("startBtnClick",p);function e(){c.off("startBtnClick",p),c.off("canplay",v),c.off("destroy",e)}c.once("destroy",e)};i.default={name:"start",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(41),o=v(u),c=r(42),g=v(c);r(43);function v(e){return e&&e.__esModule?e:{default:e}}var p=function(){var s=this,l=s.root,f=(0,n.createDom)("xg-start",'<div class="xgplayer-icon-play">'+o.default+`</div>
                                      <div class="xgplayer-icon-pause">`+g.default+"</div>",{},"xgplayer-start");function d(y){(0,n.addClass)(y.root,"xgplayer-skin-default"),y.config&&(y.config.autoplay&&!(0,n.isWeiXin)()&&!(0,n.isUc)()&&(0,n.addClass)(y.root,"xgplayer-is-enter"),y.config.lang&&y.config.lang==="en"?(0,n.addClass)(y.root,"xgplayer-lang-is-en"):y.config.lang==="jp"&&(0,n.addClass)(y.root,"xgplayer-lang-is-jp"),y.config.enableContextmenu||y.video.addEventListener("contextmenu",function(m){m.preventDefault(),m.stopPropagation()}))}s.config&&s.config.hideStartBtn&&(0,n.addClass)(l,"xgplayer-start-hide"),s.isReady?(l.appendChild(f),d(s)):s.once("ready",function(){l.appendChild(f),d(s)}),s.once("autoplay was prevented",function(){(0,n.removeClass)(s.root,"xgplayer-is-enter"),(0,n.addClass)(s.root,"xgplayer-nostart")}),s.once("canplay",function(){(0,n.removeClass)(s.root,"xgplayer-is-enter")}),f.onclick=function(y){y.preventDefault(),y.stopPropagation(),s.userGestureTrigEvent("startBtnClick")}};i.default={name:"s_start",method:p},t.exports=i.default},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="70" height="70" viewBox="0 0 70 70">
  <path transform="translate(15,15) scale(0.04,0.04)" d="M576,363L810,512L576,661zM342,214L576,363L576,661L342,810z"></path>
</svg>
`},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="70" height="70" viewBox="0 0 70 70">
  <path transform="translate(15,15) scale(0.04 0.04)" d="M598,214h170v596h-170v-596zM256 810v-596h170v596h-170z"></path>
</svg>
`},function(t,i,r){var n=r(44);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-start{border-radius:50%;display:inline-block;width:70px;height:70px;background:rgba(0,0,0,.38);overflow:hidden;text-align:center;line-height:70px;vertical-align:middle;position:absolute;left:50%;top:50%;z-index:115;margin:-35px auto auto -35px;cursor:pointer}.xgplayer-skin-default .xgplayer-start div{position:absolute}.xgplayer-skin-default .xgplayer-start div svg{fill:hsla(0,0%,100%,.7)}.xgplayer-skin-default .xgplayer-start .xgplayer-icon-play{display:block}.xgplayer-skin-default .xgplayer-start .xgplayer-icon-pause{display:none}.xgplayer-skin-default .xgplayer-start:hover{opacity:.85}.xgplayer-skin-default.xgplayer-pause.xgplayer-start-hide .xgplayer-start,.xgplayer-skin-default.xgplayer-playing .xgplayer-start,.xgplayer-skin-default.xgplayer-playing .xgplayer-start .xgplayer-icon-play,.xgplayer-skin-default.xgplayer-start-hide .xgplayer-start{display:none}.xgplayer-skin-default.xgplayer-playing .xgplayer-start .xgplayer-icon-pause{display:block}.xgplayer-skin-default.xgplayer-pause .xgplayer-start{display:inline-block}.xgplayer-skin-default.xgplayer-pause .xgplayer-start .xgplayer-icon-play{display:block}.xgplayer-skin-default.xgplayer-is-replay .xgplayer-start,.xgplayer-skin-default.xgplayer-pause .xgplayer-start .xgplayer-icon-pause{display:none}.xgplayer-skin-default.xgplayer-is-replay .xgplayer-start .xgplayer-icon-play{display:block}.xgplayer-skin-default.xgplayer-is-replay .xgplayer-start .xgplayer-icon-pause{display:none}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var c=this,g=c.root;function v(){c.config.rotateFullscreen?(0,n.hasClass)(g,"xgplayer-rotate-fullscreen")?c.exitRotateFullscreen():c.getRotateFullscreen():(0,n.hasClass)(g,"xgplayer-is-fullscreen")?c.exitFullscreen(g):c.getFullscreen(g)}c.on("fullscreenBtnClick",v);function p(){var l=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;l&&l===g?((0,n.addClass)(g,"xgplayer-is-fullscreen"),c.emit("requestFullscreen")):(0,n.hasClass)(g,"xgplayer-is-fullscreen")&&((0,n.removeClass)(g,"xgplayer-is-fullscreen"),c.emit("exitFullscreen")),c.danmu&&typeof c.danmu.resize=="function"&&c.danmu.resize()}["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"].forEach(function(l){document.addEventListener(l,p)}),c.video.addEventListener("webkitbeginfullscreen",function(){(0,n.addClass)(g,"xgplayer-is-fullscreen"),c.emit("requestFullscreen")}),c.video.addEventListener("webkitendfullscreen",function(){(0,n.removeClass)(g,"xgplayer-is-fullscreen"),c.emit("exitFullscreen")});function e(l){var f=c.video.webkitPresentationMode;f!==n.PresentationMode.FULLSCREEN&&((0,n.removeClass)(g,"xgplayer-is-fullscreen"),c.emit("exitFullscreen"))}(0,n.checkWebkitSetPresentationMode)(c.video)&&c.video.addEventListener("webkitpresentationmodechanged",e);function s(){c.off("fullscreenBtnClick",v),["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"].forEach(function(l){document.removeEventListener(l,p)}),(0,n.checkWebkitSetPresentationMode)(c.video)&&c.video.removeEventListener("webkitpresentationmodechanged",e),c.off("destroy",s)}c.once("destroy",s),c.getFullscreen=function(l){var f=this;if(l.requestFullscreen){var d=l.requestFullscreen();d&&d.catch(function(){f.emit("fullscreen error")})}else l.mozRequestFullScreen?l.mozRequestFullScreen():l.webkitRequestFullscreen?l.webkitRequestFullscreen(window.Element.ALLOW_KEYBOARD_INPUT):f.video.webkitSupportsFullscreen?f.video.webkitEnterFullscreen():l.msRequestFullscreen?l.msRequestFullscreen():(0,n.addClass)(l,"xgplayer-is-cssfullscreen")},c.exitFullscreen=function(l){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen(),(0,n.removeClass)(l,"xgplayer-is-cssfullscreen")},c.getRotateFullscreen=function(){var l=this;document.documentElement.style.width="100%",document.documentElement.style.height="100%",l.config.fluid&&(l.root.style["padding-top"]="",l.root.style["max-width"]="unset"),l.root&&!(0,n.hasClass)(l.root,"xgplayer-rotate-fullscreen")&&(0,n.addClass)(l.root,"xgplayer-rotate-fullscreen"),l.emit("getRotateFullscreen")},c.exitRotateFullscreen=function(){var l=this;document.documentElement.style.width="unset",document.documentElement.style.height="unset",l.config.fluid&&(l.root.style.width="100%",l.root.style.height="0",l.root.style["padding-top"]=l.config.height*100/l.config.width+"%",l.root.style["max-width"]="100%"),l.root&&(0,n.hasClass)(l.root,"xgplayer-rotate-fullscreen")&&(0,n.removeClass)(l.root,"xgplayer-rotate-fullscreen"),l.emit("exitRotateFullscreen")}};i.default={name:"fullscreen",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var c=this;function g(){if(!(!c.config.allowPlayAfterEnded&&c.ended))if((0,n.hasClass)(c.root,"xgplayer-nostart")&&c.start(),c.paused){var p=c.play();p!==void 0&&p&&p.catch(function(e){})}else c.pause()}c.on("playBtnClick",g);function v(){c.off("playBtnClick",g),c.off("destroy",v)}c.once("destroy",v)};i.default={name:"play",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var c=this,g=c.root;function v(){(0,n.removeClass)(g,"xgplayer-is-replay"),c.replay()}c.on("replayBtnClick",v);function p(){c.config.loop||(0,n.addClass)(g,"xgplayer-is-replay")}c.on("ended",p);function e(){c.off("replayBtnClick",v),c.off("destroy",e)}c.once("destroy",e)};i.default={name:"replay",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(49),o=v(u),c=r(50),g=v(c);r(51);function v(e){return e&&e.__esModule?e:{default:e}}var p=function(){var s=this,l=s.config.playBtn?s.config.playBtn:{},f=void 0;l.type==="img"?f=(0,n.createImgBtn)("play",l.url.play,l.width,l.height):f=(0,n.createDom)("xg-play",`<xg-icon class="xgplayer-icon">
                                      <div class="xgplayer-icon-play">`+o.default+`</div>
                                      <div class="xgplayer-icon-pause">`+g.default+`</div>
                                     </xg-icon>`,{},"xgplayer-play");var d={};d.play=s.lang.PLAY_TIPS,d.pause=s.lang.PAUSE_TIPS;var y=(0,n.createDom)("xg-tips",'<span class="xgplayer-tip-play">'+d.play+`</span>
                                        <span class="xgplayer-tip-pause">`+d.pause+"</span>",{},"xgplayer-tips");f.appendChild(y),s.once("ready",function(){s.controls&&s.controls.appendChild(f)}),["click","touchend"].forEach(function(m){f.addEventListener(m,function(_){_.preventDefault(),_.stopPropagation(),s.userGestureTrigEvent("playBtnClick")})})};i.default={name:"s_play",method:p},t.exports=i.default},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
  <path transform="translate(2,2) scale(0.0320625 0.0320625)" d="M576,363L810,512L576,661zM342,214L576,363L576,661L342,810z"></path>
</svg>
`},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
  <path transform="translate(2,2) scale(0.0320625 0.0320625)" d="M598,214h170v596h-170v-596zM256 810v-596h170v596h-170z"></path>
</svg>
`},function(t,i,r){var n=r(52);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-play,.xgplayer-skin-default .xgplayer-play-img{width:40px;position:relative;-webkit-order:0;-moz-box-ordinal-group:1;order:0;display:block;cursor:pointer;margin-left:3px}.xgplayer-skin-default .xgplayer-play-img .xgplayer-icon,.xgplayer-skin-default .xgplayer-play .xgplayer-icon{margin-top:3px;width:32px}.xgplayer-skin-default .xgplayer-play-img .xgplayer-icon div,.xgplayer-skin-default .xgplayer-play .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-play-img .xgplayer-icon .xgplayer-icon-play,.xgplayer-skin-default .xgplayer-play .xgplayer-icon .xgplayer-icon-play{display:block}.xgplayer-skin-default .xgplayer-play-img .xgplayer-icon .xgplayer-icon-pause,.xgplayer-skin-default .xgplayer-play .xgplayer-icon .xgplayer-icon-pause{display:none}.xgplayer-skin-default .xgplayer-play-img .xgplayer-tips .xgplayer-tip-play,.xgplayer-skin-default .xgplayer-play .xgplayer-tips .xgplayer-tip-play{display:block}.xgplayer-skin-default .xgplayer-play-img .xgplayer-tips .xgplayer-tip-pause,.xgplayer-skin-default .xgplayer-play .xgplayer-tips .xgplayer-tip-pause{display:none}.xgplayer-skin-default .xgplayer-play-img:hover,.xgplayer-skin-default .xgplayer-play:hover{opacity:.85}.xgplayer-skin-default .xgplayer-play-img:hover .xgplayer-tips,.xgplayer-skin-default .xgplayer-play:hover .xgplayer-tips{display:block}.xgplayer-skin-default.xgplayer-playing .xgplayer-play-img .xgplayer-icon .xgplayer-icon-play,.xgplayer-skin-default.xgplayer-playing .xgplayer-play .xgplayer-icon .xgplayer-icon-play{display:none}.xgplayer-skin-default.xgplayer-playing .xgplayer-play-img .xgplayer-icon .xgplayer-icon-pause,.xgplayer-skin-default.xgplayer-playing .xgplayer-play .xgplayer-icon .xgplayer-icon-pause{display:block}.xgplayer-skin-default.xgplayer-playing .xgplayer-play-img .xgplayer-tips .xgplayer-tip-play,.xgplayer-skin-default.xgplayer-playing .xgplayer-play .xgplayer-tips .xgplayer-tip-play{display:none}.xgplayer-skin-default.xgplayer-pause .xgplayer-play-img .xgplayer-icon .xgplayer-icon-play,.xgplayer-skin-default.xgplayer-pause .xgplayer-play .xgplayer-icon .xgplayer-icon-play,.xgplayer-skin-default.xgplayer-playing .xgplayer-play-img .xgplayer-tips .xgplayer-tip-pause,.xgplayer-skin-default.xgplayer-playing .xgplayer-play .xgplayer-tips .xgplayer-tip-pause{display:block}.xgplayer-skin-default.xgplayer-pause .xgplayer-play-img .xgplayer-icon .xgplayer-icon-pause,.xgplayer-skin-default.xgplayer-pause .xgplayer-play .xgplayer-icon .xgplayer-icon-pause{display:none}.xgplayer-skin-default.xgplayer-pause .xgplayer-play-img .xgplayer-tips .xgplayer-tip-play,.xgplayer-skin-default.xgplayer-pause .xgplayer-play .xgplayer-tips .xgplayer-tip-play{display:block}.xgplayer-skin-default.xgplayer-pause .xgplayer-play-img .xgplayer-tips .xgplayer-tip-pause,.xgplayer-skin-default.xgplayer-pause .xgplayer-play .xgplayer-tips .xgplayer-tip-pause{display:none}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0);r(54);var u=function(){var c=this,g=c.root;if(!!c.config.poster){var v=(0,n.createDom)("xg-poster","",{},"xgplayer-poster");v.style.backgroundImage="url("+c.config.poster+")",g.appendChild(v)}};i.default={name:"s_poster",method:u},t.exports=i.default},function(t,i,r){var n=r(55);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-poster{display:none;position:absolute;left:0;top:0;width:100%;height:100%;z-index:100;background-size:cover;background-position:50%}.xgplayer-skin-default.xgplayer-nostart .xgplayer-poster{display:block}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0);r(57);var u=function(){var c=this,g=(0,n.createDom)("xg-placeholder","",{},"xgplayer-placeholder");c.controls.appendChild(g)};i.default={name:"s_flex",method:u},t.exports=i.default},function(t,i,r){var n=r(58);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-placeholder{-webkit-flex:1;-moz-box-flex:1;flex:1;-webkit-order:3;-moz-box-ordinal-group:4;order:3;display:block}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(60),o=v(u),c=r(61),g=v(c);r(62);function v(e){return e&&e.__esModule?e:{default:e}}var p=function(){var s=this,l=s.config.fullscreenBtn?s.config.fullscreenBtn:{},f=void 0;l.type==="img"?f=(0,n.createImgBtn)("fullscreen",l.url.request,l.width,l.height):f=(0,n.createDom)("xg-fullscreen",`<xg-icon class="xgplayer-icon">
                                             <div class="xgplayer-icon-requestfull">`+o.default+`</div>
                                             <div class="xgplayer-icon-exitfull">`+g.default+`</div>
                                           </xg-icon>`,{},"xgplayer-fullscreen");var d={};d.requestfull=s.lang.FULLSCREEN_TIPS,d.exitfull=s.lang.EXITFULLSCREEN_TIPS;var y=(0,n.createDom)("xg-tips",'<span class="xgplayer-tip-requestfull">'+d.requestfull+`</span>
                                        <span class="xgplayer-tip-exitfull">`+d.exitfull+"</span>",{},"xgplayer-tips");f.appendChild(y),s.once("ready",function(){s.controls&&s.controls.appendChild(f)}),["click","touchend"].forEach(function(m){f.addEventListener(m,function(_){_.preventDefault(),_.stopPropagation(),s.userGestureTrigEvent("fullscreenBtnClick")})})};i.default={name:"s_fullscreen",method:p},t.exports=i.default},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
  <path transform="scale(0.0320625 0.0320625)" d="M598 214h212v212h-84v-128h-128v-84zM726 726v-128h84v212h-212v-84h128zM214 426v-212h212v84h-128v128h-84zM298 598v128h128v84h-212v-212h84z"></path>
</svg>
`},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
  <path transform="scale(0.0320625 0.0320625)" d="M682 342h128v84h-212v-212h84v128zM598 810v-212h212v84h-128v128h-84zM342 342v-128h84v212h-212v-84h128zM214 682v-84h212v212h-84v-128h-128z"></path>
</svg>
`},function(t,i,r){var n=r(63);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-fullscreen,.xgplayer-skin-default .xgplayer-fullscreen-img{position:relative;-webkit-order:13;-moz-box-ordinal-group:14;order:13;display:block;cursor:pointer;margin-left:5px;margin-right:3px}.xgplayer-skin-default .xgplayer-fullscreen-img .xgplayer-icon,.xgplayer-skin-default .xgplayer-fullscreen .xgplayer-icon{margin-top:3px}.xgplayer-skin-default .xgplayer-fullscreen-img .xgplayer-icon div,.xgplayer-skin-default .xgplayer-fullscreen .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-fullscreen-img .xgplayer-icon .xgplayer-icon-requestfull,.xgplayer-skin-default .xgplayer-fullscreen .xgplayer-icon .xgplayer-icon-requestfull{display:block}.xgplayer-skin-default .xgplayer-fullscreen-img .xgplayer-icon .xgplayer-icon-exitfull,.xgplayer-skin-default .xgplayer-fullscreen .xgplayer-icon .xgplayer-icon-exitfull{display:none}.xgplayer-skin-default .xgplayer-fullscreen-img .xgplayer-tips,.xgplayer-skin-default .xgplayer-fullscreen .xgplayer-tips{position:absolute;right:0;left:auto}.xgplayer-skin-default .xgplayer-fullscreen-img .xgplayer-tips .xgplayer-tip-requestfull,.xgplayer-skin-default .xgplayer-fullscreen .xgplayer-tips .xgplayer-tip-requestfull{display:block}.xgplayer-skin-default .xgplayer-fullscreen-img .xgplayer-tips .xgplayer-tip-exitfull,.xgplayer-skin-default .xgplayer-fullscreen .xgplayer-tips .xgplayer-tip-exitfull{display:none}.xgplayer-skin-default .xgplayer-fullscreen-img:hover,.xgplayer-skin-default .xgplayer-fullscreen:hover{opacity:.85}.xgplayer-skin-default .xgplayer-fullscreen-img:hover .xgplayer-tips,.xgplayer-skin-default .xgplayer-fullscreen:hover .xgplayer-tips{display:block}.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-fullscreen-img .xgplayer-icon .xgplayer-icon-requestfull,.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-fullscreen .xgplayer-icon .xgplayer-icon-requestfull,.xgplayer-skin-default.xgplayer-rotate-fullscreen .xgplayer-fullscreen-img .xgplayer-icon .xgplayer-icon-requestfull,.xgplayer-skin-default.xgplayer-rotate-fullscreen .xgplayer-fullscreen .xgplayer-icon .xgplayer-icon-requestfull{display:none}.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-fullscreen-img .xgplayer-icon .xgplayer-icon-exitfull,.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-fullscreen .xgplayer-icon .xgplayer-icon-exitfull,.xgplayer-skin-default.xgplayer-rotate-fullscreen .xgplayer-fullscreen-img .xgplayer-icon .xgplayer-icon-exitfull,.xgplayer-skin-default.xgplayer-rotate-fullscreen .xgplayer-fullscreen .xgplayer-icon .xgplayer-icon-exitfull{display:block}.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-fullscreen-img .xgplayer-tips .xgplayer-tip-requestfull,.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-fullscreen .xgplayer-tips .xgplayer-tip-requestfull,.xgplayer-skin-default.xgplayer-rotate-fullscreen .xgplayer-fullscreen-img .xgplayer-tips .xgplayer-tip-requestfull,.xgplayer-skin-default.xgplayer-rotate-fullscreen .xgplayer-fullscreen .xgplayer-tips .xgplayer-tip-requestfull{display:none}.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-fullscreen-img .xgplayer-tips .xgplayer-tip-exitfull,.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-fullscreen .xgplayer-tips .xgplayer-tip-exitfull,.xgplayer-skin-default.xgplayer-rotate-fullscreen .xgplayer-fullscreen-img .xgplayer-tips .xgplayer-tip-exitfull,.xgplayer-skin-default.xgplayer-rotate-fullscreen .xgplayer-fullscreen .xgplayer-tips .xgplayer-tip-exitfull{display:block}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(65),o=c(u);r(66);function c(v){return v&&v.__esModule?v:{default:v}}var g=function(){var p=this,e=p.root,s=(0,n.createDom)("xg-loading",""+o.default,{},"xgplayer-loading");p.once("ready",function(){e.appendChild(s)})};i.default={name:"s_loading",method:g},t.exports=i.default},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewbox="0 0 100 100">
  <path d="M100,50A50,50,0,1,1,50,0"></path>
</svg>
`},function(t,i,r){var n=r(67);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-loading{display:none;width:100px;height:100px;overflow:hidden;-webkit-transform:scale(.7);-ms-transform:scale(.7);transform:scale(.7);position:absolute;left:50%;top:50%;margin:-50px auto auto -50px}.xgplayer-skin-default .xgplayer-loading svg{border-radius:50%;-webkit-transform-origin:center;-ms-transform-origin:center;transform-origin:center;-webkit-animation:loadingRotate 1s linear infinite;animation:loadingRotate 1s linear infinite}.xgplayer-skin-default .xgplayer-loading svg path{stroke:#ddd;stroke-dasharray:236;-webkit-animation:loadingDashOffset 2s linear infinite;animation:loadingDashOffset 2s linear infinite;animation-direction:alternate-reverse;fill:none;stroke-width:12px}.xgplayer-skin-default.xgplayer-nostart .xgplayer-loading{display:none}.xgplayer-skin-default.xgplayer-pause .xgplayer-loading{display:none!important}.xgplayer-skin-default.xgplayer-isloading .xgplayer-loading{display:block}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(5),o=c(u);r(69);function c(p){return p&&p.__esModule?p:{default:p}}var g=function(e){return(0,n.hasClass)(e.root,"xgplayer-rotate-fullscreen")},v=function(){var e=this,s=(0,n.createDom)("xg-progress",`<xg-outer class="xgplayer-progress-outer">
                                                   <xg-cache class="xgplayer-progress-cache"></xg-cache>
                                                   <xg-played class="xgplayer-progress-played">
                                                     <xg-progress-btn class="xgplayer-progress-btn"></xg-progress-btn>
                                                     <xg-point class="xgplayer-progress-point xgplayer-tips"></xg-point>
                                                     <xg-thumbnail class="xgplayer-progress-thumbnail xgplayer-tips"></xg-thumbnail>
                                                   </xg-played>
                                                 </xg-outer>`,{tabindex:1},"xgplayer-progress"),l=void 0;e.controls.appendChild(s);var f=s.querySelector(".xgplayer-progress-played"),d=s.querySelector(".xgplayer-progress-outer"),y=s.querySelector(".xgplayer-progress-cache"),m=s.querySelector(".xgplayer-progress-point"),_=s.querySelector(".xgplayer-progress-thumbnail");e.dotArr={};function E(J,Q){J.addEventListener("mouseenter",function(ne){Q&&((0,n.addClass)(J,"xgplayer-progress-dot-show"),(0,n.addClass)(s,"xgplayer-progress-dot-active"))}),J.addEventListener("mouseleave",function(ne){Q&&((0,n.removeClass)(J,"xgplayer-progress-dot-show"),(0,n.removeClass)(s,"xgplayer-progress-dot-active"))}),J.addEventListener("touchend",function(ne){ne.stopPropagation(),Q&&((0,n.hasClass)(J,"xgplayer-progress-dot-show")||Object.keys(e.dotArr).forEach(function(Ee){e.dotArr[Ee]&&(0,n.removeClass)(e.dotArr[Ee],"xgplayer-progress-dot-show")}),(0,n.toggleClass)(J,"xgplayer-progress-dot-show"),(0,n.toggleClass)(s,"xgplayer-progress-dot-active"))})}function w(){e.config.progressDot&&(0,n.typeOf)(e.config.progressDot)==="Array"&&e.config.progressDot.forEach(function(J){if(J.time>=0&&J.time<=e.duration){var Q=(0,n.createDom)("xg-progress-dot",J.text?'<span class="xgplayer-progress-tip">'+J.text+"</span>":"",{},"xgplayer-progress-dot");if(Q.style.left=J.time/e.duration*100+"%",J.duration>=0&&(Q.style.width=Math.min(J.duration,e.duration-J.time)/e.duration*100+"%"),J.style)for(var ne in J.style)Q.style[ne]=J.style[ne];d.appendChild(Q),e.dotArr[J.time]=Q,E(Q,J.text)}})}e.once("canplay",w),e.addProgressDot=function(J,Q,ne,Ee){if(!e.dotArr[J]&&J>=0&&J<=e.duration){var we=(0,n.createDom)("xg-progress-dot",Q?'<span class="xgplayer-progress-tip">'+Q+"</span>":"",{},"xgplayer-progress-dot");if(we.style.left=J/e.duration*100+"%",ne>=0&&(we.style.width=Math.min(ne,e.duration-J)/e.duration*100+"%"),Ee)for(var Ae in Ee)we.style[Ae]=Ee[Ae];d.appendChild(we),e.dotArr[J]=we,E(we,Q)}},e.removeProgressDot=function(J){if(J>=0&&J<=e.duration&&e.dotArr[J]){var Q=e.dotArr[J];Q.parentNode.removeChild(Q),Q=null,e.dotArr[J]=null}},e.removeAllProgressDot=function(){Object.keys(e.dotArr).forEach(function(J){if(e.dotArr[J]){var Q=e.dotArr[J];Q.parentNode.removeChild(Q),Q=null,e.dotArr[J]=null}})};var k=0,x=0,S=0,P=0,U=0,R=0,C=[],A=void 0,b=void 0,O=function(){e.config.thumbnail&&(e.config.thumbnail.isShowCoverPreview&&!A&&(f.removeChild(_),A=(0,n.createDom)("xg-coverpreview",`<xg-outer class="xgplayer-coverpreview-outer">
            <xg-thumbnail class="xgplayer-coverpreview-thumbnail"></xg-thumbnail>
            <xg-point class="xgplayer-coverpreview-point"></xg-point>
          </xg-outer>`,{tabindex:1},"xgplayer-coverpreview"),A.querySelector(".xgplayer-coverpreview-outer"),b=A.querySelector(".xgplayer-coverpreview-point"),_=A.querySelector(".xgplayer-coverpreview-thumbnail"),e.root.appendChild(A)),k=e.config.thumbnail.pic_num,x=e.config.thumbnail.width,S=e.config.thumbnail.height,P=e.config.thumbnail.col,U=e.config.thumbnail.row,C=e.config.thumbnail.urls,_.style.width=x+"px",_.style.height=S+"px")};e.on("loadedmetadata",O),typeof e.config.disableSwipeHandler=="function"&&typeof e.config.enableSwipeHandler=="function"&&(e.root.addEventListener("touchmove",function(J){J.preventDefault(),e.disableSwipe||(e.disableSwipe=!0,e.config.disableSwipeHandler.call(e))}),e.root.addEventListener("touchstart",function(J){e.disableSwipe=!0,e.config.disableSwipeHandler.call(e)}),e.root.addEventListener("touchend",function(J){e.disableSwipe=!1,e.config.enableSwipeHandler.call(e)}));var W=["touchstart","mousedown"];o.default.device==="mobile"&&W.pop(),W.forEach(function(J){s.addEventListener(J,function(Q){if(!e.config.disableProgress){if(Q.stopPropagation(),(0,n.event)(Q),Q._target===m||!e.config.allowSeekAfterEnded&&e.ended)return!0;s.focus();var ne=f.getBoundingClientRect(),Ee=ne.left,we=g(e);we?(Ee=f.getBoundingClientRect().top,l=s.getBoundingClientRect().height):(l=s.getBoundingClientRect().width,Ee=f.getBoundingClientRect().left);var Ae=function(Ce){Ce.stopPropagation(),(0,n.event)(Ce),e.isProgressMoving=!0;var Me=(we?Ce.clientY:Ce.clientX)-Ee;Me>l&&(Me=l);var Ge=Me/l*e.duration;if(Ge<0&&(Ge=0),!(e.config.allowSeekPlayed&&Number(Ge).toFixed(1)>e.maxPlayedTime))if(f.style.width=Me*100/l+"%",e.videoConfig.mediaType==="video"&&!e.dash&&!e.config.closeMoveSeek)console.log("trigger touchmove"),e.currentTime=Number(Ge).toFixed(1);else{var D=(0,n.findDom)(e.controls,".xgplayer-time");D&&(D.innerHTML='<span class="xgplayer-time-current">'+(0,n.format)(Ge||0)+"</span><span>"+(0,n.format)(e.duration)+"</span>")}if(e.config.thumbnail&&e.config.thumbnail.isShowCoverPreview){b.innerHTML="<span>"+(0,n.format)(Ge)+"</span> / "+(0,n.format)(e.duration||0),R=e.duration/k;var fe=Math.floor(Ge/R);_.style.backgroundImage="url("+C[Math.ceil((fe+1)/(P*U))-1]+")";var ae=fe+1-P*U*(Math.ceil((fe+1)/(P*U))-1),X=Math.ceil(ae/U)-1,H=ae-X*U-1;_.style["background-position"]="-"+H*x+"px -"+X*S+"px",A.style.display="block"}e.emit("focus")},De=function Ve(Ce){if(console.log("up event",Ce),Ce.stopPropagation(),(0,n.event)(Ce),window.removeEventListener("mousemove",Ae),window.removeEventListener("touchmove",Ae,{passive:!1}),window.removeEventListener("mouseup",Ve),window.removeEventListener("touchend",Ve),o.default.browser.indexOf("ie")<0&&s.blur(),!e.isProgressMoving||e.videoConfig&&e.videoConfig.mediaType==="audio"||e.dash||e.config.closeMoveSeek){var Me=(we?Ce.clientY:Ce.clientX)-Ee;Me>l&&(Me=l);var Ge=Me/l*e.duration;Ge<0&&(Ge=0),e.config.allowSeekPlayed&&Number(Ge).toFixed(1)>e.maxPlayedTime||(f.style.width=Me*100/l+"%",console.warn("trigger touchup"),e.currentTime=Number(Ge).toFixed(1))}e.config.thumbnail&&e.config.thumbnail.isShowCoverPreview&&(A.style.display="none"),e.emit("focus"),e.isProgressMoving=!1};return window.addEventListener("touchmove",Ae,{passive:!1}),window.addEventListener("touchend",De),window.addEventListener("mousemove",Ae),window.addEventListener("mouseup",De),!0}})}),s.addEventListener("mouseenter",function(J){if(!e.config.allowSeekAfterEnded&&e.ended)return!0;var Q=g(e),ne=Q?s.getBoundingClientRect().top:s.getBoundingClientRect().left,Ee=Q?s.getBoundingClientRect().height:s.getBoundingClientRect().width,we=function(Ce){var Me=((Q?Ce.clientY:Ce.clientX)-ne)/Ee*e.duration;Me=Me<0?0:Me,m.textContent=(0,n.format)(Me);var Ge=m.getBoundingClientRect().width;if(e.config.thumbnail&&!e.config.thumbnail.isShowCoverPreview){R=e.duration/k;var D=Math.floor(Me/R);_.style.backgroundImage="url("+C[Math.ceil((D+1)/(P*U))-1]+")";var fe=D+1-P*U*(Math.ceil((D+1)/(P*U))-1),ae=Math.ceil(fe/U)-1,X=fe-ae*U-1;_.style["background-position"]="-"+X*x+"px -"+ae*S+"px";var H=(Q?Ce.clientY:Ce.clientX)-ne-x/2;H=H>0?H:0,H=H<Ee-x?H:Ee-x,_.style.left=H+"px",_.style.top=-10-S+"px",_.style.display="block",m.style.left=H+x/2-Ge/2+"px"}else{var q=Ce.clientX-ne-Ge/2;q=q>0?q:0,q=q>Ee-Ge?Ee-Ge:q,m.style.left=q+"px"}(0,n.hasClass)(s,"xgplayer-progress-dot-active")?m.style.display="none":m.style.display="block"},Ae=function(Ce){we(Ce)},De=function Ve(Ce){s.removeEventListener("mousemove",Ae,!1),s.removeEventListener("mouseleave",Ve,!1),we(Ce),m.style.display="none",e.config.thumbnail&&!e.config.thumbnail.isShowCoverPreview&&(_.style.display="none")};s.addEventListener("mousemove",Ae,!1),s.addEventListener("mouseleave",De,!1),we(J)},!1);var K=function(){if(e.maxPlayedTime===void 0&&(e.maxPlayedTime=0),e.maxPlayedTime<e.currentTime&&(e.maxPlayedTime=e.currentTime),!l&&s&&(l=s.getBoundingClientRect().width),!e.isProgressMoving&&!e.isSeeking&&!e.seeking){var Q=e.currentTime/e.duration,ne=Number(f.style.width.replace("%","")||"0")/Number(s.style.width||"100");Math.abs(Q-ne)<=1&&(f.style.width=e.currentTime*100/e.duration+"%")}};e.on("timeupdate",K);var G=function(Q){f.style.width=Q*100/e.duration+"%"};e.on("currentTimeChange",G);var B=function(){f.style.width="0%"};e.on("srcChange",B);var j=function(){var Q=e.buffered;if(Q&&Q.length>0){for(var ne=Q.end(Q.length-1),Ee=0,we=Q.length;Ee<we;Ee++)if(e.currentTime>=Q.start(Ee)&&e.currentTime<=Q.end(Ee)){ne=Q.end(Ee);for(var Ae=Ee+1;Ae<Q.length;Ae++)if(Q.start(Ae)-Q.end(Ae-1)>=2){ne=Q.end(Ae-1);break}break}y.style.width=ne/e.duration*100+"%"}},z=["bufferedChange","cacheupdate","ended","timeupdate"];z.forEach(function(J){e.on(J,j)});function $(){e.removeAllProgressDot(),e.off("canplay",w),e.off("timeupdate",K),e.off("currentTimeChange",G),e.off("srcChange",B),e.off("loadedmetadata",O),z.forEach(function(J){e.off(J,j)}),e.off("destroy",$)}e.once("destroy",$)};i.default={name:"s_progress",method:v},t.exports=i.default},function(t,i,r){var n=r(70);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-progress{display:block;position:absolute;height:20px;line-height:20px;left:12px;right:12px;outline:none;top:-15px;z-index:35}.xgplayer-skin-default .xgplayer-progress-outer{background:hsla(0,0%,100%,.3);display:block;height:3px;line-height:3px;margin-top:8.5px;width:100%;position:relative;cursor:pointer}.xgplayer-skin-default .xgplayer-progress-cache,.xgplayer-skin-default .xgplayer-progress-played{display:block;height:100%;line-height:1;position:absolute;left:0;top:0}.xgplayer-skin-default .xgplayer-progress-cache{width:0;background:hsla(0,0%,100%,.5)}.xgplayer-skin-default .xgplayer-progress-played{display:block;width:0;background-image:linear-gradient(-90deg,#fa1f41,#e31106);border-radius:0 1.5px 1.5px 0}.xgplayer-skin-default .xgplayer-progress-btn{display:none;position:absolute;left:0;top:-5px;width:13px;height:13px;border-radius:30px;background:#fff;box-shadow:0 0 2px 0 rgba(0,0,0,.26);left:100%;-webkit-transform:translate(-50%);-ms-transform:translate(-50%);transform:translate(-50%);z-index:36}.xgplayer-skin-default .xgplayer-progress-point{position:absolute}.xgplayer-skin-default .xgplayer-progress-point.xgplayer-tips{margin-left:0;top:-25px;display:none;z-index:100}.xgplayer-skin-default .xgplayer-progress-dot{display:inline-block;position:absolute;height:3px;width:5px;top:0;background:#fff;border-radius:6px;z-index:16}.xgplayer-skin-default .xgplayer-progress-dot .xgplayer-progress-tip{position:absolute;bottom:200%;right:50%;-webkit-transform:translateX(50%);-ms-transform:translateX(50%);transform:translateX(50%);height:auto;line-height:30px;width:auto;background:rgba(0,0,0,.3);border-radius:6px;border:1px solid rgba(0,0,0,.8);cursor:default;white-space:nowrap;display:none}.xgplayer-skin-default .xgplayer-progress-dot-show .xgplayer-progress-tip{display:block}.xgplayer-skin-default .xgplayer-progress-thumbnail{position:absolute;-moz-box-sizing:border-box;box-sizing:border-box}.xgplayer-skin-default .xgplayer-progress-thumbnail.xgplayer-tips{margin-left:0;display:none;z-index:99}.xgplayer-skin-default .xgplayer-coverpreview{position:absolute;width:100%;height:100%;top:0;left:0;display:none}.xgplayer-skin-default .xgplayer-coverpreview .xgplayer-coverpreview-outer{position:absolute;display:block;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.xgplayer-skin-default .xgplayer-coverpreview .xgplayer-coverpreview-outer .xgplayer-coverpreview-thumbnail{display:block}.xgplayer-skin-default .xgplayer-coverpreview .xgplayer-coverpreview-outer .xgplayer-coverpreview-point{display:block;text-align:center;font-family:PingFangSC-Regular;font-size:11px;color:#ccc;padding:2px 4px}.xgplayer-skin-default .xgplayer-coverpreview .xgplayer-coverpreview-outer .xgplayer-coverpreview-point span{color:#fff}.xgplayer-skin-default .xgplayer-progress:focus .xgplayer-progress-outer,.xgplayer-skin-default .xgplayer-progress:hover .xgplayer-progress-outer{height:6px;margin-top:7px}.xgplayer-skin-default .xgplayer-progress:focus .xgplayer-progress-dot,.xgplayer-skin-default .xgplayer-progress:hover .xgplayer-progress-dot{height:6px}.xgplayer-skin-default .xgplayer-progress:focus .xgplayer-progress-btn,.xgplayer-skin-default .xgplayer-progress:hover .xgplayer-progress-btn{display:block;top:-3px}.xgplayer-skin-default.xgplayer-definition-active .xgplayer-progress,.xgplayer-skin-default.xgplayer-playbackrate-active .xgplayer-progress,.xgplayer-skin-default.xgplayer-texttrack-active .xgplayer-progress,.xgplayer-skin-default.xgplayer-volume-active .xgplayer-progress{z-index:15}.xgplayer-skin-default.xgplayer-mobile .xgplayer-progress-btn{display:block!important}.xgplayer-skin-default.xgplayer-mobile .xgplayer-progress:focus .xgplayer-progress-outer,.xgplayer-skin-default.xgplayer-mobile .xgplayer-progress:hover .xgplayer-progress-outer{height:3px!important;margin-top:8.5px!important}.xgplayer-skin-default.xgplayer-mobile .xgplayer-progress:focus .xgplayer-progress-btn,.xgplayer-skin-default.xgplayer-mobile .xgplayer-progress:hover .xgplayer-progress-btn{display:block!important;top:-5px!important}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0);r(72);var u=function(){var c=this,g=(0,n.createDom)("xg-time",'<span class="xgplayer-time-current">'+(c.currentTime||(0,n.format)(0))+`</span>
                                           <span>`+(c.duration||(0,n.format)(0))+"</span>",{},"xgplayer-time");c.once("ready",function(){c.controls&&c.controls.appendChild(g)});var v=function(){(c.videoConfig.mediaType!=="audio"||!c.isProgressMoving||!c.dash)&&(g.innerHTML='<span class="xgplayer-time-current">'+(0,n.format)(c.currentTime||0)+"</span>"+("<span>"+(0,n.format)(c.duration)+"</span>"))};c.on("durationchange",v),c.on("timeupdate",v);function p(){c.off("durationchange",v),c.off("timeupdate",v),c.off("destroy",p)}c.once("destroy",p)};i.default={name:"s_time",method:u},t.exports=i.default},function(t,i,r){var n=r(73);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,'.xgplayer-skin-default .xgplayer-time{-webkit-order:2;-moz-box-ordinal-group:3;order:2;font-family:ArialMT;font-size:13px;color:#fff;line-height:40px;height:40px;text-align:center;display:inline-block;margin:auto 8px}.xgplayer-skin-default .xgplayer-time span{color:hsla(0,0%,100%,.5)}.xgplayer-skin-default .xgplayer-time .xgplayer-time-current{color:#fff}.xgplayer-skin-default .xgplayer-time .xgplayer-time-current:after{content:"/";display:inline-block;padding:0 3px}',""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(75),o=c(u);r(76);function c(v){return v&&v.__esModule?v:{default:v}}var g=function(){var p=this,e=p.root,s=p.lang.REPLAY,l=(0,n.createDom)("xg-replay",o.default+`
                                         <xg-replay-txt class="xgplayer-replay-txt">`+s+`</xg-replay-txt>
                                        `,{},"xgplayer-replay");p.once("ready",function(){e.appendChild(l)});function f(){var _=l.querySelector("path");if(_){var E=window.getComputedStyle(_).getPropertyValue("transform");if(typeof E=="string"&&E.indexOf("none")>-1)return;_.setAttribute("transform",E)}}p.on("ended",f);function d(_){_.preventDefault(),_.stopPropagation()}l.addEventListener("click",d);var y=l.querySelector("svg");["click","touchend"].forEach(function(_){y.addEventListener(_,function(E){E.preventDefault(),E.stopPropagation(),p.userGestureTrigEvent("replayBtnClick")})});function m(){p.off("ended",f),p.off("destroy",m)}p.once("destroy",m)};i.default={name:"s_replay",method:g},t.exports=i.default},function(t,i,r){r.r(i),i.default=`<svg class="xgplayer-replay-svg" xmlns="http://www.w3.org/2000/svg" width="78" height="78" viewbox="0 0 78 78">
  <path d="M8.22708362,13.8757234 L11.2677371,12.6472196 C11.7798067,12.4403301 12.3626381,12.6877273 12.5695276,13.1997969 L12.9441342,14.1269807 C13.1510237,14.6390502 12.9036264,15.2218816 12.3915569,15.4287712 L6.8284538,17.6764107 L5.90126995,18.0510173 C5.38920044,18.2579068 4.80636901,18.0105096 4.5994795,17.49844 L1.97723335,11.0081531 C1.77034384,10.4960836 2.0177411,9.91325213 2.52981061,9.70636262 L3.45699446,9.33175602 C3.96906396,9.12486652 4.5518954,9.37226378 4.75878491,9.88433329 L5.67885163,12.1615783 C7.99551726,6.6766934 13.3983951,3 19.5,3 C27.7842712,3 34.5,9.71572875 34.5,18 C34.5,26.2842712 27.7842712,33 19.5,33 C15.4573596,33 11.6658607,31.3912946 8.87004692,28.5831991 C8.28554571,27.9961303 8.28762719,27.0463851 8.87469603,26.4618839 C9.46176488,25.8773827 10.4115101,25.8794641 10.9960113,26.466533 C13.2344327,28.7147875 16.263503,30 19.5,30 C26.127417,30 31.5,24.627417 31.5,18 C31.5,11.372583 26.127417,6 19.5,6 C14.4183772,6 9.94214483,9.18783811 8.22708362,13.8757234 Z"></path>
</svg>
`},function(t,i,r){var n=r(77);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-replay{position:absolute;left:0;top:0;width:100%;height:100%;z-index:105;display:none;-webkit-justify-content:center;-moz-box-pack:center;justify-content:center;-webkit-align-items:center;-moz-box-align:center;align-items:center;background:rgba(0,0,0,.54);-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;flex-direction:column}.xgplayer-skin-default .xgplayer-replay svg{background:rgba(0,0,0,.58);border-radius:100%;cursor:pointer}.xgplayer-skin-default .xgplayer-replay svg path{-webkit-transform:translate(20px,21px);-ms-transform:translate(20px,21px);transform:translate(20px,21px);fill:#ddd}.xgplayer-skin-default .xgplayer-replay svg:hover{background:rgba(0,0,0,.38)}.xgplayer-skin-default .xgplayer-replay svg:hover path{fill:#fff}.xgplayer-skin-default .xgplayer-replay .xgplayer-replay-txt{display:inline-block;font-family:PingFangSC-Regular;font-size:14px;color:#fff;line-height:34px}.xgplayer-skin-default.xgplayer.xgplayer-ended .xgplayer-controls{display:none}.xgplayer-skin-default.xgplayer.xgplayer-ended .xgplayer-replay{display:-webkit-flex;display:-moz-box;display:flex}",""])},function(t,i,r){var n=r(161);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){t.exports=r(80)},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(9),u=q(n),o=r(81),c=q(o),g=r(82),v=q(g),p=r(83),e=q(p),s=r(84),l=q(s),f=r(85),d=q(f),y=r(88),m=q(y),_=r(45),E=q(_),w=r(89),k=q(w),x=r(90),S=q(x),P=r(91),U=q(P),R=r(92),C=q(R),A=r(37),b=q(A),O=r(38),W=q(O),K=r(98),G=q(K),B=r(46),j=q(B),z=r(99),$=q(z),J=r(100),Q=q(J),ne=r(47),Ee=q(ne),we=r(101),Ae=q(we),De=r(102),Ve=q(De),Ce=r(103),Me=q(Ce),Ge=r(39),D=q(Ge),fe=r(104),ae=q(fe),X=r(105),H=q(X);r(107);function q(ce){return ce&&ce.__esModule?ce:{default:ce}}u.default.installAll([c.default,v.default,e.default,l.default,d.default,m.default,E.default,k.default,S.default,U.default,C.default,b.default,W.default,G.default,j.default,$.default,Q.default,Ee.default,Ae.default,Ve.default,Me.default,D.default,ae.default,H.default]),i.default=u.default,t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=function(){var o=this;if(!o.config.airplay||!window.WebKitPlaybackTargetAvailabilityEvent)return;function c(){o.video.webkitShowPlaybackTargetPicker()}o.on("airplayBtnClick",c);function g(){o.off("airplayBtnClick",c),o.off("destroy",g)}o.once("destroy",g)};i.default={name:"airplay",method:n},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var c=this,g=c.root;function v(){(0,n.hasClass)(g,"xgplayer-is-cssfullscreen")?c.exitCssFullscreen():c.getCssFullscreen()}c.on("cssFullscreenBtnClick",v),c.on("exitFullscreen",function(){(0,n.removeClass)(g,"xgplayer-is-cssfullscreen")});function p(){c.off("cssFullscreenBtnClick",v),c.off("destroy",p)}c.once("destroy",p),c.getCssFullscreen=function(){var e=this;e.config.fluid&&(e.root.style["padding-top"]=""),(0,n.addClass)(e.root,"xgplayer-is-cssfullscreen"),e.emit("requestCssFullscreen")},c.exitCssFullscreen=function(){var e=this;e.config.fluid&&(e.root.style.width="100%",e.root.style.height="0",e.root.style["padding-top"]=e.config.height*100/e.config.width+"%"),(0,n.removeClass)(e.root,"xgplayer-is-cssfullscreen"),e.emit("exitCssFullscreen")}};i.default={name:"cssFullscreen",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var c=this;function g(v){var p=c.root.querySelector("xg-danmu");if((0,n.addClass)(p,"xgplayer-has-danmu"),!c.config.danmu.closeDefaultBtn){var e=function(){v.start()},s=function(){(0,n.hasClass)(c.danmuBtn,"danmu-switch-active")&&v.pause()},l=function(){(0,n.hasClass)(c.danmuBtn,"danmu-switch-active")&&v.play()},f=function(){(0,n.hasClass)(c.danmuBtn,"danmu-switch-active")&&(v.stop(),v.start())},d=function y(){c.off("timeupdate",e),c.off("pause",s),c.off("play",l),c.off("seeked",f),c.off("destroy",y)};c.danmuBtn=(0,n.copyDom)(v.bulletBtn.createSwitch(!0)),c.controls.appendChild(c.danmuBtn),["click","touchend"].forEach(function(y){c.danmuBtn.addEventListener(y,function(m){m.preventDefault(),m.stopPropagation(),(0,n.toggleClass)(c.danmuBtn,"danmu-switch-active"),(0,n.hasClass)(c.danmuBtn,"danmu-switch-active")?(c.emit("danmuBtnOn"),(0,n.addClass)(p,"xgplayer-has-danmu"),c.once("timeupdate",e)):(c.emit("danmuBtnOff"),(0,n.removeClass)(p,"xgplayer-has-danmu"),v.stop())})}),c.onElementClick&&p.addEventListener("click",function(y){c.onElementClick(y,p)},!1),c.onElementDblclick&&p.addEventListener("dblclick",function(y){c.onElementDblclick(y,p)},!1),c.on("pause",s),c.on("play",l),c.on("seeked",f),c.once("destroy",d)}}c.on("initDefaultDanmu",g)};i.default={name:"danmu",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=function(){var o=this;function c(){o.off("destroy",c)}o.once("destroy",c)};i.default={name:"definition",method:n},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(86),u=c(n),o=r(87);function c(v){return v&&v.__esModule?v:{default:v}}var g=function(){var p=this;function e(){p.download()}p.on("downloadBtnClick",e);function s(){p.off("downloadBtnClick",e),p.off("destroy",s)}p.once("destroy",s),p.download=function(){var l=(0,o.getAbsoluteURL)(this.config.url);(0,u.default)(l)}};i.default={name:"download",method:g},t.exports=i.default},function(t,i,r){var n,u,o;(function(c,g){u=[],n=g,o=typeof n=="function"?n.apply(i,u):n,o!==void 0&&(t.exports=o)})(this,function(){return function c(g,v,p){var e=window,s="application/octet-stream",l=p||s,f=g,d=!v&&!p&&f,y=document.createElement("a"),m=function(A){return String(A)},_=e.Blob||e.MozBlob||e.WebKitBlob||m,E=v||"download",w,k;if(_=_.call?_.bind(e):Blob,String(this)==="true"&&(f=[f,l],l=f[0],f=f[1]),d&&d.length<2048&&(E=d.split("/").pop().split("?")[0],y.href=d,y.href.indexOf(d)!==-1)){var x=new XMLHttpRequest;return x.open("GET",d,!0),x.responseType="blob",x.onload=function(A){c(A.target.response,E,s)},setTimeout(function(){x.send()},0),x}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(f))if(f.length>1024*1024*1.999&&_!==m)f=R(f),l=f.type||s;else return navigator.msSaveBlob?navigator.msSaveBlob(R(f),E):C(f);else if(/([\x80-\xff])/.test(f)){var S=0,P=new Uint8Array(f.length),U=P.length;for(S;S<U;++S)P[S]=f.charCodeAt(S);f=new _([P],{type:l})}w=f instanceof _?f:new _([f],{type:l});function R(A){var b=A.split(/[:;,]/),O=b[1],W=b[2]=="base64"?atob:decodeURIComponent,K=W(b.pop()),G=K.length,B=0,j=new Uint8Array(G);for(B;B<G;++B)j[B]=K.charCodeAt(B);return new _([j],{type:O})}function C(A,b){if("download"in y)return y.href=A,y.setAttribute("download",E),y.className="download-js-link",y.innerHTML="downloading...",y.style.display="none",document.body.appendChild(y),setTimeout(function(){y.click(),document.body.removeChild(y),b===!0&&setTimeout(function(){e.URL.revokeObjectURL(y.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(A)&&(A="data:"+A.replace(/^data:([\w\/\-\+]+)/,s)),window.open(A)||confirm(`Displaying New Document

Use Save As... to download, then click back to return to this page.`)&&(location.href=A),!0;var O=document.createElement("iframe");document.body.appendChild(O),!b&&/^data:/.test(A)&&(A="data:"+A.replace(/^data:([\w\/\-\+]+)/,s)),O.src=A,setTimeout(function(){document.body.removeChild(O)},333)}if(navigator.msSaveBlob)return navigator.msSaveBlob(w,E);if(e.URL)C(e.URL.createObjectURL(w),!0);else{if(typeof w=="string"||w.constructor===m)try{return C("data:"+l+";base64,"+e.btoa(w))}catch(A){return C("data:"+l+","+encodeURIComponent(w))}k=new FileReader,k.onload=function(A){C(this.result)},k.readAsDataURL(w)}return!0}})},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0}),i.getAbsoluteURL=function(u){if(!u.match(/^https?:\/\//)){var o=document.createElement("div");o.innerHTML='<a href="'+u+'">x</a>',u=o.firstChild.href}return u}},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(4),u=o(n);function o(v){return v&&v.__esModule?v:{default:v}}var c={maxCount:3,backupUrl:"",isFetch:!0,fetchTimeout:100};function g(){var v=this,p=this;if(!p.config.errorConfig||p.src.indexOf("blob:")>-1)return;var e={},s=p.config.errorConfig;for(var l in c)s[l]===void 0?e[l]=c[l]:e[l]=s[l];p.retryData={count:0,errfTimer:null,isFetchReturn:!1,currentTime:0};function f(m,_,E){var w=function(x,S){m.retryData.isFetchReturn||(m.retryData.isFetchReturn=!0,x(S))};return new Promise(function(k,x){try{var S=new window.XMLHttpRequest;S.open("get",_),S.onload=function(){w(k,{status:S.status,statusText:S.statusText,xhr:S})},S.onerror=function(){w(k,{status:S.status,statusText:S.statusText||"The network environment is disconnected or the address is invalid",xhr:S})},S.onabort=function(){},m.retryData.errfTimer=window.setTimeout(function(){var P=m.retryData.errfTimer;window.clearTimeout(P),m.retryData.errfTimer=null,w(k,{status:-1,statusText:"request timeout"})},E),S.send()}catch(P){m.retryData.isFetchReturn=!0,w(k,{status:-2,statusText:"request error"})}})}function d(){this.currentTime=this.retryData.currentTime,this.play(),this.retryData.retryCode=0,this.retryData.isFetchReturn=!1,this.retryData.currentTime=0}var y=p._onError;p._onError=function(m){var _=v.retryData.count;if(_>e.maxCount){e.isFetch?f(v,v.currentSrc,e.fetchTimeout).then(function(w){v.emit("error",new u.default({type:"network",currentTime:v.currentTime,duration:v.duration||0,networkState:v.networkState,readyState:v.readyState,currentSrc:v.currentSrc,src:v.src,ended:v.ended,httpCode:w.status,httpMsg:w.statusText,errd:{line:101,msg:v.error,handle:"plugin errorRetry"},errorCode:v.video&&v.video.error.code,mediaError:v.video&&v.video.error})),y.call(v,w)}):y.call(v,m);return}_===0&&(v.retryData.currentTime=v.currentTime,v.once("canplay",d.bind(v)));var E="";e.count<2?E=e.backupUrl?e.backupUrl:p.currentSrc:E=e.backupUrl&&_>1?e.backupUrl:p.currentSrc,v.retryData.count++,v.src=E}}i.default={name:"errorretry",method:g},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function v(p,e){for(var s=0;s<e.length;s++){var l=e[s];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(p,l.key,l)}}return function(p,e,s){return e&&v(p.prototype,e),s&&v(p,s),p}}(),u=r(0);function o(v,p){if(!(v instanceof p))throw new TypeError("Cannot call a class as a function")}var c=function(){function v(p){o(this,v),this.player=p,this.state={playbackRate:0,isRepeat:!1,keyCode:0,repeat:0,isBody:!1},this.timer=null,this.initEvents()}return n(v,[{key:"initEvents",value:function(){var e=this,s=this.player,l=s.root,f=s.config;if(this.player.onBodyKeydown=this.onBodyKeydown.bind(this),this.player.onKeydown=this.onKeydown.bind(this),this.player.onKeyup=this.onKeyup.bind(this),!f.keyShortcut||f.keyShortcut==="on"){document.addEventListener("keydown",this.player.onBodyKeydown),l.addEventListener("keydown",this.player.onKeydown);var d=function(){document.removeEventListener("keydown",e.player.onBodyKeydown),l.removeEventListener("keydown",e.player.onKeydown),clearTimeout(e.timer),e.timer=null};(0,u.on)(this.player,"destroy",d)}}},{key:"checkTarget",value:function(e){var s=this.player;return e.target===s.root||e.target===s.video||e.target===s.controls}},{key:"onBodyKeydown",value:function(e){var s=e||window.event,l=s.keyCode;if(s.target===document.body&&(l===37||l===39||l===32))return s.preventDefault(),s.cancelBubble=!0,s.returnValue=!1,s.repeat||document.addEventListener("keyup",this.player.onKeyup),this.handler(s),!1}},{key:"onKeydown",value:function(e){var s=e||window.event,l=s.keyCode;if(this.checkTarget(s)&&(l===37||l===38||l===39||l===40||l===32||l===27))return s.preventDefault(),s.cancelBubble=!0,s.returnValue=!1,this.player.emit("focus"),s.repeat||this.player.root.addEventListener("keyup",this.player.onKeyup),this.handler(s),!1}},{key:"onKeyup",value:function(){var e=this.state,s=this.player;document.removeEventListener("keyup",this.player.onKeyup),s.root.removeEventListener("keyup",this.player.onKeyup),!!e.keyCode&&(e.playbackRate!==0&&(s.playbackRate=e.playbackRate),e.isRepeat||this.handlerKeyCode(e.keyCode,!1),e.playbackRate=0,e.isRepeat=!1,e.keyCode=0,e.repeat=0,this.changeVolumeSlide())}},{key:"handler",value:function(e){var s=this.state,l=this.player;s.keyCode=e.keyCode,s.isRepeat=e.repeat,e.repeat&&(l.config.disableLongPress?this.handlerKeyCode(s.keyCode,!1):s.repeat%2==0&&this.handlerKeyCode(s.keyCode,!0),s.repeat++)}},{key:"handlerKeyCode",value:function(e,s){var l=this.player,f=this.state;switch(e){case 39:s?f.repeat===0&&this.changeRate():this.seek(!1,s);break;case 37:this.seek(!0,s);break;case 38:this.changeVolume(!0);break;case 40:this.changeVolume(!1);break;case 32:s||(l.paused?l.play():l.pause());break;case 27:(0,u.hasClass)(l.root,"xgplayer-is-cssfullscreen")&&l.exitCssFullscreen();break}}},{key:"seek",value:function(e,s){var l=this.player,f=l.config.keyShortcutStep||{},d=f.currentTime||10;l.isLoading||l.isSeeking||s&&this.state.repeat%8>0||(e?l.currentTime-d>=0?l.currentTime-=d:l.currentTime=0:l.maxPlayedTime&&l.config.allowSeekPlayed&&l.currentTime+d>l.maxPlayedTime?l.currentTime=l.maxPlayedTime:l.currentTime+d<=l.duration?l.currentTime+=d:l.currentTime=l.duration+1)}},{key:"changeRate",value:function(){this.state.playbackRate=this.player.playbackRate,this.player.playbackRate=this.player.config.keyboardRate||5}},{key:"changeVolumeSlide",value:function(e){var s=this.player;!s.controls||(e?(s.emit("focus"),(0,u.hasClass)(s.root,"xgplayer-volume-active")||(0,u.addClass)(s.root,"xgplayer-volume-active")):(clearTimeout(this.timer),this.timer=setTimeout(function(){(0,u.removeClass)(s.root,"xgplayer-volume-active")},1e3)))}},{key:"changeVolume",value:function(e){var s=this.player,l=s.config.keyShortcutStep||{},f=l.volume||.1;this.changeVolumeSlide(!0);var d=s.volume;e&&d+f<=1?s.volume=d+f:!e&&d-f>=0&&(s.volume=d-f)}}]),v}(),g=function(){var p=this;p.keyboard=new c(p)};i.default={name:"keyboard",method:g},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var c=this,g=c.root;function v(e){c.uploadFile=e.files[0];var s=URL.createObjectURL(c.uploadFile);if((0,n.hasClass)(g,"xgplayer-nostart"))c.config.url=s,c.start();else{c.src=s;var l=c.play();l!==void 0&&l&&l.catch(function(f){})}}c.on("upload",v);function p(){c.off("upload",v),c.off("destroy",p)}c.once("destroy",p)};i.default={name:"localPreview",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=function(){var o=this;o.on("memoryPlayStart",function(c){setTimeout(function(){console.log("memoryPlayStart",c,o.readyState,11),o.currentTime=c})})};i.default={name:"memoryPlay",method:n},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(93),o=c(u);function c(v){return v&&v.__esModule?v:{default:v}}var g=function(){var p=this,e=p.root;function s(){(0,n.hasClass)(e,"xgplayer-miniplayer-active")?p.exitMiniplayer():p.getMiniplayer()}p.on("miniplayerBtnClick",s);function l(){p.off("miniplayerBtnClick",s),p.off("destroy",l)}p.once("destroy",l),p.getMiniplayer=function(){(0,n.hasClass)(e,"xgplayer-is-fullscreen")&&this.exitFullscreen(e),(0,n.hasClass)(e,"xgplayer-is-cssfullscreen")&&this.exitCssFullscreen(),(0,n.hasClass)(e,"xgplayer-rotate-fullscreen")&&this.exitRotateFullscreen();var f=(0,n.createDom)("xg-miniplayer-lay","<div></div>",{},"xgplayer-miniplayer-lay");this.root.appendChild(f);var d=(0,n.createDom)("xg-miniplayer-drag",'<div class="drag-handle"><span>'+this.lang.MINIPLAYER_DRAG+"</span></div>",{tabindex:9},"xgplayer-miniplayer-drag");this.root.appendChild(d),new o.default(".xgplayer",{handle:".drag-handle"}),(0,n.addClass)(this.root,"xgplayer-miniplayer-active"),this.root.style.right=0,this.root.style.bottom="200px",this.root.style.top="",this.root.style.left="",this.root.style.width="320px",this.root.style.height="180px",this.config.miniplayerConfig&&(this.config.miniplayerConfig.top!==void 0&&(this.root.style.top=this.config.miniplayerConfig.top+"px",this.root.style.bottom=""),this.config.miniplayerConfig.bottom!==void 0&&(this.root.style.bottom=this.config.miniplayerConfig.bottom+"px"),this.config.miniplayerConfig.left!==void 0&&(this.root.style.left=this.config.miniplayerConfig.left+"px",this.root.style.right=""),this.config.miniplayerConfig.right!==void 0&&(this.root.style.right=this.config.miniplayerConfig.right+"px"),this.config.miniplayerConfig.width!==void 0&&(this.root.style.width=this.config.miniplayerConfig.width+"px"),this.config.miniplayerConfig.height!==void 0&&(this.root.style.height=this.config.miniplayerConfig.height+"px")),this.config.fluid&&(this.root.style["padding-top"]="");var y=this;["click","touchend"].forEach(function(m){f.addEventListener(m,function(_){_.preventDefault(),_.stopPropagation(),y.exitMiniplayer()})})},p.exitMiniplayer=function(){(0,n.removeClass)(this.root,"xgplayer-miniplayer-active"),this.root.style.right="",this.root.style.bottom="",this.root.style.top="",this.root.style.left="",this.config.fluid?(this.root.style.width="100%",this.root.style.height="0",this.root.style["padding-top"]=this.config.height*100/this.config.width+"%"):(this.config.width&&(typeof this.config.width!="number"?this.root.style.width=this.config.width:this.root.style.width=this.config.width+"px"),this.config.height&&(typeof this.config.height!="number"?this.root.style.height=this.config.height:this.root.style.height=this.config.height+"px"));var f=(0,n.findDom)(this.root,".xgplayer-miniplayer-lay");f&&f.parentNode&&f.parentNode.removeChild(f);var d=(0,n.findDom)(this.root,".xgplayer-miniplayer-drag");d&&d.parentNode&&d.parentNode.removeChild(d)}};i.default={name:"miniplayer",method:g},t.exports=i.default},function(t,i,r){var n,u;/*!
* Draggabilly v2.4.1
* Make that shiz draggable
* https://draggabilly.desandro.com
* MIT license
*/(function(o,c){n=[r(94),r(95)],u=function(g,v){return c(o,g,v)}.apply(i,n),u!==void 0&&(t.exports=u)})(window,function(c,g,v){function p(m,_){for(var E in _)m[E]=_[E];return m}function e(){}var s=c.jQuery;function l(m,_){this.element=typeof m=="string"?document.querySelector(m):m,s&&(this.$element=s(this.element)),this.options=p({},this.constructor.defaults),this.option(_),this._create()}var f=l.prototype=Object.create(v.prototype);l.defaults={},f.option=function(m){p(this.options,m)};var d={relative:!0,absolute:!0,fixed:!0};f._create=function(){this.position={},this._getPosition(),this.startPoint={x:0,y:0},this.dragPoint={x:0,y:0},this.startPosition=p({},this.position);var m=getComputedStyle(this.element);d[m.position]||(this.element.style.position="relative"),this.on("pointerMove",this.onPointerMove),this.on("pointerUp",this.onPointerUp),this.enable(),this.setHandles()},f.setHandles=function(){this.handles=this.options.handle?this.element.querySelectorAll(this.options.handle):[this.element],this.bindHandles()},f.dispatchEvent=function(m,_,E){var w=[_].concat(E);this.emitEvent(m,w),this.dispatchJQueryEvent(m,_,E)},f.dispatchJQueryEvent=function(m,_,E){var w=c.jQuery;if(!(!w||!this.$element)){var k=w.Event(_);k.type=m,this.$element.trigger(k,E)}},f._getPosition=function(){var m=getComputedStyle(this.element),_=this._getPositionCoord(m.left,"width"),E=this._getPositionCoord(m.top,"height");this.position.x=isNaN(_)?0:_,this.position.y=isNaN(E)?0:E,this._addTransformPosition(m)},f._getPositionCoord=function(m,_){if(m.indexOf("%")!=-1){var E=g(this.element.parentNode);return E?parseFloat(m)/100*E[_]:0}return parseInt(m,10)},f._addTransformPosition=function(m){var _=m.transform;if(_.indexOf("matrix")===0){var E=_.split(","),w=_.indexOf("matrix3d")===0?12:4,k=parseInt(E[w],10),x=parseInt(E[w+1],10);this.position.x+=k,this.position.y+=x}},f.onPointerDown=function(m,_){this.element.classList.add("is-pointer-down"),this.dispatchJQueryEvent("pointerDown",m,[_])},f.pointerDown=function(m,_){var E=this.okayPointerDown(m);if(!E||!this.isEnabled){this._pointerReset();return}this.pointerDownPointer={pageX:_.pageX,pageY:_.pageY},m.preventDefault(),this.pointerDownBlur(),this._bindPostStartEvents(m),this.element.classList.add("is-pointer-down"),this.dispatchEvent("pointerDown",m,[_])},f.dragStart=function(m,_){!this.isEnabled||(this._getPosition(),this.measureContainment(),this.startPosition.x=this.position.x,this.startPosition.y=this.position.y,this.setLeftTop(),this.dragPoint.x=0,this.dragPoint.y=0,this.element.classList.add("is-dragging"),this.dispatchEvent("dragStart",m,[_]),this.animate())},f.measureContainment=function(){var m=this.getContainer();if(!!m){var _=g(this.element),E=g(m),w=this.element.getBoundingClientRect(),k=m.getBoundingClientRect(),x=E.borderLeftWidth+E.borderRightWidth,S=E.borderTopWidth+E.borderBottomWidth,P=this.relativeStartPosition={x:w.left-(k.left+E.borderLeftWidth),y:w.top-(k.top+E.borderTopWidth)};this.containSize={width:E.width-x-P.x-_.width,height:E.height-S-P.y-_.height}}},f.getContainer=function(){var m=this.options.containment;if(!!m){var _=m instanceof HTMLElement;return _?m:typeof m=="string"?document.querySelector(m):this.element.parentNode}},f.onPointerMove=function(m,_,E){this.dispatchJQueryEvent("pointerMove",m,[_,E])},f.dragMove=function(m,_,E){if(!!this.isEnabled){var w=E.x,k=E.y,x=this.options.grid,S=x&&x[0],P=x&&x[1];w=y(w,S),k=y(k,P),w=this.containDrag("x",w,S),k=this.containDrag("y",k,P),w=this.options.axis=="y"?0:w,k=this.options.axis=="x"?0:k,this.position.x=this.startPosition.x+w,this.position.y=this.startPosition.y+k,this.dragPoint.x=w,this.dragPoint.y=k,this.dispatchEvent("dragMove",m,[_,E])}};function y(m,_,E){return E=E||"round",_?Math[E](m/_)*_:m}return f.containDrag=function(m,_,E){if(!this.options.containment)return _;var w=m=="x"?"width":"height",k=this.relativeStartPosition[m],x=y(-k,E,"ceil"),S=this.containSize[w];return S=y(S,E,"floor"),Math.max(x,Math.min(S,_))},f.onPointerUp=function(m,_){this.element.classList.remove("is-pointer-down"),this.dispatchJQueryEvent("pointerUp",m,[_])},f.dragEnd=function(m,_){!this.isEnabled||(this.element.style.transform="",this.setLeftTop(),this.element.classList.remove("is-dragging"),this.dispatchEvent("dragEnd",m,[_]))},f.animate=function(){if(!!this.isDragging){this.positionDrag();var m=this;requestAnimationFrame(function(){m.animate()})}},f.setLeftTop=function(){this.element.style.left=this.position.x+"px",this.element.style.top=this.position.y+"px"},f.positionDrag=function(){this.element.style.transform="translate3d( "+this.dragPoint.x+"px, "+this.dragPoint.y+"px, 0)"},f.staticClick=function(m,_){this.dispatchEvent("staticClick",m,[_])},f.setPosition=function(m,_){this.position.x=m,this.position.y=_,this.setLeftTop()},f.enable=function(){this.isEnabled=!0},f.disable=function(){this.isEnabled=!1,this.isDragging&&this.dragEnd()},f.destroy=function(){this.disable(),this.element.style.transform="",this.element.style.left="",this.element.style.top="",this.element.style.position="",this.unbindHandles(),this.$element&&this.$element.removeData("draggabilly")},f._init=e,s&&s.bridget&&s.bridget("draggabilly",l),l})},function(t,i,r){var n,u;/*!
* getSize v2.0.3
* measure size of elements
* MIT license
*/(function(o,c){n=c,u=typeof n=="function"?n.call(i,r,i,t):n,u!==void 0&&(t.exports=u)})(window,function(){function c(_){var E=parseFloat(_),w=_.indexOf("%")==-1&&!isNaN(E);return w&&E}function g(){}var v=typeof console=="undefined"?g:function(_){console.error(_)},p=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],e=p.length;function s(){for(var _={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},E=0;E<e;E++){var w=p[E];_[w]=0}return _}function l(_){var E=getComputedStyle(_);return E||v("Style returned "+E+". Are you running this code in a hidden iframe on Firefox? See https://bit.ly/getsizebug1"),E}var f=!1,d;function y(){if(!f){f=!0;var _=document.createElement("div");_.style.width="200px",_.style.padding="1px 2px 3px 4px",_.style.borderStyle="solid",_.style.borderWidth="1px 2px 3px 4px",_.style.boxSizing="border-box";var E=document.body||document.documentElement;E.appendChild(_);var w=l(_);d=Math.round(c(w.width))==200,m.isBoxSizeOuter=d,E.removeChild(_)}}function m(_){if(y(),typeof _=="string"&&(_=document.querySelector(_)),!(!_||typeof _!="object"||!_.nodeType)){var E=l(_);if(E.display=="none")return s();var w={};w.width=_.offsetWidth,w.height=_.offsetHeight;for(var k=w.isBorderBox=E.boxSizing=="border-box",x=0;x<e;x++){var S=p[x],P=E[S],U=parseFloat(P);w[S]=isNaN(U)?0:U}var R=w.paddingLeft+w.paddingRight,C=w.paddingTop+w.paddingBottom,A=w.marginLeft+w.marginRight,b=w.marginTop+w.marginBottom,O=w.borderLeftWidth+w.borderRightWidth,W=w.borderTopWidth+w.borderBottomWidth,K=k&&d,G=c(E.width);G!==!1&&(w.width=G+(K?0:R+O));var B=c(E.height);return B!==!1&&(w.height=B+(K?0:C+W)),w.innerWidth=w.width-(R+O),w.innerHeight=w.height-(C+W),w.outerWidth=w.width+A,w.outerHeight=w.height+b,w}}return m})},function(t,i,r){var n,u;/*!
* Unidragger v2.4.0
* Draggable base class
* MIT license
*/(function(o,c){n=[r(96)],u=function(g){return c(o,g)}.apply(i,n),u!==void 0&&(t.exports=u)})(window,function(c,g){function v(){}var p=v.prototype=Object.create(g.prototype);p.bindHandles=function(){this._bindHandles(!0)},p.unbindHandles=function(){this._bindHandles(!1)},p._bindHandles=function(l){l=l===void 0?!0:l;for(var f=l?"addEventListener":"removeEventListener",d=l?this._touchActionValue:"",y=0;y<this.handles.length;y++){var m=this.handles[y];this._bindStartEvent(m,l),m[f]("click",this),c.PointerEvent&&(m.style.touchAction=d)}},p._touchActionValue="none",p.pointerDown=function(l,f){var d=this.okayPointerDown(l);!d||(this.pointerDownPointer={pageX:f.pageX,pageY:f.pageY},l.preventDefault(),this.pointerDownBlur(),this._bindPostStartEvents(l),this.emitEvent("pointerDown",[l,f]))};var e={TEXTAREA:!0,INPUT:!0,SELECT:!0,OPTION:!0},s={radio:!0,checkbox:!0,button:!0,submit:!0,image:!0,file:!0};return p.okayPointerDown=function(l){var f=e[l.target.nodeName],d=s[l.target.type],y=!f||d;return y||this._pointerReset(),y},p.pointerDownBlur=function(){var l=document.activeElement,f=l&&l.blur&&l!=document.body;f&&l.blur()},p.pointerMove=function(l,f){var d=this._dragPointerMove(l,f);this.emitEvent("pointerMove",[l,f,d]),this._dragMove(l,f,d)},p._dragPointerMove=function(l,f){var d={x:f.pageX-this.pointerDownPointer.pageX,y:f.pageY-this.pointerDownPointer.pageY};return!this.isDragging&&this.hasDragStarted(d)&&this._dragStart(l,f),d},p.hasDragStarted=function(l){return Math.abs(l.x)>3||Math.abs(l.y)>3},p.pointerUp=function(l,f){this.emitEvent("pointerUp",[l,f]),this._dragPointerUp(l,f)},p._dragPointerUp=function(l,f){this.isDragging?this._dragEnd(l,f):this._staticClick(l,f)},p._dragStart=function(l,f){this.isDragging=!0,this.isPreventingClicks=!0,this.dragStart(l,f)},p.dragStart=function(l,f){this.emitEvent("dragStart",[l,f])},p._dragMove=function(l,f,d){!this.isDragging||this.dragMove(l,f,d)},p.dragMove=function(l,f,d){l.preventDefault(),this.emitEvent("dragMove",[l,f,d])},p._dragEnd=function(l,f){this.isDragging=!1,setTimeout(function(){delete this.isPreventingClicks}.bind(this)),this.dragEnd(l,f)},p.dragEnd=function(l,f){this.emitEvent("dragEnd",[l,f])},p.onclick=function(l){this.isPreventingClicks&&l.preventDefault()},p._staticClick=function(l,f){this.isIgnoringMouseUp&&l.type=="mouseup"||(this.staticClick(l,f),l.type!="mouseup"&&(this.isIgnoringMouseUp=!0,setTimeout(function(){delete this.isIgnoringMouseUp}.bind(this),400)))},p.staticClick=function(l,f){this.emitEvent("staticClick",[l,f])},v.getPointerPoint=g.getPointerPoint,v})},function(t,i,r){var n,u;/*!
* Unipointer v2.4.0
* base class for doing one thing with pointer event
* MIT license
*/(function(o,c){n=[r(97)],u=function(g){return c(o,g)}.apply(i,n),u!==void 0&&(t.exports=u)})(window,function(c,g){function v(){}function p(){}var e=p.prototype=Object.create(g.prototype);e.bindStartEvent=function(l){this._bindStartEvent(l,!0)},e.unbindStartEvent=function(l){this._bindStartEvent(l,!1)},e._bindStartEvent=function(l,f){f=f===void 0?!0:f;var d=f?"addEventListener":"removeEventListener",y="mousedown";"ontouchstart"in c?y="touchstart":c.PointerEvent&&(y="pointerdown"),l[d](y,this)},e.handleEvent=function(l){var f="on"+l.type;this[f]&&this[f](l)},e.getTouch=function(l){for(var f=0;f<l.length;f++){var d=l[f];if(d.identifier==this.pointerIdentifier)return d}},e.onmousedown=function(l){var f=l.button;f&&f!==0&&f!==1||this._pointerDown(l,l)},e.ontouchstart=function(l){this._pointerDown(l,l.changedTouches[0])},e.onpointerdown=function(l){this._pointerDown(l,l)},e._pointerDown=function(l,f){l.button||this.isPointerDown||(this.isPointerDown=!0,this.pointerIdentifier=f.pointerId!==void 0?f.pointerId:f.identifier,this.pointerDown(l,f))},e.pointerDown=function(l,f){this._bindPostStartEvents(l),this.emitEvent("pointerDown",[l,f])};var s={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"]};return e._bindPostStartEvents=function(l){if(!!l){var f=s[l.type];f.forEach(function(d){c.addEventListener(d,this)},this),this._boundPointerEvents=f}},e._unbindPostStartEvents=function(){!this._boundPointerEvents||(this._boundPointerEvents.forEach(function(l){c.removeEventListener(l,this)},this),delete this._boundPointerEvents)},e.onmousemove=function(l){this._pointerMove(l,l)},e.onpointermove=function(l){l.pointerId==this.pointerIdentifier&&this._pointerMove(l,l)},e.ontouchmove=function(l){var f=this.getTouch(l.changedTouches);f&&this._pointerMove(l,f)},e._pointerMove=function(l,f){this.pointerMove(l,f)},e.pointerMove=function(l,f){this.emitEvent("pointerMove",[l,f])},e.onmouseup=function(l){this._pointerUp(l,l)},e.onpointerup=function(l){l.pointerId==this.pointerIdentifier&&this._pointerUp(l,l)},e.ontouchend=function(l){var f=this.getTouch(l.changedTouches);f&&this._pointerUp(l,f)},e._pointerUp=function(l,f){this._pointerDone(),this.pointerUp(l,f)},e.pointerUp=function(l,f){this.emitEvent("pointerUp",[l,f])},e._pointerDone=function(){this._pointerReset(),this._unbindPostStartEvents(),this.pointerDone()},e._pointerReset=function(){this.isPointerDown=!1,delete this.pointerIdentifier},e.pointerDone=v,e.onpointercancel=function(l){l.pointerId==this.pointerIdentifier&&this._pointerCancel(l,l)},e.ontouchcancel=function(l){var f=this.getTouch(l.changedTouches);f&&this._pointerCancel(l,f)},e._pointerCancel=function(l,f){this._pointerDone(),this.pointerCancel(l,f)},e.pointerCancel=function(l,f){this.emitEvent("pointerCancel",[l,f])},p.getPointerPoint=function(l){return{x:l.pageX,y:l.pageY}},p})},function(t,i,r){var n,u;(function(o,c){n=c,u=typeof n=="function"?n.call(i,r,i,t):n,u!==void 0&&(t.exports=u)})(typeof window!="undefined"?window:this,function(){function o(){}var c=o.prototype;return c.on=function(g,v){if(!(!g||!v)){var p=this._events=this._events||{},e=p[g]=p[g]||[];return e.indexOf(v)==-1&&e.push(v),this}},c.once=function(g,v){if(!(!g||!v)){this.on(g,v);var p=this._onceEvents=this._onceEvents||{},e=p[g]=p[g]||{};return e[v]=!0,this}},c.off=function(g,v){var p=this._events&&this._events[g];if(!(!p||!p.length)){var e=p.indexOf(v);return e!=-1&&p.splice(e,1),this}},c.emitEvent=function(g,v){var p=this._events&&this._events[g];if(!(!p||!p.length)){p=p.slice(0),v=v||[];for(var e=this._onceEvents&&this._onceEvents[g],s=0;s<p.length;s++){var l=p[s],f=e&&e[l];f&&(this.off(g,l),delete e[l]),l.apply(this,v)}return this}},c.allOff=function(){delete this._events,delete this._onceEvents},o})},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var c=this,g=this;function v(){g.video!==document.pictureInPictureElement?g.video.requestPictureInPicture():document.exitPictureInPicture()}g.on("pipBtnClick",v);var p=function(l){var f=g.video.webkitPresentationMode;c.pMode=f,f===n.PresentationMode.PIP?g.emit("requestPictureInPicture",l.pictureInPictureWindow):f===n.PresentationMode.INLINE&&g.emit("exitPictureInPicture")};g.video.addEventListener("enterpictureinpicture",function(s){(0,n.addClass)(g.root,"xgplayer-pip-active"),g.emit("requestPictureInPicture",s)}),g.video.addEventListener("leavepictureinpicture",function(){(0,n.removeClass)(g.root,"xgplayer-pip-active"),g.emit("exitPictureInPicture")}),(0,n.checkWebkitSetPresentationMode)(g.video)&&g.video.addEventListener("webkitpresentationmodechanged",p);function e(){g.off("pipBtnClick",v),g.off("destroy",e),(0,n.checkWebkitSetPresentationMode)(g.video)&&g.video.removeEventListener("webkitpresentationmodechanged",p)}g.once("destroy",e)};i.default={name:"pip",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=function(){var o=this,c=o.config.playNext;o.currentVideoIndex=-1;function g(){o.currentVideoIndex+1<c.urlList.length&&(o.currentVideoIndex++,o.video.autoplay=!0,o.src=c.urlList[o.currentVideoIndex],o.emit("playerNext",o.currentVideoIndex+1),o.currentVideoIndex+1===c.urlList.length&&o.emit("urlListEnd"))}o.on("playNextBtnClick",g);function v(){o.off("playNextBtnClick",g),o.off("destroy",v)}o.once("destroy",v)};i.default={name:"playNext",method:n},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var c=this,g=c.config.reload;if(!g)return;function v(){(0,n.removeClass)(c.root,"xgplayer-is-error"),c.src=c.config.url}c.on("reloadBtnClick",v);function p(){c.off("reloadBtnClick",v),c.off("destroy",p)}c.once("destroy",p)};i.default={name:"reload",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=function(){var o=this,c=o.config.rotate;if(!c)return;function g(){o.rotate(c.clockwise,c.innerRotate)}o.on("rotateBtnClick",g);function v(){o.off("rotateBtnClick",g),o.off("destroy",v)}o.once("destroy",v),o.updateRotateDeg=function(){var p=this;p.rotateDeg||(p.rotateDeg=0);var e=p.root.offsetWidth,s=p.root.offsetHeight,l=p.video.videoWidth,f=p.video.videoHeight;!p.config.rotate.innerRotate&&p.config.rotate.controlsFix&&(p.root.style.width=s+"px",p.root.style.height=e+"px");var d=void 0;if(p.rotateDeg===.25||p.rotateDeg===.75){if(p.config.rotate.innerRotate)if(l/f>s/e){var y=0;f/l>s/e?y=s*l/f:y=e,d=s/y}else{var m=0;f/l>s/e?m=s:m=e*f/l,d=e/m}else e>=s?d=e/s:d=s/e;d=Number(d.toFixed(5))}else d=1;p.config.rotate.innerRotate||p.config.rotate.controlsFix?(p.video.style.transformOrigin="center center",p.video.style.transform="rotate("+p.rotateDeg+"turn) scale("+d+")",p.video.style.webKitTransform="rotate("+p.rotateDeg+"turn) scale("+d+")"):(p.root.style.transformOrigin="center center",p.root.style.transform="rotate("+p.rotateDeg+"turn) scale("+1+")",p.root.style.webKitTransform="rotate("+p.rotateDeg+"turn) scale("+1+")")},o.rotate=function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,s=this;s.rotateDeg||(s.rotateDeg=0);var l=p?1:-1;s.rotateDeg=(s.rotateDeg+1+l*.25*e)%1,this.updateRotateDeg(),s.emit("rotate",s.rotateDeg*360)}};i.default={name:"rotate",method:n},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=function(){var o=this,c=o.config.screenShot,g=null;if(!c)return;o.video.setAttribute("crossOrigin","anonymous");var v=.92;(c.quality||c.quality===0)&&(v=c.quality);var p=c.type===void 0?"image/png":c.type,e=c.format===void 0?".png":c.format,s=document.createElement("canvas"),l=s.getContext("2d"),f=new Image;s.width=this.config.width||600,s.height=this.config.height||337.5;var d=function(_,E){var w=document.createElement("a");w.href=_,w.download=E;var k=document.createEvent("MouseEvents");k.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),w.dispatchEvent(k)};o.screenShot=function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;m=c.saveImg===void 0?m:c.saveImg,s.width=o.video.videoWidth||600,s.height=o.video.videoHeight||337.5,g=c.callBack,f.onload=function(){l.drawImage(o.video,0,0,s.width,s.height),f.src=s.toDataURL(p,v).replace(p,"image/octet-stream");var _=f.src.replace(/^data:image\/[^;]+/,"data:application/octet-stream"),E=c.fileName||o.lang.SCREENSHOT;o.emit("screenShot",_),m&&g?g(_,E,e):m&&d(_,E+e)}()},o.on("screenShotBtnClick",o.screenShot);function y(){o.off("screenShotBtnClick",o.screenShot),o.off("destroy",y)}o.once("destroy",y)};i.default={name:"screenShot",method:n},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(4),u=o(n);function o(g){return g&&g.__esModule?g:{default:g}}function c(){var g=this;if(!!g.config.enableStallCheck){var v=0,p=void 0,e=void 0;g.once("complete",function(){setInterval(function(){g.currentTime-(v||0)>.1||g.paused?(p===1||p===2)&&(p=0,clearTimeout(e),e=null):p||(p=1,e=setTimeout(function(){p===1&&(p=2,g.emit("error",new u.default("STALL"))),e=null},2e4)),v=g.currentTime},1e3)})}}i.default={name:"stallCheck",method:c},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(5),o=c(u);function c(v){return v&&v.__esModule?v:{default:v}}var g=function(){var p=this,e=p.root,s=void 0,l=void 0,f=void 0,d=void 0;function y(){!p.controls||(p.volume=p.config.volume,s=p.controls.querySelector(".xgplayer-volume"),!!s&&(l=s.querySelector(".xgplayer-slider"),f=s.querySelector(".xgplayer-bar"),d=s.querySelector(".xgplayer-drag"),o.default.device==="mobile"&&(p.volume===0&&(p.video.muted=!0),x())))}p.once("canplay",y);function m(P){if(!!l){p.video.muted=!1,l.focus(),(0,n.event)(P);var U=f.getBoundingClientRect(),R={x:P.clientX,y:P.clientY},C=d.getBoundingClientRect().height,A=!1,b=function(K){K.preventDefault(),K.stopPropagation(),(0,n.event)(K),A=!0;var G=C-K.clientY+R.y,B=G/U.height;d.style.height=G+"px",p.volume=Math.max(Math.min(B,1),0)},O=function W(K){if(K.preventDefault(),K.stopPropagation(),(0,n.event)(K),window.removeEventListener("mousemove",b),window.removeEventListener("touchmove",b),window.removeEventListener("mouseup",W),window.removeEventListener("touchend",W),!A){var G=U.height-(K.clientY-U.top),B=G/U.height;d.style.height=G+"px",B<=0&&(p.volume>0?d.volume=p.video.volume:B=d.volume),p.volume=Math.max(Math.min(B,1),0)}l.volume=p.volume,A=!1};return window.addEventListener("mousemove",b),window.addEventListener("touchmove",b),window.addEventListener("mouseup",O),window.addEventListener("touchend",O),!1}}p.on("volumeBarClick",m);function _(){if(o.default.device==="mobile")p.video.muted?(p.video.muted=!1,p.emit("unmute"),p.volume=1):(p.video.muted=!0,p.emit("mute"),p.volume=0);else{if(!l)return;p.video.muted=!1,p.volume<.1?(l.volume<.1?p.volume=.6:p.volume=l.volume,p.emit("unmute")):(p.volume=0,p.emit("mute"))}}p.on("volumeIconClick",_);function E(){(0,n.addClass)(e,"xgplayer-volume-active"),s&&s.focus()}p.on("volumeIconEnter",E);function w(){(0,n.removeClass)(e,"xgplayer-volume-active")}p.on("volumeIconLeave",w);var k=null;function x(){k&&clearTimeout(k),k=setTimeout(function(){if(o.default.device==="mobile")(0,n.removeClass)(e,"xgplayer-volume-muted"),(0,n.removeClass)(e,"xgplayer-volume-large"),p.video.muted||p.video.defaultMuted?(p.video.muted||(p.video.muted=!0),p.video.defaultMuted=!1,(0,n.addClass)(e,"xgplayer-volume-muted")):(0,n.addClass)(e,"xgplayer-volume-large");else{if((0,n.removeClass)(e,"xgplayer-volume-muted"),(0,n.removeClass)(e,"xgplayer-volume-small"),(0,n.removeClass)(e,"xgplayer-volume-large"),p.volume===0||p.muted?(0,n.addClass)(e,"xgplayer-volume-muted"):p.volume<.5?(0,n.addClass)(e,"xgplayer-volume-small"):(0,n.addClass)(e,"xgplayer-volume-large"),!f)return;var P=f.getBoundingClientRect().height||76;d.style.height=p.volume*P+"px"}},50)}p.on("volumechange",x);function S(){p.off("canplay",y),p.off("volumeBarClick",m),p.off("volumeIconClick",_),p.off("volumeIconEnter",E),p.off("volumeIconLeave",w),p.off("volumechange",x),p.off("destroy",S),k&&(clearTimeout(k),k=null)}p.once("destroy",S)};i.default={name:"volume",method:g},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function s(l,f){for(var d=0;d<f.length;d++){var y=f[d];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(l,y.key,y)}}return function(l,f,d){return f&&s(l.prototype,f),d&&s(l,d),l}}(),u=r(106),o=c(u);function c(s){return s&&s.__esModule?s:{default:s}}function g(s,l){if(!(s instanceof l))throw new TypeError("Cannot call a class as a function")}var v={follow:!0,mode:"stroke",followBottom:50,fitVideo:!0,offsetBottom:2,baseSizeX:49,baseSizeY:28,minSize:16,minMobileSize:13,line:"double",fontColor:"#fff"},p=function(){function s(l,f,d){var y=this;g(this,s);var m=this.create(f,d,l.textTrackShowDefault);m.attachPlayer(l),this.subtitle=m,this.player=l,this.positionData={vBottom:0,marginBottom:0},this.isActive=!1,this.followBottom=d.followBottom,["onSubtitleResize","onFocus","onBlur"].map(function(_){y[_]=y[_].bind(y)}),l.controls&&d.follow&&(this.subtitle.on("resize",this.onSubtitleResize),l.on("focus",this.onFocus),l.on("blur",this.onBlur))}return n(s,[{key:"create",value:function(f){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,m={subTitles:f,defaultOpen:y};return Object.keys(d).map(function(_){m[_]=d[_]}),new o.default(m)}},{key:"switch",value:function(f){return this.subtitle.switch(f)}},{key:"switchOff",value:function(){return this.subtitle.switchOff()}},{key:"setSubTitles",value:function(f,d,y){return this.subtitle.setSubTitles(f,d,y)}},{key:"onFocus",value:function(){var f=this.positionData,d=f.marginBottom,y=f.vBottom;if(!(this.isActive||!d)){this.isActive=!0;var m=d+y;this.followBottom>m&&(m=this.followBottom),this.subtitle&&(this.subtitle.root.style.bottom=m+"px")}}},{key:"onBlur",value:function(){this.isActive=!1;var f=this.positionData.vBottom+this.positionData.marginBottom;this.subtitle&&(this.subtitle.root.style.bottom=f+"px")}},{key:"onSubtitleResize",value:function(f){this.positionData.vBottom=f.vBottom,this.positionData.marginBottom=f.marginBottom}},{key:"destroy",value:function(){this.subtitle.off("resize",this.onSubtitleResize),this.player.off("focus",this.onFocus),this.player.off("blur",this.onBlur),this.subtitle.destroy(),this.subtitle=null}}]),s}(),e=function(){var l=this,f=this,d=f.config.textTrack;if(!d)return;var y=f.config.textTrackStyle||{};Object.keys(v).map(function(_){y[_]===void 0&&(y[_]=v[_])}),f.textTrackShowDefault=!1,f.config.textTrack.map(function(_,E){!_.id&&!_.language&&(_.id=E),!_.url&&(_.url=_.src),!_.language&&(_.language=_.srclang),_.isDefault===void 0&&(_.isDefault=_.default),!f.textTrackShowDefault&&(f.textTrackShowDefault=_.isDefault||_.default)}),this.subTitles=new p(f,f.config.textTrack,y),f.setSubTitles=function(_){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,w=!1;_.map(function(k,x){!k.id&&!k.language&&(k.id=x),!k.url&&(k.url=k.src),!k.language&&(k.language=k.srclang),k.isDefault===void 0&&(k.isDefault=k.default),k.isDefault&&(w=!0)}),f.textTrackShowDefault=w,l.subTitles.setSubTitles(_,w,E),f.emit("subtitle_change",{off:!1,isListUpdate:!0,list:_})},f.switchSubTitle=function(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:"",language:""};l.subTitles.switch(_).then(function(E){E.code===0&&(_.off=!1,_.isListUpdate=!1,_.list=[],f.emit("subtitle_change",_))})},f.switchOffSubtile=function(){l.subTitles.switchOff(),f.emit("subtitle_change",{off:!0,isListUpdate:!1,list:[]})};function m(){this.subTitles.destroy(),this.subTitles=null}f.once("destroy",m)};i.default={name:"textTrack",method:e},t.exports=i.default},function(t,i,r){(function(n,u){t.exports=u()})(this,function(){function n(T){return T&&T.__esModule&&Object.prototype.hasOwnProperty.call(T,"default")?T.default:T}function u(T,L){return L={exports:{}},T(L,L.exports),L.exports}function o(T){var L,F;this.promise=new T(function(I,Y){if(L!==void 0||F!==void 0)throw TypeError("Bad Promise constructor");L=I,F=Y}),this.resolve=Ee(L),this.reject=Ee(F)}function c(T){var L=T.length;return L===3?(60*(60*Number(T[0])+Number(T[1]))*1e3+1e3*Number(T[2]))/1e3:L===2?(60*Number(T[0])*1e3+1e3*Number(T[1]))/1e3:Number(T[0])}function g(T){return/^(\-|\+)?\d+(\.\d+)?$/.test(T)}function v(T){return T}function p(T,L){return T>=0&&T<L.length?L[T]:""}function e(T,L){if(!T)return!1;if(T.classList)return Array.prototype.some.call(T.classList,function(I){return I===L});var F=T.className&&zr(T.className)==="object"?T.getAttribute("class"):T.className;return F&&!!F.match(new RegExp("(\\s|^)"+L+"(\\s|$)"))}function s(T,L){T&&(T.classList?L.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(F){F&&T.classList.add(F)}):e(T,L)||(T.className&&zr(T.className)==="object"?T.setAttribute("class",T.getAttribute("class")+" "+L):T.className+=" "+L))}function l(T,L){T&&(T.classList?L.split(/\s+/g).forEach(function(F){T.classList.remove(F)}):e(T,L)&&L.split(/\s+/g).forEach(function(F){var I=new RegExp("(\\s|^)"+F+"(\\s|$)");T.className&&zr(T.className)==="object"?T.setAttribute("class",T.getAttribute("class").replace(I," ")):T.className=T.className.replace(I," ")}))}function f(T,L,F){var I=L.length;if(I<1)return-1;if(F=F<0?0:F>=I?I-1:F,L[F].start<=T&&T<L[F].end)return F;for(var Y=L[F].end<=T?F+1:0;Y<I;Y++){if(L[Y].start<=T&&T<L[Y].end)return Y;if(T>L[Y].end&&Y+1<I&&T<L[Y+1].start||T>L[Y].end&&Y+1>=I)return-1}return-1}function d(T,L,F){var I=L.length;if(I<1)return[];var Y=[];if((F=F<0?0:F>=I?I-1:F)<I)for(var ee=L[F].end<=T?F:0;ee<I&&(L[ee].start<=T&&T<L[ee].end&&Y.push(ee),!(T<L[ee].start));ee++);return Y}function y(T){return Object.prototype.toString.call(T).match(/([^\s.*]+)(?=]$)/g)[0]}function m(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"div",L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},I=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",Y=document.createElement(T);return Y.className=I,Y.innerHTML=L,cn(F).forEach(function(ee){var se=ee,de=F[ee];T==="video"||T==="audio"||T==="live-video"?de&&Y.setAttribute(se,de):Y.setAttribute(se,de)}),Y}function _(){var T=navigator.userAgent,L=/(?:Windows Phone)/.test(T),F=/(?:SymbianOS)/.test(T)||L,I=/(?:Android)/.test(T),Y=/(?:Firefox)/.test(T),ee=/(?:iPad|PlayBook)/.test(T)||I&&!/(?:Mobile)/.test(T)||Y&&/(?:Tablet)/.test(T);return/(?:iPhone)/.test(T)&&!ee||I||F||ee}function E(T){var L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",F="";T.map(function(de){F+=" "+L+" "+de.key+" {"+de.style+"}"});var I=document.createElement("style"),Y=document.head||document.getElementsByTagName("head")[0];if(I.type="text/css",I.id="ssss",I.styleSheet){var ee=function(){try{I.styleSheet.cssText=F}catch(de){}};I.styleSheet.disabled?setTimeout(ee,10):ee()}else{var se=document.createTextNode(F);I.appendChild(se)}Y.appendChild(I)}function w(T,L){dn||(dn=new Hu),dn.addObserver(T,L)}function k(T,L){dn&&dn.unObserver(T,L)}function x(T){var L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},F={code:Ys[T].code,msg:Ys[T].msg};return cn(L).map(function(I){F[I]=L[I]}),F}function S(T,L,F,I,Y){Y?F(x(2,Y),{format:I.format}):I.format?(T.list=I.list,T.format=I.format,T.styles=I.styles,L(T)):F(x(3))}function P(T){return new Aa(function(L,F){if(T.list)return void L(T);if(T.json){var I=Da.parseJson(T.json);return T.list=I,T.format="json",void L(T)}if(T.stringContent&&!T.url)Da.parse(T.stringContent,function(ee,se){S(T,L,F,ee,se)});else if(T.url)new Mu({url:T.url,type:"text"}).then(function(ee){Da.parse(ee.res.response,function(se,de){S(T,L,F,se,de)})}).catch(function(ee){var se=x(1,{statusText:ee.statusText,status:ee.status,type:ee.type,message:"http load error",url:T.url});F(se)});else{var Y=x(8);F(Y)}})}function U(T,L){return!!(T.id&&T.id===L.id||T.language&&T.language===L.language)}var R=function(T){if(T==null)throw TypeError("Can't call method on  "+T);return T},C=function(T){return Object(R(T))},A={}.hasOwnProperty,b=function(T,L){return A.call(T,L)},O=u(function(T){var L=T.exports={version:"2.6.12"};typeof __e=="number"&&(__e=L)}),W=(O.version,u(function(T){var L=T.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=L)})),K=u(function(T){var L=W["__core-js_shared__"]||(W["__core-js_shared__"]={});(T.exports=function(F,I){return L[F]||(L[F]=I!==void 0?I:{})})("versions",[]).push({version:O.version,mode:"pure",copyright:"\xA9 2020 Denis Pushkarev (zloirock.ru)"})}),G=0,B=Math.random(),j=function(T){return"Symbol(".concat(T===void 0?"":T,")_",(++G+B).toString(36))},z=K("keys"),$=function(T){return z[T]||(z[T]=j(T))},J=$("IE_PROTO"),Q=Object.prototype,ne=Object.getPrototypeOf||function(T){return T=C(T),b(T,J)?T[J]:typeof T.constructor=="function"&&T instanceof T.constructor?T.constructor.prototype:T instanceof Object?Q:null},Ee=function(T){if(typeof T!="function")throw TypeError(T+" is not a function!");return T},we=function(T,L,F){if(Ee(T),L===void 0)return T;switch(F){case 1:return function(I){return T.call(L,I)};case 2:return function(I,Y){return T.call(L,I,Y)};case 3:return function(I,Y,ee){return T.call(L,I,Y,ee)}}return function(){return T.apply(L,arguments)}},Ae=function(T){return typeof T=="object"?T!==null:typeof T=="function"},De=function(T){if(!Ae(T))throw TypeError(T+" is not an object!");return T},Ve=function(T){try{return!!T()}catch(L){return!0}},Ce=!Ve(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7}),Me=W.document,Ge=Ae(Me)&&Ae(Me.createElement),D=function(T){return Ge?Me.createElement(T):{}},fe=!Ce&&!Ve(function(){return Object.defineProperty(D("div"),"a",{get:function(){return 7}}).a!=7}),ae=function(T,L){if(!Ae(T))return T;var F,I;if(L&&typeof(F=T.toString)=="function"&&!Ae(I=F.call(T))||typeof(F=T.valueOf)=="function"&&!Ae(I=F.call(T))||!L&&typeof(F=T.toString)=="function"&&!Ae(I=F.call(T)))return I;throw TypeError("Can't convert object to primitive value")},X=Object.defineProperty,H={f:Ce?Object.defineProperty:function(T,L,F){if(De(T),L=ae(L,!0),De(F),fe)try{return X(T,L,F)}catch(I){}if("get"in F||"set"in F)throw TypeError("Accessors not supported!");return"value"in F&&(T[L]=F.value),T}},q=function(T,L){return{enumerable:!(1&T),configurable:!(2&T),writable:!(4&T),value:L}},ce=Ce?function(T,L,F){return H.f(T,L,q(1,F))}:function(T,L,F){return T[L]=F,T},he=function(T,L,F){var I,Y,ee,se=T&he.F,de=T&he.G,xe=T&he.S,Re=T&he.P,Fe=T&he.B,Ie=T&he.W,He=de?O:O[L]||(O[L]={}),Ke=He.prototype,Be=de?W:xe?W[L]:(W[L]||{}).prototype;de&&(F=L);for(I in F)(Y=!se&&Be&&Be[I]!==void 0)&&b(He,I)||(ee=Y?Be[I]:F[I],He[I]=de&&typeof Be[I]!="function"?F[I]:Fe&&Y?we(ee,W):Ie&&Be[I]==ee?function(qe){var Qe=function(rt,bt,Lt){if(this instanceof qe){switch(arguments.length){case 0:return new qe;case 1:return new qe(rt);case 2:return new qe(rt,bt)}return new qe(rt,bt,Lt)}return qe.apply(this,arguments)};return Qe.prototype=qe.prototype,Qe}(ee):Re&&typeof ee=="function"?we(Function.call,ee):ee,Re&&((He.virtual||(He.virtual={}))[I]=ee,T&he.R&&Ke&&!Ke[I]&&ce(Ke,I,ee)))};he.F=1,he.G=2,he.S=4,he.P=8,he.B=16,he.W=32,he.U=64,he.R=128;var te=he,Te=function(T,L){var F=(O.Object||{})[T]||Object[T],I={};I[T]=L(F),te(te.S+te.F*Ve(function(){F(1)}),"Object",I)};Te("getPrototypeOf",function(){return function(T){return ne(C(T))}});var Le=O.Object.getPrototypeOf,Se=n(u(function(T){T.exports={default:Le,__esModule:!0}})),ze=n(u(function(T,L){L.__esModule=!0,L.default=function(F,I){if(!(F instanceof I))throw new TypeError("Cannot call a class as a function")}})),Xe=Math.ceil,it=Math.floor,Je=function(T){return isNaN(T=+T)?0:(T>0?it:Xe)(T)},Ft=ce,yt={},Bt={}.toString,ot=function(T){return Bt.call(T).slice(8,-1)},Ci=Object("z").propertyIsEnumerable(0)?Object:function(T){return ot(T)=="String"?T.split(""):Object(T)},Nt=function(T){return Ci(R(T))},Wt=Math.min,Di=function(T){return T>0?Wt(Je(T),9007199254740991):0},ci=Math.max,vr=Math.min,yr=function(T,L){return T=Je(T),T<0?ci(T+L,0):vr(T,L)},Ji=function(T){return function(L,F,I){var Y,ee=Nt(L),se=Di(ee.length),de=yr(I,se);if(T&&F!=F){for(;se>de;)if((Y=ee[de++])!=Y)return!0}else for(;se>de;de++)if((T||de in ee)&&ee[de]===F)return T||de||0;return!T&&-1}}(!1),Kt=$("IE_PROTO"),qt=function(T,L){var F,I=Nt(T),Y=0,ee=[];for(F in I)F!=Kt&&b(I,F)&&ee.push(F);for(;L.length>Y;)b(I,F=L[Y++])&&(~Ji(ee,F)||ee.push(F));return ee},Oi="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),Qi=Object.keys||function(T){return qt(T,Oi)},Fr=Ce?Object.defineProperties:function(T,L){De(T);for(var F,I=Qi(L),Y=I.length,ee=0;Y>ee;)H.f(T,F=I[ee++],L[F]);return T},er=W.document,Ii=er&&er.documentElement,Br=$("IE_PROTO"),mr=function(){},xi=function(){var T,L=D("iframe"),F=Oi.length;for(L.style.display="none",Ii.appendChild(L),L.src="javascript:",(T=L.contentWindow.document).open(),T.write("<script>document.F=Object<\/script>"),T.close(),xi=T.F;F--;)delete xi.prototype[Oi[F]];return xi()},ri=Object.create||function(T,L){var F;return T!==null?(mr.prototype=De(T),F=new mr,mr.prototype=null,F[Br]=T):F=xi(),L===void 0?F:Fr(F,L)},wt=u(function(T){var L=K("wks"),F=W.Symbol,I=typeof F=="function";(T.exports=function(Y){return L[Y]||(L[Y]=I&&F[Y]||(I?F:j)("Symbol."+Y))}).store=L}),tr=H.f,ir=wt("toStringTag"),Ei=function(T,L,F){T&&!b(T=F?T:T.prototype,ir)&&tr(T,ir,{configurable:!0,value:L})},rr={};ce(rr,wt("iterator"),function(){return this});var Or=function(T,L,F){T.prototype=ri(rr,{next:q(1,F)}),Ei(T,L+" Iterator")},Mi=wt("iterator"),Ni=!([].keys&&"next"in[].keys()),Ir=function(){return this},_r=function(T,L,F,I,Y,ee,se){Or(F,L,I);var de,xe,Re,Fe=function(Lt){if(!Ni&&Lt in Be)return Be[Lt];switch(Lt){case"keys":case"values":return function(){return new F(this,Lt)}}return function(){return new F(this,Lt)}},Ie=L+" Iterator",He=Y=="values",Ke=!1,Be=T.prototype,qe=Be[Mi]||Be["@@iterator"]||Y&&Be[Y],Qe=qe||Fe(Y),rt=Y?He?Fe("entries"):Qe:void 0,bt=L=="Array"&&Be.entries||qe;if(bt&&(Re=ne(bt.call(new T)))!==Object.prototype&&Re.next&&Ei(Re,Ie,!0),He&&qe&&qe.name!=="values"&&(Ke=!0,Qe=function(){return qe.call(this)}),se&&(Ni||Ke||!Be[Mi])&&ce(Be,Mi,Qe),yt[L]=Qe,yt[Ie]=Ir,Y)if(de={values:He?Qe:Fe("values"),keys:ee?Qe:Fe("keys"),entries:rt},se)for(xe in de)xe in Be||Ft(Be,xe,de[xe]);else te(te.P+te.F*(Ni||Ke),L,de);return de},nr=function(T){return function(L,F){var I,Y,ee=String(R(L)),se=Je(F),de=ee.length;return se<0||se>=de?T?"":void 0:(I=ee.charCodeAt(se),I<55296||I>56319||se+1===de||(Y=ee.charCodeAt(se+1))<56320||Y>57343?T?ee.charAt(se):I:T?ee.slice(se,se+2):Y-56320+(I-55296<<10)+65536)}}(!0);_r(String,"String",function(T){this._t=String(T),this._i=0},function(){var T,L=this._t,F=this._i;return F>=L.length?{value:void 0,done:!0}:(T=nr(L,F),this._i+=T.length,{value:T,done:!1})});var Zt=function(T,L){return{value:L,done:!!T}};_r(Array,"Array",function(T,L){this._t=Nt(T),this._i=0,this._k=L},function(){var T=this._t,L=this._k,F=this._i++;return!T||F>=T.length?(this._t=void 0,Zt(1)):L=="keys"?Zt(0,F):L=="values"?Zt(0,T[F]):Zt(0,[F,T[F]])},"values"),yt.Arguments=yt.Array;for(var Ot=wt("toStringTag"),di="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),bi=0;bi<di.length;bi++){var ni=di[bi],Mr=W[ni],zi=Mr&&Mr.prototype;zi&&!zi[Ot]&&ce(zi,Ot,ni),yt[ni]=yt.Array}var ai={f:wt},xt=ai.f("iterator"),Jt=u(function(T){T.exports={default:xt,__esModule:!0}});n(Jt);var zt=u(function(T){var L=j("meta"),F=H.f,I=0,Y=Object.isExtensible||function(){return!0},ee=!Ve(function(){return Y(Object.preventExtensions({}))}),se=function(Ie){F(Ie,L,{value:{i:"O"+ ++I,w:{}}})},de=function(Ie,He){if(!Ae(Ie))return typeof Ie=="symbol"?Ie:(typeof Ie=="string"?"S":"P")+Ie;if(!b(Ie,L)){if(!Y(Ie))return"F";if(!He)return"E";se(Ie)}return Ie[L].i},xe=function(Ie,He){if(!b(Ie,L)){if(!Y(Ie))return!0;if(!He)return!1;se(Ie)}return Ie[L].w},Re=function(Ie){return ee&&Fe.NEED&&Y(Ie)&&!b(Ie,L)&&se(Ie),Ie},Fe=T.exports={KEY:L,NEED:!1,fastKey:de,getWeak:xe,onFreeze:Re}}),si=(zt.KEY,zt.NEED,zt.fastKey,zt.getWeak,zt.onFreeze,H.f),mt=function(T){var L=O.Symbol||(O.Symbol={});T.charAt(0)=="_"||T in L||si(L,T,{value:ai.f(T)})},Tt={f:Object.getOwnPropertySymbols},gt={f:{}.propertyIsEnumerable},hi=function(T){var L=Qi(T),F=Tt.f;if(F)for(var I,Y=F(T),ee=gt.f,se=0;Y.length>se;)ee.call(T,I=Y[se++])&&L.push(I);return L},ar=Array.isArray||function(T){return ot(T)=="Array"},pt=Oi.concat("length","prototype"),Vt={f:Object.getOwnPropertyNames||function(T){return qt(T,pt)}},Vi=Vt.f,Hi={}.toString,ji=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],pi=function(T){try{return Vi(T)}catch(L){return ji.slice()}},Ri={f:function(T){return ji&&Hi.call(T)=="[object Window]"?pi(T):Vi(Nt(T))}},gi=Object.getOwnPropertyDescriptor,Rt={f:Ce?gi:function(T,L){if(T=Nt(T),L=ae(L,!0),fe)try{return gi(T,L)}catch(F){}if(b(T,L))return q(!gt.f.call(T,L),T[L])}},tn=zt.KEY,xr=Rt.f,oi=H.f,sr=Ri.f,Ht=W.Symbol,et=W.JSON,M=et&&et.stringify,V=wt("_hidden"),Z=wt("toPrimitive"),le={}.propertyIsEnumerable,be=K("symbol-registry"),Ue=K("symbols"),tt=K("op-symbols"),ut=Object.prototype,dt=typeof Ht=="function"&&!!Tt.f,St=W.QObject,Ut=!St||!St.prototype||!St.prototype.findChild,rn=Ce&&Ve(function(){return ri(oi({},"a",{get:function(){return oi(this,"a",{value:7}).a}})).a!=7})?function(T,L,F){var I=xr(ut,L);I&&delete ut[L],oi(T,L,F),I&&T!==ut&&oi(ut,L,I)}:oi,Gi=function(T){var L=Ue[T]=ri(Ht.prototype);return L._k=T,L},nn=dt&&typeof Ht.iterator=="symbol"?function(T){return typeof T=="symbol"}:function(T){return T instanceof Ht},Nr=function(T,L,F){return T===ut&&Nr(tt,L,F),De(T),L=ae(L,!0),De(F),b(Ue,L)?(F.enumerable?(b(T,V)&&T[V][L]&&(T[V][L]=!1),F=ri(F,{enumerable:q(0,!1)})):(b(T,V)||oi(T,V,q(1,{})),T[V][L]=!0),rn(T,L,F)):oi(T,L,F)},wi=function(T,L){De(T);for(var F,I=hi(L=Nt(L)),Y=0,ee=I.length;ee>Y;)Nr(T,F=I[Y++],L[F]);return T},Cn=function(T,L){return L===void 0?ri(T):wi(ri(T),L)},Dn=function(T){var L=le.call(this,T=ae(T,!0));return!(this===ut&&b(Ue,T)&&!b(tt,T))&&(!(L||!b(this,T)||!b(Ue,T)||b(this,V)&&this[V][T])||L)},$i=function(T,L){if(T=Nt(T),L=ae(L,!0),T!==ut||!b(Ue,L)||b(tt,L)){var F=xr(T,L);return!F||!b(Ue,L)||b(T,V)&&T[V][L]||(F.enumerable=!0),F}},Rn=function(T){for(var L,F=sr(Nt(T)),I=[],Y=0;F.length>Y;)b(Ue,L=F[Y++])||L==V||L==tn||I.push(L);return I},Un=function(T){for(var L,F=T===ut,I=sr(F?tt:Nt(T)),Y=[],ee=0;I.length>ee;)!b(Ue,L=I[ee++])||F&&!b(ut,L)||Y.push(Ue[L]);return Y};dt||(Ft((Ht=function(){if(this instanceof Ht)throw TypeError("Symbol is not a constructor!");var T=j(arguments.length>0?arguments[0]:void 0),L=function(F){this===ut&&L.call(tt,F),b(this,V)&&b(this[V],T)&&(this[V][T]=!1),rn(this,T,q(1,F))};return Ce&&Ut&&rn(ut,T,{configurable:!0,set:L}),Gi(T)}).prototype,"toString",function(){return this._k}),Rt.f=$i,H.f=Nr,Vt.f=Ri.f=Rn,gt.f=Dn,Tt.f=Un,ai.f=function(T){return Gi(wt(T))}),te(te.G+te.W+te.F*!dt,{Symbol:Ht});for(var Ln="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Pn=0;Ln.length>Pn;)wt(Ln[Pn++]);for(var Fn=Qi(wt.store),Bn=0;Fn.length>Bn;)mt(Fn[Bn++]);te(te.S+te.F*!dt,"Symbol",{for:function(T){return b(be,T+="")?be[T]:be[T]=Ht(T)},keyFor:function(T){if(!nn(T))throw TypeError(T+" is not a symbol!");for(var L in be)if(be[L]===T)return L},useSetter:function(){Ut=!0},useSimple:function(){Ut=!1}}),te(te.S+te.F*!dt,"Object",{create:Cn,defineProperty:Nr,defineProperties:wi,getOwnPropertyDescriptor:$i,getOwnPropertyNames:Rn,getOwnPropertySymbols:Un});var da=Ve(function(){Tt.f(1)});te(te.S+te.F*da,"Object",{getOwnPropertySymbols:function(T){return Tt.f(C(T))}}),et&&te(te.S+te.F*(!dt||Ve(function(){var T=Ht();return M([T])!="[null]"||M({a:T})!="{}"||M(Object(T))!="{}"})),"JSON",{stringify:function(T){for(var L,F,I=[T],Y=1;arguments.length>Y;)I.push(arguments[Y++]);if(F=L=I[1],(Ae(L)||T!==void 0)&&!nn(T))return ar(L)||(L=function(ee,se){if(typeof F=="function"&&(se=F.call(this,ee,se)),!nn(se))return se}),I[1]=L,M.apply(et,I)}}),Ht.prototype[Z]||ce(Ht.prototype,Z,Ht.prototype.valueOf),Ei(Ht,"Symbol"),Ei(Math,"Math",!0),Ei(W.JSON,"JSON",!0),mt("asyncIterator"),mt("observable");var vi=O.Symbol,On=u(function(T){T.exports={default:vi,__esModule:!0}});n(On);var Er=u(function(T,L){function F(se){return se&&se.__esModule?se:{default:se}}L.__esModule=!0;var I=F(Jt),Y=F(On),ee=typeof Y.default=="function"&&typeof I.default=="symbol"?function(se){return typeof se}:function(se){return se&&typeof Y.default=="function"&&se.constructor===Y.default&&se!==Y.default.prototype?"symbol":typeof se};L.default=typeof Y.default=="function"&&ee(I.default)==="symbol"?function(se){return se===void 0?"undefined":ee(se)}:function(se){return se&&typeof Y.default=="function"&&se.constructor===Y.default&&se!==Y.default.prototype?"symbol":se===void 0?"undefined":ee(se)}}),zr=n(Er),In=n(u(function(T,L){L.__esModule=!0;var F=function(I){return I&&I.__esModule?I:{default:I}}(Er);L.default=function(I,Y){if(!I)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!Y||(Y===void 0?"undefined":(0,F.default)(Y))!=="object"&&typeof Y!="function"?I:Y}}));te(te.S+te.F*!Ce,"Object",{defineProperty:H.f});var ha=O.Object,pa=function(T,L,F){return ha.defineProperty(T,L,F)},an=u(function(T){T.exports={default:pa,__esModule:!0}});n(an);var Vr=n(u(function(T,L){L.__esModule=!0;var F=function(I){return I&&I.__esModule?I:{default:I}}(an);L.default=function(){function I(Y,ee){for(var se=0;se<ee.length;se++){var de=ee[se];de.enumerable=de.enumerable||!1,de.configurable=!0,"value"in de&&(de.writable=!0),(0,F.default)(Y,de.key,de)}}return function(Y,ee,se){return ee&&I(Y.prototype,ee),se&&I(Y,se),Y}}()})),N=function(T,L){if(De(T),!Ae(L)&&L!==null)throw TypeError(L+": can't set as prototype!")},re={set:Object.setPrototypeOf||("__proto__"in{}?function(T,L,F){try{(F=we(Function.call,Rt.f(Object.prototype,"__proto__").set,2))(T,[]),L=!(T instanceof Array)}catch(I){L=!0}return function(I,Y){return N(I,Y),L?I.__proto__=Y:F(I,Y),I}}({},!1):void 0),check:N};te(te.S,"Object",{setPrototypeOf:re.set});var ie=O.Object.setPrototypeOf,ue=u(function(T){T.exports={default:ie,__esModule:!0}});n(ue),te(te.S,"Object",{create:ri});var ye=O.Object,pe=function(T,L){return ye.create(T,L)},_e=u(function(T){T.exports={default:pe,__esModule:!0}});n(_e);var ge,Pe,ke,vt=n(u(function(T,L){function F(se){return se&&se.__esModule?se:{default:se}}L.__esModule=!0;var I=F(ue),Y=F(_e),ee=F(Er);L.default=function(se,de){if(typeof de!="function"&&de!==null)throw new TypeError("Super expression must either be null or a function, not "+(de===void 0?"undefined":(0,ee.default)(de)));se.prototype=(0,Y.default)(de&&de.prototype,{constructor:{value:se,enumerable:!1,writable:!0,configurable:!0}}),de&&(I.default?(0,I.default)(se,de):se.__proto__=de)}})),Ze=wt("toStringTag"),Ne=ot(function(){return arguments}())=="Arguments",At=function(T,L){try{return T[L]}catch(F){}},Qt=function(T){var L,F,I;return T===void 0?"Undefined":T===null?"Null":typeof(F=At(L=Object(T),Ze))=="string"?F:Ne?ot(L):(I=ot(L))=="Object"&&typeof L.callee=="function"?"Arguments":I},sn=function(T,L,F,I){if(!(T instanceof L)||I!==void 0&&I in T)throw TypeError(F+": incorrect invocation!");return T},me=function(T,L,F,I){try{return I?L(De(F)[0],F[1]):L(F)}catch(ee){var Y=T.return;throw Y!==void 0&&De(Y.call(T)),ee}},ht=wt("iterator"),Yt=Array.prototype,Su=function(T){return T!==void 0&&(yt.Array===T||Yt[ht]===T)},ku=wt("iterator"),Au=O.getIteratorMethod=function(T){if(T!=null)return T[ku]||T["@@iterator"]||yt[Qt(T)]},bs=u(function(T){var L={},F={},I=T.exports=function(Y,ee,se,de,xe){var Re,Fe,Ie,He,Ke=xe?function(){return Y}:Au(Y),Be=we(se,de,ee?2:1),qe=0;if(typeof Ke!="function")throw TypeError(Y+" is not iterable!");if(Su(Ke)){for(Re=Di(Y.length);Re>qe;qe++)if((He=ee?Be(De(Fe=Y[qe])[0],Fe[1]):Be(Y[qe]))===L||He===F)return He}else for(Ie=Ke.call(Y);!(Fe=Ie.next()).done;)if((He=me(Ie,Be,Fe.value,ee))===L||He===F)return He};I.BREAK=L,I.RETURN=F}),Cu=wt("species"),ws=function(T,L){var F,I=De(T).constructor;return I===void 0||(F=De(I)[Cu])==null?L:Ee(F)},Du=function(T,L,F){var I=F===void 0;switch(L.length){case 0:return I?T():T.call(F);case 1:return I?T(L[0]):T.call(F,L[0]);case 2:return I?T(L[0],L[1]):T.call(F,L[0],L[1]);case 3:return I?T(L[0],L[1],L[2]):T.call(F,L[0],L[1],L[2]);case 4:return I?T(L[0],L[1],L[2],L[3]):T.call(F,L[0],L[1],L[2],L[3])}return T.apply(F,L)},Ts=W.process,ga=W.setImmediate,va=W.clearImmediate,Ss=W.MessageChannel,ya=W.Dispatch,ma=0,on={},ln=function(){var T=+this;if(on.hasOwnProperty(T)){var L=on[T];delete on[T],L()}},ks=function(T){ln.call(T.data)};ga&&va||(ga=function(T){for(var L=[],F=1;arguments.length>F;)L.push(arguments[F++]);return on[++ma]=function(){Du(typeof T=="function"?T:Function(T),L)},ge(ma),ma},va=function(T){delete on[T]},ot(Ts)=="process"?ge=function(T){Ts.nextTick(we(ln,T,1))}:ya&&ya.now?ge=function(T){ya.now(we(ln,T,1))}:Ss?(ke=(Pe=new Ss).port2,Pe.port1.onmessage=ks,ge=we(ke.postMessage,ke,1)):W.addEventListener&&typeof postMessage=="function"&&!W.importScripts?(ge=function(T){W.postMessage(T+"","*")},W.addEventListener("message",ks,!1)):ge="onreadystatechange"in D("script")?function(T){Ii.appendChild(D("script")).onreadystatechange=function(){Ii.removeChild(this),ln.call(T)}}:function(T){setTimeout(we(ln,T,1),0)});var As={set:ga,clear:va},Ru=As.set,Cs=W.MutationObserver||W.WebKitMutationObserver,_a=W.process,xa=W.Promise,Ds=ot(_a)=="process",Mn={f:function(T){return new o(T)}},Nn=function(T){try{return{e:!1,v:T()}}catch(L){return{e:!0,v:L}}},Rs=W.navigator,Uu=Rs&&Rs.userAgent||"",Ea=function(T,L){if(De(T),Ae(L)&&L.constructor===T)return L;var F=Mn.f(T);return(0,F.resolve)(L),F.promise},Us=wt("species"),ba=wt("iterator"),Ls=!1;try{var Ps=[7][ba]();Ps.return=function(){Ls=!0},Array.from(Ps,function(){throw 2})}catch(T){}var wa,Fs,Bs,Ta,Os=As.set,Is=function(){var T,L,F,I=function(){var de,xe;for(Ds&&(de=_a.domain)&&de.exit();T;){xe=T.fn,T=T.next;try{xe()}catch(Re){throw T?F():L=void 0,Re}}L=void 0,de&&de.enter()};if(Ds)F=function(){_a.nextTick(I)};else if(!Cs||W.navigator&&W.navigator.standalone)if(xa&&xa.resolve){var Y=xa.resolve(void 0);F=function(){Y.then(I)}}else F=function(){Ru.call(W,I)};else{var ee=!0,se=document.createTextNode("");new Cs(I).observe(se,{characterData:!0}),F=function(){se.data=ee=!ee}}return function(de){var xe={fn:de,next:void 0};L&&(L.next=xe),T||(T=xe,F()),L=xe}}(),Ms=W.TypeError,Hr=W.process,Ns=Hr&&Hr.versions,Lu=Ns&&Ns.v8||"",Ui=W.Promise,un=Qt(Hr)=="process",zn=function(){},fn=Fs=Mn.f,Vn=!!function(){try{var T=Ui.resolve(1),L=(T.constructor={})[wt("species")]=function(F){F(zn,zn)};return(un||typeof PromiseRejectionEvent=="function")&&T.then(zn)instanceof L&&Lu.indexOf("6.6")!==0&&Uu.indexOf("Chrome/66")===-1}catch(F){}}(),zs=function(T){var L;return!(!Ae(T)||typeof(L=T.then)!="function")&&L},Sa=function(T,L){if(!T._n){T._n=!0;var F=T._c;Is(function(){for(var I=T._v,Y=T._s==1,ee=0;F.length>ee;)(function(se){var de,xe,Re,Fe=Y?se.ok:se.fail,Ie=se.resolve,He=se.reject,Ke=se.domain;try{Fe?(Y||(T._h==2&&Fu(T),T._h=1),Fe===!0?de=I:(Ke&&Ke.enter(),de=Fe(I),Ke&&(Ke.exit(),Re=!0)),de===se.promise?He(Ms("Promise-chain cycle")):(xe=zs(de))?xe.call(de,Ie,He):Ie(de)):He(I)}catch(Be){Ke&&!Re&&Ke.exit(),He(Be)}})(F[ee++]);T._c=[],T._n=!1,L&&!T._h&&Pu(T)})}},Pu=function(T){Os.call(W,function(){var L,F,I,Y=T._v,ee=Vs(T);if(ee&&(L=Nn(function(){un?Hr.emit("unhandledRejection",Y,T):(F=W.onunhandledrejection)?F({promise:T,reason:Y}):(I=W.console)&&I.error&&I.error("Unhandled promise rejection",Y)}),T._h=un||Vs(T)?2:1),T._a=void 0,ee&&L.e)throw L.v})},Vs=function(T){return T._h!==1&&(T._a||T._c).length===0},Fu=function(T){Os.call(W,function(){var L;un?Hr.emit("rejectionHandled",T):(L=W.onrejectionhandled)&&L({promise:T,reason:T._v})})},jr=function(T){var L=this;L._d||(L._d=!0,(L=L._w||L)._v=T,L._s=2,L._a||(L._a=L._c.slice()),Sa(L,!0))},ka=function(T){var L,F=this;if(!F._d){F._d=!0,F=F._w||F;try{if(F===T)throw Ms("Promise can't be resolved itself");(L=zs(T))?Is(function(){var I={_w:F,_d:!1};try{L.call(T,we(ka,I,1),we(jr,I,1))}catch(Y){jr.call(I,Y)}}):(F._v=T,F._s=1,Sa(F,!1))}catch(I){jr.call({_w:F,_d:!1},I)}}};Vn||(Ui=function(T){sn(this,Ui,"Promise","_h"),Ee(T),wa.call(this);try{T(we(ka,this,1),we(jr,this,1))}catch(L){jr.call(this,L)}},(wa=function(T){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=function(T,L,F){for(var I in L)F&&T[I]?T[I]=L[I]:ce(T,I,L[I]);return T}(Ui.prototype,{then:function(T,L){var F=fn(ws(this,Ui));return F.ok=typeof T!="function"||T,F.fail=typeof L=="function"&&L,F.domain=un?Hr.domain:void 0,this._c.push(F),this._a&&this._a.push(F),this._s&&Sa(this,!1),F.promise},catch:function(T){return this.then(void 0,T)}}),Bs=function(){var T=new wa;this.promise=T,this.resolve=we(ka,T,1),this.reject=we(jr,T,1)},Mn.f=fn=function(T){return T===Ui||T===Ta?new Bs(T):Fs(T)}),te(te.G+te.W+te.F*!Vn,{Promise:Ui}),Ei(Ui,"Promise"),function(T){var L=typeof O[T]=="function"?O[T]:W[T];Ce&&L&&!L[Us]&&H.f(L,Us,{configurable:!0,get:function(){return this}})}("Promise"),Ta=O.Promise,te(te.S+te.F*!Vn,"Promise",{reject:function(T){var L=fn(this);return(0,L.reject)(T),L.promise}}),te(te.S+!0*te.F,"Promise",{resolve:function(T){return Ea(this===Ta?Ui:this,T)}}),te(te.S+te.F*!(Vn&&function(T,L){if(!L&&!Ls)return!1;var F=!1;try{var I=[7],Y=I[ba]();Y.next=function(){return{done:F=!0}},I[ba]=function(){return Y},T(I)}catch(ee){}return F}(function(T){Ui.all(T).catch(zn)})),"Promise",{all:function(T){var L=this,F=fn(L),I=F.resolve,Y=F.reject,ee=Nn(function(){var se=[],de=0,xe=1;bs(T,!1,function(Re){var Fe=de++,Ie=!1;se.push(void 0),xe++,L.resolve(Re).then(function(He){Ie||(Ie=!0,se[Fe]=He,--xe||I(se))},Y)}),--xe||I(se)});return ee.e&&Y(ee.v),F.promise},race:function(T){var L=this,F=fn(L),I=F.reject,Y=Nn(function(){bs(T,!1,function(ee){L.resolve(ee).then(F.resolve,I)})});return Y.e&&I(Y.v),F.promise}}),te(te.P+te.R,"Promise",{finally:function(T){var L=ws(this,O.Promise||W.Promise),F=typeof T=="function";return this.then(F?function(I){return Ea(L,T()).then(function(){return I})}:T,F?function(I){return Ea(L,T()).then(function(){throw I})}:T)}}),te(te.S,"Promise",{try:function(T){var L=Mn.f(this),F=Nn(T);return(F.e?L.reject:L.resolve)(F.v),L.promise}});var Bu=O.Promise,Aa=n(u(function(T){T.exports={default:Bu,__esModule:!0}}));Te("keys",function(){return function(T){return Qi(C(T))}});var Ou=O.Object.keys,cn=n(u(function(T){T.exports={default:Ou,__esModule:!0}})),Iu=u(function(T){function L(){}function F(xe,Re,Fe){this.fn=xe,this.context=Re,this.once=Fe||!1}function I(xe,Re,Fe,Ie,He){if(typeof Fe!="function")throw new TypeError("The listener must be a function");var Ke=new F(Fe,Ie||xe,He),Be=de?de+Re:Re;return xe._events[Be]?xe._events[Be].fn?xe._events[Be]=[xe._events[Be],Ke]:xe._events[Be].push(Ke):(xe._events[Be]=Ke,xe._eventsCount++),xe}function Y(xe,Re){--xe._eventsCount==0?xe._events=new L:delete xe._events[Re]}function ee(){this._events=new L,this._eventsCount=0}var se=Object.prototype.hasOwnProperty,de="~";Object.create&&(L.prototype=Object.create(null),new L().__proto__||(de=!1)),ee.prototype.eventNames=function(){var xe,Re,Fe=[];if(this._eventsCount===0)return Fe;for(Re in xe=this._events)se.call(xe,Re)&&Fe.push(de?Re.slice(1):Re);return Object.getOwnPropertySymbols?Fe.concat(Object.getOwnPropertySymbols(xe)):Fe},ee.prototype.listeners=function(xe){var Re=de?de+xe:xe,Fe=this._events[Re];if(!Fe)return[];if(Fe.fn)return[Fe.fn];for(var Ie=0,He=Fe.length,Ke=new Array(He);Ie<He;Ie++)Ke[Ie]=Fe[Ie].fn;return Ke},ee.prototype.listenerCount=function(xe){var Re=de?de+xe:xe,Fe=this._events[Re];return Fe?Fe.fn?1:Fe.length:0},ee.prototype.emit=function(xe,Re,Fe,Ie,He,Ke){var Be=de?de+xe:xe;if(!this._events[Be])return!1;var qe,Qe,rt=this._events[Be],bt=arguments.length;if(rt.fn){switch(rt.once&&this.removeListener(xe,rt.fn,void 0,!0),bt){case 1:return rt.fn.call(rt.context),!0;case 2:return rt.fn.call(rt.context,Re),!0;case 3:return rt.fn.call(rt.context,Re,Fe),!0;case 4:return rt.fn.call(rt.context,Re,Fe,Ie),!0;case 5:return rt.fn.call(rt.context,Re,Fe,Ie,He),!0;case 6:return rt.fn.call(rt.context,Re,Fe,Ie,He,Ke),!0}for(Qe=1,qe=new Array(bt-1);Qe<bt;Qe++)qe[Qe-1]=arguments[Qe];rt.fn.apply(rt.context,qe)}else{var Lt,or=rt.length;for(Qe=0;Qe<or;Qe++)switch(rt[Qe].once&&this.removeListener(xe,rt[Qe].fn,void 0,!0),bt){case 1:rt[Qe].fn.call(rt[Qe].context);break;case 2:rt[Qe].fn.call(rt[Qe].context,Re);break;case 3:rt[Qe].fn.call(rt[Qe].context,Re,Fe);break;case 4:rt[Qe].fn.call(rt[Qe].context,Re,Fe,Ie);break;default:if(!qe)for(Lt=1,qe=new Array(bt-1);Lt<bt;Lt++)qe[Lt-1]=arguments[Lt];rt[Qe].fn.apply(rt[Qe].context,qe)}}return!0},ee.prototype.on=function(xe,Re,Fe){return I(this,xe,Re,Fe,!1)},ee.prototype.once=function(xe,Re,Fe){return I(this,xe,Re,Fe,!0)},ee.prototype.removeListener=function(xe,Re,Fe,Ie){var He=de?de+xe:xe;if(!this._events[He])return this;if(!Re)return Y(this,He),this;var Ke=this._events[He];if(Ke.fn)Ke.fn!==Re||Ie&&!Ke.once||Fe&&Ke.context!==Fe||Y(this,He);else{for(var Be=0,qe=[],Qe=Ke.length;Be<Qe;Be++)(Ke[Be].fn!==Re||Ie&&!Ke[Be].once||Fe&&Ke[Be].context!==Fe)&&qe.push(Ke[Be]);qe.length?this._events[He]=qe.length===1?qe[0]:qe:Y(this,He)}return this},ee.prototype.removeAllListeners=function(xe){var Re;return xe?(Re=de?de+xe:xe,this._events[Re]&&Y(this,Re)):(this._events=new L,this._eventsCount=0),this},ee.prototype.off=ee.prototype.removeListener,ee.prototype.addListener=ee.prototype.on,ee.prefixed=de,ee.EventEmitter=ee,T.exports=ee}),Mu=function T(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},F=L.url,I=L.method,Y=I===void 0?"GET":I,ee=L.type,se=ee===void 0?"arraybuffer":ee,de=L.timeout,xe=de===void 0?1e4:de,Re=L.data,Fe=Re===void 0?{}:Re,Ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ze(this,T),new Aa(function(He,Ke){var Be=new window.XMLHttpRequest,qe=Y.toUpperCase(),Qe=[];se&&(Be.responseType=se),xe&&(Be.timeout=xe);for(var rt in Fe)Qe.push("k="+Fe[rt]);if(Be.onload=function(){Be.status===200||Be.status===206?He({context:Ie,res:Be}):Ke(new Error({context:Ie,res:Be,type:"error"}))},Be.onerror=function(bt){Ke(new Error({context:Ie,res:Be,type:"error"}))},Be.ontimeout=function(bt){Ke(new Error({context:Ie,res:Be,type:"error"}))},Be.onabort=function(){Ke(new Error({context:Ie,res:Be,type:"error"}))},qe==="GET")Be.open(qe,""+F),Be.send();else{if(qe!=="post")throw new Error("xhr "+qe+" is not supported");Be.open(qe,F),Be.setRequestHeader("Content-type","application/x-www-form-urlencoded"),Be.send(Qe.join("&"))}})},Ca=/^WEBVTT/,Nu=/^STYLE+$/,zu=/^\:\:cue/,Vu=/^}+$/,Hs=/^\[Script Info\].*/,js=[/[0-9]{1,3}:[0-9]{2}:[0-9]{2}\.[0-9]{1,3}-->[0-9]{1,3}:[0-9]{2}:[0-9]{2}\.[0-9]{1,3}/,/[0-9]{1,2}:[0-9]{2}\.[0-9]{1,3}-->[0-9]{1,2}:[0-9]{2}\.[0-9]{1,3}/,/[0-9]{1,2}\.[0-9]{1,3}-->[0-9]{1,2}\.[0-9]{1,3}/],Gs=/^Format:\s/,$s=/^Style:\s/,Ws=/^Dialogue:\s/,Da=function(){function T(){ze(this,T)}return Vr(T,null,[{key:"parseJson",value:function(L){for(var F=[],I=0,Y=0;Y<L.length;Y++){if(I>=50&&(I=0),I===0){var ee={start:L[Y].start,list:[L[Y]],end:L[Y].end};F.push(ee)}else F[F.length-1].list.push(L[Y]),F[F.length-1].end=L[Y].end;I++}return F}},{key:"parse",value:function(L,F){var I=T.checkFormat(L);I||F({format:I});try{var Y=[];I==="ass"?Y=T.parseASS(L):I==="vtt"&&(Y=T.parseVTT(L)),F({format:I,list:Y.list,styles:Y.styles})}catch(ee){console.error(ee),F({format:I},ee)}}},{key:"parseASSItem",value:function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],I=L.split(","),Y={},ee="";try{var se=I.length-F.length;return ee=se>0?I.splice(F.length-1,se+1).join(",")+"":I[I.length-1]+"",ee=ee.replace(/\\n+/g,""),ee=v(ee),I[F.length-1]=ee,F.map(function(de,xe){de==="end"||de==="start"?Y[de]=c(I[xe].split(":")):de==="text"?Y[de]=[I[xe]]:de==="layer"?(Y[de]=[I[xe]],Y.textTag=[I[xe]]):Y[de]=de==="style"?[I[xe]]:Number(I[xe])?Number(I[xe]):I[xe]}),Y}catch(de){return console.error(de),{}}}},{key:"parseASS",value:function(L){for(var F=L.split(`
`),I=[],Y=0,ee=0,se=[],de=[],xe=null;Y<F.length;){if(Gs.test(F[Y]))de=(de=F[Y].replace(Gs,"").replace(/\s+/g,"").split(",")).map(function(qe){return qe.toLocaleLowerCase()});else if($s.test(F[Y]))se.push(F[Y].replace($s,"").replace(/\s+/g,""));else if(Ws.test(F[Y])){var Re=T.parseASSItem(F[Y].replace(Ws,""),de);if(xe&&Re.start===xe.start&&Re.end===xe.end)try{var Fe=xe,Ie=Fe.text,He=Fe.textTag,Ke=Fe.style;Ie.push(Re.text[0]),He.push(Re.textTag[0]),Ke.push(Re.style[0])}catch(qe){console.error(qe)}else{xe=Re;var Be=null;ee%50==0?((Be={start:xe.start,end:xe.end,list:[]}).list.push(xe),I.push(Be)):((Be=I[I.length-1]).end=xe.end,Be.list.push(xe)),ee++}}Y++}return{list:I,style:{}}}},{key:"parseVTTStyle",value:function(L,F){var I=L.split(":");if(I.length>1){var Y=I[0].trim().split("-"),ee="";Y.length>1?Y.map(function(se,de){ee+=de===0?se:se.charAt(0).toUpperCase()+se.slice(1)}):ee=Y[0],F[ee]=I[1].trim().replace(/;$/,"")}return F}},{key:"parseVTT",value:function(L){for(var F=(L=L.replace(Ca,"")).split(`
`),I=[],Y=0,ee=0,se=null,de=!1,xe=!1,Re=null,Fe=null,Ie=[];Y<F.length;){var He=p(Y,F).trim();if(!He||de&&g(He))de=!He;else if(zu.test(He)&&Nu.test(p(Y-1,F).trim())){xe=!0;var Ke=/\((.+?)\)/g.exec(He);Fe=Ke?Ke[1]:"",Re=""}else if(xe)Vu.test(He)?(Ie.push({key:Fe,style:Re}),Re=null,Fe=null,xe=!1):Re+=He;else if(He){de=!1;var Be=this.checkIsTime(F[Y]);if(Be){var qe=this.parseVttTime(Be);if(!se||qe.start!==se.start||qe.end!==se.end){(se=qe).text=[],se.textTag=[];var Qe=null;ee%50==0?((Qe={start:se.start,end:se.end,list:[]}).list.push(se),I.push(Qe)):((Qe=I[I.length-1]).end=se.end,Qe.list.push(se)),ee++}}else if(se){var rt=se,bt=rt.text,Lt=rt.textTag,or=this.parseVttText(F[Y]);bt.push(or.text),Lt.push(or.tag)}de=!1}Y++}return{list:I,styles:Ie}}},{key:"checkIsTime",value:function(L){L=L.replace(/\s+/g,"");for(var F=0,I=null;F<js.length&&!(I=js[F].exec(L));)F++;return I?I[0]:null}},{key:"parseVttText",value:function(L){var F=/^(<?.+?>)/g.exec(L),I="",Y="default";if(F){Y=F[0].replace(/\<|\>|\&/g,"");var ee=RegExp("^<"+Y+">(([\\s\\S])*?)</"+Y+">$").exec(L);ee?I=ee[1]:(I=L,Y="")}else I=L;for(var se=/<(\w+).(\w+)>/g,de=se.exec(I);de&&de.length>2;)I=I.replace(de[0],"<"+de[1]+' class="'+de[2]+'">'),de=se.exec(I);return{tag:Y,text:v(I.replace(/\\n+/g,"<br/>"))}}},{key:"parseVttTime",value:function(L){var F=L.split("-->"),I=void 0,Y=0;if(F.length===2){var ee=F[0].split(":"),se=F[1].split(":");I=c(ee),Y=c(se)}return{start:I,end:Y,time:L}}},{key:"isVTT",value:function(L){return Ca.test(L)}},{key:"isASS",value:function(L){return Hs.test(L)}},{key:"checkFormat",value:function(L){return L?Ca.test(L)?"vtt":Hs.test(L)?"ass":null:null}}]),T}(),Hu=function(){function T(){var L=this;ze(this,T),this.__handlers=[],window.ResizeObserver&&(this.observer=new window.ResizeObserver(function(F){L.__trigger(F)}))}return Vr(T,[{key:"addObserver",value:function(L,F){if(this.observer){this.observer&&this.observer.observe(L);for(var I=this.__handlers,Y=-1,ee=0;ee<I.length;ee++)I[ee]&&L===I[ee].target&&(Y=ee);Y>-1?this.__handlers[Y].handler.push(F):this.__handlers.push({target:L,handler:[F]})}}},{key:"unObserver",value:function(L){var F=-1;this.__handlers.map(function(I,Y){L===I.target&&(F=Y)}),this.observer&&this.observer.unobserve(L),F>-1&&this.__handlers.splice(F,1)}},{key:"destroyObserver",value:function(){this.observer&&this.observer.disconnect(),this.observer=null,this.__handlers=null}},{key:"__runHandler",value:function(L,F){for(var I=this.__handlers,Y=0;Y<I.length;Y++)if(I[Y]&&L===I[Y].target){I[Y].handler&&I[Y].handler.map(function(ee){try{ee(L,F)}catch(se){console.error(se)}});break}}},{key:"__trigger",value:function(L){var F=this;L.map(function(I){var Y=I.contentRect;F.__runHandler(I.target,Y)})}}]),T}(),dn=null;(function(T,L){L===void 0&&(L={});var F=L.insertAt;if(T&&typeof document!="undefined"){var I=document.head||document.getElementsByTagName("head")[0],Y=document.createElement("style");Y.type="text/css",F==="top"&&I.firstChild?I.insertBefore(Y,I.firstChild):I.appendChild(Y),Y.styleSheet?Y.styleSheet.cssText=T:Y.appendChild(document.createTextNode(T))}})(`xg-text-track.xg-text-track {
  font-family: "PingFang SC","SF Pro SC","SF Pro Text","SF Pro Icons","Helvetica Neue","Helvetica","Arial",sans-serif;
  -webkit-font-smoothing: antialiased;
  position: absolute;
  bottom: 0;
  color: #fff;
  left: 0;
  right: 0;
  pointer-events: none;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center; }
  xg-text-track.xg-text-track.text-track-no-fitvideo {
    margin-bottom: 2%; }
  xg-text-track.xg-text-track.text-track-hide {
    opacity: 0;
    visibility: hidden; }
  xg-text-track.xg-text-track.text-track-show {
    opacity: 1;
    visibility: visible; }
  xg-text-track.xg-text-track xg-text-track-inner {
    display: block;
    max-width: 92%; }
  xg-text-track.xg-text-track xg-text-track-span {
    display: -webkit-box;
    text-align: center;
    text-overflow: ellipsis;
    -webkit-box-orient: vertical;
    overflow: hidden;
    padding: 1px 4px;
    -webkit-line-clamp: 1;
    line-height: 120%;
    word-break: break-word; }
    xg-text-track.xg-text-track xg-text-track-span.text-track-deputy {
      font-size: 75%; }
    xg-text-track.xg-text-track xg-text-track-span.text-track-single {
      -webkit-line-clamp: 1; }
    xg-text-track.xg-text-track xg-text-track-span.text-track-double {
      -webkit-line-clamp: 2; }
    xg-text-track.xg-text-track xg-text-track-span.text-track-three {
      -webkit-line-clamp: 3; }
  xg-text-track.xg-text-track.text-track-bg xg-text-track-inner {
    background-color: rgba(0, 0, 0, .54);
    border-radius: 2px; }
  xg-text-track.xg-text-track.text-track-stroke xg-text-track-inner {
    background-color: none;
    border-radius: 0;
    text-shadow: -1px 1px 0 rgba(0, 0, 0, .7), 1px 1px 0 rgba(0, 0, 0, .7), 1px -1px 0 rgba(0, 0, 0, .7), -1px -1px 0 rgba(0, 0, 0, .7); }
`);var Ys=[{code:0,msg:"SUCCESS"},{code:1,msg:"LOAD_ERROR"},{code:2,msg:"PARSER_ERROR"},{code:3,msg:"FORMAT_NOT_SUPPORTED"},{code:4,msg:"ID_OR_LANGUAGE_NOT_EXIST"},{code:5,msg:"PARAMETERS_ERROR"},{code:6,msg:"ABORT"},{code:7,msg:"UNKNOWN"},{code:8,msg:"DATA_ERROR:subtitle.url is null"}],ju={RESIZE:"resize"},Xs=!1;return function(T){function L(F){ze(this,L);var I=In(this,(L.__proto__||Se(L)).call(this));return Xs=_(),I.currentText=null,I.textTrack=[],I._cid=-1,I._gid=-1,I._cids=[],I._iId=null,I._iC=0,I.player=null,I.root=null,I.config={line:"double",bottom:0,mode:"stroke",defaultOpen:!1,baseSizeX:49,baseSizeY:28,minSize:16,minMobileSize:13,fitVideo:!0,offsetBottom:2,fontColor:"#fff"},I._ctime=0,I._loadingTrack={},cn(I.config).map(function(Y){F[Y]!==void 0&&F[Y]!==null&&(I.config[Y]=F[Y])}),I._isOpen=!1,I._videoMeta={scale:0,videoHeight:0,videoWidth:0,lwidth:0,lheight:0,vWidth:0,vHeight:0,vBottom:0,vLeft:0,marginBottom:0},F.subTitles&&y(F.subTitles)==="Array"?(F.player&&I.attachPlayer(F.player),I.setSubTitles(F.subTitles,I.config.defaultOpen),I):In(I)}return vt(L,T),Vr(L,[{key:"version",get:function(){return"1.0.12"}}]),Vr(L,[{key:"setSubTitles",value:function(){var F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],I=this,Y=arguments.length>1&&arguments[1]!==void 0&&arguments[1],ee=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],se=this._isOpen||Y;ee&&this.innerRoot&&this.switchOff(),this.currentText=null,this.textTrack=[],F.map(function(de){var xe={};cn(de).map(function(Re){xe[Re]=de[Re]}),xe.isDefault&&(I.currentText=xe),I.textTrack.push(xe)}),this.currentText&&P(this.currentText).then(function(de){I.addStyles(de),se&&I.switch()})}},{key:"addStyles",value:function(F){var I=F.styles,Y=F.format;I&&Y==="vtt"&&(I.map(function(ee){ee.key||(ee.key="xg-text-track-span")}),E(I,"xg-text-track"))}},{key:"attachPlayer",value:function(F){var I=this;if(F){this.player&&this.detachPlayer();var Y=this.config,ee=Y.fontColor,se=Y.mode,de=Y.fitVideo;this.player=F,this.root=document.createElement("xg-text-track"),this.root.className="xg-text-track",!this._isOpen&&s(this.root,"text-track-hide"),!de&&s(this.root,"text-track-no-fitvideo"),se&&s(this.root,"text-track-"+se),this.innerRoot=document.createElement("xg-text-track-inner"),this.root.appendChild(this.innerRoot),ee&&(this.root.style.color=ee),this.currentText&&["language","id","label"].map(function(xe){I.root.setAttribute("data-"+xe,I.currentText[xe]||"")}),this.player.root.appendChild(this.root),["destroy","__onTimeupdate","_onResize"].map(function(xe){I[xe]=I[xe].bind(I)}),this.player.on("destroy",this.destroy),this.player.on("timeupdate",this.__onTimeupdate),this._isOpen&&this.switch(),w(F.root,this._onResize)}}},{key:"detachPlayer",value:function(){var F=this.player;F&&(F.off("destroy",this.destroy),F.off("timeupdate",this.__onTimeupdate),F.root&&(k(F.root,this._onResize),F.root.removeChild(this.root)),this.innerRoot=null,this.root=null,this.player=null)}},{key:"switch",value:function(){var F=this,I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:"",language:""};return this._loadingTrack=I,new Aa(function(Y,ee){if(!I.id&&!I.language){if(F.currentText){F._loadingTrack={},F._updateCurrent(F.currentText),F._isOpen=!0,F.show();var se=x(0,{message:"switch default subtitle success"});return void Y(se)}var de=x(5,{message:"no default subtitle"});return void ee(de)}if(F.currentText&&U(I,F.currentText))F._loadingTrack={},F._updateCurrent(F.currentText),F._isOpen=!0,F.show(),Y(x(0));else{for(var xe=null,Re=0;Re<F.textTrack.length;Re++)if(U(I,F.textTrack[Re])){xe=F.textTrack[Re];break}if(xe)xe.list?(F._loadingTrack={},F._updateCurrent(xe),F._isOpen=!0,F.show(),Y(x(0))):P(xe).then(function(Ie){if(F.addStyles(Ie),F._loadingTrack.id===xe.id||F._loadingTrack.language===Ie.language)F._loadingTrack={},F._updateCurrent(Ie),F._isOpen=!0,F.show(),Y(x(0));else{var He=x(6,{message:"check _loadingTrack fail id: "+F._loadingTrack.id+"  nextSubtitle:"+Ie.id});console.trace(He),ee(He)}}).catch(function(Ie){ee(Ie)});else{var Fe=x(4,new Error("The is no subtitle with id:[{"+I.id+"}] or language:["+I.language+"]"));console.trace(Fe),ee(Fe)}}})}},{key:"switchOff",value:function(){this._isOpen=!1,this.hide()}},{key:"_updateCurrent",value:function(F){var I=this;if(this.root){this.currentText=F,["language","id","label"].map(function(ee){I.root.setAttribute("data-"+ee,I.currentText[ee]||"")}),this.__remove(this._cids);var Y=this.player.currentTime;this._cids=[],this._gid=-1,this._cid=-1,this._update(Y)}}},{key:"__loadAll",value:function(){this.textTrack.map(function(F){P(F)})}},{key:"getDelCid",value:function(F,I){for(var Y=[],ee=0;ee<F.length;ee++)I.includes(F[ee])||Y.push(F[ee]);return Y}},{key:"getNewCid",value:function(F,I){for(var Y=[],ee=0;ee<I.length;ee++)F.includes(I[ee])||Y.push(I[ee]);return Y}},{key:"_update",value:function(F){var I=this,Y=f(F,this.currentText.list,this._gid),ee=[];if(Y>-1&&(ee=d(F,this.currentText.list[Y].list,this._cid)),ee.length<1)return this._cids.length>0&&this.__remove(this._cids),void(this._cids=[]);if(this._cids!==ee||Y!==this._gid){this._gid=Y,this._cid=ee[0];var se=this.getDelCid(this._cids,ee),de=this.getNewCid(this._cids,ee);this._cids=ee,this.__remove(se);var xe=[];de.map(function(Re){var Fe=I.currentText.list[Y].list[Re];Fe.index=Re,xe.push(Fe)}),this.__render(xe,F)}}},{key:"__onTimeupdate",value:function(){if(this._isOpen){var F=this.player.video,I=F.videoWidth,Y=F.videoHeight;!this._videoMeta.scale&&I&&Y&&this._onResize(this.player.root);var ee=this.player.currentTime;Math.round(Math.abs(1e3*ee-this._ctime))<200||(this._ctime=1e3*ee,this.currentText&&this.currentText.list&&this._update(ee))}}},{key:"_onResize",value:function(F){var I=this._videoMeta;if(F&&F instanceof window.Element||(F=this.player.root),this._iId&&(clearTimeout(this._iId),this._iId=null),!I.scale){if(!this.player.video)return;var Y=this.player.video,ee=Y.videoWidth,se=Y.videoHeight;if(!ee||!se)return;I.videoWidth=ee,I.videoHeight=se,I.scale=parseInt(se/ee*100,10)}this.__startResize(F)}},{key:"resize",value:function(F,I){var Y=this,ee=this.config,se=ee.baseSizeX,de=ee.baseSizeY,xe=ee.minMobileSize,Re=ee.minSize,Fe=ee.fitVideo,Ie=ee.offsetBottom,He=this._videoMeta.scale;this._videoMeta.lwidth=F,this._videoMeta.lheight=I;var Ke=void 0,Be=0;I/F*100>=He?(Be=parseInt(He*F,10)/100,Ke=F):(Be=I,Ke=parseInt(I/He*100,10)),this._videoMeta.vWidth=Ke,this._videoMeta.vHeight=Be;var qe=0,Qe=0;He>120?(qe=de,Qe=parseInt(qe*Be/1080,10)):(qe=se,Qe=parseInt(qe*Ke/1920,10));var rt=Xs?xe:Re,bt={fontSize:Qe=Qe<rt?rt:Qe>qe?qe:Qe},Lt=parseInt((I-Be)/2,10),or=parseInt((F-Ke)/2,10),Ra=parseInt(Be*Ie,10)/100;this._videoMeta.vBottom=Lt,this._videoMeta.vLeft=or,this._videoMeta.marginBottom=Ra,Fe&&(bt.bottom=Lt+Ra,bt.left=bt.right=or),cn(bt).map(function(Ks){Y.root.style[Ks]=bt[Ks]+"px"}),this.emit(ju.RESIZE,{vLeft:or,vBottom:Lt,marginBottom:Ra,vWidth:Ke,vHeight:Be,fontSize:Qe,scale:He})}},{key:"__startResize",value:function(F){var I=this,Y=F.getBoundingClientRect(),ee=this._videoMeta,se=Y.width,de=Y.height;if(this._iId&&(clearTimeout(this._iId),this._iId=null),se>0&&de>0&&(se!==ee.lwidth||de!==ee.lheight))this._iC=0,this.resize(se,de);else{if(this._iC>=5)return void(this._iC=0);this._iC++,this._iId=setTimeout(function(){I.__startResize(F)},50)}}},{key:"__remove",value:function(F){var I=this;if(F&&!(F.length<1)){for(var Y=this.innerRoot.children,ee=[],se=0;se<Y.length;se++){var de=Number(Y[se].getAttribute("data-index"));F.includes(de)&&ee.push(Y[se])}ee.map(function(xe){I.innerRoot.removeChild(xe)})}}},{key:"__render",value:function(){var F=this,I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];I.length>0&&I.map(function(Y){var ee="text-track-"+F.config.line;Y.text.map(function(se,de){de>0&&(ee+=" text-track-deputy");var xe={"data-start":Y.start,"data-end":Y.end,"data-index":Y.index};F.innerRoot.appendChild(m("xg-text-track-span",se,xe,ee))})})}},{key:"show",value:function(){l(this.root,"text-track-hide")}},{key:"hide",value:function(){s(this.root,"text-track-hide"),this.innerRoot.innerHTML=""}},{key:"destroy",value:function(){this.detachPlayer(),this.removeAllListeners(),this.player=null,this.textTrack=null}},{key:"marginBottom",get:function(){var F=this._videoMeta,I=F.bottom,Y=F.marginBottom;return this.config.fitVideo?I+Y:Y}}]),L}(Iu)})},function(t,i,r){var n=r(9),u=Je(n),o=r(10),c=Je(o),g=r(108),v=Je(g),p=r(48),e=Je(p),s=r(40),l=Je(s),f=r(53),d=Je(f),y=r(56),m=Je(y),_=r(59),E=Je(_),w=r(111),k=Je(w),x=r(116),S=Je(x),P=r(122),U=Je(P),R=r(64),C=Je(R),A=r(68),b=Je(A),O=r(71),W=Je(O),K=r(74),G=Je(K),B=r(125),j=Je(B),z=r(128),$=Je(z),J=r(129),Q=Je(J),ne=r(133),Ee=Je(ne),we=r(139),Ae=Je(we),De=r(142),Ve=Je(De),Ce=r(145),Me=Je(Ce),Ge=r(149),D=Je(Ge),fe=r(153),ae=Je(fe),X=r(157),H=Je(X),q=r(160),ce=Je(q),he=r(162),te=Je(he),Te=r(163),Le=Je(Te),Se=r(166),ze=Je(Se),Xe=r(169),it=Je(Xe);function Je(Ft){return Ft&&Ft.__esModule?Ft:{default:Ft}}u.default.installAll([c.default,v.default,e.default,l.default,d.default,m.default,E.default,k.default,S.default,U.default,C.default,b.default,W.default,G.default,j.default,$.default,Q.default,Ee.default,Ae.default,Ve.default,Me.default,D.default,ae.default,H.default,ce.default,te.default,Le.default,ze.default,it.default])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0);r(109);var u=function(){for(var c=this,g=c.root,v="",p=1;p<=12;p++)v+='<div class="xgplayer-enter-bar'+p+'"></div>';var e=(0,n.createDom)("xg-enter",`<div class="xgplayer-enter-spinner">
                                                  `+v+`
                                                </div>`,{},"xgplayer-enter");g.appendChild(e)};i.default={name:"s_enter",method:u},t.exports=i.default},function(t,i,r){var n=r(110);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-enter{display:none;position:absolute;left:0;top:0;width:100%;height:100%;background:#000;z-index:120}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner{display:block;position:absolute;left:50%;top:50%;height:100px;width:100px;position:relative;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div{width:12%;height:26%;background-color:hsla(0,0%,100%,.7);position:absolute;left:44%;top:37%;opacity:0;border-radius:30px;-webkit-animation:fade 1s linear infinite;animation:fade 1s linear infinite}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar1{-webkit-transform:rotate(0deg) translateY(-142%);-ms-transform:rotate(0deg) translateY(-142%);transform:rotate(0deg) translateY(-142%);-webkit-animation-delay:0s;animation-delay:0s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar2{-webkit-transform:rotate(30deg) translateY(-142%);-ms-transform:rotate(30deg) translateY(-142%);transform:rotate(30deg) translateY(-142%);-webkit-animation-delay:-.9163s;animation-delay:-.9163s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar3{-webkit-transform:rotate(60deg) translateY(-142%);-ms-transform:rotate(60deg) translateY(-142%);transform:rotate(60deg) translateY(-142%);-webkit-animation-delay:-.833s;animation-delay:-.833s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar4{-webkit-transform:rotate(90deg) translateY(-142%);-ms-transform:rotate(90deg) translateY(-142%);transform:rotate(90deg) translateY(-142%);-webkit-animation-delay:-.7497s;animation-delay:-.7497s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar5{-webkit-transform:rotate(120deg) translateY(-142%);-ms-transform:rotate(120deg) translateY(-142%);transform:rotate(120deg) translateY(-142%);-webkit-animation-delay:-.6664s;animation-delay:-.6664s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar6{-webkit-transform:rotate(150deg) translateY(-142%);-ms-transform:rotate(150deg) translateY(-142%);transform:rotate(150deg) translateY(-142%);-webkit-animation-delay:-.5831s;animation-delay:-.5831s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar7{-webkit-transform:rotate(180deg) translateY(-142%);-ms-transform:rotate(180deg) translateY(-142%);transform:rotate(180deg) translateY(-142%);-webkit-animation-delay:-.4998s;animation-delay:-.4998s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar8{-webkit-transform:rotate(210deg) translateY(-142%);-ms-transform:rotate(210deg) translateY(-142%);transform:rotate(210deg) translateY(-142%);-webkit-animation-delay:-.4165s;animation-delay:-.4165s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar9{-webkit-transform:rotate(240deg) translateY(-142%);-ms-transform:rotate(240deg) translateY(-142%);transform:rotate(240deg) translateY(-142%);-webkit-animation-delay:-.3332s;animation-delay:-.3332s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar10{-webkit-transform:rotate(270deg) translateY(-142%);-ms-transform:rotate(270deg) translateY(-142%);transform:rotate(270deg) translateY(-142%);-webkit-animation-delay:-.2499s;animation-delay:-.2499s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar11{-webkit-transform:rotate(300deg) translateY(-142%);-ms-transform:rotate(300deg) translateY(-142%);transform:rotate(300deg) translateY(-142%);-webkit-animation-delay:-.1666s;animation-delay:-.1666s}.xgplayer-skin-default .xgplayer-enter .xgplayer-enter-spinner div.xgplayer-enter-bar12{-webkit-transform:rotate(330deg) translateY(-142%);-ms-transform:rotate(330deg) translateY(-142%);transform:rotate(330deg) translateY(-142%);-webkit-animation-delay:-.0833s;animation-delay:-.0833s}@-webkit-keyframes fade{0%{opacity:1}to{opacity:.25}}@keyframes fade{0%{opacity:1}to{opacity:.25}}.xgplayer-skin-default.xgplayer-is-enter .xgplayer-enter{display:block}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(112),o=v(u),c=r(113),g=v(c);r(114);function v(e){return e&&e.__esModule?e:{default:e}}var p=function(){var s=this;if(!!s.config.cssFullscreen){var l=(0,n.createDom)("xg-cssfullscreen",`<xg-icon class="xgplayer-icon">
                                             <div class="xgplayer-icon-requestfull">`+o.default+`</div>
                                             <div class="xgplayer-icon-exitfull">`+g.default+`</div>
                                           </xg-icon>`,{},"xgplayer-cssfullscreen"),f={};f.requestfull=s.lang.CSSFULLSCREEN_TIPS,f.exitfull=s.lang.EXITCSSFULLSCREEN_TIPS;var d=(0,n.createDom)("xg-tips",'<span class="xgplayer-tip-requestfull">'+f.requestfull+`</span>
                                        <span class="xgplayer-tip-exitfull">`+f.exitfull+"</span>",{},"xgplayer-tips");l.appendChild(d),s.once("ready",function(){s.controls.appendChild(l)}),["click","touchend"].forEach(function(y){l.addEventListener(y,function(m){m.preventDefault(),m.stopPropagation(),s.userGestureTrigEvent("cssFullscreenBtnClick")})})}};i.default={name:"s_cssFullscreen",method:p},t.exports=i.default},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
  <path transform="scale(0.028 0.028)" d="M843.617212 67.898413 175.411567 67.898413c-61.502749 0-111.367437 49.856501-111.367437 111.367437l0 668.205645c0 61.510936 49.864688 111.367437 111.367437 111.367437L843.617212 958.838931c61.510936 0 111.367437-49.856501 111.367437-111.367437L954.984648 179.26585C954.984648 117.754914 905.12917 67.898413 843.617212 67.898413zM398.146441 736.104057c15.380292 0 27.842115 12.461823 27.842115 27.842115 0 15.379269-12.461823 27.841092-27.842115 27.841092L259.725858 791.787264c-7.785314 0-14.781658-3.217275-19.838837-8.365528-5.383614-4.577249-8.791224-11.228739-8.791224-19.475564L231.095797 624.736621c0-15.371082 12.471033-27.842115 27.842115-27.842115 15.380292 0 27.842115 12.471033 27.842115 27.842115l-0.61603 71.426773 133.036969-133.037992 39.378869 39.378869L324.962651 736.113267 398.146441 736.104057zM419.199942 463.611943 286.162974 330.565764l0.61603 71.435982c0 15.380292-12.461823 27.842115-27.842115 27.842115-15.371082 0-27.842115-12.461823-27.842115-27.842115L231.094774 262.791172c0-8.256034 3.40761-14.908548 8.791224-19.476587 5.057179-5.148253 12.053524-8.374738 19.838837-8.374738l138.420583 0.00921c15.380292 0 27.842115 12.461823 27.842115 27.842115s-12.461823 27.842115-27.842115 27.842115l-73.175603-0.00921 133.607974 133.607974L419.199942 463.611943zM787.932981 763.946172c0 8.247848-3.40761 14.899338-8.791224 19.475564-5.057179 5.148253-12.053524 8.365528-19.839861 8.365528L620.881314 791.787264c-15.379269 0-27.841092-12.461823-27.841092-27.841092 0-15.380292 12.461823-27.842115 27.841092-27.842115l73.185836 0.00921L560.449967 602.50427l39.378869-39.378869L732.875015 696.163393l-0.62524-71.426773c0-15.371082 12.462846-27.842115 27.842115-27.842115 15.380292 0 27.842115 12.471033 27.842115 27.842115L787.934005 763.946172zM787.932981 402.000724c0 15.380292-12.461823 27.842115-27.842115 27.842115-15.379269 0-27.842115-12.461823-27.842115-27.842115l0.62524-71.435982L599.828836 463.611943l-39.378869-39.378869 133.617184-133.607974-73.185836 0.00921c-15.379269 0-27.841092-12.461823-27.841092-27.842115s12.461823-27.842115 27.841092-27.842115l138.421606-0.00921c7.785314 0 14.781658 3.226484 19.839861 8.374738 5.383614 4.568039 8.791224 11.219529 8.791224 19.476587L787.934005 402.000724z"></path>
</svg>
`},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
  <path transform="scale(0.028 0.028)" d="M834.56 81.92H189.44c-59.392 0-107.52 48.128-107.52 107.52v645.12c0 59.392 48.128 107.52 107.52 107.52h645.12c59.392 0 107.52-48.128 107.52-107.52V189.44c0-59.392-48.128-107.52-107.52-107.52zM458.24 727.04c0 14.848-12.288 26.624-26.624 26.624S404.48 741.888 404.48 727.04v-69.632L289.28 773.12c-10.752 10.24-27.648 10.24-37.888 0-10.24-10.752-10.24-27.648 0-37.888L366.592 619.52H296.96c-14.848 0-26.624-12.288-26.624-26.624s12.288-26.624 26.624-26.624h134.144c14.848 0 26.624 12.288 26.624 26.624V727.04z m0-295.936c0 14.848-12.288 26.624-26.624 26.624H296.96c-14.848 0-26.624-12.288-26.624-26.624S282.112 404.48 296.96 404.48h69.632L251.392 289.28c-10.24-10.752-10.24-27.648 0-37.888 5.12-5.12 12.288-7.68 18.944-7.68 6.656 0 13.824 2.56 18.944 7.68L404.48 366.592V296.96c0-14.848 12.288-26.624 26.624-26.624s26.624 12.288 26.624 26.624v134.144zM773.12 773.12c-10.752 10.24-27.648 10.24-37.888 0L619.52 657.408V727.04c0 14.848-12.288 26.624-26.624 26.624s-26.624-11.776-26.624-26.624v-134.144c0-14.848 12.288-26.624 26.624-26.624H727.04c14.848 0 26.624 12.288 26.624 26.624s-12.288 26.624-26.624 26.624h-69.632l115.2 115.2c10.752 10.752 10.752 27.648 0.512 38.4z m0-483.84L657.408 404.48H727.04c14.848 0 26.624 12.288 26.624 26.624 0 14.848-12.288 26.624-26.624 26.624h-134.144c-14.848 0-26.624-12.288-26.624-26.624V296.96c0-14.848 12.288-26.624 26.624-26.624s26.624 12.288 26.624 26.624v69.632L734.72 250.88c5.12-5.12 12.288-7.68 18.944-7.68s13.824 2.56 18.944 7.68c10.752 10.752 10.752 27.648 0.512 38.4z"></path>
</svg>
`},function(t,i,r){var n=r(115);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-cssfullscreen,.xgplayer-skin-default .xgplayer-cssfullscreen-img{position:relative;-webkit-order:12;-moz-box-ordinal-group:13;order:12;display:block;cursor:pointer}.xgplayer-skin-default .xgplayer-cssfullscreen-img .xgplayer-icon,.xgplayer-skin-default .xgplayer-cssfullscreen .xgplayer-icon{width:32px;margin-top:5px}.xgplayer-skin-default .xgplayer-cssfullscreen-img .xgplayer-icon div,.xgplayer-skin-default .xgplayer-cssfullscreen .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-cssfullscreen-img .xgplayer-icon .xgplayer-icon-requestfull,.xgplayer-skin-default .xgplayer-cssfullscreen .xgplayer-icon .xgplayer-icon-requestfull{display:block}.xgplayer-skin-default .xgplayer-cssfullscreen-img .xgplayer-icon .xgplayer-icon-exitfull,.xgplayer-skin-default .xgplayer-cssfullscreen .xgplayer-icon .xgplayer-icon-exitfull{display:none}.xgplayer-skin-default .xgplayer-cssfullscreen-img .xgplayer-tips,.xgplayer-skin-default .xgplayer-cssfullscreen .xgplayer-tips{margin-left:-40px}.xgplayer-skin-default .xgplayer-cssfullscreen-img .xgplayer-tips .xgplayer-tip-requestfull,.xgplayer-skin-default .xgplayer-cssfullscreen .xgplayer-tips .xgplayer-tip-requestfull{display:block}.xgplayer-skin-default .xgplayer-cssfullscreen-img .xgplayer-tips .xgplayer-tip-exitfull,.xgplayer-skin-default .xgplayer-cssfullscreen .xgplayer-tips .xgplayer-tip-exitfull{display:none}.xgplayer-skin-default .xgplayer-cssfullscreen-img:hover,.xgplayer-skin-default .xgplayer-cssfullscreen:hover{opacity:.85}.xgplayer-skin-default .xgplayer-cssfullscreen-img:hover .xgplayer-tips,.xgplayer-skin-default .xgplayer-cssfullscreen:hover .xgplayer-tips{display:block}.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen-img .xgplayer-icon .xgplayer-icon-requestfull,.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen .xgplayer-icon .xgplayer-icon-requestfull{display:none}.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen-img .xgplayer-icon .xgplayer-icon-exitfull,.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen .xgplayer-icon .xgplayer-icon-exitfull{display:block}.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen-img .xgplayer-tips,.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen .xgplayer-tips{margin-left:-47px}.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen-img .xgplayer-tips .xgplayer-tip-requestfull,.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen .xgplayer-tips .xgplayer-tip-requestfull{display:none}.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen-img .xgplayer-tips .xgplayer-tip-exitfull,.xgplayer-skin-default.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen .xgplayer-tips .xgplayer-tip-exitfull{display:block}.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-cssfullscreen,.xgplayer-skin-default.xgplayer-is-fullscreen .xgplayer-cssfullscreen-img{display:none}.xgplayer-skin-default.xgplayer-is-cssfullscreen{position:fixed!important;left:0!important;top:0!important;width:100%!important;height:100%!important;z-index:99999!important}.xgplayer-lang-is-en .xgplayer-cssfullscreen-img .xgplayer-tips,.xgplayer-lang-is-en .xgplayer-cssfullscreen .xgplayer-tips,.xgplayer-lang-is-en.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen-img .xgplayer-tips,.xgplayer-lang-is-en.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen .xgplayer-tips{margin-left:-46px}.lang-is-jp .xgplayer-cssfullscreen-img .xgplayer-tips,.lang-is-jp .xgplayer-cssfullscreen .xgplayer-tips{margin-left:-120px}.lang-is-jp.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen-img .xgplayer-tips,.lang-is-jp.xgplayer-is-cssfullscreen .xgplayer-cssfullscreen .xgplayer-tips{margin-left:-60px}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(117),o=e(u),c=r(118),g=e(c),v=r(119),p=e(v);r(120);function e(l){return l&&l.__esModule?l:{default:l}}var s=function(){var f=this,d=(0,n.createDom)("xg-volume",`<xg-icon class="xgplayer-icon">
                                         <div class="xgplayer-icon-large">`+p.default+`</div>
                                         <div class="xgplayer-icon-small">`+g.default+`</div>
                                         <div class="xgplayer-icon-muted">`+o.default+`</div>
                                       </xg-icon>
                                       <xg-slider class="xgplayer-slider" tabindex="2">
                                         <xg-bar class="xgplayer-bar">
                                           <xg-drag class="xgplayer-drag"></xg-drag>
                                         </xg-bar>
                                       </xg-slider>`,{},"xgplayer-volume");f.once("ready",function(){f.controls&&f.controls.appendChild(d)});var y=d.querySelector(".xgplayer-slider"),m=d.querySelector(".xgplayer-bar"),_=d.querySelector(".xgplayer-drag"),E=d.querySelector(".xgplayer-icon");_.style.height=f.config.volume*100+"%",y.volume=f.config.volume,m.addEventListener("mousedown",function(w){w.preventDefault(),w.stopPropagation(),f.userGestureTrigEvent("volumeBarClick",w)}),["click","touchend"].forEach(function(w){E.addEventListener(w,function(k){k.preventDefault(),k.stopPropagation(),f.userGestureTrigEvent("volumeIconClick")})}),E.addEventListener("mouseenter",function(w){w.preventDefault(),w.stopPropagation(),f.userGestureTrigEvent("volumeIconEnter")}),["blur","mouseleave"].forEach(function(w){d.addEventListener(w,function(k){k.preventDefault(),k.stopPropagation(),f.userGestureTrigEvent("volumeIconLeave")})})};i.default={name:"s_volume",method:s},t.exports=i.default},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28">
  <path transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path transform="scale(0.0220625 0.0220625)" d="M920.4 439.808l-108.544-109.056-72.704 72.704 109.568 108.544-109.056 108.544 72.704 72.704 108.032-109.568 108.544 109.056 72.704-72.704-109.568-108.032 109.056-108.544-72.704-72.704-108.032 109.568z"></path>
</svg>
`},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28">
  <path transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path transform="scale(0.0220625 0.0220625)" d="M795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021zM795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021z"></path>
</svg>
`},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28">
  <path transform="scale(0.0220625 0.0220625)" d="M358.4 358.4h-204.8v307.2h204.8l256 256v-819.2l-256 256z"></path>
  <path transform="scale(0.0220625 0.0220625)" d="M940.632 837.632l-72.192-72.192c65.114-64.745 105.412-154.386 105.412-253.44s-40.299-188.695-105.396-253.424l-0.016-0.016 72.192-72.192c83.639 83.197 135.401 198.37 135.401 325.632s-51.762 242.434-135.381 325.612l-0.020 0.020zM795.648 693.248l-72.704-72.704c27.756-27.789 44.921-66.162 44.921-108.544s-17.165-80.755-44.922-108.546l0.002 0.002 72.704-72.704c46.713 46.235 75.639 110.363 75.639 181.248s-28.926 135.013-75.617 181.227l-0.021 0.021z"></path>
</svg>
`},function(t,i,r){var n=r(121);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,'.xgplayer-skin-default .xgplayer-volume{outline:none;-webkit-order:4;-moz-box-ordinal-group:5;order:4;width:40px;height:40px;display:block;position:relative;z-index:18}.xgplayer-skin-default .xgplayer-volume .xgplayer-icon{margin-top:8px;cursor:pointer;position:absolute;bottom:-9px}.xgplayer-skin-default .xgplayer-volume .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-volume .xgplayer-icon .xgplayer-icon-large{display:block}.xgplayer-skin-default .xgplayer-volume .xgplayer-icon .xgplayer-icon-muted,.xgplayer-skin-default .xgplayer-volume .xgplayer-icon .xgplayer-icon-small{display:none}.xgplayer-skin-default .xgplayer-slider{display:none;position:absolute;width:28px;height:92px;background:rgba(0,0,0,.54);border-radius:1px;bottom:42px;outline:none}.xgplayer-skin-default .xgplayer-slider:after{content:" ";display:block;height:15px;width:28px;position:absolute;bottom:-15px;left:0;z-index:20}.xgplayer-skin-default .xgplayer-bar,.xgplayer-skin-default .xgplayer-drag{display:block;position:absolute;bottom:6px;left:12px;background:hsla(0,0%,100%,.3);border-radius:100px;width:4px;height:76px;outline:none;cursor:pointer}.xgplayer-skin-default .xgplayer-drag{bottom:0;left:0;background:#fa1f41;max-height:76px}.xgplayer-skin-default .xgplayer-drag:after{content:" ";display:inline-block;width:8px;height:8px;background:#fff;box-shadow:0 0 5px 0 rgba(0,0,0,.26);position:absolute;border-radius:50%;left:-2px;top:-6px}.xgplayer-skin-default.xgplayer-volume-active .xgplayer-slider,.xgplayer-skin-default.xgplayer-volume-large .xgplayer-volume .xgplayer-icon .xgplayer-icon-large{display:block}.xgplayer-skin-default.xgplayer-volume-large .xgplayer-volume .xgplayer-icon .xgplayer-icon-muted,.xgplayer-skin-default.xgplayer-volume-large .xgplayer-volume .xgplayer-icon .xgplayer-icon-small,.xgplayer-skin-default.xgplayer-volume-small .xgplayer-volume .xgplayer-icon .xgplayer-icon-large{display:none}.xgplayer-skin-default.xgplayer-volume-small .xgplayer-volume .xgplayer-icon .xgplayer-icon-small{display:block}.xgplayer-skin-default.xgplayer-volume-muted .xgplayer-volume .xgplayer-icon .xgplayer-icon-large,.xgplayer-skin-default.xgplayer-volume-muted .xgplayer-volume .xgplayer-icon .xgplayer-icon-small,.xgplayer-skin-default.xgplayer-volume-small .xgplayer-volume .xgplayer-icon .xgplayer-icon-muted{display:none}.xgplayer-skin-default.xgplayer-volume-muted .xgplayer-volume .xgplayer-icon .xgplayer-icon-muted{display:block}.xgplayer-skin-default.xgplayer-mobile .xgplayer-volume .xgplayer-slider{display:none}',""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(5),o=c(u);r(123);function c(v){return v&&v.__esModule?v:{default:v}}var g=function(){var p=this,e=p.root,s=void 0,l=(0,n.createDom)("xg-definition","",{tabindex:3},"xgplayer-definition");o.default.device==="mobile"&&(p.config.definitionActive="click");function f(){var w=p.definitionList,k=["<ul>"],x=p.config.url,S=document.createElement("a");p.switchURL?["mp4","hls","__flv__","dash"].every(function(A){return p[A]?(p[A].url&&(S.href=p[A].url),A==="__flv__"&&(p[A]._options?S.href=p[A]._options.url:S.href=p[A]._mediaDataSource.url),A==="hls"&&(S.href=p[A].originUrl||p[A].url,x=S.href),x=S.href,!1):!0}):x=p.currentSrc||p.src,w.forEach(function(A){S.href=A.url,p.dash?k.push("<li url='"+A.url+"' cname='"+A.name+"' class='"+(A.selected?"selected":"")+"'>"+A.name+"</li>"):k.push("<li url='"+A.url+"' cname='"+A.name+"' class='"+(S.href===x?"selected":"")+"'>"+A.name+"</li>")});var P=w.filter(function(A){return S.href=A.url,p.dash?A.selected===!0:S.href===x});console.warn("cursrc:",P,"src:",x,"list:",w),k.push("</ul><p class='name'>"+(P[0]||{name:""}).name+"</p>");var U=e.querySelector(".xgplayer-definition");if(U){U.innerHTML=k.join("");var R=U.querySelector(".name");(!p.config.definitionActive||p.config.definitionActive==="hover")&&R.addEventListener("mouseenter",function(A){A.preventDefault(),A.stopPropagation(),(0,n.addClass)(p.root,"xgplayer-definition-active"),U.focus()})}else{l.innerHTML=k.join("");var C=l.querySelector(".name");(!p.config.definitionActive||p.config.definitionActive==="hover")&&C.addEventListener("mouseenter",function(A){A.preventDefault(),A.stopPropagation(),(0,n.addClass)(p.root,"xgplayer-definition-active"),l.focus()}),p.controls.appendChild(l)}}function d(w){p.definitionList=w,w&&w instanceof Array&&w.length>0&&((0,n.addClass)(e,"xgplayer-is-definition"),p.once("canplay",f))}p.on("resourceReady",d);function y(){if(p.currentTime=p.curTime,s)p.pause();else{var w=p.play();w!==void 0&&w&&w.catch(function(k){})}}function m(){p.once("timeupdate",y)}["touchend","click"].forEach(function(w){l.addEventListener(w,function(k){k.preventDefault(),k.stopPropagation();var x=p.definitionList,S=k.target||k.srcElement,P=document.createElement("a");if(S&&S.tagName.toLocaleLowerCase()==="li"){var U=void 0,R=void 0;if(Array.prototype.forEach.call(S.parentNode.childNodes,function(A){(0,n.hasClass)(A,"selected")&&(U=A.getAttribute("cname"),(0,n.removeClass)(A,"selected"),p.emit("beforeDefinitionChange",A.getAttribute("url")))}),p.dash&&x.forEach(function(A){A.selected=!1,A.name===S.innerHTML&&(A.selected=!0)}),(0,n.addClass)(S,"selected"),R=S.getAttribute("cname"),S.parentNode.nextSibling.innerHTML=""+S.getAttribute("cname"),P.href=S.getAttribute("url"),s=p.paused,p.switchURL){var C=document.createElement("a");["mp4","hls","__flv__","dash"].every(function(A){return p[A]?(p[A].url&&(C.href=p[A].url),A==="__flv__"&&(p[A]._options?C.href=p[A]._options.url:C.href=p[A]._mediaDataSource.url),A==="hls"&&(C.href=p[A].originUrl||p[A].url),!1):!0}),C.href!==P.href&&!p.ended&&p.switchURL(P.href)}else p.hls&&(document.createElement("a"),p.hls.url),P.href!==p.currentSrc&&(p.curTime=p.currentTime,p.ended||(p.src=P.href));navigator.userAgent.toLowerCase().indexOf("android")>-1?p.once("timeupdate",m):p.once("loadedmetadata",y),p.emit("definitionChange",{from:U,to:R}),o.default.device==="mobile"&&(0,n.removeClass)(p.root,"xgplayer-definition-active")}else p.config.definitionActive==="click"&&S&&(S.tagName.toLocaleLowerCase()==="p"||S.tagName.toLocaleLowerCase()==="em")&&(o.default.device==="mobile"?(0,n.toggleClass)(p.root,"xgplayer-definition-active"):(0,n.addClass)(p.root,"xgplayer-definition-active"),l.focus());p.emit("focus")},!1)}),l.addEventListener("mouseleave",function(w){w.preventDefault(),w.stopPropagation(),(0,n.removeClass)(e,"xgplayer-definition-active")});function _(){(0,n.removeClass)(e,"xgplayer-definition-active")}p.on("blur",_);function E(){p.off("resourceReady",d),p.off("canplay",f),navigator.userAgent.toLowerCase().indexOf("android")>-1?(p.off("timeupdate",m),p.off("timeupdate",y)):p.off("loadedmetadata",y),p.off("blur",_),p.off("destroy",E)}p.once("destroy",E),p.getCurrentDefinition=function(){for(var w=p.controls.querySelectorAll(".xgplayer-definition ul li"),k=0;k<w.length;k++)if(w[k].className&&w[k].className.indexOf("selected")>-1)return{name:w[k].getAttribute("cname"),url:w[k].getAttribute("url")};return{name:w[0].getAttribute("cname"),url:w[0].getAttribute("url")}},p.switchDefinition=function(){for(var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},k=p.controls.querySelectorAll(".xgplayer-definition ul li"),x=0;x<k.length;x++)(k[x].getAttribute("cname")===w.name||k[x].getAttribute("url")===w.url||x===w.index)&&k[x].click()}};i.default={name:"s_definition",method:g},t.exports=i.default},function(t,i,r){var n=r(124);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-definition{-webkit-order:5;-moz-box-ordinal-group:6;order:5;width:60px;height:150px;z-index:18;position:relative;outline:none;display:none;cursor:default;margin-left:10px;margin-top:-119px}.xgplayer-skin-default .xgplayer-definition ul{display:none;list-style:none;width:78px;background:rgba(0,0,0,.54);border-radius:1px;position:absolute;bottom:30px;left:0;text-align:center;white-space:nowrap;margin-left:-10px;z-index:26;cursor:pointer}.xgplayer-skin-default .xgplayer-definition ul li{opacity:.7;font-family:PingFangSC-Regular;font-size:11px;color:hsla(0,0%,100%,.8);padding:6px 13px}.xgplayer-skin-default .xgplayer-definition ul li.selected,.xgplayer-skin-default .xgplayer-definition ul li:hover{color:#fff;opacity:1}.xgplayer-skin-default .xgplayer-definition .name{text-align:center;font-family:PingFangSC-Regular;font-size:13px;cursor:pointer;color:hsla(0,0%,100%,.8);position:absolute;bottom:0;width:60px;height:20px;line-height:20px;background:rgba(0,0,0,.38);border-radius:10px;display:inline-block;vertical-align:middle}.xgplayer-skin-default.xgplayer-definition-active .xgplayer-definition ul,.xgplayer-skin-default.xgplayer-is-definition .xgplayer-definition{display:block}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(5),o=c(u);r(126);function c(v){return v&&v.__esModule?v:{default:v}}var g=function(){var p=this,e=[];if(p.config.playbackRate)e=[].concat(p.config.playbackRate),e.sort(function(x,S){return S-x});else return!1;var s=p.config.playbackRateUnit!==void 0?p.config.playbackRateUnit:"x",l=(0,n.createDom)("xg-playbackrate"," ",{},"xgplayer-playbackrate");o.default.device==="mobile"&&(p.config.playbackRateActive="click");var f=[];e.forEach(function(x){f.push({name:""+x,rate:""+x+s,selected:!1})});var d=1,y=["<ul>"];f.forEach(function(x){p.config.defaultPlaybackRate&&p.config.defaultPlaybackRate.toString()===x.name?(x.selected=!0,d=p.config.defaultPlaybackRate,p.once("playing",function(){p.video.playbackRate=p.config.defaultPlaybackRate})):(x.name==="1.0"||x.name==="1")&&(!p.config.defaultPlaybackRate||p.config.defaultPlaybackRate===1)&&(x.selected=!0),y.push("<li cname='"+x.name+"' class='"+(x.selected?"selected":"")+"'>"+x.rate+"</li>")}),y.push("</ul><p class='name'>"+d+s+"</p>");var m=p.root.querySelector(".xgplayer-playbackrate");if(m){m.innerHTML=y.join("");var _=m.querySelector(".name");(!p.config.playbackRateActive||p.config.playbackRateActive==="hover")&&_.addEventListener("mouseenter",function(x){x.preventDefault(),x.stopPropagation(),(0,n.addClass)(p.root,"xgplayer-playbackrate-active"),m.focus()})}else{l.innerHTML=y.join("");var E=l.querySelector(".name");(!p.config.playbackRateActive||p.config.playbackRateActive==="hover")&&E.addEventListener("mouseenter",function(x){x.preventDefault(),x.stopPropagation(),(0,n.addClass)(p.root,"xgplayer-playbackrate-active"),l.focus()}),p.once("ready",function(){p.controls.appendChild(l)})}var w=["touchend","click"];w.forEach(function(x){l.addEventListener(x,function(S){S.stopPropagation(),S.preventDefault();var P=S.target;if(P&&P.tagName.toLocaleLowerCase()==="li"){var U=void 0,R=void 0;f.forEach(function(C){C.selected=!1,P.textContent.replace(/\s+/g,"")===C.rate&&(Array.prototype.forEach.call(P.parentNode.childNodes,function(A){(0,n.hasClass)(A,"selected")&&(U=Number(A.getAttribute("cname")),(0,n.removeClass)(A,"selected"))}),C.selected=!0,p.video.playbackRate=C.name*1,d=C.name*1)}),(0,n.addClass)(P,"selected"),R=Number(P.getAttribute("cname")),P.parentNode.nextSibling.innerHTML=""+P.getAttribute("cname")+s,p.emit("playbackrateChange",{from:U,to:R}),o.default.device==="mobile"&&(0,n.removeClass)(p.root,"xgplayer-playbackrate-active")}else p.config.playbackRateActive==="click"&&P&&(P.tagName.toLocaleLowerCase()==="p"||P.tagName.toLocaleLowerCase()==="span")&&(o.default.device==="mobile"?(0,n.toggleClass)(p.root,"xgplayer-playbackrate-active"):(0,n.addClass)(p.root,"xgplayer-playbackrate-active"),l.focus());p.emit("focus")},!1)}),l.addEventListener("mouseleave",function(x){x.preventDefault(),x.stopPropagation(),(0,n.removeClass)(p.root,"xgplayer-playbackrate-active")});function k(){(0,n.removeClass)(p.root,"xgplayer-playbackrate-active")}p.on("blur",k),p.on("play",function(){p.video.playbackRate.toFixed(1)!==d.toFixed(1)&&(p.video.playbackRate=d)}),p.switchPlaybackRate=function(){for(var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},S=p.controls.querySelectorAll(".xgplayer-playbackrate ul li"),P=0;P<S.length;P++)!(0,n.hasClass)(S[P],"selected")&&(S[P].getAttribute("cname")===""+x.playbackRate||P===x.index)&&S[P].click()},p.on("ratechange",function(){p.switchPlaybackRate({playbackRate:p.playbackRate})})};i.default={name:"s_playbackRate",method:g},t.exports=i.default},function(t,i,r){var n=r(127);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-playbackrate{-webkit-order:8;-moz-box-ordinal-group:9;order:8;width:60px;height:150px;z-index:18;position:relative;display:inline-block;cursor:default;margin-top:-119px}.xgplayer-skin-default .xgplayer-playbackrate ul{display:none;list-style:none;width:78px;background:rgba(0,0,0,.54);border-radius:1px;position:absolute;bottom:30px;left:50%;-webkit-transform:translateX(-50%);-ms-transform:translateX(-50%);transform:translateX(-50%);text-align:left;white-space:nowrap;z-index:26;cursor:pointer}.xgplayer-skin-default .xgplayer-playbackrate ul li{opacity:.7;font-family:PingFangSC-Regular;font-size:11px;color:hsla(0,0%,100%,.8);position:relative;padding:4px 0;text-align:center}.xgplayer-skin-default .xgplayer-playbackrate ul li.selected,.xgplayer-skin-default .xgplayer-playbackrate ul li:hover{color:#fff;opacity:1}.xgplayer-skin-default .xgplayer-playbackrate ul li:first-child{position:relative;margin-top:12px}.xgplayer-skin-default .xgplayer-playbackrate ul li:last-child{position:relative;margin-bottom:12px}.xgplayer-skin-default .xgplayer-playbackrate .name{width:60px;height:20px;position:absolute;bottom:0;text-align:center;font-family:PingFangSC-Regular;font-size:13px;background:rgba(0,0,0,.38);color:hsla(0,0%,100%,.8);border-radius:10px;line-height:20px}.xgplayer-skin-default .xgplayer-playbackrate span{position:relative;top:19px;font-weight:700;text-shadow:0 0 4px rgba(0,0,0,.6)}.xgplayer-skin-default .xgplayer-playbackrate:hover{opacity:1}.xgplayer-skin-default.xgplayer-playbackrate-active .xgplayer-playbackrate ul{display:block}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=function(){var c=this;if(c.config.preview&&c.config.preview.uploadEl){var g=(0,n.createDom)("xg-preview",'<input type="file">',{},"xgplayer-preview"),v=g.querySelector("input");c.config.preview.uploadEl.appendChild(g),v.onchange=function(){c.emit("upload",v)}}};i.default={name:"s_localPreview",method:u},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(130),o=c(u);r(131);function c(v){return v&&v.__esModule?v:{default:v}}var g=function(){var p=this;if(!!p.config.download){var e=(0,n.createDom)("xg-download",'<xg-icon class="xgplayer-icon">'+o.default+"</xg-icon>",{},"xgplayer-download"),s=p.lang.DOWNLOAD_TIPS,l=(0,n.createDom)("xg-tips",'<span class="xgplayer-tip-download">'+s+"</span>",{},"xgplayer-tips");e.appendChild(l),p.once("ready",function(){p.controls.appendChild(e)}),["click","touchend"].forEach(function(f){e.addEventListener(f,function(d){d.preventDefault(),d.stopPropagation(),p.userGestureTrigEvent("downloadBtnClick")})})}};i.default={name:"s_download",method:g},t.exports=i.default},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24">
  <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
    <g transform="translate(-488.000000, -340.000000)" fill="#FFFFFF">
      <g id="Group-2">
        <g id="volme_big-copy" transform="translate(488.000000, 340.000000)">
          <rect id="Rectangle-18" x="11" y="4" width="2" height="12" rx="1"></rect>
          <rect id="Rectangle-2" x="3" y="18" width="18" height="2" rx="1"></rect>
          <rect id="Rectangle-2" transform="translate(4.000000, 17.500000) rotate(90.000000) translate(-4.000000, -17.500000) " x="1.5" y="16.5" width="5" height="2" rx="1"></rect><rect id="Rectangle-2-Copy-3" transform="translate(20.000000, 17.500000) rotate(90.000000) translate(-20.000000, -17.500000) " x="17.5" y="16.5" width="5" height="2" rx="1"></rect>
          <path d="M9.48791171,8.26502656 L9.48791171,14.2650266 C9.48791171,14.8173113 9.04019646,15.2650266 8.48791171,15.2650266 C7.93562696,15.2650266 7.48791171,14.8173113 7.48791171,14.2650266 L7.48791171,7.26502656 C7.48791171,6.71274181 7.93562696,6.26502656 8.48791171,6.26502656 L15.4879117,6.26502656 C16.0401965,6.26502656 16.4879117,6.71274181 16.4879117,7.26502656 C16.4879117,7.81731131 16.0401965,8.26502656 15.4879117,8.26502656 L9.48791171,8.26502656 Z" id="Combined-Shape" transform="translate(11.987912, 10.765027) scale(1, -1) rotate(45.000000) translate(-11.987912, -10.765027) "></path>
        </g>
      </g>
    </g>
  </g>
</svg>
`},function(t,i,r){var n=r(132);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-download{position:relative;-webkit-order:9;-moz-box-ordinal-group:10;order:9;display:block;cursor:pointer}.xgplayer-skin-default .xgplayer-download .xgplayer-icon{margin-top:3px}.xgplayer-skin-default .xgplayer-download .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-download .xgplayer-icon svg{position:relative;top:5px;left:5px}.xgplayer-skin-default .xgplayer-download .xgplayer-tips{margin-left:-20px}.xgplayer-skin-default .xgplayer-download .xgplayer-tips .xgplayer-tip-download{display:block}.xgplayer-skin-default .xgplayer-download:hover{opacity:.85}.xgplayer-skin-default .xgplayer-download:hover .xgplayer-tips{display:block}.xgplayer-lang-is-en .xgplayer-download .xgplayer-tips{margin-left:-32px}.xgplayer-lang-is-jp .xgplayer-download .xgplayer-tips{margin-left:-40px}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(134),o=v(u),c=r(136),g=v(c);r(137);function v(e){return e&&e.__esModule?e:{default:e}}var p=function(){var s=this,l=s.root;if(!!s.config.danmu){var f=(0,n.createDom)("xg-danmu","",{},"xgplayer-danmu");s.once("ready",function(){l.appendChild(f)});var d=(0,n.deepCopy)({container:f,player:s.video,comments:[],area:{start:0,end:1}},s.config.danmu),y=void 0;s.config.danmu.panel&&(y=(0,n.createDom)("xg-panel",`<xg-panel-icon class="xgplayer-panel-icon">
                                                `+g.default+`
                                              </xg-panel-icon>
                                              <xg-panel-slider class="xgplayer-panel-slider">
                                                <xg-hidemode class="xgplayer-hidemode">
                                                  <p class="xgplayer-hidemode-font">\u5C4F\u853D\u7C7B\u578B</p>
                                                  <ul class="xgplayer-hidemode-radio">
                                                    <li class="xgplayer-hidemode-scroll" id="false">\u6EDA\u52A8</li><li class="xgplayer-hidemode-top" id="false">\u9876\u90E8</li><li class="xgplayer-hidemode-bottom" id="false">\u5E95\u90E8</li><li class="xgplayer-hidemode-color" id="false">\u8272\u5F69</li>
                                                  </ul>
                                                </xg-hidemode>
                                                <xg-transparency class="xgplayer-transparency">
                                                  <span>\u4E0D\u900F\u660E\u5EA6</span>
                                                  <input class="xgplayer-transparency-line xgplayer-transparency-color xgplayer-transparency-bar xgplayer-transparency-gradient" type="range" min="0" max="100" step="0.1" value="50"></input>
                                                </xg-transparency>
                                                <xg-showarea class="xgplayer-showarea">
                                                  <div class="xgplayer-showarea-name">\u663E\u793A\u533A\u57DF</div>
                                                  <div class="xgplayer-showarea-control">
                                                    <div class="xgplayer-showarea-control-up">
                                                      <span class="xgplayer-showarea-control-up-item xgplayer-showarea-onequarters">1/4</span>
                                                      <span class="xgplayer-showarea-control-up-item xgplayer-showarea-twoquarters selected-color">1/2</span>
                                                      <span class="xgplayer-showarea-control-up-item xgplayer-showarea-threequarters">3/4</span>
                                                      <span class="xgplayer-showarea-control-up-item xgplayer-showarea-full">1</span>
                                                    </div>
                                                    <div class="xgplayer-showarea-control-down">
                                                      <div class="xgplayer-showarea-control-down-dots">
                                                        <span class="xgplayer-showarea-onequarters-dot"></span>
                                                        <span class="xgplayer-showarea-twoquarters-dot"></span>
                                                        <span class="xgplayer-showarea-threequarters-dot"></span>
                                                        <span class="xgplayer-showarea-full-dot"></span>
                                                      </div>
                                                      <input class="xgplayer-showarea-line xgplayer-showarea-color xgplayer-showarea-bar xgplayer-gradient" type="range" min="1" max="4" step="1" value="1">
                                                    </div>
                                                  </div>
                                                </xg-showarea>
                                                <xg-danmuspeed class="xgplayer-danmuspeed">
                                                  <div class="xgplayer-danmuspeed-name">\u5F39\u5E55\u901F\u5EA6</div>
                                                  <div class="xgplayer-danmuspeed-control">
                                                    <div class="xgplayer-danmuspeed-control-up">
                                                      <span class="xgplayer-danmuspeed-control-up-item xgplayer-danmuspeed-small">\u6162</span>
                                                      <span class="xgplayer-danmuspeed-control-up-item xgplayer-danmuspeed-middle selected-color">\u4E2D</span>
                                                      <span class="xgplayer-danmuspeed-control-up-item xgplayer-danmuspeed-large">\u5FEB</span>
                                                    </div>
                                                    <div class="xgplayer-danmuspeed-control-down">
                                                      <div class="xgplayer-danmuspeed-control-down-dots">
                                                        <span class="xgplayer-danmuspeed-small-dot"></span>
                                                        <span class="xgplayer-danmuspeed-middle-dot"></span>
                                                        <span class="xgplayer-danmuspeed-large-dot"></span>
                                                      </div>
                                                      <input class="xgplayer-danmuspeed-line xgplayer-danmuspeed-color xgplayer-danmuspeed-bar xgplayer-gradient" type="range" min="50" max="150" step="50" value="100">
                                                    </div>
                                                  </div>
                                                </xg-danmuspeed>
                                                <xg-danmufont class="xgplayer-danmufont">
                                                  <div class="xgplayer-danmufont-name">\u5B57\u4F53\u5927\u5C0F</div>
                                                  <div class="xgplayer-danmufont-control">
                                                    <div class="xgplayer-danmufont-control-up">
                                                      <span class="xgplayer-danmufont-control-up-item xgplayer-danmufont-small">\u5C0F</span>
                                                      <span class="xgplayer-danmufont-control-up-item xgplayer-danmufont-middle">\u4E2D</span>
                                                      <span class="xgplayer-danmufont-control-up-item xgplayer-danmufont-large selected-color">\u5927</span>
                                                    </div>
                                                    <div class="xgplayer-danmufont-control-down">
                                                      <div class="xgplayer-danmufont-control-down-dots">
                                                        <span class="xgplayer-danmufont-small-dot"></span>
                                                        <span class="xgplayer-danmufont-middle-dot"></span>
                                                        <span class="xgplayer-danmufont-large-dot"></span>
                                                      </div>
                                                      <input class="xgplayer-danmufont-line xgplayer-danmufont-color xgplayer-danmufont-bar xgplayer-gradient" type="range" min="20" max="30" step="5" value="25">
                                                    </div>
                                                  </div>
                                                </xg-danmufont>
                                              </xg-panel-slider>`,{tabindex:7},"xgplayer-panel"),s.once("ready",function(){s.controls.appendChild(y)})),s.once("complete",function(){var m=new o.default(d);if(s.emit("initDefaultDanmu",m),s.danmu=m,!!s.config.danmu.panel){var _=y.querySelector(".xgplayer-panel-slider"),E=void 0,w=["mouseenter","touchend","click"];w.forEach(function(z){y.addEventListener(z,function($){$.preventDefault(),$.stopPropagation(),(0,n.addClass)(_,"xgplayer-panel-active"),y.focus(),E=!0})}),y.addEventListener("mouseleave",function(z){z.preventDefault(),z.stopPropagation(),(0,n.removeClass)(_,"xgplayer-panel-active"),E=!1}),_.addEventListener("mouseleave",function(z){z.preventDefault(),z.stopPropagation(),E===!1&&(0,n.removeClass)(_,"xgplayer-panel-active")});var k=s.config.danmu,x=y.querySelector(".xgplayer-hidemode-scroll"),S=y.querySelector(".xgplayer-hidemode-top"),P=y.querySelector(".xgplayer-hidemode-bottom"),U=y.querySelector(".xgplayer-hidemode-color"),R={scroll:x,top:S,bottom:P,color:U},C=function($){var J=$,Q=["touchend","click"];Q.forEach(function(ne){R[J].addEventListener(ne,function(Ee){R[J].getAttribute("id")!=="true"?(R[J].style.color="#f85959",R[J].setAttribute("id","true"),s.danmu.hide(J)):(R[J].style.color="#aaa",R[J].setAttribute("id","false"),s.danmu.show(J))})})};for(var A in R)C(A);var b=y.querySelector(".xgplayer-transparency-line"),O=y.querySelector(".xgplayer-transparency-gradient"),W=50;O.style.background="linear-gradient(to right, #f85959 0%, #f85959 "+W+"%, #aaa "+W+"%, #aaa)",b.addEventListener("input",function(z){z.preventDefault(),z.stopPropagation(),W=z.target.value,O.style.background="linear-gradient(to right, #f85959 0%, #f85959 "+W+"%, #aaa "+W+"%, #aaa)",k.comments.forEach(function($){$.style.opacity=W/100})});var K=y.querySelector(".xgplayer-showarea-line");K.addEventListener("input",function(z){z.preventDefault(),z.stopPropagation();var $=z.target.value;s.danmu.config.area.end=$/100,s.config.danmu.area.end=$/100,s.danmu.bulletBtn.main.channel.resize()});var G=y.querySelector(".xgplayer-danmuspeed-line");G.addEventListener("input",function(z){z.preventDefault(),z.stopPropagation();var $=z.target.value;k.comments.forEach(function(J){J.duration=(200-$)*100})});var B=y.querySelector(".xgplayer-danmufont-line");if(B.addEventListener("input",function(z){z.preventDefault(),z.stopPropagation();var $=z.target.value;k.comments.forEach(function(J){J.style.fontSize=$+"px"})}),navigator.userAgent.indexOf("Firefox")>-1)for(var j=0;j<_.querySelectorAll("input").length;j++)_.querySelectorAll("input")[j].style.marginTop="10px"}})}};i.default={name:"s_danmu",method:p},t.exports=i.default},function(t,i,r){(function(n){var u,o,c,g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v};/*! Built @Mon, 17 Oct 2022 06:40:43 GMT */(function(v,p){g(i)=="object"&&g(n)=="object"?n.exports=p():(o=[],u=p,c=typeof u=="function"?u.apply(i,o):u,c!==void 0&&(n.exports=c))})(window,function(){return function(v){var p={};function e(s){if(p[s])return p[s].exports;var l=p[s]={i:s,l:!1,exports:{}};return v[s].call(l.exports,l,l.exports,e),l.l=!0,l.exports}return e.m=v,e.c=p,e.d=function(s,l,f){e.o(s,l)||Object.defineProperty(s,l,{enumerable:!0,get:f})},e.r=function(s){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},e.t=function(s,l){if(1&l&&(s=e(s)),8&l||4&l&&(typeof s=="undefined"?"undefined":g(s))=="object"&&s&&s.__esModule)return s;var f=Object.create(null);if(e.r(f),Object.defineProperty(f,"default",{enumerable:!0,value:s}),2&l&&typeof s!="string")for(var d in s)e.d(f,d,function(y){return s[y]}.bind(null,d));return f},e.n=function(s){var l=s&&s.__esModule?function(){return s.default}:function(){return s};return e.d(l,"a",l),l},e.o=function(s,l){return Object.prototype.hasOwnProperty.call(s,l)},e.p="",e(e.s=4)}([function(v,p,e){function s(y,m){return y.classList?Array.prototype.some.call(y.classList,function(_){return _===m}):!!y.className.match(new RegExp("(\\s|^)"+m+"(\\s|$)"))}function l(y,m){y.classList?m.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(_){_&&y.classList.add(_)}):s(y,m)||(y.className+=" "+m)}function f(y,m){y.classList?m.split(/\s+/g).forEach(function(_){y.classList.remove(_)}):s(y,m)&&m.split(/\s+/g).forEach(function(_){var E=new RegExp("(\\s|^)"+_+"(\\s|$)");y.className=y.className.replace(E," ")})}function d(y){return Object.prototype.toString.call(y).match(/([^\s.*]+)(?=]$)/g)[0]}Object.defineProperty(p,"__esModule",{value:!0}),p.createDom=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"div",m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",w=document.createElement(y);return w.className=E,w.innerHTML=m,Object.keys(_).forEach(function(k){var x=k,S=_[k];y==="video"||y==="audio"?S&&w.setAttribute(x,S):w.setAttribute(x,S)}),w},p.hasClass=s,p.addClass=l,p.removeClass=f,p.toggleClass=function(y,m){m.split(/\s+/g).forEach(function(_){s(y,_)?f(y,_):l(y,_)})},p.findDom=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,m=arguments[1],_=void 0;try{_=y.querySelector(m)}catch(E){m.startsWith("#")&&(_=y.getElementById(m.slice(1)))}return _},p.deepCopy=function y(m,_){if(d(_)==="Object"&&d(m)==="Object")return Object.keys(_).forEach(function(E){d(_[E])!=="Object"||_[E]instanceof Node?d(_[E])==="Array"?m[E]=d(m[E])==="Array"?m[E].concat(_[E]):_[E]:m[E]=_[E]:m[E]?y(m[E],_[E]):m[E]=_[E]}),m},p.typeOf=d,p.copyDom=function(y){if(y&&y.nodeType===1){var m=document.createElement(y.tagName);return Array.prototype.forEach.call(y.attributes,function(_){m.setAttribute(_.name,_.value)}),y.innerHTML&&(m.innerHTML=y.innerHTML),m}return""},p.attachEventListener=function(y,m,_,E){E?(y.on(m,_),function(w,k,x,S){w.once(S,function P(){w.off(k,x),w.off(S,P)})}(y,m,_,E)):y.on(m,function w(k){_(k),y.off(m,w)})},p.styleUtil=function(y,m,_){var E=y.style;try{E[m]=_}catch(w){E.setProperty(m,_)}},p.isNumber=function(y){return typeof y=="number"&&!Number.isNaN(y)},p.throttle=function(y,m){var _=this,E=0;return function(){for(var w=arguments.length,k=Array(w),x=0;x<w;x++)k[x]=arguments[x];clearTimeout(E),E=setTimeout(function(){return y.apply(_,k)},m)}},p.hasOwnProperty=Object.prototype.hasOwnProperty},function(v,p,e){Object.defineProperty(p,"__esModule",{value:!0});var s,l=function(){function m(_,E){for(var w=0;w<E.length;w++){var k=E[w];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(_,k.key,k)}}return function(_,E,w){return E&&m(_.prototype,E),w&&m(_,w),_}}(),f=e(26),d=(s=f)&&s.__esModule?s:{default:s},y=function(){function m(){(function(_,E){if(!(_ instanceof E))throw new TypeError("Cannot call a class as a function")})(this,m)}return l(m,[{key:"setLogger",value:function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";this.logger=new d.default(E+".js")}}]),m}();p.default=y,v.exports=p.default},function(v,p,e){var s=e(18)();v.exports=function(l){return l!==s&&l!==null}},function(v,p,e){v.exports=function(s){return s!=null}},function(v,p,e){Object.defineProperty(p,"__esModule",{value:!0});var s,l=e(5),f=(s=l)&&s.__esModule?s:{default:s};e(34),p.default=f.default,v.exports=p.default},function(v,p,e){Object.defineProperty(p,"__esModule",{value:!0}),p.DanmuJs=void 0;var s=function(){function S(P,U){for(var R=0;R<U.length;R++){var C=U[R];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(P,C.key,C)}}return function(P,U,R){return U&&S(P.prototype,U),R&&S(P,R),P}}(),l=w(e(6)),f=e(25),d=w(e(1)),y=w(e(27)),m=w(e(32)),_=e(33),E=e(0);function w(S){return S&&S.__esModule?S:{default:S}}function k(S,P){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!P||(typeof P=="undefined"?"undefined":g(P))!="object"&&typeof P!="function"?S:P}var x=p.DanmuJs=function(S){function P(U){(function(O,W){if(!(O instanceof W))throw new TypeError("Cannot call a class as a function")})(this,P);var R=k(this,(P.__proto__||Object.getPrototypeOf(P)).call(this)),C=R;C.setLogger("danmu"),C.logger&&C.logger.info("danmu.js version: "+f.version);var A=C.config={overlap:!1,area:{start:0,end:1,lines:void 0},live:!1,comments:[],direction:"r2l",needResizeObserver:!1,dropStaleComments:!1,channelSize:void 0,maxCommentsLength:void 0,bulletOffset:void 0,interval:2e3};if((0,E.deepCopy)(A,U),(0,l.default)(C),C.hideArr=[],C.domObj=new m.default,C.freezeId=null,A.comments.forEach(function(O){O.duration=O.duration?O.duration:5e3,O.mode||(O.mode="scroll")}),C.container=A.container&&A.container.nodeType===1?A.container:null,!C.container)return C.emit("error","container id can't be empty"),k(R,!1);if(A.containerStyle){var b=A.containerStyle;Object.keys(b).forEach(function(O){C.container.style[O]=b[O]})}return C.live=A.live,C.player=A.player,C.direction=A.direction,(0,E.addClass)(C.container,"danmu"),C.bulletBtn=new y.default(C),C.main=C.bulletBtn.main,C.isReady=!0,C.emit("ready"),R.logger&&R.logger.info("ready"),R.addResizeObserver(),R}return function(U,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof R=="undefined"?"undefined":g(R)));U.prototype=Object.create(R&&R.prototype,{constructor:{value:U,enumerable:!1,writable:!0,configurable:!0}}),R&&(Object.setPrototypeOf?Object.setPrototypeOf(U,R):U.__proto__=R)}(P,S),s(P,[{key:"addResizeObserver",value:function(){var R=this;this.config.needResizeObserver&&(0,_.addObserver)(this.container,function(){R.logger&&R.logger.info("needResizeObserver"),R.resize()})}},{key:"start",value:function(){this.logger&&this.logger.info("start"),this.main.start()}},{key:"pause",value:function(){this.logger&&this.logger.info("pause"),this.main.pause()}},{key:"play",value:function(){this.logger&&this.logger.info("play"),this.main.play()}},{key:"stop",value:function(){this.logger&&this.logger.info("stop"),this.main.stop()}},{key:"clear",value:function(){this.logger&&this.logger.info("clear"),this.main.clear()}},{key:"destroy",value:function(){for(var R in(0,_.unObserver)(this.container),this.logger&&this.logger.info("destroy"),this.stop(),this.bulletBtn.destroy(),this.domObj.destroy(),this)delete this[R];this.emit("destroy")}},{key:"sendComment",value:function(R){this.logger&&this.logger.info("sendComment: "+(R.txt||"[DOM Element]")),R.duration||(R.duration=15e3),R&&R.id&&R.duration&&(R.el||R.txt)&&(R.duration=R.duration?R.duration:5e3,R.style||(R.style={opacity:void 0,fontSize:void 0}),R.style&&(this.opacity&&this.opacity!==R.style.opacity&&(R.style.opacity=this.opacity),this.fontSize&&this.fontSize!==R.style.fontSize&&(R.style.fontSize=this.fontSize)),R.prior||R.realTime?(this.main.data.unshift(R),R.realTime&&(this.main.readData(),this.main.dataHandle())):this.main.data.push(R))}},{key:"setCommentID",value:function(R,C){var A=this;this.logger&&this.logger.info("setCommentID: oldID "+R+" newID "+C),R&&C&&(this.main.data.some(function(b){return b.id===R&&(b.id=C,!0)}),this.main.queue.some(function(b){return b.id===R&&(b.id=C,b.pauseMove(),A.main.status!=="paused"&&b.startMove(),!0)}))}},{key:"setCommentDuration",value:function(R,C){var A=this;this.logger&&this.logger.info("setCommentDuration: id "+R+" duration "+C),R&&C&&(C=C||5e3,this.main.data.some(function(b){return b.id===R&&(b.duration=C,!0)}),this.main.queue.some(function(b){return b.id===R&&(b.duration=C,b.pauseMove(),A.main.status!=="paused"&&b.startMove(),!0)}))}},{key:"setCommentLike",value:function(R,C){this.logger&&this.logger.info("setCommentLike: id "+R+" like "+C),R&&C&&(this.main.data.some(function(A){return A.id===R&&(A.like=C,!0)}),this.main.queue.some(function(A){return A.id===R&&(A.pauseMove(),A.setLikeDom(C.el,C.style),A.danmu.main.status!=="paused"&&A.startMove(),!0)}))}},{key:"restartComment",value:function(R){if(this.logger&&this.logger.info("restartComment: id "+R),R){var C=this.main;if(this._releaseCtrl(R),C.status==="closed")return;C.queue.some(function(A){return A.id===R&&(C.status!=="paused"?A.startMove(!0):A.status="paused",!0)})}}},{key:"_releaseCtrl",value:function(R){this.freezeId&&R===this.freezeId&&(this.mouseControl=!1,this.freezeId=null)}},{key:"_freezeCtrl",value:function(R){this.mouseControl=!0,this.freezeId=R}},{key:"freezeComment",value:function(R){this.logger&&this.logger.info("freezeComment: id "+R),R&&(this._freezeCtrl(R),this.main.queue.some(function(C){return C.id===R&&(C.status="forcedPause",C.pauseMove(),C.el&&C.el.style&&(0,E.styleUtil)(C.el,"zIndex",10),!0)}))}},{key:"removeComment",value:function(R){this.logger&&this.logger.info("removeComment: id "+R),R&&(this._releaseCtrl(R),this.main.queue.some(function(C){return C.id===R&&(C.remove(),!0)}),this.main.data=this.main.data.filter(function(C){return C.id!==R}))}},{key:"updateComments",value:function(R){var C=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],A=this.config,b=this.main,O=this.player,W=[],K=0;if(this.logger&&this.logger.info("updateComments: "+R.length+", isClear "+C),typeof C=="boolean"&&C&&(b.data=[]),b.data=b.data.concat(R),b.sortData(),typeof A.maxCommentsLength=="number"&&b.data.length>A.maxCommentsLength){K=b.data.length-A.maxCommentsLength;for(var G,B=0;B<K;B++)(G=b.data[B]).prior&&!G.attached_&&W.push(b.data[B])}else if(A.dropStaleComments&&O&&O.currentTime){var j=Math.floor(1e3*O.currentTime),z=j-A.interval;if(z>0){for(var $,J=0;J<b.data.length;J++)if(($=b.data[J]).prior&&!$.attached_&&W.push(b.data[J]),$.start>z){K=J;break}}K>0&&(b.data.splice(0,K),b.data=W.concat(b.data))}}},{key:"willChange",value:function(){var R=this.container,C=this.main;R.style.willChange="opacity",C.willChanges.push("contents"),C.queue.forEach(function(A){A.willChange()})}},{key:"stopWillChange",value:function(){this.container.style.willChange="",this.main.willChanges.splice(0),this.main.queue.forEach(function(R){R.willChange()})}},{key:"setAllDuration",value:function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"scroll",C=this,A=arguments[1],b=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];this.logger&&this.logger.info("setAllDuration: mode "+R+" duration "+A+" force "+b),A&&(A=A||5e3,b&&(this.main.forceDuration=A),this.main.data.forEach(function(O){R===O.mode&&(O.duration=A)}),this.main.queue.forEach(function(O){R===O.mode&&(O.duration=A,O.pauseMove(),C.main.status!=="paused"&&O.startMove())}))}},{key:"setPlayRate",value:function(){var R=this,C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"scroll",A=arguments[1];this.logger&&this.logger.info("setPlayRate: "+A),(0,E.isNumber)(A)&&A>0&&(this.main.playRate=A,this.main.queue.forEach(function(b){C===b.mode&&(b.pauseMove(),R.main.status!=="paused"&&b.startMove())}))}},{key:"setOpacity",value:function(R){this.logger&&this.logger.info("setOpacity: opacity "+R),this.container.style.opacity=R}},{key:"setFontSize",value:function(R,C){var A=this,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{reflow:!0};this.logger&&this.logger.info("setFontSize: size "+R+" channelSize "+C),this.fontSize=R+"px",R&&(this.main.data.forEach(function(O){O.style&&(O.style.fontSize=A.fontSize)}),this.main.queue.forEach(function(O){O.options.style||(O.options.style={}),O.options.style.fontSize=A.fontSize,O.setFontSize(A.fontSize),C&&(O.top=O.channel_id[0]*C,O.topInit())})),C&&(this.config.channelSize=C,b.reflow&&this.main.channel.resizeSync())}},{key:"setArea",value:function(R){this.logger&&this.logger.info("setArea: area "+R),this.config.area=R,R.reflow!==!1&&this.main.channel.resizeSync()}},{key:"hide",value:function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"scroll";this.logger&&this.logger.info("hide: mode "+R),this.hideArr.indexOf(R)<0&&this.hideArr.push(R);var C=this.main.queue.filter(function(A){return R===A.mode||R==="color"&&A.color});C.forEach(function(A){return A.remove()})}},{key:"show",value:function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"scroll";this.logger&&this.logger.info("show: mode "+R);var C=this.hideArr.indexOf(R);C>-1&&this.hideArr.splice(C,1)}},{key:"setDirection",value:function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"r2l";this.logger&&this.logger.info("setDirection: direction "+R),this.emit("changeDirection",R)}},{key:"resize",value:function(){this.logger&&this.logger.info("resize"),this.emit("channel_resize")}},{key:"status",get:function(){return this.main.status}},{key:"state",get:function(){var R=this.main;return{status:R.status,comments:R.data,bullets:R.queue}}},{key:"containerPos",get:function(){return this.main.channel.containerPos}}]),P}(d.default);p.default=x},function(v,p,e){var s,l,f,d,y,m,_,E=e(7),w=e(24),k=Function.prototype.apply,x=Function.prototype.call,S=Object.create,P=Object.defineProperty,U=Object.defineProperties,R=Object.prototype.hasOwnProperty,C={configurable:!0,enumerable:!1,writable:!0};l=function(b,O){var W,K;return w(O),K=this,s.call(this,b,W=function(){f.call(K,b,W),k.call(O,this,arguments)}),W.__eeOnceListener__=O,this},y={on:s=function(b,O){var W;return w(O),R.call(this,"__ee__")?W=this.__ee__:(W=C.value=S(null),P(this,"__ee__",C),C.value=null),W[b]?g(W[b])=="object"?W[b].push(O):W[b]=[W[b],O]:W[b]=O,this},once:l,off:f=function(b,O){var W,K,G,B;if(w(O),!R.call(this,"__ee__"))return this;if(!(W=this.__ee__)[b])return this;if(g(K=W[b])=="object")for(B=0;G=K[B];++B)G!==O&&G.__eeOnceListener__!==O||(K.length===2?W[b]=K[B?0:1]:K.splice(B,1));else K!==O&&K.__eeOnceListener__!==O||delete W[b];return this},emit:d=function(b){var O,W,K,G,B;if(R.call(this,"__ee__")&&(G=this.__ee__[b]))if((typeof G=="undefined"?"undefined":g(G))=="object"){for(W=arguments.length,B=new Array(W-1),O=1;O<W;++O)B[O-1]=arguments[O];for(G=G.slice(),O=0;K=G[O];++O)k.call(K,this,B)}else switch(arguments.length){case 1:x.call(G,this);break;case 2:x.call(G,this,arguments[1]);break;case 3:x.call(G,this,arguments[1],arguments[2]);break;default:for(W=arguments.length,B=new Array(W-1),O=1;O<W;++O)B[O-1]=arguments[O];k.call(G,this,B)}}},m={on:E(s),once:E(l),off:E(f),emit:E(d)},_=U({},m),v.exports=p=function(b){return b==null?S(_):U(Object(b),m)},p.methods=y},function(v,p,e){var s=e(3),l=e(8),f=e(12),d=e(20),y=e(21);(v.exports=function(m,_){var E,w,k,x,S;return arguments.length<2||typeof m!="string"?(x=_,_=m,m=null):x=arguments[2],s(m)?(E=y.call(m,"c"),w=y.call(m,"e"),k=y.call(m,"w")):(E=k=!0,w=!1),S={value:_,configurable:E,enumerable:w,writable:k},x?f(d(x),S):S}).gs=function(m,_,E){var w,k,x,S;return typeof m!="string"?(x=E,E=_,_=m,m=null):x=arguments[3],s(_)?l(_)?s(E)?l(E)||(x=E,E=void 0):E=void 0:(x=_,_=E=void 0):_=void 0,s(m)?(w=y.call(m,"c"),k=y.call(m,"e")):(w=!0,k=!1),S={get:_,set:E,configurable:w,enumerable:k},x?f(d(x),S):S}},function(v,p,e){var s=e(9),l=/^\s*class[\s{/}]/,f=Function.prototype.toString;v.exports=function(d){return!!s(d)&&!l.test(f.call(d))}},function(v,p,e){var s=e(10);v.exports=function(l){if(typeof l!="function"||!hasOwnProperty.call(l,"length"))return!1;try{if(typeof l.length!="number"||typeof l.call!="function"||typeof l.apply!="function")return!1}catch(f){return!1}return!s(l)}},function(v,p,e){var s=e(11);v.exports=function(l){if(!s(l))return!1;try{return!!l.constructor&&l.constructor.prototype===l}catch(f){return!1}}},function(v,p,e){var s=e(3),l={object:!0,function:!0,undefined:!0};v.exports=function(f){return!!s(f)&&hasOwnProperty.call(l,typeof f=="undefined"?"undefined":g(f))}},function(v,p,e){v.exports=e(13)()?Object.assign:e(14)},function(v,p,e){v.exports=function(){var s,l=Object.assign;return typeof l=="function"&&(l(s={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),s.foo+s.bar+s.trzy==="razdwatrzy")}},function(v,p,e){var s=e(15),l=e(19),f=Math.max;v.exports=function(d,y){var m,_,E,w=f(arguments.length,2);for(d=Object(l(d)),E=function(x){try{d[x]=y[x]}catch(S){m||(m=S)}},_=1;_<w;++_)s(y=arguments[_]).forEach(E);if(m!==void 0)throw m;return d}},function(v,p,e){v.exports=e(16)()?Object.keys:e(17)},function(v,p,e){v.exports=function(){try{return Object.keys("primitive"),!0}catch(s){return!1}}},function(v,p,e){var s=e(2),l=Object.keys;v.exports=function(f){return l(s(f)?Object(f):f)}},function(v,p,e){v.exports=function(){}},function(v,p,e){var s=e(2);v.exports=function(l){if(!s(l))throw new TypeError("Cannot use null or undefined");return l}},function(v,p,e){var s=e(2),l=Array.prototype.forEach,f=Object.create,d=function(m,_){var E;for(E in m)_[E]=m[E]};v.exports=function(y){var m=f(null);return l.call(arguments,function(_){s(_)&&d(Object(_),m)}),m}},function(v,p,e){v.exports=e(22)()?String.prototype.contains:e(23)},function(v,p,e){var s="razdwatrzy";v.exports=function(){return typeof s.contains=="function"&&s.contains("dwa")===!0&&s.contains("foo")===!1}},function(v,p,e){var s=String.prototype.indexOf;v.exports=function(l){return s.call(this,l,arguments[1])>-1}},function(v,p,e){v.exports=function(s){if(typeof s!="function")throw new TypeError(s+" is not a function");return s}},function(v){v.exports=JSON.parse('{"version":"1.1.2"}')},function(v,p,e){Object.defineProperty(p,"__esModule",{value:!0});var s=function(){function d(y,m){for(var _=0;_<m.length;_++){var E=m[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(y,E.key,E)}}return function(y,m,_){return m&&d(y.prototype,m),_&&d(y,_),y}}(),l=typeof window!="undefined"&&window.location.href.indexOf("danmu-debug")>-1,f=function(){function d(y){(function(m,_){if(!(m instanceof _))throw new TypeError("Cannot call a class as a function")})(this,d),this.constructorName=y||""}return s(d,[{key:"info",value:function(m){for(var _,E=arguments.length,w=Array(E>1?E-1:0),k=1;k<E;k++)w[k-1]=arguments[k];l&&(_=console).log.apply(_,["[Danmu Log]["+this.constructorName+"]",m].concat(w))}}]),d}();p.default=f,v.exports=p.default},function(v,p,e){Object.defineProperty(p,"__esModule",{value:!0});var s=function(){function _(E,w){for(var k=0;k<w.length;k++){var x=w[k];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(E,x.key,x)}}return function(E,w,k){return w&&_(E.prototype,w),k&&_(E,k),E}}(),l=y(e(1)),f=y(e(28)),d=e(0);function y(_){return _&&_.__esModule?_:{default:_}}var m=function(_){function E(w){(function(x,S){if(!(x instanceof S))throw new TypeError("Cannot call a class as a function")})(this,E);var k=function(x,S){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!S||(typeof S=="undefined"?"undefined":g(S))!="object"&&typeof S!="function"?x:S}(this,(E.__proto__||Object.getPrototypeOf(E)).call(this));return k.setLogger("control"),k.danmu=w,k.main=new f.default(w),w.config.defaultOff||k.main.start(),k}return function(w,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof k=="undefined"?"undefined":g(k)));w.prototype=Object.create(k&&k.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),k&&(Object.setPrototypeOf?Object.setPrototypeOf(w,k):w.__proto__=k)}(E,_),s(E,[{key:"createSwitch",value:function(){var k=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return this.logger&&this.logger.info("createSwitch"),this.switchBtn=(0,d.createDom)("dk-switch",'<span class="txt">\u5F39</span>',{},"danmu-switch "+(k?"danmu-switch-active":"")),this.switchBtn}},{key:"destroy",value:function(){for(var k in this.logger&&this.logger.info("destroy"),this.main.destroy(),this)d.hasOwnProperty.call(this,k)&&delete this[k]}}]),E}(l.default);p.default=m,v.exports=p.default},function(v,p,e){Object.defineProperty(p,"__esModule",{value:!0});var s=function(){function E(w,k){for(var x=0;x<k.length;x++){var S=k[x];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(w,S.key,S)}}return function(w,k,x){return k&&E(w.prototype,k),x&&E(w,x),w}}(),l=m(e(1)),f=m(e(29)),d=m(e(30)),y=e(0);function m(E){return E&&E.__esModule?E:{default:E}}var _=function(E){function w(k){(function(S,P){if(!(S instanceof P))throw new TypeError("Cannot call a class as a function")})(this,w);var x=function(S,P){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!P||(typeof P=="undefined"?"undefined":g(P))!="object"&&typeof P!="function"?S:P}(this,(w.__proto__||Object.getPrototypeOf(w)).call(this));return x.setLogger("main"),x.danmu=k,x.container=k.container,x.channel=new d.default(k),x.data=[].concat(k.config.comments),x.playedData=[],x.queue=[],x.timer=null,x.playRate=1,x.retryStatus="normal",x.interval=k.config.interval,x.willChanges=[],x._status="idle",(0,y.attachEventListener)(k,"bullet_remove",x.updateQueue.bind(x),"destroy"),(0,y.attachEventListener)(k,"changeDirection",function(S){x.danmu.direction=S},"destroy"),x}return function(k,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof x=="undefined"?"undefined":g(x)));k.prototype=Object.create(x&&x.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(k,x):k.__proto__=x)}(w,E),s(w,[{key:"_cancelDataHandleTimer",value:function(){this.handleId&&(clearTimeout(this.handleId),this.handleId=null),this.handleTimer&&(clearTimeout(this.handleTimer),this.handleTimer=null)}},{key:"destroy",value:function(){for(var x in this.logger&&this.logger.info("destroy"),this._cancelDataHandleTimer(),this.channel.destroy(),this.data=[],this)delete this[x]}},{key:"updateQueue",value:function(x){this.logger&&this.logger.info("updateQueue");var S=this;S.queue.some(function(P,U){return P.id===x.bullet.id&&(S.queue.splice(U,1),!0)}),S.data.some(function(P){return P.id===x.bullet.id&&(P.attached_=!1,!0)})}},{key:"init",value:function(){var x=this;x.logger&&x.logger.info("init"),x.retryStatus="normal",x.sortData(),function S(){x._status!=="closed"||x.retryStatus!=="stop"?(x._status==="playing"&&(x.readData(),x.dataHandle()),x.retryStatus==="stop"&&x._status!=="paused"||(x.handleTimer=setTimeout(function(){x.handleId=requestAnimationFrame(function(){S()})},250))):x._cancelDataHandleTimer()}()}},{key:"start",value:function(){this.logger&&this.logger.info("start"),this._status="playing",this.queue=[],this.container.innerHTML="",this.channel.reset(),this.init()}},{key:"stop",value:function(){this.logger&&this.logger.info("stop"),this._status="closed",this.retryStatus="stop",this.queue=[],this.container.innerHTML="",this.channel.reset()}},{key:"clear",value:function(){this.logger&&this.logger.info("clear"),this.channel.reset(),this.data=[],this.queue=[],this.container.innerHTML=""}},{key:"play",value:function(){var x=this;if(this._status!=="closed"){this.logger&&this.logger.info("play"),this._status="playing";var S=this.channel.channels;S&&S.length>0&&["scroll","top","bottom"].forEach(function(P){x.queue.forEach(function(R){R.startMove(),R.resized=!0});for(var U=0;U<S.length;U++)S[U].queue[P].forEach(function(R){R.resized=!1})})}else this.logger&&this.logger.info("play ignored")}},{key:"pause",value:function(){if(this._status!=="closed"){this.logger&&this.logger.info("pause"),this._status="paused";var x=this.channel.channels;x&&x.length>0&&this.queue.forEach(function(S){S.pauseMove()})}else this.logger&&this.logger.info("pause ignored")}},{key:"dataHandle",value:function(){this._status!=="paused"&&this._status!=="closed"&&this.queue.length&&this.queue.forEach(function(x){x.status==="waiting"&&x.startMove()})}},{key:"readData",value:function(){if(this.danmu.isReady){var x=this,S=this.danmu,P=S.player,U=x.interval,R=x.channel,C=void 0,A=void 0;if(P){var b=P.currentTime?Math.floor(1e3*P.currentTime):0;A=x.data.filter(function(B){return!B.start&&x.danmu.hideArr.indexOf(B.mode)<0&&(!B.color||x.danmu.hideArr.indexOf("color")<0)&&(B.start=b),!B.attached_&&x.danmu.hideArr.indexOf(B.mode)<0&&(!B.color||x.danmu.hideArr.indexOf("color")<0)&&B.start-U<=b&&b<=B.start+U}),S.live&&(x.data=[])}else(A=x.data.splice(0,1)).length===0&&(A=x.playedData.splice(0,1));if(A.length>0){R.updatePos();var O=2;e:for(var W,K=0;K<A.length;K++)if(W=A[K],x.forceDuration&&x.forceDuration!==W.duration&&(W.duration=x.forceDuration),(C=new f.default(S,W))&&!C.bulletCreateFail)if(C.attach(),W.attached_=!0,R.addBullet(C).result)x.queue.push(C),C.topInit(),O=2;else{for(var G in C.detach(),C)y.hasOwnProperty.call(C,G)&&delete C[G];if(C=null,W.attached_=!1,W.noDiscard&&(W.prior?x.data.unshift(W):x.data.push(W)),O===0)break e;O--}else{if(O===0)break e;O--}}}}},{key:"sortData",value:function(){this.data.sort(function(x,S){return(x.start||-1)-(S.start||-1)})}},{key:"status",get:function(){return this._status}}]),w}(l.default);p.default=_,v.exports=p.default},function(v,p,e){Object.defineProperty(p,"__esModule",{value:!0}),p.Bullet=void 0;var s,l=function(){function E(w,k){for(var x=0;x<k.length;x++){var S=k[x];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(w,S.key,S)}}return function(w,k,x){return k&&E(w.prototype,k),x&&E(w,x),w}}(),f=e(1),d=(s=f)&&s.__esModule?s:{default:s},y=e(0);function m(E,w){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!w||(typeof w=="undefined"?"undefined":g(w))!="object"&&typeof w!="function"?E:w}var _=p.Bullet=function(E){function w(k,x){(function(W,K){if(!(W instanceof K))throw new TypeError("Cannot call a class as a function")})(this,w);var S=m(this,(w.__proto__||Object.getPrototypeOf(w)).call(this)),P=S,U=void 0;if(S.setLogger("bullet"),S.danmu=k,S.options=x,S.duration=x.duration,S.id=x.id,S.container=k.container,S.start=x.start,S.prior=x.prior,S.realTime=x.realTime,S.color=x.color,S.bookChannelId=x.bookChannelId,S.direction=k.direction,S.reuseDOM=!0,S.willChanges=[],S.domObj=k.domObj,x.el&&x.el.nodeType===1){if(x.el.parentNode)return m(S,{bulletCreateFail:!0});if(k.config.disableCopyDOM)U=x.el,S.reuseDOM=!1;else{U=S.domObj.use();var R=(0,y.copyDom)(x.el);x.eventListeners&&x.eventListeners.length>0&&x.eventListeners.forEach(function(W){R.addEventListener(W.event,W.listener,W.useCapture||!1)}),U.appendChild(R)}}else(U=S.domObj.use()).textContent=x.txt;if(S.onChangeDirection=function(W){P.direction=W},S.danmu.on("changeDirection",S.onChangeDirection),x.style){var C=x.style;Object.keys(C).forEach(function(W){(0,y.styleUtil)(U,W,C[W])})}x.mode==="top"||x.mode==="bottom"?S.mode=x.mode:S.mode="scroll",S.el=U,x.like&&x.like.el&&S.setLikeDom(x.like.el,x.like.style),S.status="waiting";var A=void 0;if((0,y.isNumber)(k.config.bulletOffset)&&k.config.bulletOffset>=0)A=k.config.bulletOffset;else{var b=k.containerPos;A=b.width/10>100?100:b.width/10}var O=x.realTime?0:Math.floor(Math.random()*A);return S.updateOffset(O),S}return function(k,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof x=="undefined"?"undefined":g(x)));k.prototype=Object.create(x&&x.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(k,x):k.__proto__=x)}(w,E),l(w,[{key:"updateOffset",value:function(x){this.random=x,(0,y.styleUtil)(this.el,"left",this.danmu.containerPos.width+x+"px")}},{key:"attach",value:function(){var x=this.el;this.container.appendChild(x),this.elPos=x.getBoundingClientRect(),this.direction==="b2t"?(this.width=this.elPos.height,this.height=this.elPos.width):(this.width=this.elPos.width,this.height=this.elPos.height),this.moveV&&(this.duration=(this.danmu.containerPos.width+this.random+this.width)/this.moveV*1e3),this.danmu.config&&(this.danmu.config.mouseControl&&(this.mouseoverFunWrapper=this.mouseoverFun.bind(this),x.addEventListener("mouseover",this.mouseoverFunWrapper,!1)),this.danmu.config.mouseEnterControl&&(this.mouseEnterFunWrapper=this.mouseoverFun.bind(this),x.addEventListener("mouseenter",this.mouseEnterFunWrapper,!1))),x.addEventListener("transitionend",this._onTransitionEnd,!1)}},{key:"detach",value:function(){var x=this.el;if(x){var S=this.danmu.config;S&&(S.mouseControl&&x.removeEventListener("mouseover",this.mouseoverFunWrapper,!1),S.mouseEnterControl&&x.removeEventListener("mouseenter",this.mouseEnterFunWrapper,!1)),x.removeEventListener("transitionend",this._onTransitionEnd,!1),x.parentNode&&x.parentNode.removeChild(x),this.reuseDOM&&this.domObj.unused(x),this.el=null}this.elPos=void 0,this.danmu.off("changeDirection",this.onChangeDirection)}},{key:"willChange",value:function(){var x=this.danmu.main.willChanges.concat(this.willChanges).join();(0,y.styleUtil)(this.el,"willChange",x)}},{key:"mouseoverFun",value:function(x){this.danmu&&this.danmu.mouseControl&&this.danmu.config.mouseControlPause||this.status==="waiting"||this.status==="end"||this.danmu&&this.danmu.emit("bullet_hover",{bullet:this,event:x})}},{key:"_onTransitionEnd",value:function(){this.status="end",this.remove()}},{key:"topInit",value:function(){this.logger&&this.logger.info("topInit #"+(this.options.txt||"[DOM Element]")+"#"),this.direction==="b2t"?((0,y.styleUtil)(this.el,"transformOrigin","left top"),(0,y.styleUtil)(this.el,"transform","translateX(-"+this.top+"px) translateY("+this.danmu.containerPos.height+"px) translateZ(0px) rotate(90deg)"),(0,y.styleUtil)(this.el,"transition","transform 0s linear 0s")):(0,y.styleUtil)(this.el,"top",this.top+"px")}},{key:"pauseMove",value:function(){var x=arguments.length>0&&arguments[0]!==void 0&&arguments[0],S=this;if(S.status!=="paused"&&(S.status!=="forcedPause"&&(this.status="paused"),S._moveV=void 0,this.el))if(this.willChange(),this.mode==="scroll"){var P=S.danmu.containerPos;if(x){var U=(new Date().getTime()-S.moveTime)/1e3,R=U*this.moveV,C=0;C=S.moveMoreS-R>=0?this.direction==="b2t"?(S.moveMoreS-R)/S.moveContainerHeight*P.height:(S.moveMoreS-R)/S.moveContainerWidth*P.width:S.moveMoreS-R,this.direction==="b2t"?(0,y.styleUtil)(this.el,"transform","translateX(-"+this.top+"px) translateY("+C+"px) translateZ(0px) rotate(90deg)"):(0,y.styleUtil)(this.el,"left",C+"px")}else this.direction==="b2t"?(0,y.styleUtil)(this.el,"transform","translateX(-"+this.top+"px) translateY("+(this.el.getBoundingClientRect().top-P.top)+"px) translateZ(0px) rotate(90deg)"):(0,y.styleUtil)(this.el,"left",this.el.getBoundingClientRect().left-P.left+"px");this.direction==="b2t"||(0,y.styleUtil)(this.el,"transform","translateX(0px) translateY(0px) translateZ(0px)"),(0,y.styleUtil)(this.el,"transition","transform 0s linear 0s")}else this.pastDuration&&this.startTime?this.pastDuration=this.pastDuration+new Date().getTime()-this.startTime:this.pastDuration=1}},{key:"startMove",value:function(x){if(this.hasMove||(this.danmu.emit("bullet_start",this),this.hasMove=!0),(this.status!=="forcedPause"||x)&&this.el&&this.status!=="start")if(this.status="start",this.willChanges=["transform","transition"],this.willChange(),(0,y.styleUtil)(this.el,"backface-visibility","hidden"),(0,y.styleUtil)(this.el,"perspective","500em"),this.mode==="scroll"){var S=this.danmu.containerPos;if(this.direction==="b2t"){var P=(this.el.getBoundingClientRect().bottom-S.top)/this.moveV;(0,y.styleUtil)(this.el,"transition","transform "+P+"s linear 0s"),(0,y.styleUtil)(this.el,"transform","translateX(-"+this.top+"px) translateY(-"+this.height+"px) translateZ(0px) rotate(90deg)"),this.moveTime=new Date().getTime(),this.moveMoreS=this.el.getBoundingClientRect().top-S.top,this.moveContainerHeight=S.height}else{if(!this.el)return;var U=this.el.getBoundingClientRect(),R=U.right-S.left,C=R/this.moveV;U.right>S.left?((0,y.styleUtil)(this.el,"transition","transform "+C+"s linear 0s"),(0,y.styleUtil)(this.el,"transform","translateX(-"+R+"px) translateY(0px) translateZ(0px)"),this.moveTime=new Date().getTime(),this.moveMoreS=U.left-S.left,this.moveContainerWidth=S.width):(this.status="end",this.remove())}}else{var A=new Date().getTime(),b=(this.startTime&&A-this.startTime>this.duration?A-this.startTime:this.duration)/1e3;(0,y.styleUtil)(this.el,"left","50%"),(0,y.styleUtil)(this.el,"margin","0 0 0 -"+this.width/2+"px"),(0,y.styleUtil)(this.el,"visibility","hidden"),(0,y.styleUtil)(this.el,"transition","visibility "+b+"s 0s"),this.pastDuration||(this.pastDuration=1),this.startTime=A}}},{key:"remove",value:function(){this.logger&&this.logger.info("remove #"+(this.options.txt||"[DOM Element]")+"#"),this.pauseMove(),this.el&&this.el.parentNode&&(this.willChanges=[],this.willChange(),this.detach(),this.options.el&&this.options.el.nodeType===1&&this.danmu.config.disableCopyDOM&&(0,y.styleUtil)(this.options.el,"transform","none"),this.danmu.emit("bullet_remove",{bullet:this}))}},{key:"setFontSize",value:function(x){this.el&&(this.el.style.fontSize=x)}},{key:"setLikeDom",value:function(x,S){if(x&&(Object.keys(S).forEach(function(U){x.style[U]=S[U]}),x.className="danmu-like",this.el)){var P=this.el.querySelector(".danmu-like");P&&this.el.removeChild(P),this.el.innerHTML=""+this.el.innerHTML+x.outerHTML}return x}},{key:"moveV",get:function(){var x=this._moveV;if(!x){if(this.options.moveV)x=this.options.moveV;else if(this.elPos){var S=this.danmu.containerPos;x=(this.direction==="b2t"?S.height+this.height:S.width+this.width)/this.duration*1e3}x&&(x*=this.danmu.main.playRate,this._moveV=x)}return x}}]),w}(d.default);p.default=_},function(v,p,e){Object.defineProperty(p,"__esModule",{value:!0});var s,l=function(){function E(w,k){for(var x=0;x<k.length;x++){var S=k[x];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(w,S.key,S)}}return function(w,k,x){return k&&E(w.prototype,k),x&&E(w,x),w}}(),f=e(1),d=(s=f)&&s.__esModule?s:{default:s},y=e(0),m=e(31),_=function(E){function w(k){(function(P,U){if(!(P instanceof U))throw new TypeError("Cannot call a class as a function")})(this,w);var x=function(P,U){if(!P)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!U||(typeof U=="undefined"?"undefined":g(U))!="object"&&typeof U!="function"?P:U}(this,(w.__proto__||Object.getPrototypeOf(w)).call(this)),S=x;return S.setLogger("channel"),S.danmu=k,S.reset(!0),S.direction=k.direction,S.channels=[],S.updatePos(),(0,y.attachEventListener)(x.danmu,"bullet_remove",function(P){S.removeBullet(P.bullet)},"destroy"),(0,y.attachEventListener)(x.danmu,"changeDirection",function(P){S.direction=P},"destroy"),(0,y.attachEventListener)(x.danmu,"channel_resize",function(){S.resize()},"destroy"),x}return function(k,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof x=="undefined"?"undefined":g(x)));k.prototype=Object.create(x&&x.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(k,x):k.__proto__=x)}(w,E),l(w,[{key:"updatePos",value:function(){var x=this.container.getBoundingClientRect();this.containerPos=x,this.containerWidth=x.width,this.containerHeight=x.height,this.containerTop=x.top,this.containerBottom=x.bottom,this.containerLeft=x.left,this.containerRight=x.right}},{key:"destroy",value:function(){for(var x in this.logger&&this.logger.info("destroy"),this.channels.splice(0,this.channels.length),this._cancelResizeTimer(),this)y.hasOwnProperty.call(this,x)&&delete this[x]}},{key:"addBullet",value:function(x){var S=this,P=this.danmu,U=this.channels,R=void 0,C=void 0,A=void 0;if(S.direction==="b2t"?(C=this.channelWidth,A=Math.ceil(x.width/C)):(R=this.channelHeight,A=Math.ceil(x.height/R)),A>U.length)return{result:!1,message:"exceed channels.length, occupy="+A+",channelsSize="+U.length};for(var b=!0,O=void 0,W=-1,K=0,G=U.length;K<G;K++)if(U[K].queue[x.mode].some(function(Xe){return Xe.id===x.id}))return{result:!1,message:"exited, channelOrder="+K+",danmu_id="+x.id};if(x.mode==="scroll")for(var B=0,j=U.length-A;B<=j;B++){b=!0;for(var z=B;z<B+A;z++){if((O=U[z]).operating.scroll){b=!1;break}if(O.bookId.scroll&&O.bookId.scroll!==x.id){b=!1;break}O.operating.scroll=!0;var $=O.queue.scroll[0];if($){var J=$.el.getBoundingClientRect();if(S.direction==="b2t"){if(J.bottom>=S.containerPos.bottom){b=!1,O.operating.scroll=!1;break}}else if(J.right>=S.containerPos.right){b=!1,O.operating.scroll=!1;break}var Q=void 0,ne=$.moveV,Ee=void 0,we=x.moveV,Ae=void 0;if(S.direction==="b2t"?(Ee=(Q=J.bottom-S.containerTop)/ne,Ae=S.containerHeight+x.random-Q):(Ee=(Q=J.right-S.containerLeft)/ne,Ae=S.containerWidth+x.random-Q),we>ne){var De=Ae/(we-ne);if(P.config.bOffset||(P.config.bOffset=0),Ee+P.config.bOffset>=De){var Ve=Ee*we-S.containerPos.width;Ve>0&&x.updateOffset(Ve+(1+Math.ceil(5*Math.random())))}}}O.operating.scroll=!1}if(b){W=B;break}}else if(x.mode==="top")for(var Ce=0,Me=U.length-A;Ce<=Me;Ce++){b=!0;for(var Ge=Ce;Ge<Ce+A;Ge++){if(Ge>Math.floor(U.length/2)){b=!1;break}if((O=U[Ge]).operating[x.mode]){b=!1;break}if((O.bookId[x.mode]||x.prior)&&O.bookId[x.mode]!==x.id){b=!1;break}if(O.operating[x.mode]=!0,O.queue[x.mode].length>0){b=!1,O.operating[x.mode]=!1;break}O.operating[x.mode]=!1}if(b){W=Ce;break}}else if(x.mode==="bottom")for(var D=U.length-A;D>=0;D--){b=!0;for(var fe=D;fe<D+A;fe++){if(fe<=Math.floor(U.length/2)){b=!1;break}if((O=U[fe]).operating[x.mode]){b=!1;break}if((O.bookId[x.mode]||x.prior)&&O.bookId[x.mode]!==x.id){b=!1;break}if(O.operating[x.mode]=!0,O.queue[x.mode].length>0){b=!1,O.operating[x.mode]=!1;break}O.operating[x.mode]=!1}if(b){W=D;break}}if(W!==-1){for(var ae=W,X=W+A;ae<X;ae++)(O=U[ae]).operating[x.mode]=!0,O.queue[x.mode].unshift(x),x.prior&&(delete O.bookId[x.mode],S.logger&&S.logger.info(ae+"\u53F7\u8F68\u9053\u6062\u590D\u6B63\u5E38\u4F7F\u7528")),O.operating[x.mode]=!1;return x.prior&&(S.logger&&S.logger.info(x.id+"\u53F7\u4F18\u5148\u5F39\u5E55\u8FD0\u884C\u5B8C\u6BD5"),delete x.bookChannelId,P.player&&P.bulletBtn.main.data.some(function(Xe){return Xe.id===x.id&&(delete Xe.bookChannelId,!0)})),x.channel_id=[W,A],S.direction==="b2t"?(x.top=W*C,S.danmu.config.area&&S.danmu.config.area.start&&(x.top+=S.containerWidth*S.danmu.config.area.start)):(x.top=W*R,S.danmu.config.area&&S.danmu.config.area.start&&(x.top+=S.containerHeight*S.danmu.config.area.start)),{result:x,message:"success"}}if(x.options.realTime){var H=0,q=-1,ce=null;if(S.danmu.bulletBtn.main.queue.forEach(function(Xe,it){!Xe.prior&&!Xe.options.realTime&&Xe.el&&Xe.el.getBoundingClientRect().left>S.containerPos.right&&Xe.start>=H&&(H=Xe.start,q=it,ce=Xe)}),ce){ce.remove(),S.removeBullet(ce),S.danmu.bulletBtn.main.queue.splice(q,1),x.channel_id=ce.channel_id;for(var he=ce.channel_id[0],te=ce.channel_id[0]+ce.channel_id[1];he<te;he++)(O=U[he]).operating[x.mode]=!0,O.queue[x.mode].unshift(x),x.prior&&delete O.bookId[x.mode],O.operating[x.mode]=!1;return x.top=ce.top,S.danmu.config.area&&S.danmu.config.area.start&&(x.top+=S.containerHeight*S.danmu.config.area.start),{result:x,message:"success"}}}if(x.prior)if(x.bookChannelId||S.danmu.live)P.player&&P.bulletBtn.main.data.some(function(Xe){return Xe.id===x.id&&(S.logger&&S.logger.info(x.id+"\u53F7\u4F18\u5148\u5F39\u5E55\u5C06\u4E8E2\u79D2\u540E\u518D\u6B21\u8BF7\u6C42\u6CE8\u518C"),Xe.start+=2e3,!0)});else{W=-1;for(var Te=0,Le=U.length-A;Te<=Le;Te++){b=!0;for(var Se=Te;Se<Te+A;Se++)if(U[Se].bookId[x.mode]){b=!1;break}if(b){W=Te;break}}if(W!==-1){for(var ze=W;ze<W+A;ze++)U[ze].bookId[x.mode]=x.id,S.logger&&S.logger.info(ze+"\u53F7\u8F68\u9053\u88AB"+x.id+"\u53F7\u4F18\u5148\u5F39\u5E55\u9884\u5B9A");P.player&&P.bulletBtn.main.data.some(function(Xe){return Xe.id===x.id&&(S.logger&&S.logger.info(x.id+"\u53F7\u4F18\u5148\u5F39\u5E55\u5C06\u4E8E2\u79D2\u540E\u518D\u6B21\u8BF7\u6C42\u6CE8\u518C"),Xe.start+=2e3,Xe.bookChannelId=[W,A],S.logger&&S.logger.info(x.id+"\u53F7\u4F18\u5148\u5F39\u5E55\u9884\u5B9A\u4E86"+W+"~"+(W+A-1)+"\u53F7\u8F68\u9053"),!0)})}}return{result:!1,message:"no surplus will right"}}},{key:"removeBullet",value:function(x){this.logger&&this.logger.info("removeBullet "+(x.options.txt||"[DOM Element]"));for(var S=this.channels,P=x.channel_id,U=void 0,R=P[0],C=P[0]+P[1];R<C;R++)if(U=S[R]){U.operating[x.mode]=!0;var A=-1;U.queue[x.mode].some(function(b,O){return b.id===x.id&&(A=O,!0)}),A>-1&&U.queue[x.mode].splice(A,1),U.operating[x.mode]=!1}x.options.loop&&this.danmu.bulletBtn.main.playedData.push(x.options)}},{key:"resizeSync",value:function(){this.resize(!0)}},{key:"resize",value:function(){var x=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.logger&&this.logger.info("resize");var S=this;function P(){var U=S.danmu,R=U.container,C=U.config,A=U.bulletBtn,b=void 0;if(S.updatePos(),S._cancelResizeTimer(),A.main.data&&A.main.data.forEach(function(Ve){Ve.bookChannelId&&(delete Ve.bookChannelId,S.logger&&S.logger.info("resize\u5BFC\u81F4"+Ve.id+"\u53F7\u4F18\u5148\u5F39\u5E55\u9884\u5B9A\u53D6\u6D88"))}),S.logger&&S.logger.info("resize\u5BFC\u81F4\u6240\u6709\u8F68\u9053\u6062\u590D\u6B63\u5E38\u4F7F\u7528"),S.width=S.containerWidth,S.height=S.containerHeight,C.area){var O=C.area,W=O.lines,K=O.start,G=O.end;(0,m.validAreaLineRule)(W)?b=W:K>=0&&G>=K&&(S.direction==="b2t"?S.width=S.width*(G-K):S.height=S.height*(G-K))}S.container=R;var B=C.channelSize||(/mobile/gi.test(navigator.userAgent)?10:12);(0,y.isNumber)(b)||(b=S.direction==="b2t"?Math.floor(S.width/B):Math.floor(S.height/B));for(var j=[],z=0;z<b;z++)j[z]={id:z,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}};if(S.channels&&S.channels.length<=j.length){for(var $=function(Ce){j[Ce]={id:Ce,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}},["scroll","top"].forEach(function(Me){S.channels[Ce].queue[Me].forEach(function(Ge){Ge.el&&j[Ce].queue[Me].push(Ge)})}),S.channels[Ce].queue.bottom.forEach(function(Me){if(Me.el&&(j[Ce+j.length-S.channels.length].queue.bottom.push(Me),Me.channel_id[0]+Me.channel_id[1]-1===Ce)){var Ge=[].concat(Me.channel_id);Me.channel_id=[Ge[0]-S.channels.length+j.length,Ge[1]],Me.top=Me.channel_id[0]*B,S.danmu.config.area&&S.danmu.config.area.start&&(Me.top+=S.containerHeight*S.danmu.config.area.start),Me.topInit()}})},J=0;J<S.channels.length;J++)$(J);for(var Q=function(Ce){["scroll","top","bottom"].forEach(function(Me){j[Ce].queue[Me].forEach(function(Ge){Ge.resized=!1})})},ne=0;ne<j.length;ne++)Q(ne);S.channels=j,S.direction==="b2t"?S.channelWidth=B:S.channelHeight=B}else if(S.channels&&S.channels.length>j.length){for(var Ee=function(Ce){j[Ce]={id:Ce,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}},["scroll","top","bottom"].forEach(function(Me){if(!(Me==="top"&&Ce>Math.floor(j.length/2))){if(!(Me==="bottom"&&Ce<=Math.floor(j.length/2))){var Ge=Me==="bottom"?Ce-j.length+S.channels.length:Ce;S.channels[Ge].queue[Me].forEach(function(D,fe){if(D.el&&(j[Ce].queue[Me].push(D),Me==="bottom"&&D.channel_id[0]+D.channel_id[1]-1===Ge)){var ae=[].concat(D.channel_id);D.channel_id=[ae[0]-S.channels.length+j.length,ae[1]],D.top=D.channel_id[0]*B,S.danmu.config.area&&S.danmu.config.area.start&&(D.top+=S.containerHeight*S.danmu.config.area.start),D.topInit()}S.channels[Ge].queue[Me].splice(fe,1)})}}})},we=0;we<j.length;we++)Ee(we);for(var Ae=function(Ce){["scroll","top","bottom"].forEach(function(Me){j[Ce].queue[Me].forEach(function(Ge){Ge.resized=!1})})},De=0;De<j.length;De++)Ae(De);S.channels=j,S.direction==="b2t"?S.channelWidth=B:S.channelHeight=B}S.resizing=!1}S.resizing||(S.resizing=!0,x?P():(this._cancelResizeTimer(),this.resizeId=requestAnimationFrame(P)))}},{key:"_cancelResizeTimer",value:function(){this.resizeId&&(cancelAnimationFrame(this.resizeId),this.resizeId=null)}},{key:"reset",value:function(){var x=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.logger&&this.logger.info("reset");var S=this,P=S.danmu,U=P.container,R=P.bulletBtn,C=P.config;function A(){var b=void 0,O=U.getBoundingClientRect();if(S.width=O.width,S.height=O.height,S.resetId&&(cancelAnimationFrame(S.resetId),S.resetId=null),C.area){var W=C.area,K=W.lines,G=W.start,B=W.end;(0,m.validAreaLineRule)(K)?b=K:G>=0&&B>=G&&(S.direction==="b2t"?S.width=S.width*(B-G):S.height=S.height*(B-G))}var j=C.channelSize||(/mobile/gi.test(navigator.userAgent)?10:12);(0,y.isNumber)(b)||(b=S.direction==="b2t"?Math.floor(S.width/j):Math.floor(S.height/j));for(var z=[],$=0;$<b;$++)z[$]={id:$,queue:{scroll:[],top:[],bottom:[]},operating:{scroll:!1,top:!1,bottom:!1},bookId:{}};S.channels=z,S.direction==="b2t"?S.channelWidth=j:S.channelHeight=j}S.container=U,R&&R.main&&R.main.queue.forEach(function(b){b.remove()}),S.channels&&S.channels.length>0&&["scroll","top","bottom"].forEach(function(b){for(var O=0;O<S.channels.length;O++)S.channels[O].queue[b].forEach(function(W){W.remove()})}),R&&R.main&&R.main.data&&R.main.data.forEach(function(b){b.attached_=!1}),x?this.resetId=requestAnimationFrame(A):A()}}]),w}(d.default);p.default=_,v.exports=p.default},function(v,p,e){Object.defineProperty(p,"__esModule",{value:!0}),p.validAreaLineRule=function(s){return typeof s=="number"&&s>=0&&Number.isInteger(s)}},function(v,p,e){Object.defineProperty(p,"__esModule",{value:!0});var s=function(){function d(y,m){for(var _=0;_<m.length;_++){var E=m[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(y,E.key,E)}}return function(y,m,_){return m&&d(y.prototype,m),_&&d(y,_),y}}(),l=e(0),f=function(){function d(y){(function(m,_){if(!(m instanceof _))throw new TypeError("Cannot call a class as a function")})(this,d),y={initDOM:function(){return document.createElement("div")},initSize:10},this.init(y)}return s(d,[{key:"init",value:function(m){this.idleList=[],this.usingList=[],this._id=0,this.options=m,this._expand(m.initSize)}},{key:"use",value:function(){this.idleList.length||this._expand(1);var m=this.idleList.shift();return this.usingList.push(m),m}},{key:"unused",value:function(m){var _=this.usingList.indexOf(m);_<0||(this.usingList.splice(_,1),m.innerHTML="",m.textcontent="",this.clearElementStyle(m),this.idleList.push(m))}},{key:"_expand",value:function(m){for(var _=0;_<m;_++)this.idleList.push(this.options.initDOM(this._id++))}},{key:"destroy",value:function(){for(var m=0;m<this.idleList.length;m++)this.idleList[m].innerHTML="",this.idleList[m].textcontent="",this.clearElementStyle(this.idleList[m]);for(var _=0;_<this.usingList.length;_++)this.usingList[_].innerHTML="",this.usingList[_].textcontent="",this.clearElementStyle(this.usingList[_]);for(var E in this)l.hasOwnProperty.call(this,E)&&delete this[E]}},{key:"clearElementStyle",value:function(m){var _=typeof window!="undefined"?window.navigator.userAgent:null;_&&(_.indexOf("MSIE ")>-1||_.indexOf("Trident/")>-1?(0,l.styleUtil)(m,"transform","none"):m.setAttribute("style",""))}}]),d}();p.default=f,v.exports=p.default},function(v,p,e){Object.defineProperty(p,"__esModule",{value:!0}),p.destroyObserver=p.unObserver=p.addObserver=void 0;var s=function(){function d(y,m){for(var _=0;_<m.length;_++){var E=m[_];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(y,E.key,E)}}return function(y,m,_){return m&&d(y.prototype,m),_&&d(y,_),y}}(),l=e(0),f=new(function(){function d(){var y=this;if(function(m,_){if(!(m instanceof _))throw new TypeError("Cannot call a class as a function")}(this,d),this.__handlers=[],window.ResizeObserver)try{this.observer=new window.ResizeObserver((0,l.throttle)(function(m){y.__trigger(m)},100))}catch(m){}}return s(d,[{key:"addObserver",value:function(m,_){if(this.observer){this.observer&&this.observer.observe(m);for(var E=this.__handlers,w=-1,k=0;k<E.length;k++)E[k]&&m===E[k].target&&(w=k);w>-1?this.__handlers[w].handler.push(_):this.__handlers.push({target:m,handler:[_]})}}},{key:"unObserver",value:function(m){var _=-1;this.__handlers.map(function(E,w){m===E.target&&(_=w)}),this.observer&&this.observer.unobserve(m),_>-1&&this.__handlers.splice(_,1)}},{key:"destroyObserver",value:function(){this.observer&&this.observer.disconnect(),this.observer=null,this.__handlers=null}},{key:"__runHandler",value:function(m){for(var _=this.__handlers,E=0;E<_.length;E++)if(_[E]&&m===_[E].target){_[E].handler&&_[E].handler.map(function(w){try{w()}catch(k){console.error(k)}});break}}},{key:"__trigger",value:function(m){var _=this;m.map(function(E){_.__runHandler(E.target)})}}]),d}());p.addObserver=function(d,y){f.addObserver(d,y)},p.unObserver=function(d,y){f.unObserver(d,y)},p.destroyObserver=function(d,y){f.destroyObserver(d,y)}},function(v,p,e){var s=e(35);typeof s=="string"&&(s=[[v.i,s,""]]);var l={hmr:!0,transform:void 0,insertInto:void 0};e(37)(s,l),s.locals&&(v.exports=s.locals)},function(v,p,e){(v.exports=e(36)(!1)).push([v.i,".danmu{overflow:hidden;-webkit-user-select:none;-moz-user-select:none;user-select:none;-ms-user-select:none}.danmu>*{position:absolute;white-space:nowrap}.danmu-switch{width:32px;height:20px;border-radius:100px;background-color:#ccc;-webkit-box-sizing:border-box;box-sizing:border-box;outline:none;cursor:pointer;position:relative;text-align:center;margin:10px auto}.danmu-switch.danmu-switch-active{padding-left:12px;background-color:#f85959}.danmu-switch span.txt{width:20px;height:20px;line-height:20px;text-align:center;display:block;border-radius:100px;background-color:#fff;-webkit-box-shadow:-2px 0 0 0 rgba(0, 0, 0, .04);box-shadow:-2px 0 0 0 rgba(0, 0, 0, .04);font-family:PingFangSC;font-size:10px;font-weight:500;color:#f44336}",""])},function(v,p){v.exports=function(e){var s=[];return s.toString=function(){return this.map(function(l){var f=function(d,y){var m=d[1]||"",_=d[3];if(!_)return m;if(y&&typeof btoa=="function"){var E=(k=_,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(k))))+" */"),w=_.sources.map(function(x){return"/*# sourceURL="+_.sourceRoot+x+" */"});return[m].concat(w).concat([E]).join(`
`)}var k;return[m].join(`
`)}(l,e);return l[2]?"@media "+l[2]+"{"+f+"}":f}).join("")},s.i=function(l,f){typeof l=="string"&&(l=[[null,l,""]]);for(var d={},y=0;y<this.length;y++){var m=this[y][0];typeof m=="number"&&(d[m]=!0)}for(y=0;y<l.length;y++){var _=l[y];typeof _[0]=="number"&&d[_[0]]||(f&&!_[2]?_[2]=f:f&&(_[2]="("+_[2]+") and ("+f+")"),s.push(_))}},s}},function(v,p,e){var s,l,f={},d=(s=function(){return window&&document&&document.all&&!window.atob},function(){return l===void 0&&(l=s.apply(this,arguments)),l}),y=function(j){return document.querySelector(j)},m=function(B){var j={};return function(z){if(typeof z=="function")return z();if(j[z]===void 0){var $=y.call(this,z);if(window.HTMLIFrameElement&&$ instanceof window.HTMLIFrameElement)try{$=$.contentDocument.head}catch(J){$=null}j[z]=$}return j[z]}}(),_=null,E=0,w=[],k=e(38);function x(B,j){for(var z=0;z<B.length;z++){var $=B[z],J=f[$.id];if(J){J.refs++;for(var Q=0;Q<J.parts.length;Q++)J.parts[Q]($.parts[Q]);for(;Q<$.parts.length;Q++)J.parts.push(A($.parts[Q],j))}else{var ne=[];for(Q=0;Q<$.parts.length;Q++)ne.push(A($.parts[Q],j));f[$.id]={id:$.id,refs:1,parts:ne}}}}function S(B,j){for(var z=[],$={},J=0;J<B.length;J++){var Q=B[J],ne=j.base?Q[0]+j.base:Q[0],Ee={css:Q[1],media:Q[2],sourceMap:Q[3]};$[ne]?$[ne].parts.push(Ee):z.push($[ne]={id:ne,parts:[Ee]})}return z}function P(B,j){var z=m(B.insertInto);if(!z)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var $=w[w.length-1];if(B.insertAt==="top")$?$.nextSibling?z.insertBefore(j,$.nextSibling):z.appendChild(j):z.insertBefore(j,z.firstChild),w.push(j);else if(B.insertAt==="bottom")z.appendChild(j);else{if(g(B.insertAt)!="object"||!B.insertAt.before)throw new Error(`[Style Loader]

 Invalid value for parameter 'insertAt' ('options.insertAt') found.
 Must be 'top', 'bottom', or Object.
 (https://github.com/webpack-contrib/style-loader#insertat)
`);var J=m(B.insertInto+" "+B.insertAt.before);z.insertBefore(j,J)}}function U(B){if(B.parentNode===null)return!1;B.parentNode.removeChild(B);var j=w.indexOf(B);j>=0&&w.splice(j,1)}function R(B){var j=document.createElement("style");return B.attrs.type===void 0&&(B.attrs.type="text/css"),C(j,B.attrs),P(B,j),j}function C(B,j){Object.keys(j).forEach(function(z){B.setAttribute(z,j[z])})}function A(B,j){var z,$,J,Q;if(j.transform&&B.css){if(!(Q=j.transform(B.css)))return function(){};B.css=Q}if(j.singleton){var ne=E++;z=_||(_=R(j)),$=W.bind(null,z,ne,!1),J=W.bind(null,z,ne,!0)}else B.sourceMap&&typeof URL=="function"&&typeof URL.createObjectURL=="function"&&typeof URL.revokeObjectURL=="function"&&typeof Blob=="function"&&typeof btoa=="function"?(z=function(Ee){var we=document.createElement("link");return Ee.attrs.type===void 0&&(Ee.attrs.type="text/css"),Ee.attrs.rel="stylesheet",C(we,Ee.attrs),P(Ee,we),we}(j),$=G.bind(null,z,j),J=function(){U(z),z.href&&URL.revokeObjectURL(z.href)}):(z=R(j),$=K.bind(null,z),J=function(){U(z)});return $(B),function(Ee){if(Ee){if(Ee.css===B.css&&Ee.media===B.media&&Ee.sourceMap===B.sourceMap)return;$(B=Ee)}else J()}}v.exports=function(B,j){if(typeof DEBUG!="undefined"&&DEBUG&&(typeof document=="undefined"?"undefined":g(document))!="object")throw new Error("The style-loader cannot be used in a non-browser environment");(j=j||{}).attrs=g(j.attrs)=="object"?j.attrs:{},j.singleton||typeof j.singleton=="boolean"||(j.singleton=d()),j.insertInto||(j.insertInto="head"),j.insertAt||(j.insertAt="bottom");var z=S(B,j);return x(z,j),function($){for(var J=[],Q=0;Q<z.length;Q++){var ne=z[Q];(Ee=f[ne.id]).refs--,J.push(Ee)}for($&&x(S($,j),j),Q=0;Q<J.length;Q++){var Ee;if((Ee=J[Q]).refs===0){for(var we=0;we<Ee.parts.length;we++)Ee.parts[we]();delete f[Ee.id]}}}};var b,O=(b=[],function(B,j){return b[B]=j,b.filter(Boolean).join(`
`)});function W(B,j,z,$){var J=z?"":$.css;if(B.styleSheet)B.styleSheet.cssText=O(j,J);else{var Q=document.createTextNode(J),ne=B.childNodes;ne[j]&&B.removeChild(ne[j]),ne.length?B.insertBefore(Q,ne[j]):B.appendChild(Q)}}function K(B,j){var z=j.css,$=j.media;if($&&B.setAttribute("media",$),B.styleSheet)B.styleSheet.cssText=z;else{for(;B.firstChild;)B.removeChild(B.firstChild);B.appendChild(document.createTextNode(z))}}function G(B,j,z){var $=z.css,J=z.sourceMap,Q=j.convertToAbsoluteUrls===void 0&&J;(j.convertToAbsoluteUrls||Q)&&($=k($)),J&&($+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(J))))+" */");var ne=new Blob([$],{type:"text/css"}),Ee=B.href;B.href=URL.createObjectURL(ne),Ee&&URL.revokeObjectURL(Ee)}},function(v,p){v.exports=function(e){var s=typeof window!="undefined"&&window.location;if(!s)throw new Error("fixUrls requires window.location");if(!e||typeof e!="string")return e;var l=s.protocol+"//"+s.host,f=l+s.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(d,y){var m,_=y.trim().replace(/^"(.*)"$/,function(E,w){return w}).replace(/^'(.*)'$/,function(E,w){return w});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(_)?d:(m=_.indexOf("//")===0?_:_.indexOf("/")===0?l+_:f+_.replace(/^\.\//,""),"url("+JSON.stringify(m)+")")})}}])})}).call(this,r(135)(t))},function(t,i){t.exports=function(r){return r.webpackPolyfill||(r.deprecate=function(){},r.paths=[],r.children||(r.children=[]),Object.defineProperty(r,"loaded",{enumerable:!0,get:function(){return r.l}}),Object.defineProperty(r,"id",{enumerable:!0,get:function(){return r.i}}),r.webpackPolyfill=1),r}},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40" width="40" height="40">
  <path fill="#f85959" transform="scale(0.8 0.8)" d="M36.5,18.73a1.19,1.19,0,0,0,1-1.14V16.33a1.2,1.2,0,0,0-1-1.13l-.61-.08a1.75,1.75,0,0,1-1.3-.86l-.21-.36-.2-.36A1.72,1.72,0,0,1,34,12l.23-.58a1.18,1.18,0,0,0-.5-1.42l-1.1-.62a1.18,1.18,0,0,0-1.47.3l-.39.51a1.82,1.82,0,0,1-1.41.72c-.44,0-1.88-.27-2.22-.7l-.39-.49a1.18,1.18,0,0,0-1.48-.28l-1.09.64a1.19,1.19,0,0,0-.47,1.43l.25.59a1.87,1.87,0,0,1-.08,1.58c-.26.37-1.17,1.5-1.71,1.58l-.63.09a1.19,1.19,0,0,0-1,1.14l0,1.27a1.17,1.17,0,0,0,1,1.12l.61.08a1.74,1.74,0,0,1,1.3.87l.21.36.2.35A1.69,1.69,0,0,1,24,22.08l-.23.59a1.19,1.19,0,0,0,.5,1.42l1.1.62a1.19,1.19,0,0,0,1.48-.31l.38-.5a1.83,1.83,0,0,1,1.41-.72c.44,0,1.88.25,2.22.69l.39.49a1.18,1.18,0,0,0,1.48.28L33.86,24a1.19,1.19,0,0,0,.47-1.43L34.09,22a1.84,1.84,0,0,1,.07-1.58c.26-.37,1.17-1.5,1.72-1.58ZM31,18.94a2.76,2.76,0,0,1-4.65-1.2A2.71,2.71,0,0,1,27,15.13a2.76,2.76,0,0,1,4.64,1.2A2.7,2.7,0,0,1,31,18.94Z"/>
  <path fill="#f85959" transform="scale(0.8 0.8)" d="M32,0H3.59A3.59,3.59,0,0,0,0,3.59v17A3.59,3.59,0,0,0,3.59,24.2H19.72a12.59,12.59,0,0,1-.81-1.2A11.73,11.73,0,0,1,35.54,7.28V3.59A3.59,3.59,0,0,0,32,0ZM13,14.18H4.29a1.52,1.52,0,0,1,0-3H13a1.52,1.52,0,0,1,0,3ZM16.45,8H4.29a1.51,1.51,0,0,1,0-3H16.45a1.51,1.51,0,1,1,0,3Z"/>
</svg>
`},function(t,i,r){var n=r(138);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .danmu-switch{-webkit-order:6;-moz-box-ordinal-group:7;order:6;z-index:26}.xgplayer-skin-default .xgplayer-danmu{display:none;position:absolute;top:0;left:0;right:0;height:100%;overflow:hidden;z-index:9;outline:none;pointer-events:none}.xgplayer-skin-default .xgplayer-danmu>*{position:absolute;white-space:nowrap;z-index:9;pointer-events:auto}.xgplayer-skin-default .xgplayer-danmu.xgplayer-has-danmu{display:block}.xgplayer-skin-default .xgplayer-panel{outline:none;-webkit-order:7;-moz-box-ordinal-group:8;order:7;width:40px;height:40px;display:inline-block;position:relative;font-family:PingFangSC-Regular;font-size:13px;color:hsla(0,0%,100%,.8);z-index:36}.xgplayer-skin-default .xgplayer-panel .xgplayer-panel-icon{cursor:pointer;position:absolute;margin-left:5px;top:10px}.xgplayer-skin-default .xgplayer-panel-active{display:block!important;bottom:30px}.xgplayer-skin-default .xgplayer-panel-slider{z-index:36;display:none;position:absolute;width:230px;height:230px;background:rgba(0,0,0,.54);border-radius:1px;padding:10px 20px;outline:none;left:-115px;bottom:40px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-hidemode{padding-bottom:10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-hidemode-radio li{display:inline;list-style:none;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-hidemode ul{display:-webkit-flex;display:-moz-box;display:flex;-webkit-justify-content:space-around;justify-content:space-around}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-hidemode li{margin:0 12px;font-size:11px;color:#aaa}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-hidemode-font{margin-bottom:10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency{display:block;margin-top:10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-line{-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;outline:none;width:150px;height:4px;background:#aaa;border-radius:4px;border-style:none;margin-left:10px;margin-top:-2px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-line::-moz-focus-outer{border:0!important}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-color::-webkit-slider-runnable-track{outline:none;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-color::-moz-range-track{outline:none;background-color:#aaa;border-color:transparent;cursor:pointer;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-color::-ms-track{outline:none;background-color:#aaa;color:transparent;border-color:transparent;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-bar::-webkit-slider-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:6px;width:6px;margin-top:-4px;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-bar::-moz-range-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:0;width:0;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-bar::-ms-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:6px;width:6px;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-transparency .xgplayer-transparency-bar::-moz-range-progress{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;height:4px;border-radius:4px;background:linear-gradient(90deg,#f85959,#f85959 100%,#aaa)}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea{display:block;margin-top:8px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea-name{display:inline-block;position:relative;top:-10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea-control{display:inline-block}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea-control-up{width:150px;margin-left:10px;display:-moz-box;display:-webkit-flex;display:flex;-webkit-justify-content:space-between;-moz-box-pack:justify;justify-content:space-between;color:#aaa}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea-control-down{position:relative;top:-10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea-control-down-dots{display:-webkit-flex;display:-moz-box;display:flex;width:150px;margin-left:10px;-webkit-justify-content:space-between;-moz-box-pack:justify;justify-content:space-between}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea-threequarters,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea-twoquarters{margin-left:-6px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea-full{margin-right:3px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-line{-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;outline:none;width:150px;height:4px;background:#aaa;border-radius:4px;border-style:none;margin-left:10px;margin-top:-2px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-line::-moz-focus-outer{border:0!important}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-color::-webkit-slider-runnable-track{outline:none;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-color::-moz-range-track{outline:none;background-color:#aaa;border-color:transparent;cursor:pointer;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-color::-ms-track{outline:none;background-color:#aaa;color:transparent;border-color:transparent;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-bar::-webkit-slider-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:6px;width:6px;margin-top:-4px;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-bar::-moz-range-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:0;width:0;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-bar::-ms-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:6px;width:6px;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-full-dot,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-onequarters-dot,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-threequarters-dot,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-twoquarters-dot,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-showarea .xgplayer-showarea-zero-dot{width:3px;height:3px;border:3px solid #aaa;border-radius:50%;background-color:#aaa;position:relative;top:16px;z-index:-1}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed{display:block}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed-name{display:inline-block;position:relative;top:-10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed-control{display:inline-block}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed-control-up{width:150px;margin-left:10px;display:-moz-box;display:-webkit-flex;display:flex;-webkit-justify-content:space-between;-moz-box-pack:justify;justify-content:space-between;color:#aaa}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed-control-down{position:relative;top:-10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed-control-down-dots{display:-webkit-flex;display:-moz-box;display:flex;width:150px;margin-left:10px;-webkit-justify-content:space-between;-moz-box-pack:justify;justify-content:space-between}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-line{-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;outline:none;width:150px;height:4px;background:#aaa;border-radius:4px;border-style:none;margin-left:10px;margin-top:-2px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-line::-moz-focus-outer{border:0!important}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-color::-webkit-slider-runnable-track{outline:none;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-color::-moz-range-track{outline:none;background-color:#aaa;border-color:transparent;cursor:pointer;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-color::-ms-track{outline:none;background-color:#aaa;color:transparent;border-color:transparent;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-bar::-webkit-slider-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:6px;width:6px;margin-top:-4px;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-bar::-moz-range-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:0;width:0;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-bar::-ms-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:6px;width:6px;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-large-dot,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-middle-dot,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmuspeed .xgplayer-danmuspeed-small-dot{width:3px;height:3px;border:3px solid #aaa;border-radius:50%;background-color:#aaa;position:relative;top:16px;z-index:-1}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont{display:block}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont-name{display:inline-block;position:relative;top:-10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont-control{display:inline-block}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont-control-up{width:150px;margin-left:10px;display:-moz-box;display:-webkit-flex;display:flex;-webkit-justify-content:space-between;-moz-box-pack:justify;justify-content:space-between;color:#aaa}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont-control-down{position:relative;top:-10px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont-control-down-dots{display:-webkit-flex;display:-moz-box;display:flex;width:150px;margin-left:10px;-webkit-justify-content:space-between;-moz-box-pack:justify;justify-content:space-between}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-line{-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;outline:none;width:150px;height:4px;background:#aaa;border-radius:4px;border-style:none;margin-left:10px;margin-top:-2px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-line::-moz-focus-outer{border:0!important}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-color::-webkit-slider-runnable-track{outline:none;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-color::-moz-range-track{outline:none;background-color:#aaa;border-color:transparent;cursor:pointer;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-color::-ms-track{outline:none;background-color:#aaa;color:transparent;border-color:transparent;width:150px;height:4px;border-radius:4px}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-bar::-webkit-slider-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:6px;width:6px;margin-top:-4px;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-bar::-moz-range-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:0;width:0;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-bar::-ms-thumb{outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:6px solid #f85959;height:6px;width:6px;border-radius:6px;cursor:pointer}.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-large-dot,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-middle-dot,.xgplayer-skin-default .xgplayer-panel-slider .xgplayer-danmufont .xgplayer-danmufont-small-dot{width:3px;height:3px;border:3px solid #aaa;border-radius:50%;background-color:#aaa;position:relative;top:16px;z-index:-1}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0);r(140);var u=function(){var c=this;if(!(!c.config.pip||typeof c.video.requestPictureInPicture!="function")){var g=c.lang.PIP,v=(0,n.createDom)("xg-pip",'<p class="name"><span>'+g+"</span></p>",{tabindex:9},"xgplayer-pip");c.once("ready",function(){c.controls.appendChild(v)}),["click","touchend"].forEach(function(p){v.addEventListener(p,function(e){e.preventDefault(),e.stopPropagation(),c.userGestureTrigEvent("pipBtnClick")})})}};i.default={name:"s_pip",method:u},t.exports=i.default},function(t,i,r){var n=r(141);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-pip{-webkit-order:9;-moz-box-ordinal-group:10;order:9;position:relative;outline:none;display:block;cursor:pointer;height:20px;top:10px}.xgplayer-skin-default .xgplayer-pip .name{text-align:center;font-family:PingFangSC-Regular;font-size:13px;line-height:20px;height:20px;color:hsla(0,0%,100%,.8)}.xgplayer-skin-default .xgplayer-pip .name span{width:60px;height:20px;line-height:20px;background:rgba(0,0,0,.38);border-radius:10px;display:inline-block;vertical-align:middle}.lang-is-jp .xgplayer-pip .name span{width:70px;height:20px}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0);r(143);var u=function(){var c=this;if(!!c.config.miniplayer){var g=c.lang.MINIPLAYER,v=(0,n.createDom)("xg-miniplayer",'<p class="name"><span>'+g+"</span></p>",{tabindex:9},"xgplayer-miniplayer");c.once("ready",function(){c.controls.appendChild(v)}),["click","touchend"].forEach(function(p){v.addEventListener(p,function(e){e.preventDefault(),e.stopPropagation(),c.userGestureTrigEvent("miniplayerBtnClick")})})}};i.default={name:"s_miniplayer",method:u},t.exports=i.default},function(t,i,r){var n=r(144);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-miniplayer{-webkit-order:9;-moz-box-ordinal-group:10;order:9;position:relative;outline:none;display:block;cursor:pointer;height:20px;top:10px}.xgplayer-skin-default .xgplayer-miniplayer .name{text-align:center;font-family:PingFangSC-Regular;font-size:13px;line-height:20px;height:20px;color:hsla(0,0%,100%,.8)}.xgplayer-skin-default .xgplayer-miniplayer .name span{width:80px;height:20px;line-height:20px;background:rgba(0,0,0,.38);border-radius:10px;display:inline-block;vertical-align:middle}.xgplayer-skin-default .xgplayer-miniplayer-lay{position:absolute;top:26px;left:0;width:100%;height:100%;z-index:130;cursor:pointer;background-color:transparent;display:none}.xgplayer-skin-default .xgplayer-miniplayer-lay div{width:100%;height:100%}.xgplayer-skin-default .xgplayer-miniplayer-drag{cursor:move;position:absolute;top:0;left:0;width:100%;height:26px;line-height:26px;background-image:linear-gradient(rgba(0,0,0,.3),transparent);z-index:130;display:none}.xgplayer-skin-default .xgplayer-miniplayer-drag .drag-handle{width:100%}.xgplayer-skin-default.xgplayer-miniplayer-active{position:fixed;right:0;bottom:200px;width:320px;height:180px;z-index:110}.xgplayer-skin-default.xgplayer-miniplayer-active .xgplayer-controls,.xgplayer-skin-default.xgplayer-miniplayer-active .xgplayer-danmu{display:none}.xgplayer-skin-default.xgplayer-miniplayer-active .xgplayer-miniplayer-lay{display:block}.xgplayer-skin-default.xgplayer-miniplayer-active .xgplayer-miniplayer-drag{display:-webkit-flex;display:-moz-box;display:flex}.xgplayer-skin-default.xgplayer-inactive .xgplayer-miniplayer-drag{display:none}.lang-is-jp .xgplayer-miniplayer .name span{width:70px;height:20px}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(146),o=c(u);r(147);function c(v){return v&&v.__esModule?v:{default:v}}var g=function(){var p=this,e=p.config.playNext;if(!e||!e.urlList)return;var s=(0,n.createDom)("xg-playnext",'<xg-icon class="xgplayer-icon">'+o.default+"</xg-icon>",{},"xgplayer-playnext"),l=p.lang.PLAYNEXT_TIPS,f=(0,n.createDom)("xg-tips",'<span class="xgplayer-tip-playnext">'+l+"</span>",{},"xgplayer-tips");s.appendChild(f),p.once("ready",function(){p.controls.appendChild(s)}),["click","touchend"].forEach(function(m){s.addEventListener(m,function(_){_.preventDefault(),_.stopPropagation(),(0,n.addClass)(p.root,"xgplayer-is-enter"),p.userGestureTrigEvent("playNextBtnClick")})});var d=function(){(0,n.addClass)(p.root,"xgplayer-playnext-inactive")};p.on("urlListEnd",d);function y(){p.off("urlListEnd",d),p.off("destroy",y)}p.once("destroy",y)};i.default={name:"s_playNext",method:g},t.exports=i.default},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">
  <path transform="scale(0.038 0.028)" d="M800 380v768h-128v-352l-320 320v-704l320 320v-352z"></path>
</svg>
`},function(t,i,r){var n=r(148);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-playnext{position:relative;-webkit-order:1;-moz-box-ordinal-group:2;order:1;display:block;cursor:pointer;top:-2px}.xgplayer-skin-default .xgplayer-playnext .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-playnext .xgplayer-tips .xgplayer-tip-playnext{display:block}.xgplayer-skin-default .xgplayer-playnext:hover{opacity:.85}.xgplayer-skin-default .xgplayer-playnext:hover .xgplayer-tips{display:block}.xgplayer-lang-is-en .xgplayer-playnext .xgplayer-tips{margin-left:-25px}.xgplayer-lang-is-jp .xgplayer-playnext .xgplayer-tips{margin-left:-38px}.xgplayer-skin-default.xgplayer-playnext-inactive .xgplayer-playnext{display:none}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(150),o=c(u);r(151);function c(v){return v&&v.__esModule?v:{default:v}}var g=function(){var p=this;if(!!p.config.rotate){var e=(0,n.createDom)("xg-rotate",'<xg-icon class="xgplayer-icon">'+o.default+"</xg-icon>",{},"xgplayer-rotate"),s=p.lang.ROTATE_TIPS,l=(0,n.createDom)("xg-tips",'<span class="xgplayer-tip-rotate">'+s+"</span>",{},"xgplayer-tips");e.appendChild(l),p.once("ready",function(){p.controls.appendChild(e)}),["click","touchend"].forEach(function(f){e.addEventListener(f,function(d){d.preventDefault(),d.stopPropagation(),p.userGestureTrigEvent("rotateBtnClick")})})}};i.default={name:"s_rotate",method:g},t.exports=i.default},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 40 40" fill="none">
  <g clip-path="url(#clip0)">
    <path transform="scale(1.5 1.5)" d="M11.6665 9.16663H4.1665C2.78579 9.16663 1.6665 10.2859 1.6665 11.6666V15.8333C1.6665 17.214 2.78579 18.3333 4.1665 18.3333H11.6665C13.0472 18.3333 14.1665 17.214 14.1665 15.8333V11.6666C14.1665 10.2859 13.0472 9.16663 11.6665 9.16663Z" fill="white"/>
    <path transform="scale(1.5 1.5)" fill-rule="evenodd" clip-rule="evenodd" d="M3.88148 4.06298C3.75371 4.21005 3.67667 4.40231 3.67749 4.61242C3.67847 4.87253 3.79852 5.10435 3.98581 5.25646L6.99111 8.05895C7.32771 8.37283 7.85502 8.35443 8.16891 8.01782C8.48279 7.68122 8.46437 7.15391 8.12778 6.84003L6.62061 5.43457L9.8198 5.4224C9.82848 5.42239 9.8372 5.42221 9.84591 5.4219C10.9714 5.38233 12.0885 5.6285 13.0931 6.13744C14.0976 6.64635 14.957 7.40148 15.5908 8.33234C16.2246 9.2632 16.6122 10.3394 16.7177 11.4606C16.823 12.5819 16.6427 13.7115 16.1934 14.7442C16.0098 15.1661 16.203 15.6571 16.6251 15.8408C17.0471 16.0243 17.5381 15.8311 17.7216 15.4091C18.2833 14.1183 18.5087 12.7063 18.3771 11.3047C18.2453 9.90318 17.7607 8.55792 16.9684 7.39433C16.1761 6.23073 15.1021 5.28683 13.8463 4.65065C12.5946 4.01651 11.203 3.70872 9.80072 3.75583L6.43415 3.76862L7.96326 2.12885C8.27715 1.79225 8.25872 1.26494 7.92213 0.951061C7.58553 0.63718 7.05822 0.655585 6.74433 0.99219L3.90268 4.0395C3.89545 4.04724 3.88841 4.05509 3.88154 4.06303L3.88148 4.06298Z" fill="white"/>
  </g>
  <defs>
    <clipPath id="clip0">
      <rect width="40" height="40" fill="white"/>
    </clipPath>
  </defs>
</svg>
`},function(t,i,r){var n=r(152);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-rotate{position:relative;-webkit-order:10;-moz-box-ordinal-group:11;order:10;display:block;cursor:pointer}.xgplayer-skin-default .xgplayer-rotate .xgplayer-icon{margin-top:7px;width:26px}.xgplayer-skin-default .xgplayer-rotate .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-rotate .xgplayer-tips{margin-left:-22px}.xgplayer-skin-default .xgplayer-rotate .xgplayer-tips .xgplayer-tip-rotate{display:block}.xgplayer-skin-default .xgplayer-rotate:hover{opacity:.85}.xgplayer-skin-default .xgplayer-rotate:hover .xgplayer-tips{display:block}.xgplayer-lang-is-en .xgplayer-rotate .xgplayer-tips{margin-left:-26px}.xgplayer-lang-is-jp .xgplayer-rotate .xgplayer-tips{margin-left:-38px}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(154),o=c(u);r(155);function c(v){return v&&v.__esModule?v:{default:v}}var g=function(){var p=this;if(!!p.config.reload){var e=(0,n.createDom)("xg-reload",'<xg-icon class="xgplayer-icon">'+o.default+"</xg-icon>",{},"xgplayer-reload"),s=p.lang.RELOAD_TIPS,l=(0,n.createDom)("xg-tips",'<span class="xgplayer-tip-reload">'+s+"</span>",{},"xgplayer-tips");e.appendChild(l),p.once("ready",function(){p.controls.appendChild(e)}),["click","touchend"].forEach(function(f){e.addEventListener(f,function(d){d.preventDefault(),d.stopPropagation(),p.userGestureTrigEvent("reloadBtnClick")})})}};i.default={name:"s_reload",method:g},t.exports=i.default},function(t,i,r){r.r(i),i.default=`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28">
    <path fill="#FFF" fill-opacity="1" fill-rule="nonzero" d="M18.17 19.988a7.182 7.182 0 0 1-4.256 1.318 7.806 7.806 0 0 1-.595-.03c-.08-.008-.16-.021-.242-.031a8.004 8.004 0 0 1-.458-.071c-.094-.018-.185-.042-.276-.063a7.743 7.743 0 0 1-.439-.113c-.068-.022-.136-.047-.205-.07a7.03 7.03 0 0 1-.492-.181c-.037-.015-.072-.032-.108-.049a7.295 7.295 0 0 1-.554-.269l-.025-.012a7.347 7.347 0 0 1-2.111-1.753c-.03-.036-.057-.074-.086-.11a7.305 7.305 0 0 1-1.594-4.557h1.686a.123.123 0 0 0 .108-.064.119.119 0 0 0-.006-.125L5.684 9.532a.123.123 0 0 0-.103-.056.123.123 0 0 0-.102.056l-2.834 4.276a.121.121 0 0 0-.005.125c.022.04.064.064.107.064h1.687c0 2.025.627 3.902 1.693 5.454.013.021.022.044.037.066.11.159.233.305.352.455.043.057.085.116.13.171.175.213.36.413.55.61.02.018.036.038.054.055a9.447 9.447 0 0 0 2.91 1.996c.058.026.115.054.175.079.202.084.41.158.619.228.098.034.196.069.296.1.183.054.37.1.558.145.125.029.249.06.376.085.052.01.102.027.155.035.177.032.355.05.533.071.064.007.128.018.19.026.32.03.639.052.956.052a9.46 9.46 0 0 0 5.47-1.746 1.16 1.16 0 0 0 .282-1.608 1.143 1.143 0 0 0-1.6-.283zm5.397-5.991a9.604 9.604 0 0 0-1.685-5.441c-.016-.027-.026-.054-.043-.078-.132-.19-.276-.366-.419-.543-.017-.022-.032-.044-.05-.065a9.467 9.467 0 0 0-3.571-2.7l-.114-.051a11.2 11.2 0 0 0-.673-.248c-.082-.027-.163-.057-.247-.082a9.188 9.188 0 0 0-.6-.156c-.113-.026-.224-.055-.337-.077-.057-.011-.109-.028-.164-.037-.151-.027-.304-.039-.455-.058-.104-.013-.208-.03-.313-.04a10.05 10.05 0 0 0-.759-.039c-.045 0-.09-.007-.136-.007l-.025.003a9.45 9.45 0 0 0-5.46 1.737 1.16 1.16 0 0 0-.284 1.608c.363.523 1.08.65 1.6.284a7.182 7.182 0 0 1 4.222-1.32c.217.002.429.013.639.033.065.007.129.017.193.025.173.021.344.046.513.08.075.014.149.033.221.05.166.037.331.077.494.127l.152.051c.185.061.366.127.545.201l.054.025a7.308 7.308 0 0 1 2.741 2.067l.013.018a7.302 7.302 0 0 1 1.652 4.633h-1.686a.123.123 0 0 0-.108.064.12.12 0 0 0 .006.124l2.834 4.277c.022.033.06.054.103.054.042 0 .08-.021.102-.054l2.833-4.277a.12.12 0 0 0 .005-.124.123.123 0 0 0-.108-.064h-1.685z"/>
</svg>
`},function(t,i,r){var n=r(156);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-reload{position:relative;-webkit-order:1;-moz-box-ordinal-group:2;order:1;display:block;width:40px;height:40px;cursor:pointer}.xgplayer-skin-default .xgplayer-reload .xgplayer-icon{margin-top:7px;width:26px}.xgplayer-skin-default .xgplayer-reload .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-reload .xgplayer-tips{margin-left:-22px}.xgplayer-skin-default .xgplayer-reload .xgplayer-tips .xgplayer-tip-reload{display:block}.xgplayer-skin-default .xgplayer-reload:hover{opacity:.85}.xgplayer-skin-default .xgplayer-reload:hover .xgplayer-tips{display:block}.xgplayer-lang-is-en .xgplayer-reload .xgplayer-tips{margin-left:-26px}.xgplayer-lang-is-jp .xgplayer-reload .xgplayer-tips{margin-left:-38px}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0);r(158);var u=function(){var c=this;if(!(!c.config.screenShot||c.config.screenShot.hideButton)){var g=c.lang.SCREENSHOT,v=(0,n.createDom)("xg-screenshot",'<p class="name"><span>'+(c.config.screenShot.iconText||g)+"</span></p>",{tabindex:11},"xgplayer-screenshot");c.once("ready",function(){c.controls.appendChild(v)}),["click","touchend"].forEach(function(p){v.addEventListener(p,function(e){e.preventDefault(),e.stopPropagation(),c.userGestureTrigEvent("screenShotBtnClick")})})}};i.default={name:"s_screenShot",method:u},t.exports=i.default},function(t,i,r){var n=r(159);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-screenshot{-webkit-order:11;-moz-box-ordinal-group:12;order:11;position:relative;outline:none;display:block;cursor:pointer;height:20px;top:10px}.xgplayer-skin-default .xgplayer-screenshot .name{text-align:center;font-family:PingFangSC-Regular;font-size:13px;line-height:20px;height:20px;color:hsla(0,0%,100%,.8)}.xgplayer-skin-default .xgplayer-screenshot .name span{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;padding:0 10px;height:20px;line-height:20px;background:rgba(0,0,0,.38);border-radius:10px;display:inline-block;vertical-align:middle}.xgplayer-lang-is-en .xgplayer-screenshot .name span,.xgplayer-lang-is-jp .xgplayer-screenshot .name span{width:75px;height:20px}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(9),u=o(n);r(78);function o(g){return g&&g.__esModule?g:{default:g}}var c=function(){if(!!this.config.nativeTextTrack){var v=this,p=v.root,e=u.default.util,s=e.createDom("xg-texttrack","",{tabindex:7},"xgplayer-texttrack"),l=v.config.nativeTextTrack;l&&Array.isArray(l)&&l.length>0&&(e.addClass(v.root,"xgplayer-is-texttrack"),v.once("canplay",function(){var f=this,d=["<ul>"];d.push("<li class='"+(this.textTrackShowDefault?"":"selected")+"'}'>"+v.lang.OFF+"</li>"),l.forEach(function(w){d.push("<li class='"+(w.default&&f.textTrackShowDefault?"selected":"")+"'>"+w.label+"</li>")});var y=v.lang.TEXTTRACK;d.push('</ul><p class="name">'+y+"</p>");var m=p.querySelector(".xgplayer-texttrack");if(m){m.innerHTML=d.join("");var _=m.querySelector(".name");(!v.config.textTrackActive||v.config.textTrackActive==="hover")&&_.addEventListener("mouseenter",function(w){w.preventDefault(),w.stopPropagation(),e.addClass(p,"xgplayer-texttrack-active"),m.focus()})}else{s.innerHTML=d.join("");var E=s.querySelector(".name");(!v.config.textTrackActive||v.config.textTrackActive==="hover")&&E.addEventListener("mouseenter",function(w){w.preventDefault(),w.stopPropagation(),e.addClass(v.root,"xgplayer-texttrack-active"),s.focus()}),v.controls.appendChild(s)}})),["touchend","click"].forEach(function(f){s.addEventListener(f,function(d){d.preventDefault(),d.stopPropagation();var y=d.target||d.srcElement;if(y&&y.tagName.toLocaleLowerCase()==="li"){Array.prototype.forEach.call(y.parentNode.childNodes,function(_){e.removeClass(_,"selected")}),e.addClass(y,"selected");var m=v.root.getElementsByTagName("Track");y.innerHTML===v.lang.OFF?(m[0].track.mode="hidden",m[0].src="",e.removeClass(v.root,"xgplayer-texttrack-active")):(m[0].style.display="block",e.addClass(v.root,"xgplayer-texttrack-active"),m[0].track.mode="showing",l.some(function(_){if(_.label===y.innerHTML)return m[0].src=_.src,_.kind&&(m[0].kind=_.kind),m[0].label=_.label,_.srclang&&(m[0].srclang=_.srclang),!0}),v.emit("textTrackChange",y.innerHTML))}else v.config.textTrackActive==="click"&&y&&(y.tagName.toLocaleLowerCase()==="p"||y.tagName.toLocaleLowerCase()==="em")&&(e.addClass(v.root,"xgplayer-texttrack-active"),s.focus())},!1)}),v.on("play",function(){var f=p.querySelector(".xgplayer-texttrack ul"),d=p.getElementsByTagName("Track");!v.hls||!f||!d||(d[0].src="",Array.prototype.forEach.call(f.childNodes,function(y){e.hasClass(y,"selected")&&(y.innerHTML===v.lang.OFF?(d[0].track.mode="hidden",d[0].src=""):(d[0].track.mode="hidden",l.some(function(m){if(m.label!==y.innerHTML)return d[0].src=m.src,m.kind&&(d[0].kind=m.kind),d[0].label=m.label,m.srclang&&(d[0].srclang=m.srclang),!0}),l.some(function(m){if(m.label===y.innerHTML)return setTimeout(function(){d[0].src=m.src,m.kind&&(d[0].kind=m.kind),d[0].label=m.label,m.srclang&&(d[0].srclang=m.srclang),d[0].track.mode="showing"}),!0})))}),e.removeClass(v.root,"xgplayer-texttrack-active"))}),s.addEventListener("mouseleave",function(f){f.preventDefault(),f.stopPropagation(),e.removeClass(v.root,"xgplayer-texttrack-active")})}};i.default={name:"s_nativeTextTrack",method:c},t.exports=i.default},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-texttrack{-webkit-order:7;-moz-box-ordinal-group:8;order:7;width:60px;height:150px;z-index:18;position:relative;outline:none;display:none;cursor:default;margin-top:-119px}.xgplayer-skin-default .xgplayer-texttrack ul{display:none;list-style:none;min-width:78px;background:rgba(0,0,0,.54);border-radius:1px;position:absolute;bottom:30px;text-align:center;white-space:nowrap;left:50%;-webkit-transform:translateX(-50%);-ms-transform:translateX(-50%);transform:translateX(-50%);width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;z-index:26;cursor:pointer}.xgplayer-skin-default .xgplayer-texttrack ul li{opacity:.7;font-family:PingFangSC-Regular;font-size:11px;color:hsla(0,0%,100%,.8);width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;margin:auto;padding:6px 13px}.xgplayer-skin-default .xgplayer-texttrack ul li.selected,.xgplayer-skin-default .xgplayer-texttrack ul li:hover{color:#fff;opacity:1}.xgplayer-skin-default .xgplayer-texttrack .name{text-align:center;font-family:PingFangSC-Regular;font-size:13px;cursor:pointer;color:hsla(0,0%,100%,.8);position:absolute;bottom:0;width:60px;height:20px;line-height:20px;background:rgba(0,0,0,.38);border-radius:10px;display:inline-block;vertical-align:middle}.xgplayer-skin-default .xgplayer-texttrack.xgplayer-texttrack-hide{display:none}xg-text-track{transition:bottom .3s ease}.xgplayer-skin-default.xgplayer-is-texttrack .xgplayer-texttrack,.xgplayer-skin-default.xgplayer-texttrack-active .xgplayer-texttrack ul{display:block}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0);r(78);function u(c,g,v,p){if(g.length===0){c.innerHTML="";return}var e=[];e.push('<li data-type="off" class="'+(p?"":"selected")+'">'+v+"</li>"),g.forEach(function(s){e.push("<li data-id="+s.id+" data-language="+s.language+' class="'+(s.isDefault&&p?"selected":"")+'">'+s.label+"</li>")}),c.innerHTML=e.join("")}var o=function(){var g=this;if(!this.config.textTrack)return;var v=this.config.textTrack,p=g.lang.TEXTTRACK,e=(0,n.createDom)("xg-texttrack",'<ul></ul><p class="name">'+p+"</p>",{tabindex:7},"xgplayer-texttrack");function s(){var f=g.root.querySelector(".xgplayer-texttrack");if(!f){g.controls.appendChild(e);var d=e.querySelector(".name");!g.config.textTrackActive||g.config.textTrackActive==="hover"?(d.addEventListener("mouseenter",function(m){m.preventDefault(),m.stopPropagation(),(0,n.addClass)(g.root,"xgplayer-texttrack-active"),e.focus()}),e.addEventListener("mouseleave",function(m){m.preventDefault(),m.stopPropagation(),(0,n.removeClass)(g.root,"xgplayer-texttrack-active")})):d.addEventListener("click",function(m){m.preventDefault(),m.stopPropagation(),(0,n.hasClass)(g.root,"xgplayer-texttrack-active")?(0,n.removeClass)(g.root,"xgplayer-texttrack-active"):(0,n.addClass)(g.root,"xgplayer-texttrack-active")})}["touchend","click"].forEach(function(m){e.addEventListener(m,function(_){_.preventDefault(),_.stopPropagation();var E=_.target||_.srcElement;if(E&&E.tagName.toLocaleLowerCase()==="li"){var w=E.getAttribute("data-id"),k=E.getAttribute("data-type"),x=E.getAttribute("data-language");Array.prototype.forEach.call(E.parentNode.childNodes,function(S){(0,n.removeClass)(S,"selected")}),(0,n.addClass)(E,"selected"),k==="off"?(g.switchOffSubtile(),(0,n.removeClass)(g.root,"xgplayer-texttrack-active")):(g.switchSubTitle({id:w,language:x}),(0,n.addClass)(g.root,"xgplayer-texttrack-active"))}})});var y=e.getElementsByTagName("ul")[0];u(y,v,g.lang.OFF,g.textTrackShowDefault),v.length===0?(0,n.addClass)(e,"xgplayer-texttrack-hide"):(0,n.removeClass)(e,"xgplayer-texttrack-hide")}var l=function(d){if(!!d.isListUpdate){var y=e.getElementsByTagName("ul")[0];v=d.list,u(y,d.list,g.lang.OFF,g.textTrackShowDefault),d.list.length>0?(0,n.addClass)(g.root,"xgplayer-is-texttrack"):(0,n.removeClass)(g.root,"xgplayer-is-texttrack"),d.list.length===0?(0,n.addClass)(e,"xgplayer-texttrack-hide"):(0,n.removeClass)(e,"xgplayer-texttrack-hide")}};v&&Array.isArray(v)&&(v.length>0&&(0,n.addClass)(g.root,"xgplayer-is-texttrack"),g.once("canplay",s),g.on("subtitle_change",l))};i.default={name:"s_textTrack",method:o},t.exports=i.default},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0);r(164);var u=function(){var c=this,g=c.root,v=(0,n.createDom)("xg-error",'<span class="xgplayer-error-text">\u8BF7<span class="xgplayer-error-refresh">\u5237\u65B0</span>\u8BD5\u8BD5</span>',{},"xgplayer-error");c.once("ready",function(){g.appendChild(v)});var p=v.querySelector(".xgplayer-error-text");c.config.lang&&c.config.lang==="zh-cn"?p.innerHTML=c.config.errorTips||'\u8BF7<span class="xgplayer-error-refresh">\u5237\u65B0</span>\u8BD5\u8BD5':p.innerHTML=c.config.errorTips||'please try to <span class="xgplayer-error-refresh">refresh</span>';var e=null;function s(){(0,n.addClass)(c.root,"xgplayer-is-error"),e=v.querySelector(".xgplayer-error-refresh"),e&&["touchend","click"].forEach(function(f){e.addEventListener(f,function(d){d.preventDefault(),d.stopPropagation(),c.autoplay=!0;var y=c.currentTime;c.once("playing",function(){c.currentTime=y,(0,n.removeClass)(c.root,"xgplayer-is-error")}),c.src=c.config.url})})}c.on("error",s);function l(){c.off("error",s),c.off("destroy",l)}c.once("destroy",l)};i.default={name:"s_error",method:u},t.exports=i.default},function(t,i,r){var n=r(165);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-error{background:#000;display:none;position:absolute;left:0;top:0;width:100%;height:100%;z-index:125;font-family:PingFangSC-Regular;font-size:14px;color:#fff;text-align:center;line-height:100%;-webkit-justify-content:center;-moz-box-pack:center;justify-content:center;-webkit-align-items:center;-moz-box-align:center;align-items:center}.xgplayer-skin-default .xgplayer-error .xgplayer-error-refresh{color:#fa1f41;padding:0 3px;cursor:pointer}.xgplayer-skin-default .xgplayer-error .xgplayer-error-text{line-height:18px;margin:auto 6px}.xgplayer-skin-default.xgplayer-is-error .xgplayer-error{display:-webkit-flex;display:-moz-box;display:flex}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0);r(167);var u=function(){var c=this,g=c.config.lastPlayTime||0,v=c.config.lastPlayTimeHideDelay||0,p=null;if(!(g<=0)){p=(0,n.createDom)("xg-memoryplay",'<div class="xgplayer-memoryplay-spot"><div class="xgplayer-progress-tip">\u60A8\u4E0A\u6B21\u89C2\u770B\u5230 <span class="xgplayer-lasttime">'+(0,n.format)(g)+'</span> \uFF0C\u4E3A\u60A8\u81EA\u52A8\u7EED\u64AD <span class="btn-close"><svg viewBox="64 64 896 896" focusable="false" class="" data-icon="close" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8 295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512 196.9 824.9A7.95 7.95 0 0 0 203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1 216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z"></path></svg></span></div></div>',{},"xgplayer-memoryplay"),p.addEventListener("mouseover",function(l){l.stopPropagation()});var e=function(){p&&p.parentNode&&p.parentNode.removeChild(p),p=null};p.querySelector(".xgplayer-progress-tip .btn-close").addEventListener("click",e);var s=function(){v>0&&c.root.appendChild(p),c.emit("memoryPlayStart",g),v>0&&setTimeout(function(){e()},v*1e3)};c.once("playing",s),c.once("ended",e)}};i.default={name:"s_memoryPlay",method:u},t.exports=i.default},function(t,i,r){var n=r(168);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-memoryplay-spot{position:absolute;height:32px;left:10px;bottom:46px;background:rgba(0,0,0,.5);border-radius:32px;line-height:32px;color:#ddd;z-index:15;padding:0 32px 0 16px}.xgplayer-skin-default .xgplayer-memoryplay-spot .xgplayer-lasttime{color:red;font-weight:700}.xgplayer-skin-default .xgplayer-memoryplay-spot .btn-close{position:absolute;width:16px;height:16px;right:10px;top:2px;cursor:pointer;color:#fff;font-size:16px}",""])},function(t,i,r){Object.defineProperty(i,"__esModule",{value:!0});var n=r(0),u=r(170),o=c(u);r(171);function c(v){return v&&v.__esModule?v:{default:v}}var g=function(){var p=this;if(!(!p.config.airplay||!window.WebKitPlaybackTargetAvailabilityEvent)){var e=(0,n.createDom)("xg-airplay",`<xg-icon class="xgplayer-icon">
    <div class="xgplayer-icon-airplay">`+o.default+`</div>
  </xg-icon>`,{},"xgplayer-airplay"),s=(0,n.createDom)("xg-tips",'<span class="xgplayer-tip-airplay">'+p.lang.AIRPLAY_TIPS+"</span>",{},"xgplayer-tips");e.appendChild(s),p.once("ready",function(){p.controls.appendChild(e),p.video.addEventListener("webkitplaybacktargetavailabilitychanged",function(l){switch(l.availability){case"available":e.hidden=!1,e.disabled=!1;break;case"not-available":e.hidden=!0,e.disabled=!0;break}})}),["click","touchend"].forEach(function(l){e.addEventListener(l,function(f){f.preventDefault(),f.stopPropagation(),p.userGestureTrigEvent("airplayBtnClick")})})}};i.default={name:"s_airplay",method:g},t.exports=i.default},function(t,i,r){r.r(i),i.default='<svg t="1600422191774" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3100" width="28" height="28"><path d="M256 938.666667h512L512 597.333333 256 938.666667z m170.666667-85.333334l85.333333-113.781333L597.333333 853.333333H426.666667zM853.333333 85.333333H170.666667C99.946667 85.333333 42.666667 142.613333 42.666667 213.333333v426.666667c0 70.72 57.28 128 128 128h106.666666l64-85.333333H170.666667c-23.573333 0-42.666667-19.093333-42.666667-42.666667V213.333333c0-23.573333 19.093333-42.666667 42.666667-42.666666h682.666666c23.573333 0 42.666667 19.093333 42.666667 42.666666v426.666667c0 23.573333-19.093333 42.666667-42.666667 42.666667H682.666667l64 85.333333h106.666666c70.72 0 128-57.28 128-128V213.333333c0-70.72-57.28-128-128-128z" p-id="3101" fill="#ffffff"></path></svg>'},function(t,i,r){var n=r(172);typeof n=="string"&&(n=[[t.i,n,""]]);var u,o={hmr:!0};o.transform=u,o.insertInto=void 0,r(2)(n,o),n.locals&&(t.exports=n.locals)},function(t,i,r){i=t.exports=r(1)(!1),i.push([t.i,".xgplayer-skin-default .xgplayer-airplay{position:relative;-webkit-order:11;-moz-box-ordinal-group:12;order:11;display:block;cursor:pointer;margin-left:5px;margin-right:3px}.xgplayer-skin-default .xgplayer-airplay .xgplayer-icon{margin-top:6px;margin-left:6px}.xgplayer-skin-default .xgplayer-airplay .xgplayer-icon div{position:absolute}.xgplayer-skin-default .xgplayer-airplay .xgplayer-icon .xgplayer-icon-airplay{display:block}.xgplayer-skin-default .xgplayer-airplay .xgplayer-tips{position:absolute;right:0;left:auto}.xgplayer-skin-default .xgplayer-airplay .xgplayer-tips .xgplayer-tip-airplay{display:block}.xgplayer-skin-default .xgplayer-airplay:hover{opacity:.85}.xgplayer-skin-default .xgplayer-airplay:hover .xgplayer-tips{display:block}",""])}])})})(yo);var Ct=qu(yo.exports),mo={VISIBILITY_CHANGE:"VISIBILITY_CHANGE"},_o={SEEK:"SEEK"},xo={LADER_START:"LOADER_START",LOADER_DATALOADED:"LOADER_DATALOADED",LOADER_COMPLETE:"LOADER_COMPLETE",LOADER_RESPONSE_HEADERS:"LOADER_RESPONSE_HEADERS",LOADER_ERROR:"LOADER_ERROR",LOADER_RETRY:"LOADER_RETRY",LOADER_TTFB:"LOADER_TTFB"},Eo={DEMUX_START:"DEMUX_START",DEMUX_COMPLETE:"DEMUX_COMPLETE",DEMUX_ERROR:"DEMUX_ERROR",METADATA_PARSED:"METADATA_PARSED",SEI_PARSED:"SEI_PARSED",VIDEO_METADATA_CHANGE:"VIDEO_METADATA_CHANGE",AUDIO_METADATA_CHANGE:"AUDIO_METADATA_CHANGE",MEDIA_INFO:"MEDIA_INFO",ISKEYFRAME:"ISKEYFRAME"},bo={REMUX_METADATA:"REMUX_METADATA",REMUX_MEDIA:"REMUX_MEDIA",MEDIA_SEGMENT:"MEDIA_SEGMENT",REMUX_ERROR:"REMUX_ERROR",INIT_SEGMENT:"INIT_SEGMENT",DETECT_CHANGE_STREAM:"DETECT_CHANGE_STREAM",DETECT_CHANGE_STREAM_DISCONTINUE:"DETECT_CHANGE_STREAM_DISCONTINUE",DETECT_AUDIO_GAP:"DETECT_AUDIO_GAP",DETECT_LARGE_GAP:"DETECT_LARGE_GAP",DETECT_AUDIO_OVERLAP:"DETECT_AUDIO_OVERLAP",RANDOM_ACCESS_POINT:"RANDOM_ACCESS_POINT",DETECT_FRAG_ID_DISCONTINUE:"DETECT_FRAG_ID_DISCONTINUE"},wo={SOURCE_UPDATE_END:"SOURCE_UPDATE_END",MSE_ERROR:"MSE_ERROR",MSE_WRONG_TRACK_ADD:"MSE_WRONG_TRACK_ADD"},To={RETRY_TIME_EXCEEDED:"RETRY_TIME_EXCEEDED"},Ff={START_DECRYPTOO:"START_DECRYPTO",DECRYPTED:"DECRYPTED"},Ar=Object.assign({},xo,Eo,bo,wo,To,_o,mo),So=[],ko=[];for(var Ao in Ar)Ar.hasOwnProperty(Ao)&&So.push(Ar[Ao]);for(var Co in Ar)Ar.hasOwnProperty(Co)&&ko.push(Ar[Co]);var Mt={ALLEVENTS:Ar,HLS_EVENTS:To,REMUX_EVENTS:bo,DEMUX_EVENTS:Eo,MSE_EVENTS:wo,LOADER_EVENTS:xo,FlvAllowedEvents:So,HlsAllowedEvents:ko,CRYPTO_EVENTS:Ff,PLAYER_EVENTS:_o,BROWSER_EVENTS:mo},Bf=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Of(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var If=function(){function h(a){Of(this,h),this._baseURL="",this._list={},this._ts={},this.version=0,this.sequence=-1,this.targetduration=0,this.duration=0,this.fragLength=0,this._lastget=void 0,this.end=!1,this.autoclear=a.autoclear||!1,this.logger=a.logger,this.downloadedUrls=[],this._avgSegmentDuration=4}return Bf(h,[{key:"push",value:function(t,i,r,n,u,o){this._ts[t]||(this._ts[t]={duration:i,downloaded:!1,downloading:!1,start:this.duration,discontinue:!!r,id:n,cc:u,isLast:o||!1},this._list[this.duration]=t,this.duration+=i,this.fragLength+=1)}},{key:"deleteFrag",value:function(t){this._ts[t]&&(this._ts[t].start>this._lastget.time&&(this._lastget={duration:this._ts[t].duration,time:this._ts[t].start,downloaded:!1,downloading:!1,url:t,id:this._ts[t].id}),delete this._list[this._ts[t].start],delete this._ts[t],this.fragLength-=1)}},{key:"_calcAvgFrgmentDuration",value:function(t){if(!t.frags)return t.targetduration;var i=t.frags.length;return Math.floor(t.duration/i/1e3)}},{key:"pushM3U8",value:function(t,i){if(!t)throw new Error("No m3u8 data received.");if(this.version=t.version,this.targetduration=t.targetduration,this._avgSegmentDuration=Math.min(this.targetduration,this._calcAvgFrgmentDuration(t)),t.encrypt&&!this.encrypt&&(this.encrypt=t.encrypt),this.end=t.end||!1,t.sequence||(t.sequence=0),t.sequence>this.sequence){var r=t.frags.length;this.logger&&this.logger.log("PLAYLIST","new playlist ["+t.sequence+", "+(t.sequence+r-1)+"]"),this.sequence=t.sequence;for(var n=[],u=0;u<r;u++){var o=t.frags[u];!this._ts[o.url]&&this.downloadedUrls.indexOf(o.url)<0&&(n.push(o.url),this.push(o.url,o.duration,o.discontinue,o.id,o.cc,o.isLast))}if(n.length<1)throw new Error("Can not read ts file list.");if(i)for(var c=this.getTsList(),g=0;g<c.length;g++)n.indexOf(c[g])<0&&this.deleteFrag(c[g])}else throw new Error("Old m3u8 file received, "+t.sequence)}},{key:"getTsList",value:function(){return Object.keys(this._ts)}},{key:"downloaded",value:function(t,i){var r=this._ts[t];r&&(r.downloaded=i)}},{key:"downloading",value:function(t,i){var r=this._ts[t];r&&(r.downloading=i)}},{key:"getTsByName",value:function(t){return this._ts[t]}},{key:"getTs",value:function(t){var i=Object.keys(this._list),r=void 0;if(t===void 0&&(this._lastget?t=this._lastget.time+this._lastget.duration:t=0),!(i.length<1||t>=this.duration)){i=i.sort(function(g,v){return parseFloat(g)-parseFloat(v)});for(var n=0;n<i.length&&t>=parseInt(i[n]);n++){var u=this._list[i[n]],o=this._ts[u].downloaded,c=this._ts[u].downloading;r={url:u,downloaded:o,downloading:c,time:parseInt(i[n]),duration:parseInt(this._ts[u].duration),id:this._ts[u].id,cc:this._ts[u].cc,isLast:this._ts[u].isLast},this.autoclear&&this._lastget&&(delete this._ts[this._lastget.url],delete this._list[this._lastget.time]),this._lastget=r}return r&&this.downloadedUrls.push(r.url),r}}},{key:"getLastDownloadedTs",value:function(){for(var t=Object.keys(this._list).sort(function(c,g){var v=Number(c)-Number(g);return v}),i=void 0,r=0;r<t.length;r++){var n=this._list[t[r]],u=this._ts[n].downloaded,o=this._ts[n].downloading;if(u)i={url:n,downloaded:u,downloading:o,time:parseInt(t[r]),duration:parseInt(this._ts[n].duration)};else break}return i}},{key:"clear",value:function(){this._baseURL="",this._list={},this._ts={},this.version=0,this.sequence=-1,this.targetduration=0,this.duration=0}},{key:"clearDownloaded",value:function(){for(var t=Object.keys(this._ts),i=0,r=t.length;i<r;i++){var n=this._ts[t[i]];n.downloaded=!1,n.downloading=!1}}},{key:"destroy",value:function(){this._baseURL="",this._list={},this._ts={},this.version=0,this.sequence=-1,this.targetduration=0,this.duration=0,this.fragLength=0,this._lastget=void 0,this.autoclear=!1}},{key:"resetSequence",value:function(){this.sequence=-1}},{key:"list",get:function(){return this._list}},{key:"baseURL",set:function(t){this.baseURL!==t&&(this.clear(),this._baseURL=t)},get:function(){return this._baseURL}},{key:"avgSegmentDuration",get:function(){return this._avgSegmentDuration}}]),h}(),Na=If,Mf=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Do(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Nf=function h(){Do(this,h),this.mimetype="",this.init=null,this.data=[],this.bufferDuration=0},zf=function(){function h(){Do(this,h),this.sources={}}return Mf(h,[{key:"getSource",value:function(t){return this.sources[t]}},{key:"createSource",value:function(t){return this.sources[t]=new Nf,this.sources[t]}},{key:"clear",value:function(){this.sources={}}},{key:"destroy",value:function(){this.clear()}}]),h}(),Ro=zf,Vf=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Hf(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var jf=function(){function h(a){if(Hf(this,h),a instanceof ArrayBuffer)this.buffer=a,this.dataview=new DataView(a),this.dataview.position=0;else throw new Error("data is invalid")}return Vf(h,[{key:"back",value:function(t){this.position-=t}},{key:"getUint8",value:function(t){return this.dataview.getUint8(t)}},{key:"skip",value:function(t){for(var i=Math.floor(t/4),r=t%4,n=0;n<i;n++)h.readByte(this.dataview,4);r>0&&h.readByte(this.dataview,r)}},{key:"readUint8",value:function(){return h.readByte(this.dataview,1)}},{key:"readUint16",value:function(){return h.readByte(this.dataview,2)}},{key:"readUint24",value:function(){return h.readByte(this.dataview,3)}},{key:"readUint32",value:function(){return h.readByte(this.dataview,4)}},{key:"readUint64",value:function(){return h.readByte(this.dataview,8)}},{key:"readInt8",value:function(){return h.readByte(this.dataview,1,!0)}},{key:"readInt16",value:function(){return h.readByte(this.dataview,2,!0)}},{key:"readInt32",value:function(){return h.readByte(this.dataview,4,!0)}},{key:"writeUint32",value:function(t){return new Uint8Array([t>>>24&255,t>>>16&255,t>>>8&255,t&255])}},{key:"length",get:function(){return this.buffer.byteLength}},{key:"position",set:function(t){this.dataview.position=t},get:function(){return this.dataview.position}}],[{key:"readByte",value:function(t,i,r){var n=void 0;switch(i){case 1:r?n=t.getInt8(t.position):n=t.getUint8(t.position);break;case 2:r?n=t.getInt16(t.position):n=t.getUint16(t.position);break;case 3:if(r)throw new Error("not supported for readByte 3");n=t.getUint8(t.position)<<16,n|=t.getUint8(t.position+1)<<8,n|=t.getUint8(t.position+2);break;case 4:r?n=t.getInt32(t.position):n=t.getUint32(t.position);break;case 8:if(r)throw new Error("not supported for readBody 8");n=t.getUint32(t.position)<<32,n|=t.getUint32(t.position+4);break;default:n=""}return t.position+=i,n}}]),h}(),_n=jf,za=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Uo(h,a){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:h}function Lo(h,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);h.prototype=Object.create(a&&a.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(h,a):h.__proto__=a)}function Jn(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Va=function(){function h(){Jn(this,h),this.id=-1,this.sequenceNumber=0,this.samples=[],this.droppedSamples=[],this.length=0}return za(h,[{key:"reset",value:function(){this.sequenceNumber=0,this.samples=[],this.length=0}},{key:"destroy",value:function(){this.reset(),this.id=-1}}]),h}(),Ha=Va,Gf=function(h){Lo(a,h);function a(){Jn(this,a);var t=Uo(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return t.TAG="AudioTrack",t.type="audio",t}return a}(Va),$f=function(h){Lo(a,h);function a(){Jn(this,a);var t=Uo(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return t.TAG="VideoTrack",t.type="video",t.dropped=0,t.sequenceNumber=0,t}return za(a,[{key:"reset",value:function(){this.sequenceNumber=0,this.samples=[],this.length=0,this.dropped=0}}]),a}(Va);(function(){function h(){Jn(this,h),this.audioTrack=null,this.videoTrack=null}return za(h,[{key:"destroy",value:function(){this.audioTrack=null,this.videoTrack=null}}]),h})();var Wf=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Yf(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Xf=function(){function h(a){Yf(this,h),this.length=a||0,this.historyLen=a||0,this.array=[],this.offset=0}return Wf(h,[{key:"push",value:function(t){this.array.push(t),this.length+=t.byteLength,this.historyLen+=t.byteLength}},{key:"shift",value:function(t){if(this.array.length<1)return new Uint8Array(0);if(t===void 0)return this._shiftBuffer();if(this.offset+t===this.array[0].length){var i=this.array[0].slice(this.offset,this.offset+t);return this.offset=0,this.array.shift(),this.length-=t,i}if(this.offset+t<this.array[0].length){var r=this.array[0].slice(this.offset,this.offset+t);return this.offset+=t,this.length-=t,r}for(var n=new Uint8Array(t),u=0;this.array.length>0&&t>0;)if(this.offset+t<this.array[0].length){var o=this.array[0].slice(this.offset,this.offset+t);n.set(o,u),this.offset+=t,this.length-=t,t=0;break}else{var c=this.array[0].length-this.offset;n.set(this.array[0].slice(this.offset,this.array[0].length),u),this.array.shift(),this.offset=0,u+=c,this.length-=c,t-=c}return n}},{key:"clear",value:function(){this.array=[],this.length=0,this.offset=0}},{key:"destroy",value:function(){this.clear(),this.historyLen=0}},{key:"_shiftBuffer",value:function(){return this.length-=this.array[0].length,this.offset=0,this.array.shift()}},{key:"toInt",value:function(t,i){for(var r=0,n=this.offset+t;n<this.offset+i+t;)n<this.array[0].length?r=r*256+this.array[0][n]:this.array[1]&&(r=r*256+this.array[1][n-this.array[0].length]),n++;return r}}]),h}(),Yr=Xf,Po=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Fo(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Kf=function(){function h(a){Fo(this,h);var t={sampleRate:48e3,channelCount:2,codec:"mp4a.40.2",config:[41,401,136,0],duration:0,id:2,refSampleDuration:21,sampleRateIndex:3,timescale:1e3,type:"audio"};return a?Object.assign({},t,a):t}return Po(h,[{key:"destroy",value:function(){this.init=null}}]),h}(),Bo=function(){function h(a){Fo(this,h);var t={avcc:null,sps:new Uint8Array(0),pps:new Uint8Array(0),chromaFormat:420,codec:"avc1.640020",codecHeight:720,codecWidth:1280,duration:0,frameRate:{fixed:!0,fps:25,fps_num:25e3,fps_den:1e3},id:1,level:"3.2",presentHeight:720,presentWidth:1280,profile:"High",refSampleDuration:40,parRatio:{height:1,width:1},timescale:1e3,type:"video"};return a?Object.assign({},t,a):t}return Po(h,[{key:"destroy",value:function(){this.init=null,this.sps=null,this.pps=null}}]),h}(),Oo=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Io(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var qf=function(){function h(a){Io(this,h);var t=h.getDefault();return a?Object.assign({},t,a):t}return Oo(h,null,[{key:"getDefault",value:function(){return{dts:-1,pts:-1,originDts:-1,data:new Uint8Array}}}]),h}(),Mo=function(){function h(a){Io(this,h);var t=h.getDefault();if(!a)return t;var i=Object.assign({},t,a);return i}return Oo(h,null,[{key:"getDefault",value:function(){return{dts:-1,pts:void 0,isKeyframe:!1,originDts:-1,data:new Uint8Array,nals:[]}}}]),h}(),Zf=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Jf(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var ja=function(a){for(var t in a)if(a.hasOwnProperty(t)&&a[t]===null)return!1;return!0},Qf=function(){function h(){Jf(this,h),this.mimeType=null,this.duration=null,this.hasVideo=!1,this.video={codec:null,width:null,height:null,profile:null,level:null,frameRate:{fixed:!0,fps:25,fps_num:25e3,fps_den:1e3},chromaFormat:null,parRatio:{width:1,height:1}},this.hasAudio=!1,this.audio={codec:null,sampleRate:null,sampleRateIndex:null,channelCount:null}}return Zf(h,[{key:"isComplete",value:function(){return h.isBaseInfoReady(this)&&h.isVideoReady(this)&&h.isAudioReady(this)}}],[{key:"isBaseInfoReady",value:function(t){return ja(t)}},{key:"isVideoReady",value:function(t){return t.hasVideo?ja(t.video):!0}},{key:"isAudioReady",value:function(t){return t.hasAudio?ja(t.video):!0}}]),h}(),No=Qf,ec=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function tc(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var ic=function(){ec(h,null,[{key:"getDefault",value:function(){return{id:-1,url:"",start:-1,duration:-1,discontinue:!1,cc:-1}}}]);function h(a){tc(this,h);var t=Object.assign({},h.getDefault(),a);this.id=t.id,this.url=t.url,this.start=t.start,this.duration=t.duration,this.discontinue=t.discontinue,this.cc=t.cc}return h}(),rc=ic,zo={exports:{}};(function(h){var a=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function r(c,g,v){this.fn=c,this.context=g,this.once=v||!1}function n(c,g,v,p,e){if(typeof v!="function")throw new TypeError("The listener must be a function");var s=new r(v,p||c,e),l=t?t+g:g;return c._events[l]?c._events[l].fn?c._events[l]=[c._events[l],s]:c._events[l].push(s):(c._events[l]=s,c._eventsCount++),c}function u(c,g){--c._eventsCount==0?c._events=new i:delete c._events[g]}function o(){this._events=new i,this._eventsCount=0}o.prototype.eventNames=function(){var g=[],v,p;if(this._eventsCount===0)return g;for(p in v=this._events)a.call(v,p)&&g.push(t?p.slice(1):p);return Object.getOwnPropertySymbols?g.concat(Object.getOwnPropertySymbols(v)):g},o.prototype.listeners=function(g){var v=t?t+g:g,p=this._events[v];if(!p)return[];if(p.fn)return[p.fn];for(var e=0,s=p.length,l=new Array(s);e<s;e++)l[e]=p[e].fn;return l},o.prototype.listenerCount=function(g){var v=t?t+g:g,p=this._events[v];return p?p.fn?1:p.length:0},o.prototype.emit=function(g,v,p,e,s,l){var f=t?t+g:g;if(!this._events[f])return!1;var d=this._events[f],y=arguments.length,m,_;if(d.fn){switch(d.once&&this.removeListener(g,d.fn,void 0,!0),y){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,v),!0;case 3:return d.fn.call(d.context,v,p),!0;case 4:return d.fn.call(d.context,v,p,e),!0;case 5:return d.fn.call(d.context,v,p,e,s),!0;case 6:return d.fn.call(d.context,v,p,e,s,l),!0}for(_=1,m=new Array(y-1);_<y;_++)m[_-1]=arguments[_];d.fn.apply(d.context,m)}else{var E=d.length,w;for(_=0;_<E;_++)switch(d[_].once&&this.removeListener(g,d[_].fn,void 0,!0),y){case 1:d[_].fn.call(d[_].context);break;case 2:d[_].fn.call(d[_].context,v);break;case 3:d[_].fn.call(d[_].context,v,p);break;case 4:d[_].fn.call(d[_].context,v,p,e);break;default:if(!m)for(w=1,m=new Array(y-1);w<y;w++)m[w-1]=arguments[w];d[_].fn.apply(d[_].context,m)}}return!0},o.prototype.on=function(g,v,p){return n(this,g,v,p,!1)},o.prototype.once=function(g,v,p){return n(this,g,v,p,!0)},o.prototype.removeListener=function(g,v,p,e){var s=t?t+g:g;if(!this._events[s])return this;if(!v)return u(this,s),this;var l=this._events[s];if(l.fn)l.fn===v&&(!e||l.once)&&(!p||l.context===p)&&u(this,s);else{for(var f=0,d=[],y=l.length;f<y;f++)(l[f].fn!==v||e&&!l[f].once||p&&l[f].context!==p)&&d.push(l[f]);d.length?this._events[s]=d.length===1?d[0]:d:u(this,s)}return this},o.prototype.removeAllListeners=function(g){var v;return g?(v=t?t+g:g,this._events[v]&&u(this,v)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=t,o.EventEmitter=o,h.exports=o})(zo);var Qn=zo.exports,Vo=function h(a,t,i){a===null&&(a=Function.prototype);var r=Object.getOwnPropertyDescriptor(a,t);if(r===void 0){var n=Object.getPrototypeOf(a);return n===null?void 0:h(n,t,i)}else{if("value"in r)return r.value;var u=r.get;return u===void 0?void 0:u.call(i)}},Ho=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function nc(h,a){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:h}function ac(h,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);h.prototype=Object.create(a&&a.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(h,a):h.__proto__=a)}function jo(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var xn="__TO__",sc=function(){function h(a,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];jo(this,h),this._emitter=new Qn,this._emitter.off||(this._emitter.off=this._emitter.removeListener),this.mediaInfo=new No,this._instanceMap={},this._clsMap={},this._inited=!1,this.allowedEvents=i,this._configs=t,this._player=a,this._hooks={}}return Ho(h,[{key:"getInstance",value:function(t){var i=this._instanceMap[t];return i||null}},{key:"initInstance",value:function(t){for(var i=arguments.length,r=Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];var u=r[0],o=r[1],c=r[2],g=r[3];if(this._clsMap[t]){var v=new this._clsMap[t](u,o,c,g);return this._instanceMap[t]=v,v.init&&v.init(),v}else throw new Error(t+"\u672A\u5728context\u4E2D\u6CE8\u518C")}},{key:"init",value:function(t){if(!this._inited){for(var i in this._clsMap)this._clsMap.hasOwnProperty(i)&&!this._instanceMap[i]&&this.initInstance(i,t);this._inited=!0}}},{key:"registry",value:function(t,i){var r=this,n=this._emitter,u=this._isMessageNameValid.bind(this),o=this,c=function(g){ac(v,g);function v(p,e,s){jo(this,v);var l=nc(this,(v.__proto__||Object.getPrototypeOf(v)).call(this,p,e,s));return l.listeners={},l.onceListeners={},l.TAG=t,l._context=o,l}return Ho(v,[{key:"on",value:function(e,s){return u(e),this.listeners[e]?this.listeners[e].push(s):this.listeners[e]=[s],n.on(""+e+xn+t,s),n.on(e,s)}},{key:"before",value:function(e,s){u(e),o._hooks[e]?o._hooks[e].push(s):o._hooks[e]=[s]}},{key:"once",value:function(e,s){return u(e),this.onceListeners[e]?this.onceListeners[e].push(s):this.onceListeners[e]=[s],n.once(""+e+xn+t,s),n.once(e,s)}},{key:"emit",value:function(e){u(e);for(var s=o._hooks?o._hooks[e]:null,l=arguments.length,f=Array(l>1?l-1:0),d=1;d<l;d++)f[d-1]=arguments[d];if(s)for(var y=0,m=s.length;y<m;y++){var _=s[y];_.apply(void 0,f)}return n.emit.apply(n,[e].concat(f))}},{key:"emitTo",value:function(e,s){u(s);for(var l=arguments.length,f=Array(l>2?l-2:0),d=2;d<l;d++)f[d-2]=arguments[d];return n.emit.apply(n,[""+s+xn+e].concat(f))}},{key:"off",value:function(e,s){return u(e),n.off(e,s)}},{key:"removeListeners",value:function(){var e=Object.prototype.hasOwnProperty.bind(this.listeners);for(var s in this.listeners)if(e(s))for(var l=this.listeners[s]||[],f=0;f<l.length;f++){var d=l[f];n.off(s,d),n.off(""+s+xn+t,d)}for(var y in this.onceListeners)if(e(y))for(var m=this.onceListeners[y]||[],_=0;_<m.length;_++){var E=m[_];n.off(y,E),n.off(""+y+xn+t,E)}}},{key:"destroy",value:function(){if(this.removeListeners(),this.listeners={},delete o._instanceMap[t],Vo(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"destroy",this))return Vo(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"destroy",this).call(this);this._context=null}},{key:"_player",get:function(){return this._context?this._context._player:null},set:function(e){this._context&&(this._context._player=e)}},{key:"_pluginConfig",get:function(){return this._context?this._context._configs:null}}]),v}(i);return this._clsMap[t]=c,function(){for(var g=arguments.length,v=Array(g),p=0;p<g;p++)v[p]=arguments[p];return r.initInstance.apply(r,[t].concat(v))}}},{key:"seek",value:function(t){this._emitter.emit(Mt.PLAYER_EVENTS.SEEK,t)}},{key:"destroyInstances",value:function(){var t=this;Object.keys(this._instanceMap).forEach(function(i){t._instanceMap[i].destroy&&t._instanceMap[i].destroy()})}},{key:"destroy",value:function(){this.destroyInstances(),this._emitter&&this._emitter.removeAllListeners(),this._emitter=null,this.allowedEvents=[],this._clsMap=null,this._hooks=null,this._player=null,this._configs=null}},{key:"_isMessageNameValid",value:function(t){if(!this.allowedEvents.indexOf(t)<0)throw new Error("unregistered message name: "+t)}}]),h}(),Ga=sc,oc=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function lc(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Go=Mt.CRYPTO_EVENTS,uc=function(){function h(a){lc(this,h),this.inputBuffer=a.inputbuffer,this.outputBuffer=a.outputbuffer,this.key=a.key,this.iv=a.iv,this.method=a.method,this.crypto=window.crypto||window.msCrypto}return oc(h,[{key:"init",value:function(){this.on(Go.START_DECRYPTO,this.decrypto.bind(this))}},{key:"decrypto",value:function(){var t=this;if(this.aeskey)this.decryptoData();else{var i=this.crypto.subtle.importKey("raw",this.key.buffer,{name:"AES-CBC"},!1,["encrypt","decrypt"]);i.then(function(r){t.aeskey=r,t.decryptoData()})}}},{key:"decryptoData",value:function(){var t=this,i=this._context.getInstance(this.inputBuffer),r=this._context.getInstance(this.outputBuffer),n=i.shift();n&&this.crypto.subtle.decrypt({name:"AES-CBC",iv:this.iv.buffer},this.aeskey,n).then(function(u){r.push(new Uint8Array(u)),t.emit(Go.DECRYPTED),t.decryptoData(n)})}}]),h}(),$a=uc,fc=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function cc(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Wa=Mt.MSE_EVENTS,dc=function(){function h(a,t){cc(this,h),t&&(this._context=t,this.emit=t._emitter.emit.bind(t._emitter)),this.TAG="MSE",this.configs=Object.assign({},a),this.container=this.configs.container,this.format=this.configs.format,this.mediaSource=null,this.sourceBuffers={},this.preloadTime=this.configs.preloadTime||1,this.onSourceOpen=this.onSourceOpen.bind(this),this.onTimeUpdate=this.onTimeUpdate.bind(this),this.onUpdateEnd=this.onUpdateEnd.bind(this),this.onWaiting=this.onWaiting.bind(this),this.opened=!1}return fc(h,[{key:"init",value:function(){this.mediaSource=new self.MediaSource,this.mediaSource.addEventListener("sourceopen",this.onSourceOpen),this._url=null,this.container.addEventListener("timeupdate",this.onTimeUpdate),this.container.addEventListener("waiting",this.onWaiting)}},{key:"resetContext",value:function(t,i){if(this._context=t,this.emit=t._emitter.emit.bind(t._emitter),!i)for(var r=0;r<Object.keys(this.sourceBuffers).length;r++){var n=this.sourceBuffers[Object.keys(this.sourceBuffers)[r]];n.updating||h.clearBuffer(n)}}},{key:"onTimeUpdate",value:function(){this.emit("TIME_UPDATE",this.container)}},{key:"onWaiting",value:function(){this.emit("WAITING",this.container)}},{key:"onSourceOpen",value:function(){this.opened=!0,this.addSourceBuffers()}},{key:"onUpdateEnd",value:function(){this.emit(Wa.SOURCE_UPDATE_END),this.doAppend()}},{key:"addSourceBuffers",value:function(){if(!(!this.mediaSource||this.mediaSource.readyState!=="open"||!this.opened)){var t=this._context.getInstance("PRE_SOURCE_BUFFER"),i=this._context.getInstance("TRACKS"),r=void 0;if(!(!t||!i)){t=t.sources;for(var n=!1,u=0,o=Object.keys(t).length;u<o;u++){var c=Object.keys(t)[u];n=!1,c==="audio"?r=i.audioTrack:c==="video"&&(r=i.videoTrack),r&&t[c].init!==null&&t[c].data.length&&(n=!0)}if(n){if(Object.keys(this.sourceBuffers).length>1)return;for(var g=0,v=Object.keys(t).length;g<v;g++){var p=Object.keys(t)[g];if(!this.sourceBuffers[p]){var e=t[p],s=p==="video"?"video/mp4;codecs="+e.mimetype:"audio/mp4;codecs="+e.mimetype;try{var l=this.mediaSource.addSourceBuffer(s);this.sourceBuffers[p]=l,l.addEventListener("updateend",this.onUpdateEnd)}catch(f){if(f.code===22&&Object.keys(this.sourceBuffers).length>0)return this.emit(Wa.MSE_WRONG_TRACK_ADD,p);this.emit(Wa.MSE_ERROR,this.TAG,new Error(f.message))}}}Object.keys(this.sourceBuffers).length===this.sourceBufferLen&&this.doAppend()}}}}},{key:"doAppend",value:function(){if(!(!this.mediaSource||this.mediaSource.readyState==="closed")){this._doCleanupSourceBuffer();var t=this._context.getInstance("PRE_SOURCE_BUFFER");if(!!t&&!(Object.keys(this.sourceBuffers).length<this.sourceBufferLen))for(var i=0;i<Object.keys(this.sourceBuffers).length;i++){var r=Object.keys(this.sourceBuffers)[i],n=this.sourceBuffers[r];if(!n.updating){var u=t.sources[r];if(this["no"+r]){u.data=[],u.init.buffer=null;continue}if(u&&!u.inited)try{n.appendBuffer(u.init.buffer.buffer),u.inited=!0}catch(c){}else if(u){var o=u.data.shift();if(o)try{n.appendBuffer(o.buffer.buffer)}catch(c){u.data.unshift(o)}}}}}}},{key:"endOfStream",value:function(){try{var t=this.mediaSource.readyState;t==="open"&&this.mediaSource.endOfStream()}catch(i){}}},{key:"remove",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;try{for(var r=0;r<Object.keys(this.sourceBuffers).length;r++){var n=this.sourceBuffers[Object.keys(this.sourceBuffers)[r]];n.updating||t>i&&n.remove(i,t)}}catch(u){}}},{key:"_doCleanupSourceBuffer",value:function(){for(var t=this.container.currentTime,i=60*3,r={video:[],audio:[]},n=0;n<Object.keys(this.sourceBuffers).length;n++){for(var u=Object.keys(this.sourceBuffers)[n],o=this.sourceBuffers[u],c=o.buffered,g=!1,v=0;v<c.length;v++){var p=c.start(v),e=c.end(v);if(p<=t&&t<e+3){if(t-p>=i){g=!0;var s=t-i;r[u].push({start:p,end:s})}}else e<t&&t-p>=i&&(g=!0,r[u].push({start:p,end:e}))}g&&!o.updating&&this._doRemoveRanges(r)}}},{key:"_doRemoveRanges",value:function(t){for(var i in t)if(!(!this.sourceBuffers[i]||this.sourceBuffers[i].updating))for(var r=this.sourceBuffers[i],n=t[i];n.length&&!r.updating;){var u=n.shift();try{u&&u.end>u.start&&r.remove(u.start,u.end)}catch(o){}}}},{key:"cleanBuffers",value:function(){for(var t=this,i=[],r=function(o){var c=t.sourceBuffers[Object.keys(t.sourceBuffers)[o]],g=void 0;c.updating?g=new Promise(function(v){var p=function e(){var s=3,l=function f(){c.updating?s>0?(setTimeout(f,200),s--):v():(h.clearBuffer(c),c.addEventListener("updateend",function(){v()}))};setTimeout(l,200),c.removeEventListener("updateend",e)};c.addEventListener("updateend",p)}):g=new Promise(function(v){h.clearBuffer(c),c.addEventListener("updateend",function(){v()})}),i.push(g)},n=0;n<Object.keys(this.sourceBuffers).length;n++)r(n);return Promise.all(i)}},{key:"removeBuffers",value:function(){for(var t=this,i=[],r=function(o){var c=t.sourceBuffers[Object.keys(t.sourceBuffers)[o]];c.removeEventListener("updateend",t.onUpdateEnd);var g=void 0;c.updating?g=new Promise(function(v){var p=function e(){var s=3,l=function f(){c.updating?s>0?(setTimeout(f,200),s--):v():(h.clearBuffer(c),c.addEventListener("updateend",function(){v()}))};setTimeout(l,200),c.removeEventListener("updateend",e)};c.addEventListener("updateend",p)}):g=new Promise(function(v){h.clearBuffer(c),c.addEventListener("updateend",function(){v()})}),i.push(g)},n=0;n<Object.keys(this.sourceBuffers).length;n++)r(n);return Promise.all(i)}},{key:"destroy",value:function(){var t=this;return this.container?(this.container.removeEventListener("timeupdate",this.onTimeUpdate),this.container.removeEventListener("waiting",this.onWaiting),this.mediaSource.removeEventListener("sourceopen",this.onSourceOpen),this.removeBuffers().then(function(){for(var i=Object.keys(t.sourceBuffers),r=0;r<i.length;r++){var n=t.sourceBuffers[i[r]];delete t.sourceBuffers[i[r]],t.mediaSource.readyState==="open"&&t.mediaSource.removeSourceBuffer(n)}t.endOfStream();try{window.URL.revokeObjectURL(t.url)}catch(u){}t.url=null,t.configs={},t.container=null,t.mediaSource=null,t.sourceBuffers={},t.preloadTime=1,t.onSourceOpen=null,t.onTimeUpdate=null,t.onUpdateEnd=null,t.onWaiting=null,t.noaudio=void 0,t.novideo=void 0})):Promise.resolve()}},{key:"sourceBufferLen",get:function(){return this._context.mediaInfo?(!!this._context.mediaInfo.hasVideo&&!this.novideo)+(!!this._context.mediaInfo.hasAudio&&!this.noaudio):this.noaudio||this.novideo?1:2}},{key:"url",set:function(t){this._url=t},get:function(){if(!this._url)try{this._url=window.URL.createObjectURL(this.mediaSource)}catch(t){}return this._url}}],[{key:"clearBuffer",value:function(t){try{for(var i=t.buffered,r=.1,n=0,u=i.length;n<u;n++)r=i.end(n);t.remove(0,r)}catch(o){}}}]),h}(),hc=dc,pc=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function gc(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var vc=function(){function h(){gc(this,h),this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._lastSamplingBytes=0,this._now=Date.now}return pc(h,[{key:"reset",value:function(){this._firstCheckpoint=this._lastCheckpoint=0,this._intervalBytes=0,this._lastSamplingBytes=0}},{key:"addBytes",value:function(t){var i=this._now()-this._lastCheckpoint;this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=t):i<5e3?this._intervalBytes+=t:(this._lastSamplingBytes=this._intervalBytes/(i/1e3),this._intervalBytes=t,this._lastCheckpoint=this._now())}},{key:"currentKBps",get:function(){this.addBytes(0);var t=(this._now()-this._lastCheckpoint)/1e3;return t===0&&(t=1),this._intervalBytes/t/1024}},{key:"lastSamplingKBps",get:function(){return this.addBytes(0),this._lastSamplingBytes!==0?this._lastSamplingBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0}}]),h}(),yc=vc,$o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},mc=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function _c(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var jt=Mt.LOADER_EVENTS,xc=0,Ec=1,bc=2,wc=3,Tc=function(){function h(a){_c(this,h),this.configs=Object.assign({},a),this.url=null,this.status=0,this.error=null,this._reader=null,this._canceled=!1,this._destroyed=!1,this.readtype=this.configs.readtype,this.buffer=this.configs.buffer||"LOADER_BUFFER",this._loaderTaskNo=0,this._ttfb=0,this._speed=new yc,window.AbortController&&(this.abortControllerEnabled=!0)}return mc(h,[{key:"init",value:function(){this.on(jt.LADER_START,this.load.bind(this))}},{key:"fetch",value:function(a){function t(i,r,n){return a.apply(this,arguments)}return t.toString=function(){return a.toString()},t}(function(a,t,i){var r=this,n=null;this.abortControllerEnabled&&(this.abortController=new window.AbortController),Object.assign(t,{signal:this.abortController?this.abortController.signal:void 0});var u=new Date().getTime();return Promise.race([fetch(a,t),new Promise(function(o,c){n=setTimeout(function(){c({code:999,message:"fetch timeout"}),r.abortController&&r.abortController.abort()},i||1e4)})]).then(function(o){n&&(clearTimeout(n),n=null);var c=new Date().getTime();return r.emit(jt.LOADER_TTFB,{start:u,end:c,elapsed:c-u}),o})})},{key:"internalLoad",value:function(t,i,r,n){var u=this,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,c=arguments[5];if(!this._destroyed)return this.loading=!0,this.fetch(this.url,i,c).then(function(g){if(!u._destroyed&&u.emit(jt.LOADER_RESPONSE_HEADERS,u.TAG,g.headers),g.ok)return u.status=g.status,Promise.resolve().then(function(){u._onFetchResponse(g)}),Promise.resolve(g);r-- >0?u._retryTimer=setTimeout(function(){return u.emit(jt.LOADER_RETRY,u.TAG,{response:g,reason:"response not ok",retryTime:n-r}),u.internalLoad(t,i,r,n,o,c)},o):(u.loading=!1,u.emit(jt.LOADER_ERROR,u.TAG,{code:g.status||21,message:g.status+" ("+g.statusText+")"}))}).catch(function(g){if(u._destroyed){u.loading=!1;return}if(r-- >0)u._retryTimer=setTimeout(function(){return u.emit(jt.LOADER_RETRY,u.TAG,{error:g,reason:"fetch error",retryTime:n-r}),u.internalLoad(t,i,r,n,o,c)},o);else{if(u.loading=!1,g&&g.name==="AbortError")return;u.emit(jt.LOADER_ERROR,u.TAG,Object.assign({code:21},g))}})}},{key:"load",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=r.retryCount,u=r.retryDelay,o=r.loadTimeout;n=n===void 0?3:n,this.url=t,this._canceled=!1;var c=this.getParams(i);return this.internalLoad(t,c,n,n,u,o)}},{key:"_onFetchResponse",value:function(t){var i=this,r=this,n=this._context.getInstance(this.buffer);this._loaderTaskNo++;var u=this._loaderTaskNo;if(t.ok===!0)switch(this.readtype){case bc:t.json().then(function(o){r.loading=!1,!r._canceled&&!r._destroyed&&(n?(n.push(o),r.emit(jt.LOADER_COMPLETE,n)):r.emit(jt.LOADER_COMPLETE,o))});break;case Ec:t.text().then(function(o){r.loading=!1,!r._canceled&&!r._destroyed&&(n?(n.push(o),r.emit(jt.LOADER_COMPLETE,n)):r.emit(jt.LOADER_COMPLETE,o))});break;case wc:t.arrayBuffer().then(function(o){r.loading=!1,!r._canceled&&!r._destroyed&&(n?(n.push(new Uint8Array(o)),i._speed.addBytes(o.byteLength),r.emit(jt.LOADER_COMPLETE,n)):r.emit(jt.LOADER_COMPLETE,o))}).catch(function(){});break;case xc:default:return this._onReader(t.body.getReader(),u)}}},{key:"_onReader",value:function(t,i){var r=this,n=this._context.getInstance(this.buffer);if(!n&&this._reader||this._destroyed)try{this._reader.cancel()}catch(u){}this._reader=t,this.loading!==!1&&(this._noDataTimer=setTimeout(function(){r.loading!==!1&&r.emit(jt.LOADER_COMPLETE)},3e3),this._reader&&this._reader.read().then(function(u){if(clearTimeout(r._noDataTimer),r._canceled||r._destroyed){if(r._reader)try{r._reader.cancel()}catch(o){}return}if(u.done){r.loading=!1,r.status=0,Promise.resolve().then(function(){r.emit(jt.LOADER_COMPLETE,n)});return}return n.push(u.value),r._speed.addBytes(u.value.byteLength),Promise.resolve().then(function(){r.emit(jt.LOADER_DATALOADED,n)}),r._onReader(t,i)}).catch(function(u){clearTimeout(r._noDataTimer),r.loading=!1,!(u&&u.name==="AbortError")&&r.emit(jt.LOADER_ERROR,r.TAG,u)}))}},{key:"getParams",value:function(t){var i=Object.assign({},t),r=new Headers,n={method:"GET",headers:r,mode:"cors",cache:"default"};if($o(this.configs.headers)==="object"){var u=this.configs.headers;for(var o in u)u.hasOwnProperty(o)&&r.append(o,u[o])}if($o(i.headers)==="object"){var c=i.headers;for(var g in c)c.hasOwnProperty(g)&&r.append(g,c[g])}return i.cors===!1&&(n.mode="same-origin"),i.withCredentials&&(n.credentials="include"),n}},{key:"cancel",value:function(){if(this._reader){try{this._reader.cancel()}catch(t){}this._reader=null,this.loading=!1}clearTimeout(this._noDataTimer),this._canceled=!0,this.abortController&&this.abortController.abort()}},{key:"destroy",value:function(){this._destroyed=!0,clearTimeout(this._retryTimer),clearTimeout(this._noDataTimer),this.cancel(),this._speed.reset()}},{key:"currentSpeed",get:function(){return this._speed.lastSamplingKBps}}],[{key:"isSupported",value:function(){return!!window.fetch}},{key:"type",get:function(){return"loader"}}]),h}(),Ya=Tc,Sc=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function kc(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Fi=Mt.LOADER_EVENTS,fr=Mt.REMUX_EVENTS,cr=Mt.DEMUX_EVENTS,Xa=Mt.HLS_EVENTS,Wo=Mt.CRYTO_EVENTS,Yo=Mt.MSE_EVENTS,Ac="HLS_ERROR",Cc=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,Dc=function(){function h(a){kc(this,h),this.configs=Object.assign({},a),this.url="",this.sequence=0,this._playlist=null,this.retrytimes=this.configs.retrytimes||3,this.preloadTime=this.configs.preloadTime,this.container=this.configs.container,this._m3u8lasttime=0,this._timmer=setInterval(this._checkStatus.bind(this),300),this._lastCheck=0,this.m3u8Text=null}return Sc(h,[{key:"init",value:function(){var t=this._player.hlsOps,i=t.XgBuffer,r=t.Tracks,n=t.Playlist,u=t.RemuxedBufferManager,o=t.Compatibility,c=t.FetchLoader,g=t.TsDemuxer,v=t.Mp4Remuxer,p=t.Mse;this._context.registry("M3U8_BUFFER",i),this._context.registry("TS_BUFFER",i),this._context.registry("TRACKS",r),this._playlist=this._context.registry("PLAYLIST",n)({autoclear:!0}),this._context.registry("PRE_SOURCE_BUFFER",u),this._context.registry("COMPATIBILITY",o),this._m3u8loader=this._context.registry("M3U8_LOADER",c)({buffer:"M3U8_BUFFER",readtype:1}),this._tsloader=this._context.registry("TS_LOADER",c)({buffer:"TS_BUFFER",readtype:3}),this._context.registry("TS_DEMUXER",g)({inputbuffer:"TS_BUFFER"}),this._context.registry("MP4_REMUXER",v),this.mse=this._context.registry("MSE",p)({container:this.container}),this.initEvents()}},{key:"initEvents",value:function(){this.on(Fi.LOADER_COMPLETE,this._onLoadComplete.bind(this)),this.on(Fi.LOADER_RETRY,this._handleFetchRetry.bind(this)),this.on(fr.INIT_SEGMENT,this.mse.addSourceBuffers.bind(this.mse)),this.on(fr.MEDIA_SEGMENT,this.mse.doAppend.bind(this.mse)),this.on(cr.METADATA_PARSED,this._onMetadataParsed.bind(this)),this.on(cr.SEI_PARSED,this._handleSEIParsed.bind(this)),this.on(cr.DEMUX_COMPLETE,this._onDemuxComplete.bind(this)),this.on(Fi.LOADER_ERROR,this._onLoadError.bind(this)),this.on(cr.DEMUX_ERROR,this._onDemuxError.bind(this)),this.on(fr.REMUX_ERROR,this._onRemuxError.bind(this)),this.on(Yo.MSE_ERROR,this._handleMseError.bind(this))}},{key:"_onError",value:function(t,i,r,n){var u={code:r.code,errorType:t,errorDetails:"["+i+"]: "+(r?r.message:""),errorFatal:n};this._player.emit(Ac,u)}},{key:"_onDemuxComplete",value:function(){this.emit(fr.REMUX_MEDIA,"ts")}},{key:"_onMetadataParsed",value:function(t){t==="video"&&(this._context.mediaInfo.hasVideo=!0),t==="audio"&&(this._context.mediaInfo.hasAudio=!0),this.emit(fr.REMUX_METADATA,t)}},{key:"_onLoadError",value:function(t,i){!this._tsloader.loading&&!this._m3u8loader.loading&&this.retrytimes>=1?(this.retrytimes--,this._onError(Fi.LOADER_ERROR,t,i,!1)):this.retrytimes<=1&&(this._player.emit("error",{code:i.code,errorType:"network",ex:"["+t+"]: "+i.message,errd:{}}),this._onError(Fi.LOADER_ERROR,t,i,!0),this.emit(Xa.RETRY_TIME_EXCEEDED),this.mse.endOfStream())}},{key:"_onDemuxError",value:function(t,i,r){r===void 0&&(r=!0),this._player.emit("error",{code:i.code,errorType:"network",ex:"["+t+"]: "+(i?i.message:""),errd:{}}),this._onError(Fi.LOADER_ERROR,t,i,r)}},{key:"_onRemuxError",value:function(t,i,r){r===void 0&&(r=!0),this._player.emit("error",{errorType:"parse",ex:"["+t+"]: "+i.message,errd:{}}),this._onError(fr.REMUX_ERROR,t,i,r)}},{key:"_handleMseError",value:function(t,i,r){r===void 0&&(r=!1),this._player.emit("error",{errorType:"format",ex:"["+t+"]: "+i.message,errd:{}}),this._onError(Yo.MSE_ERROR,t,i,r)}},{key:"_handleSEIParsed",value:function(t){this._player.emit("SEI_PARSED",t)}},{key:"_onLoadComplete",value:function(t){if(t.TAG==="M3U8_BUFFER"){var i=void 0;try{this.m3u8Text=t.shift();var r=Cc.exec(this.m3u8Text);r&&r[2]?this.load(r[2]):i=this._player.hlsOps.M3U8Parser.parse(this.m3u8Text,this.url)}catch(g){this._onError("M3U8_PARSER_ERROR","M3U8_PARSER",g,!1)}if(!i){this.retrytimes>0?(this.retrytimes--,this._preload()):(this.emit(Xa.RETRY_TIME_EXCEEDED),this.mse.endOfStream());return}try{this._playlist.pushM3U8(i,!0)}catch(g){this._onError("M3U8_PARSER_ERROR","PLAYLIST",g,!1)}if(this._playlist.encrypt&&this._playlist.encrypt.uri&&!this._playlist.encrypt.key){var n=this._player.hlsOps.XgBuffer;this._context.registry("DECRYPT_BUFFER",n)(),this._context.registry("KEY_BUFFER",n)(),this._tsloader.buffer="DECRYPT_BUFFER",this._keyLoader=this._context.registry("KEY_LOADER",Ya)({buffer:"KEY_BUFFER",readtype:3});var u=this._player.config.retry||{},o=u.count,c=u.delay;this.emitTo("KEY_LOADER",Fi.LADER_START,this._playlist.encrypt.uri,{},o,c)}else this._m3u8Loaded(i)}else t.TAG==="TS_BUFFER"?(this.retrytimes=this.configs.retrytimes||3,this._playlist.downloaded(this._tsloader.url,!0),this.emit(cr.DEMUX_START)):t.TAG==="DECRYPT_BUFFER"?(this.retrytimes=this.configs.retrytimes||3,this._playlist.downloaded(this._tsloader.url,!0),this.emitTo("CRYPTO",Wo.START_DECRYPT)):t.TAG==="KEY_BUFFER"&&(this.retrytimes=this.configs.retrytimes||3,this._playlist.encrypt.key=t.shift(),this._crypto=this._context.registry("CRYPTO",$a)({key:this._playlist.encrypt.key,iv:this._playlist.encrypt.ivb,method:this._playlist.encrypt.method,inputbuffer:"DECRYPT_BUFFER",outputbuffer:"TS_BUFFER"}),this._crypto.on(Wo.DECRYPTED,this._onDcripted.bind(this)))}},{key:"_handleFetchRetry",value:function(t,i){this._player.emit("retry",Object.assign({tag:t},i))}},{key:"_onDcripted",value:function(){this.emit(cr.DEMUX_START)}},{key:"_m3u8Loaded",value:function(t){this.preloadTime||(this.preloadTime=this._playlist.targetduration?this._playlist.targetduration:5),this._playlist.fragLength>0&&this._playlist.sequence<t.sequence?this.retrytimes=this.configs.retrytimes||3:this.retrytimes>0?(this.retrytimes--,this._preload()):(this.emit(Xa.RETRY_TIME_EXCEEDED),this.mse.endOfStream())}},{key:"_checkStatus",value:function(){if(!(this.retrytimes<1&&Date.now()-this._lastCheck<4e3))if(this.retrytimes<1&&clearInterval(this._timmer),this._lastCheck=new Date().getTime(),this.container.buffered.length<1)this._preload();else{var t=this.container.currentTime,i=this.container.buffered.start(this.container.buffered.length-1);this.container.readyState<=2&&(t<i?(this.container.currentTime=i,t=i):this._preload());var r=this.container.buffered.end(this.container.buffered.length-1);t<r-this.preloadTime*2&&(this.container.currentTime=r-this.preloadTime),t>r-this.preloadTime&&this._preload()}}},{key:"_preload",value:function(){if(!(this._tsloader.loading||this._m3u8loader.loading)){var t=this._playlist.getTs(),i=this._player.config.retry||{},r=i.count,n=i.delay;if(t&&!t.downloaded&&!t.downloading)this._playlist.downloading(t.url,!0),this.emitTo("TS_LOADER",Fi.LADER_START,t.url,{},r,n);else{var u=this.preloadTime?this.preloadTime:0,o=new Date().getTime();(!t||t.downloaded)&&(o-this._m3u8lasttime)/1e3>u&&(this._m3u8lasttime=o,this.emitTo("M3U8_LOADER",Fi.LADER_START,this.url,{},r,n))}}}},{key:"load",value:function(t){this.url=t,this._preload()}},{key:"destroy",value:function(){clearInterval(this._timmer),this.off(Fi.LOADER_COMPLETE,this._onLoadComplete),this.off(fr.INIT_SEGMENT,this.mse.addSourceBuffers),this.off(fr.MEDIA_SEGMENT,this.mse.doAppend),this.off(cr.METADATA_PARSED,this._onMetadataParsed),this.off(cr.DEMUX_COMPLETE,this._onDemuxComplete),this.mse=null,this.m3u8Text=null}}]),h}(),Rc=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Uc(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Lc=function(){function h(){Uc(this,h)}return Rc(h,null,[{key:"getSilentFrame",value:function(t,i){if(t==="mp4a.40.2"){if(i===1)return new Uint8Array([0,200,0,128,35,128]);if(i===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(i===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(i===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(i===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(i===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(i===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(i===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(i===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}}]),h}(),Pc=Lc,Fc=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Bc(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Oc=function(){function h(){Bc(this,h)}return Fc(h,null,[{key:"isHeader",value:function(t,i){return!!(i+1<t.length&&h.isHeaderPattern(t,i))}},{key:"getFrameDuration",value:function(t){return 1024*9e4/t}},{key:"isHeaderPattern",value:function(t,i){return t[i]===255&&(t[i+1]&246)==240}},{key:"getHeaderLength",value:function(t,i){return t[i+1]&1?7:9}},{key:"getFullFrameLength",value:function(t,i){return(t[i+3]&3)<<11|t[i+4]<<3|(t[i+5]&224)>>>5}},{key:"parseFrameHeader",value:function(t,i,r,n,u){var o=void 0,c=void 0,g=void 0,v=t.length;if(o=h.getHeaderLength(t,i),c=h.getFullFrameLength(t,i),c-=o,c>0&&i+o+c<=v)return g=r+n*u,{headerLength:o,frameLength:c,stamp:g}}},{key:"appendFrame",value:function(t,i,r,n,u){var o=h.getFrameDuration(t),c=h.parseFrameHeader(i,r,n,u,o);if(c){var g=c.stamp,v=c.headerLength,p=c.frameLength,e={unit:i.subarray(r+v,r+v+p),pts:g,dts:g};return{sample:e,length:p+v}}}}]),h}(),Xo=Oc,Ic=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Mc(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Nc=function(){function h(a){Mc(this,h),this.TAG="Golomb",this._buffer=a,this._bufferIndex=0,this._totalBytes=a.byteLength,this._totalBits=a.byteLength*8,this._currentWord=0,this._currentWordBitsLeft=0}return Ic(h,[{key:"destroy",value:function(){this._buffer=null}},{key:"_fillCurrentWord",value:function(){var t=this._totalBytes-this._bufferIndex,i=Math.min(4,t),r=new Uint8Array(4);r.set(this._buffer.subarray(this._bufferIndex,this._bufferIndex+i)),this._currentWord=new DataView(r.buffer).getUint32(0),this._bufferIndex+=i,this._currentWordBitsLeft=i*8}},{key:"readBits",value:function(t){var i=Math.min(this._currentWordBitsLeft,t),r=this._currentWord>>>32-i;if(t>32)throw new Error("Cannot read more than 32 bits at a time");return this._currentWordBitsLeft-=i,this._currentWordBitsLeft>0?this._currentWord<<=i:this._totalBytes-this._bufferIndex>0&&this._fillCurrentWord(),i=t-i,i>0&&this._currentWordBitsLeft?r<<i|this.readBits(i):r}},{key:"readBool",value:function(){return this.readBits(1)===1}},{key:"readByte",value:function(){return this.readBits(8)}},{key:"_skipLeadingZero",value:function(){var t=void 0;for(t=0;t<this._currentWordBitsLeft;t++)if((this._currentWord&2147483648>>>t)!=0)return this._currentWord<<=t,this._currentWordBitsLeft-=t,t;return this._fillCurrentWord(),t+this._skipLeadingZero()}},{key:"readUEG",value:function(){var t=this._skipLeadingZero();return this.readBits(t+1)-1}},{key:"readSEG",value:function(){var t=this.readUEG();return t&1?t+1>>>1:-1*(t>>>1)}},{key:"readSliceType",value:function(){return this.readByte(),this.readUEG(),this.readUEG()}}]),h}(),zc=Nc,Vc=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Hc(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var jc=function(){function h(){Hc(this,h)}return Vc(h,null,[{key:"_ebsp2rbsp",value:function(t){for(var i=t,r=i.byteLength,n=new Uint8Array(r),u=0,o=0;o<r;o++)o>=2&&i[o]===3&&i[o-1]===0&&i[o-2]===0||(n[u]=i[o],u++);return new Uint8Array(n.buffer,0,u)}},{key:"parseSPS",value:function(t){var i=h._ebsp2rbsp(t),r=new zc(i);r.readByte();var n=r.readByte();r.readByte();var u=r.readByte();r.readUEG();var o=h.getProfileString(n),c=h.getLevelString(u),g=1,v=420,p=[0,420,422,444],e=8;if((n===100||n===110||n===122||n===244||n===44||n===83||n===86||n===118||n===128||n===138||n===144)&&(g=r.readUEG(),g===3&&r.readBits(1),g<=3&&(v=p[g]),e=r.readUEG()+8,r.readUEG(),r.readBits(1),r.readBool()))for(var s=g!==3?8:12,l=0;l<s;l++)r.readBool()&&(l<6?h._skipScalingList(r,16):h._skipScalingList(r,64));r.readUEG();var f=r.readUEG();if(f===0)r.readUEG();else if(f===1){r.readBits(1),r.readSEG(),r.readSEG();for(var d=r.readUEG(),y=0;y<d;y++)r.readSEG()}r.readUEG(),r.readBits(1);var m=r.readUEG(),_=r.readUEG(),E=r.readBits(1);E===0&&r.readBits(1),r.readBits(1);var w=0,k=0,x=0,S=0,P=r.readBool();P&&(w=r.readUEG(),k=r.readUEG(),x=r.readUEG(),S=r.readUEG());var U=1,R=1,C=0,A=!0,b=0,O=0,W=r.readBool();if(W){if(r.readBool()){var K=r.readByte(),G=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],B=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];K>0&&K<16?(U=G[K-1],R=B[K-1]):K===255&&(U=r.readByte()<<8|r.readByte(),R=r.readByte()<<8|r.readByte())}if(r.readBool()&&r.readBool(),r.readBool()&&(r.readBits(4),r.readBool()&&r.readBits(24)),r.readBool()&&(r.readUEG(),r.readUEG()),r.readBool()){var j=r.readBits(32),z=r.readBits(32);A=r.readBool(),b=z,O=j*2,C=b/O}}var $=1;(U!==1||R!==1)&&($=U/R);var J=0,Q=0;if(g===0)J=1,Q=2-E;else{var ne=g===3?1:2,Ee=g===1?2:1;J=ne,Q=Ee*(2-E)}var we=(m+1)*16,Ae=(2-E)*((_+1)*16);we-=(w+k)*J,Ae-=(x+S)*Q;var De=Math.ceil(we*$);return r.destroy(),r=null,{profile_string:o,level_string:c,bit_depth:e,chroma_format:v,chroma_format_string:h.getChromaFormatString(v),frame_rate:{fixed:A,fps:C,fps_den:O,fps_num:b},par_ratio:{width:U,height:R},codec_size:{width:we,height:Ae},present_size:{width:De,height:Ae}}}},{key:"_skipScalingList",value:function(t,i){for(var r=8,n=8,u=0,o=0;o<i;o++)n!==0&&(u=t.readSEG(),n=(r+u+256)%256),r=n===0?r:n}},{key:"getProfileString",value:function(t){switch(t){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}}},{key:"getLevelString",value:function(t){return(t/10).toFixed(1)}},{key:"getChromaFormatString",value:function(t){switch(t){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}}},{key:"toVideoMeta",value:function(t){var i={};t&&t.codec_size&&(i.codecWidth=t.codec_size.width,i.codecHeight=t.codec_size.height,i.presentWidth=t.present_size.width,i.presentHeight=t.present_size.height),i.profile=t.profile_string,i.level=t.level_string,i.bitDepth=t.bit_depth,i.chromaFormat=t.chroma_format,i.parRatio={width:t.par_ratio.width,height:t.par_ratio.height},i.frameRate=t.frame_rate;var r=i.frameRate.fps_den,n=i.frameRate.fps_num;return i.refSampleDuration=Math.floor(i.timescale*(r/n)),i}}]),h}(),Gc=jc,$c=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Wc(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Yc=function(){function h(){Wc(this,h)}return $c(h,null,[{key:"EBSP2RBSP",value:function(t){return t.filter(function(i,r){return r<2?!0:!(t[r-2]===0&&t[r-1]===0&&i===3)})}},{key:"EBSP2SODB",value:function(t){var i=t[t.byteLength-1];return i&&i===128?t.slice(0,t.byteLength-1):t}}]),h}(),Ko=Yc,Xc=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Kc(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var qo=function(a){for(var t="",i=0;i<a.byteLength;i++)t+=String.fromCharCode(a[i]);return t},qc=function(){function h(){Kc(this,h)}return Xc(h,null,[{key:"_resolveNalu",value:function(t){return t.length>=1?Ko.EBSP2SODB(Ko.EBSP2RBSP(t.slice(1))):null}},{key:"parse",value:function(t){var i=h._resolveNalu(t),r=h.switchPayloadType(i),n=r.payloadType,u=r.offset,o=i.slice(u);switch(n){case 5:return h.user_data_unregistered(o);default:return{code:n,content:o}}}},{key:"switchPayloadType",value:function(t){for(var i=new DataView(t.buffer),r=0,n=0;i.getUint8(n)===255;)n++,r+=255;return r+=i.getUint8(n++),{payloadType:r,offset:n}}},{key:"getPayloadLength",value:function(t){for(var i=new DataView(t.buffer),r=0,n=0;i.getUint8(n)===255;)n++,r+=255;return r+=i.getUint8(n++),{payloadLength:r,offset:n}}},{key:"user_data_unregistered",value:function(t){var i=h.getPayloadLength(t),r=i.payloadLength,n=i.offset;if(r<16)return{uuid:"",content:null};var u=t.slice(n),o=qo(u.slice(0,16)),c=qo(u.slice(16,r));return{code:5,uuid:o,content:c}}}]),h}(),Zc=qc,Jc=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Qc(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var ed=function(){function h(){Qc(this,h)}return Jc(h,null,[{key:"getNalunits",value:function(t){if(t.length-t.position<4)return[];var i=t.dataview,r=t.position;return i.getInt32(r)===1||i.getInt16(r)===0&&i.getInt8(r+2)===1?h.getAnnexbNals(t):h.getAvccNals(t)}},{key:"getAnnexbNals",value:function(t){for(var i=[],r=h.getHeaderPositionAnnexB(t),n=r.pos,u=n;n<t.length-4;){var o=t.buffer.slice(n,n+r.headerLength);r.pos===t.position&&t.skip(r.headerLength),r=h.getHeaderPositionAnnexB(t),u=r.pos;var c=new Uint8Array(t.buffer.slice(n+o.byteLength,u)),g={header:o,body:c};h.analyseNal(g),g.type<=9&&g.type!==0&&i.push(g),t.skip(u-t.position),n=u}return i}},{key:"getAvccNals",value:function(t){for(var i=[];t.position<t.length-4;){var r=t.dataview.getInt32(t.dataview.position);if(t.length-t.position>=r){var n=t.buffer.slice(t.position,t.position+4);t.skip(4);var u=new Uint8Array(t.buffer.slice(t.position,t.position+r));t.skip(r);var o={header:n,body:u};h.analyseNal(o),o.type<=9&&o.type!==0&&i.push(o)}else break}return i}},{key:"analyseNal",value:function(t){var i=t.body[0]&31;switch(t.type=i,i){case 1:t.ndr=!0;break;case 5:t.idr=!0;break;case 6:try{t.sei=Zc.parse(t.body)}catch(r){}break;case 7:t.sps=Gc.parseSPS(t.body);break;case 8:t.pps=!0;break}}},{key:"getHeaderPositionAnnexB",value:function(t){for(var i=t.position,r=0,n=t.length;r!==3&&r!==4&&i<n-4;)t.dataview.getInt16(i)===0?t.dataview.getInt16(i+2)===1?r=4:t.dataview.getInt8(i+2)===1?r=3:i++:i++;return i===n-4&&(t.dataview.getInt16(i)===0?t.dataview.getInt16(i+2)===1?r=4:i=n:(i++,t.dataview.getInt16(i)===0&&t.dataview.getInt8(i)===1?r=3:i=n)),{pos:i,headerLength:r}}},{key:"getAvcc",value:function(t,i){var r=new Uint8Array(t.byteLength+i.byteLength+11);r[0]=1,r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=255,r[5]=225;var n=6;return r.set(new Uint8Array([t.byteLength>>>8&255,t.byteLength&255]),n),n+=2,r.set(t,n),n+=t.byteLength,r[n]=1,n++,r.set(new Uint8Array([i.byteLength>>>8&255,i.byteLength&255]),n),n+=2,r.set(i,n),r}}]),h}(),Zo=ed,td=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function id(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var rd=function(){function h(a){id(this,h),this.TAG="Golomb",this._buffer=a,this._bufferIndex=0,this._totalBytes=a.byteLength,this._totalBits=a.byteLength*8,this._currentWord=0,this._currentWordBitsLeft=0}return td(h,[{key:"destroy",value:function(){this._buffer=null}},{key:"_fillCurrentWord",value:function(){var t=this._totalBytes-this._bufferIndex,i=Math.min(4,t),r=new Uint8Array(4);r.set(this._buffer.subarray(this._bufferIndex,this._bufferIndex+i)),this._currentWord=new DataView(r.buffer).getUint32(0),this._bufferIndex+=i,this._currentWordBitsLeft=i*8}},{key:"readBits",value:function(t){var i=Math.min(this._currentWordBitsLeft,t),r=this._currentWord>>>32-i;if(t>32)throw new Error("Cannot read more than 32 bits at a time");return this._currentWordBitsLeft-=i,this._currentWordBitsLeft>0?this._currentWord<<=i:this._totalBytes-this._bufferIndex>0&&this._fillCurrentWord(),i=t-i,i>0&&this._currentWordBitsLeft?r<<i|this.readBits(i):r}},{key:"readBool",value:function(){return this.readBits(1)===1}},{key:"readByte",value:function(){return this.readBits(8)}},{key:"_skipLeadingZero",value:function(){var t=void 0;for(t=0;t<this._currentWordBitsLeft;t++)if((this._currentWord&2147483648>>>t)!=0)return this._currentWord<<=t,this._currentWordBitsLeft-=t,t;return this._fillCurrentWord(),t+this._skipLeadingZero()}},{key:"readUEG",value:function(){var t=this._skipLeadingZero();return this.readBits(t+1)-1}},{key:"readSEG",value:function(){var t=this.readUEG();return t&1?t+1>>>1:-1*(t>>>1)}},{key:"readSliceType",value:function(){return this.readByte(),this.readUEG(),this.readUEG()}}]),h}(),nd=rd,ad=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function sd(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var od=function(){function h(){sd(this,h)}return ad(h,null,[{key:"_ebsp2rbsp",value:function(t){for(var i=t,r=i.byteLength,n=new Uint8Array(r),u=0,o=0;o<r;o++)o>=2&&i[o]===3&&i[o-1]===0&&i[o-2]===0||(n[u]=i[o],u++);return new Uint8Array(n.buffer,0,u)}},{key:"parseSPS",value:function(t){var i=h._ebsp2rbsp(t),r=new nd(i),n=0,u=0,o=0,c=0,g=0,v=0,p=0,e=0,s=0,l=0,f=0,d=0,y=0,m=0,_={};return r.readByte(),r.readByte(),r.readBits(4),n=r.readBits(3),r.readBits(1),_=h._readProfileTierLevel(r,n),r.readUEG(),o=r.readUEG(),o===3&&(u=r.readBits(1)),c=r.readUEG(),g=r.readUEG(),l=r.readBits(1),l===1&&(v=r.readUEG(),p=r.readUEG(),e=r.readUEG(),s=r.readUEG()),f=r.readUEG(),d=r.readUEG(),l===1&&(y=(o===1||o===2)&&u===0?2:1,m=o===1&&u===0?2:1,c-=y*p+y*v,g-=m*s+m*e),r.destroy(),r=null,{width:c,height:g,general_profile_space:_.general_profile_space,general_tier_flag:_.general_tier_flag,general_profile_idc:_.general_profile_idc,general_level_idc:_.general_level_idc,chromaFormatIdc:o,bitDepthLumaMinus8:f,bitDepthChromaMinus8:d}}},{key:"_readProfileTierLevel",value:function(t,i){var r=0,n=0,u=0,o=0;r=t.readBits(2)||0,n=t.readBits(1)||0,u=t.readBits(5)||0,t.readBits(16),t.readBits(16),t.readBits(1),t.readBits(1),t.readBits(1),t.readBits(1),t.readBits(16),t.readBits(16),t.readBits(12),o=t.readBits(8)||0;for(var c=[],g=[],v=0;v<i;v++)c[v]=t.readBits(1),g[v]=t.readBits(1);i>0&&t.readBits((8-i)*2);for(var p=0;p<i;p++)c[p]!==0&&(t.readBits(2),t.readBits(1),t.readBits(5),t.readBits(16),t.readBits(16),t.readBits(4),t.readBits(16),t.readBits(16),t.readBits(12)),g[p]!==0&&t.readBits(8);return{general_profile_space:r,general_tier_flag:n,general_profile_idc:u,general_level_idc:o}}},{key:"_skipScalingList",value:function(t,i){for(var r=8,n=8,u=0,o=0;o<i;o++)n!==0&&(u=t.readSEG(),n=(r+u+256)%256),r=n===0?r:n}},{key:"getProfileString",value:function(t){switch(t){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}}},{key:"getLevelString",value:function(t){return(t/10).toFixed(1)}},{key:"getChromaFormatString",value:function(t){switch(t){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}}},{key:"toVideoMeta",value:function(t){var i={};return t&&t.codec_size?(i.codecWidth=t.codec_size.width,i.codecHeight=t.codec_size.height,i.presentWidth=t.present_size.width,i.presentHeight=t.present_size.height):t.width&&t.height&&(i.codecWidth=t.width,i.codecHeight=t.height,i.presentWidth=t.width,i.presentHeight=t.height),i.profile=t.profile_string,i.level=t.level_string,i.bitDepth=t.bit_depth,i.chromaFormat=t.chroma_format,i}}]),h}(),ld=od,ud=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function fd(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var cd=function(){function h(){fd(this,h)}return ud(h,null,[{key:"EBSP2RBSP",value:function(t){return t.filter(function(i,r){return r<2?!0:!(t[r-2]===0&&t[r-1]===0&&i===3)})}},{key:"EBSP2SODB",value:function(t){var i=t[t.byteLength-1];return i&&i===128?t.slice(0,t.byteLength-1):t}}]),h}(),Jo=cd,dd=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function hd(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Qo=function(a){for(var t="",i=0;i<a.byteLength;i++)t+=String.fromCharCode(a[i]);return t},pd=function(){function h(){hd(this,h)}return dd(h,null,[{key:"_resolveNalu",value:function(t){return t.length>=1?Jo.EBSP2SODB(Jo.EBSP2RBSP(t.slice(1))):null}},{key:"parse",value:function(t){var i=h._resolveNalu(t),r=h.switchPayloadType(i),n=r.payloadType,u=r.offset,o=i.slice(u);switch(n){case 5:return h.user_data_unregistered(o);default:return{code:n,content:o}}}},{key:"switchPayloadType",value:function(t){for(var i=new DataView(t.buffer),r=0,n=0;i.getUint8(n)===255;)n++,r+=255;return r+=i.getUint8(n++),{payloadType:r,offset:n}}},{key:"getPayloadLength",value:function(t){for(var i=new DataView(t.buffer),r=0,n=0;i.getUint8(n)===255;)n++,r+=255;return r+=i.getUint8(n++),{payloadLength:r,offset:n}}},{key:"user_data_unregistered",value:function(t){var i=h.getPayloadLength(t),r=i.payloadLength,n=i.offset;if(r<16)return{uuid:"",content:null};var u=t.slice(n),o=Qo(u.slice(0,16)),c=Qo(u.slice(16,r));return{code:5,uuid:o,content:c}}}]),h}(),el=pd,gd=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function vd(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var yd=function(){function h(){vd(this,h)}return gd(h,null,[{key:"getNalunits",value:function(t){if(t.length-t.position<4)return[];var i=t.dataview,r=t.position;return i.getInt32(r)===1||i.getInt16(r)===0&&i.getInt8(r+2)===1?h.getAnnexbNals(t):h.getHvccNals(t)}},{key:"getAnnexbNals",value:function(t){for(var i=[],r=h.getHeaderPositionAnnexB(t),n=r.pos,u=n;n<t.length-4;){var o=t.buffer.slice(n,n+r.headerLength);r.pos===t.position&&t.skip(r.headerLength),r=h.getHeaderPositionAnnexB(t),u=r.pos;var c=new Uint8Array(t.buffer.slice(n+o.byteLength,u)),g={header:o,body:c};h.analyseNal(g),g.type<=40&&i.push(g),t.skip(u-t.position),n=u}return i}},{key:"getHvccNals",value:function(t){for(var i=[];t.position<t.length-4;){var r=t.dataview.getInt32(t.dataview.position);if(t.length-t.position>=r){var n=t.buffer.slice(t.position,t.position+4);t.skip(4);var u=new Uint8Array(t.buffer.slice(t.position,t.position+r));t.skip(r);var o={header:n,body:u};try{h.analyseNal(o)}catch(c){continue}o.type<=40&&i.push(o)}else break}return i}},{key:"analyseNal",value:function(t){var i=t.body[0]>>>1&63;switch(t.type=i,i){case 0:t.slice_trail_n=!0;break;case 1:t.slice_trail_r=!0,t.key=!0;break;case 2:t.slice_tsa_n=!0;break;case 3:t.slice_tsa_r=!0,t.key=!0;break;case 4:t.slice_stsa_n=!0;break;case 5:t.slice_stsa_r=!0,t.key=!0;break;case 6:t.slice_radl_n=!0;break;case 7:t.slice_radl_r=!0,t.key=!0;break;case 8:t.slice_rasl_n=!0;break;case 9:t.slice_rasl_r=!0,t.key=!0;break;case 16:t.slice_bla_w_lp=!0;break;case 17:t.slice_bla_w_radl=!0;break;case 18:t.slice_bla_n_lp=!0;break;case 19:t.slice_idl_w_radl=!0,t.key=!0;break;case 20:t.slice_idr_n_lp=!0,t.key=!0;break;case 21:t.slice_cra_nut=!0,t.key=!0;break;case 32:t.vps=!0;break;case 33:t.sps=ld.parseSPS(t.body);break;case 34:t.pps=!0;break;case 35:break;case 36:t.aud=!0;break;case 37:t.eob=!0;break;case 38:t.fd=!0;break;case 39:try{t.sei=el.parse(t.body.slice(1))}catch(r){}break;case 40:t.sei=el.parse(t.body.slice(1));break}}},{key:"getHeaderPositionAnnexB",value:function(t){for(var i=t.position,r=0,n=t.length;r!==3&&r!==4&&i<n-4;)t.dataview.getInt16(i)===0?t.dataview.getInt16(i+2)===1?r=4:t.dataview.getInt8(i+2)===1?r=3:i++:i++;return i===n-4&&(t.dataview.getInt16(i)===0?t.dataview.getInt16(i+2)===1&&(r=4):(i++,t.dataview.getInt16(i)===0&&t.dataview.getInt8(i)===1?r=3:i=n)),{pos:i,headerLength:r}}}]),h}(),tl=yd,il={VISIBILITY_CHANGE:"VISIBILITY_CHANGE"},rl={SEEK:"SEEK"},nl={LADER_START:"LOADER_START",LOADER_DATALOADED:"LOADER_DATALOADED",LOADER_COMPLETE:"LOADER_COMPLETE",LOADER_RESPONSE_HEADERS:"LOADER_RESPONSE_HEADERS",LOADER_ERROR:"LOADER_ERROR",LOADER_RETRY:"LOADER_RETRY",LOADER_TTFB:"LOADER_TTFB"},al={DEMUX_START:"DEMUX_START",DEMUX_COMPLETE:"DEMUX_COMPLETE",DEMUX_ERROR:"DEMUX_ERROR",METADATA_PARSED:"METADATA_PARSED",SEI_PARSED:"SEI_PARSED",VIDEO_METADATA_CHANGE:"VIDEO_METADATA_CHANGE",AUDIO_METADATA_CHANGE:"AUDIO_METADATA_CHANGE",MEDIA_INFO:"MEDIA_INFO",ISKEYFRAME:"ISKEYFRAME"},sl={REMUX_METADATA:"REMUX_METADATA",REMUX_MEDIA:"REMUX_MEDIA",MEDIA_SEGMENT:"MEDIA_SEGMENT",REMUX_ERROR:"REMUX_ERROR",INIT_SEGMENT:"INIT_SEGMENT",DETECT_CHANGE_STREAM:"DETECT_CHANGE_STREAM",DETECT_CHANGE_STREAM_DISCONTINUE:"DETECT_CHANGE_STREAM_DISCONTINUE",DETECT_AUDIO_GAP:"DETECT_AUDIO_GAP",DETECT_LARGE_GAP:"DETECT_LARGE_GAP",DETECT_AUDIO_OVERLAP:"DETECT_AUDIO_OVERLAP",RANDOM_ACCESS_POINT:"RANDOM_ACCESS_POINT",DETECT_FRAG_ID_DISCONTINUE:"DETECT_FRAG_ID_DISCONTINUE"},ol={SOURCE_UPDATE_END:"SOURCE_UPDATE_END",MSE_ERROR:"MSE_ERROR",MSE_WRONG_TRACK_ADD:"MSE_WRONG_TRACK_ADD"},ll={RETRY_TIME_EXCEEDED:"RETRY_TIME_EXCEEDED"},md={START_DECRYPTOO:"START_DECRYPTO",DECRYPTED:"DECRYPTED"},Cr=Object.assign({},nl,al,sl,ol,ll,rl,il),ul=[],fl=[];for(var cl in Cr)Cr.hasOwnProperty(cl)&&ul.push(Cr[cl]);for(var dl in Cr)Cr.hasOwnProperty(dl)&&fl.push(Cr[dl]);var _d={ALLEVENTS:Cr,HLS_EVENTS:ll,REMUX_EVENTS:sl,DEMUX_EVENTS:al,MSE_EVENTS:ol,LOADER_EVENTS:nl,FlvAllowedEvents:ul,HlsAllowedEvents:fl,CRYPTO_EVENTS:md,PLAYER_EVENTS:rl,BROWSER_EVENTS:il},xd=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Ed(h){if(Array.isArray(h)){for(var a=0,t=Array(h.length);a<h.length;a++)t[a]=h[a];return t}else return Array.from(h)}function bd(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var wd=function(){function h(){var a=this;bd(this,h);try{var t=/xgd=(\d)/.exec(document.cookie);this._status=!!t,this._level=t&&t[1]}catch(i){this._status=!1}["group","groupEnd","log","warn","error"].forEach(function(i){a[i]=function(r,n,u,o,c,g,v,p,e,s){var l;if(!!a._status){var f=r,d=[n,u,o,c,g,v,p,e,s].filter(function(y){return y!==void 0});(l=console)[i].apply(l,["["+f+"]:"].concat(Ed(d)))}}})}return xd(h,[{key:"enable",get:function(){return this._status}},{key:"long",get:function(){return this._level==="2"}}]),h}(),ti=new wd,Td=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function hl(h){if(Array.isArray(h)){for(var a=0,t=Array(h.length);a<h.length;a++)t[a]=h[a];return t}else return Array.from(h)}function Sd(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var ui=_d.REMUX_EVENTS,kd=function(){function h(){var a=this;Sd(this,h),this.TAG="Compatibility",this.nextAudioDts=0,this.nextVideoDts=0,this.lastAudioSamplesLen=0,this.lastVideoSamplesLen=0,this.lastVideoDts=void 0,this.lastAudioDts=void 0,this.allAudioSamplesCount=0,this.allVideoSamplesCount=0,this._firstAudioSample=null,this._firstVideoSample=null,this.filledAudioSamples=[],this.filledVideoSamples=[],this._lastSegmentId=0,this._currentSegmentId=0,this.videoLastSample=null,this.audioLastSample=null,Object.defineProperties(this,{_videoLargeGap:{set:function(i){a.___videoLargeGap=i,i!==0&&a.emit(ui.DETECT_LARGE_GAP,"video",i)},get:function(){return a.___videoLargeGap||0}},_audioLargeGap:{set:function(i){a.___audioLargeGap=i,i!==0&&a.emit(ui.DETECT_LARGE_GAP,"audio",i)},get:function(){return a.___audioLargeGap||0}}}),this.audioUnsyncTime=0}return Td(h,[{key:"init",value:function(){this.before(ui.REMUX_MEDIA,this.doFix.bind(this))}},{key:"reset",value:function(){this.nextAudioDts=null,this.nextVideoDts=null,this.lastAudioSamplesLen=0,this.lastVideoSamplesLen=0,this.lastVideoDts=void 0,this.lastAudioDts=void 0,this._audioLargeGap=0,this._videoLargeGap=0,this.videoLastSample=null,this.audioLastSample=null,this.filledAudioSamples=[],this.filledVideoSamples=[],this.audioUnsyncTime=0}},{key:"_isSegmentsContinuous",value:function(){return this._lastSegmentId===0||this._currentSegmentId-this._lastSegmentId==1}},{key:"doFix",value:function(){var t=void 0,i=void 0,r=void 0,n=0;this.videoTrack.samples.length&&(i=this.videoTrack.samples[0],t=i.options,ti.long&&ti.log(this.TAG,this.videoTrack.samples.slice())),this.audioTrack.samples.length&&(r=this.audioTrack.samples[0],ti.long&&ti.log(this.TAG,this.audioTrack.samples.slice())),i&&r&&(n=r.dts-i.dts),this._currentSegmentId=t&&t.id||this._currentSegmentId+1,ti.log(this.TAG,"lastSeg:"+this._lastSegmentId+" , currentSeg:"+this._currentSegmentId+", discontinue:"+(t&&t.discontinue)+" vSamp0:"+(i&&i.dts)+" aSamp0:"+(r&&r.dts));var u=this.getFirstSample(),o=u.isFirstAudioSamples,c=u.isFirstVideoSamples;this.recordSamplesCount(),this._firstVideoSample&&this.fixVideoRefSampleDuration(this.videoTrack.meta,this.videoTrack.samples);var g=h.detectChangeStream(this.videoTrack.samples,c),v=g.changed,p=g.changedIdxes;if(v){for(var e=!1,s=0;s<p.length;s++)this.fixChangeStreamVideo(p[s],c)&&(e=!0);e||this.doFixVideo(c)}else if(!this._isSegmentsContinuous()&&t&&t.start!==void 0){this.videoLastSample=null;var l=t.start;n<0&&(l-=n),ti.log(this.TAG,"fix video for _isSegmentsContinuous()\uFF0C delta:",n),this.doFixVideo(c,l),this.emit(ui.DETECT_FRAG_ID_DISCONTINUE,t.start/1e3)}else this.doFixVideo(c);this._appendSampleForLastSegment(t&&t.isLast);var f=h.detectChangeStream(this.audioTrack.samples,o),d=f.changed,y=f.changedIdxes;if(d){for(var m=!1,_=0;_<y.length;_++)this.fixChangeStreamAudio(y[_],o)&&(m=!0);if(!m)this.doFixAudio(o);else return}else if(!this._isSegmentsContinuous()&&t&&t.start!==void 0){ti.log(this.TAG,"fix audio for _isSegmentsContinuous()");var E=this.audioTrack.samples[0];this.nextAudioDts=t.start||E&&E.dts,this.doFixAudio(o,t.start),this.emit(ui.DETECT_FRAG_ID_DISCONTINUE,t.start/1e3)}else this.doFixAudio(o);this.removeInvalidSamples(),this._lastSegmentId=this._currentSegmentId}},{key:"doFixVideo",value:function(t,i){for(var r=this.videoTrack,n=r.samples,u=r.meta,o=n.length,c=0;c<o;c++){var g=n[c];g.originDts=g.dts,g.originPts=g.pts}if(!(!n||!o||!this._firstVideoSample)){var v=n[0];if(ti.log(this.TAG,"doFixVideo:: lastVideoDts: "+this.lastVideoDts+" ,  _videoLargeGap: "+this._videoLargeGap+" ,streamChangeStart:"+i+", lastVideoSample:[dts="+(this.videoLastSample&&this.videoLastSample.dts)+" , pts="+(this.videoLastSample&&this.videoLastSample.pts)+"] ,  firstDTS:"+v.dts+" ,firstPTS:"+v.pts+" ,lastDTS:"+n[o-1].dts+" , lastPTS: "+n[o-1].pts),!t&&i===void 0&&this.videoLastSample&&h.detectVideoLargeGap(this.videoLastSample?this.videoLastSample.dts:0,v.dts+this._videoLargeGap)&&(this._videoLargeGap=this.videoLastSample.dts+u.refSampleDuration-v.dts),this._videoLargeGap!==0&&(h.doFixLargeGap(n,this._videoLargeGap),this._videoLargeGap!==this.preVideoGap&&(this.preVideoGap=this._videoLargeGap,this.emit(ui.DETECT_CHANGE_STREAM_DISCONTINUE,"video",{prevDts:this.videoLastSample&&this.videoLastSample.originDts,curDts:v.originDts}))),!t&&i!==void 0&&i!==0&&(this._videoLargeGap=i-v.dts,h.doFixLargeGap(n,this._videoLargeGap)),t&&this._firstAudioSample){var p=this._firstVideoSample.originDts,e=this._firstAudioSample.dts,s=p-e;if(s>2*u.refSampleDuration&&s<10*u.refSampleDuration){for(var l=Math.floor(s/u.refSampleDuration),f=0;f<l;f++){var d=Object.assign({},v);d.dts=p-(f+1)*u.refSampleDuration,d.pts=d.dts+d.cts,n.unshift(d),this.filledVideoSamples.push({dts:d.dts,size:d.data.byteLength})}this._firstVideoSample=this.filledVideoSamples[0]||this._firstVideoSample}else Math.abs(s)>2*u.refSampleDuration&&!this._videoLargeGap&&(this._videoLargeGap=-1*s,h.doFixLargeGap(n,-1*s))}for(var y=n.length,m=1;m<y;m++){var _=n[m],E=n[m-1],w=_.dts-_.pts;Math.abs(w)<2e3&&Math.abs(_.dts-E.dts)>1e4&&(_.dts=E.dts+u.refSampleDuration,_.pts=E.pts+u.refSampleDuration)}var k=n.pop();if(n.length&&(n[n.length-1].duration=k.dts-n[n.length-1].dts),y<4){var x=n[n.length-1];x=x||k;var S=x.options&&x.options.duration,P=u.refSampleDuration;if(S&&P&&S/P>5)for(var U=x.pts,R=x.dts,C=0;C<3;C++){R+=P,U+=P;var A=Object.assign({},x,{dts:R,pts:U});C===2&&(A.duration=S),n.push(A)}k=null}if(this.videoLastSample){var b=this.videoLastSample;b.duration=v.dts-b.dts,n.unshift(this.videoLastSample)}this.videoLastSample=k,n[n.length-1]&&(this.lastVideoDts=n[n.length-1].dts),this.videoTrack.samples=n}}},{key:"_appendSampleForLastSegment",value:function(t){t&&this.videoLastSample&&this.videoTrack.samples.push(this.videoLastSample)}},{key:"doFixAudio",value:function(t,i){var r=this,n=this.audioTrack,u=n.samples,o=n.meta;if(!(!u||!u.length)){this.fixAudioRefSampleDuration(o);for(var c=0,g=u.length;c<g;c++){var v=u[c];v.originDts=v.dts}var p=u.length,e=Pc.getSilentFrame(o.originCodec,o.channelCount),s=Math.floor(o.refSampleDuration),l=this._firstAudioSample,f=u[0];if(ti.log(this.TAG,"doFixAudio:: audioDtsBase:"+this.audioDtsBase+" ,  _audioLargeGap: "+this._audioLargeGap+", streamChangeStart:"+i+" ,  nextAudioDts:"+this.nextAudioDts+",  audio: firstDTS:"+f.dts+" ,firstPTS:"+f.pts+" ,lastDTS:"+u[p-1].dts+" , lastPTS: "+u[p-1].pts),!t&&this.nextAudioDts===null&&f.options&&f.options.start&&i!==void 0&&(i=f.options.start),!t&&i===void 0&&this.nextAudioDts&&h.detectAudioLargeGap(this.nextAudioDts||0,f.dts+this._audioLargeGap)){var d=this.nextAudioDts-f.dts;this._audioLargeGap=Math.abs(d-this._videoLargeGap)<200?this._videoLargeGap:d}if(this._audioLargeGap!==0?(h.doFixLargeGap(u,this._audioLargeGap),this._audioLargeGap!==this.preAudioGap&&(this.preAudioGap=this._audioLargeGap,this.emit(ui.DETECT_CHANGE_STREAM_DISCONTINUE,"audio",{prevDts:this.lastAudioOriginDts,curDts:f.originDts}))):!t&&(i!==void 0||h.detectAudioLargeGap(this.nextAudioDts,f.dts))&&(i!==void 0&&i!==0&&(this.nextAudioDts=i),this._audioLargeGap=this.nextAudioDts-f.dts,f.options.start&&!f.options.start.isContinue&&h.doFixLargeGap(u,this._audioLargeGap)),this._firstVideoSample&&t){var y=this._firstVideoSample.originDts||this._firstVideoSample.dts,m=l.dts-y;if(m!==this._videoLargeGap)if(m>o.refSampleDuration&&m<10*o.refSampleDuration){var _=Math.floor((l.dts-y)/o.refSampleDuration);ti.warn(this.TAG,"fill "+_+" frames for av align");for(var E=0;E<_;E++){var w={data:e,datasize:e.byteLength,dts:l.dts-(E+1)*o.refSampleDuration,filtered:0};u.unshift(w),this.filledAudioSamples.push({dts:w.dts,size:w.data.byteLength})}this._firstAudioSample=this.filledAudioSamples[0]||this._firstAudioSample}else m<-1*o.refSampleDuration&&(this._audioLargeGap=-1*m,h.doFixLargeGap(u,-1*m))}var k=void 0,x=u[0].dts;if(this.nextAudioDts){k=x-this.nextAudioDts;var S=Math.abs(k);if(k>=s&&k<1e4&&e){for(var P=Math.ceil(k/s),U=0;U<P;U++){var R=x-(U+1)*s,C={dts:R>this.nextAudioDts?R:this.nextAudioDts,pts:R>this.nextAudioDts?R:this.nextAudioDts,datasize:e.byteLength,filtered:0,data:e};this.filledAudioSamples.push({dts:C.dts,size:C.data.byteLength}),this.audioTrack.samples.unshift(C),f=C}this.emit(ui.DETECT_AUDIO_GAP,k,P)}else S<o.refSampleDuration&&S>0?(f.dts=this.nextAudioDts,f.pts=this.nextAudioDts):k<0&&S<s&&(h.doFixLargeGap(u,-1*k),this.emit(ui.DETECT_AUDIO_OVERLAP,k))}for(var A=u[0].dts+s,b=1;b<u.length;){var O=u[b],W=O.dts-A;if(W<=-1*s){ti.warn("drop 1 audio sample for "+W+" ms overlap"),u.splice(b,1);continue}if(W>=10*s){var K=Math.round(W/s);if(K>1e3)break;ti.warn(this.TAG,"inject "+K+" audio frame for "+W+" ms gap, index="+b);for(var G=0;G<K;G++){var B={data:e,datasize:e.byteLength,dts:A,originDts:A,filtered:0};u.splice(b,0,B),A+=s,b++}O.dts=O.pts=O.originDts=A,A+=s,b++}else O.dts=O.pts=O.originDts=A,A+=s,b++}var j=o.refSampleDuration-s;u.forEach(function(J,Q){if(Q!==0){var ne=u[Q-1];J.dts=J.pts=ne.dts+ne.duration}J.duration=s,r.audioUnsyncTime=r.audioUnsyncTime+j,r.audioUnsyncTime>=1&&(J.duration+=1,r.audioUnsyncTime-=1)});var z=u[u.length-1];this.lastAudioDts=z.dts;var $=z.duration;this.lastAudioSamplesLen=p,this.nextAudioDts=this.lastAudioDts+($||s),this.lastAudioOriginDts=z.originDts,this.audioTrack.samples=h.sortAudioSamples(u)}}},{key:"fixChangeStreamVideo",value:function(t){ti.log(this.TAG,"fixChangeStreamVideo(), changeIdx=",t);var i=this.videoTrack.samples,r=t===0?this.lastVideoDts?this.lastVideoDts:this.getStreamChangeStart(i[0]):i[t-1].dts,n=i[t].dts,u=Math.abs(r-n)<=1e4;if(this.emit(ui.DETECT_CHANGE_STREAM,"video",n),u)return i[t].options?i[t].options.isContinue=!0:i[t].options={isContinue:!0},!1;this.emit(ui.DETECT_CHANGE_STREAM_DISCONTINUE,"video",{prevDts:r,curDts:n});var o=i.slice(0,t),c=i.slice(t),g=i[t],v=void 0;return this._videoLargeGap=0,this.videoLastSample=null,this.lastVideoDts=null,g.options&&g.options.start!==void 0?v=g.options.start:v=r-this.videoDtsBase,this.videoTrack.samples=i.slice(0,t),this.doFixVideo(!1),this.videoTrack.samples=i.slice(t),this.doFixVideo(!1,v),this.videoTrack.samples=o.concat(c),!0}},{key:"fixChangeStreamAudio",value:function(t){ti.log(this.TAG,"fixChangeStreamAudio(), changeIdx=",t);var i=this.audioTrack.samples,r=t===0?this.lastAudioDts:i[t-1].dts,n=i[t].dts,u=Math.abs(r-n)<=1e4;if(this.emit(ui.DETECT_CHANGE_STREAM,"audio",n),u)return i[t].options?i[t].options.isContinue=!0:i[t].options={isContinue:!0},!1;this.emit(ui.DETECT_CHANGE_STREAM_DISCONTINUE,"audio",{prevDts:r,curDts:n}),this._audioLargeGap=0;var o=this.nextAudioDts;this.nextAudioDts=null;var c=i.slice(0,t),g=i.slice(t),v=i[t],p=void 0;return v.options&&v.options.start!==void 0?p=v.options.start:(p=o,v.options.isContinue=!0),this.audioTrack.samples=c,this.doFixAudio(!1),this.audioTrack.samples=g,this.doFixAudio(!1,p),this.audioTrack.samples=c.concat(g),!0}},{key:"getFirstSample",value:function(){var t=this.videoTrack.samples,i=this.audioTrack.samples,r=!1,n=!1;return!this._firstVideoSample&&t.length&&(this._firstVideoSample=h.findFirstVideoSample(t),this.removeInvalidSamples(),r=!0),!this._firstAudioSample&&i.length&&(this._firstAudioSample=h.findFirstAudioSample(i),this.removeInvalidSamples(),n=!0),{isFirstVideoSamples:r,isFirstAudioSamples:n}}},{key:"fixVideoRefSampleDuration",value:function(t,i){if(!!t){var r=this.allVideoSamplesCount,n=this._firstVideoSample.dts,u=this.filledVideoSamples.length;if(h.isRefSampleDurationValid(t.refSampleDuration)){if(t.refSampleDuration&&i.length>=5){var g=i[i.length-1].dts,v=i[0].dts,p=(g-v)/(i.length-1);if(p>0&&p<1e3){var e=Math.floor(Math.abs(t.refSampleDuration-p)<=5?t.refSampleDuration:p);h.isRefSampleDurationValid(e)&&(t.refSampleDuration=e)}}}else if(i.length>=1){var o=i[i.length-1].dts,c=Math.floor((o-n)/(r+u-1));h.isRefSampleDurationValid(c)&&(t.refSampleDuration=c)}h.isRefSampleDurationValid(t.refSampleDuration)||(t.refSampleDuration=66)}}},{key:"fixAudioRefSampleDuration",value:function(t){!t||(t.refSampleDuration=t.timescale*1024/t.sampleRate)}},{key:"recordSamplesCount",value:function(){var t=this.audioTrack,i=this.videoTrack;this.allAudioSamplesCount+=t.samples.length,this.allVideoSamplesCount+=i.samples.length}},{key:"removeInvalidSamples",value:function(){var t=this.audioTrack.samples[0],i=this.videoTrack.samples[0];t&&(this.audioTrack.samples=this.audioTrack.samples.filter(function(r,n){return r===t?!0:r.dts>=t.dts})),i&&(this.videoTrack.samples=this.videoTrack.samples.filter(function(r,n){return r===i?!0:r.dts>=i.dts}))}},{key:"getStreamChangeStart",value:function(t){return t.options&&t.options.start?t.options.start-this.dtsBase:1/0}},{key:"tracks",get:function(){return this._context.getInstance("TRACKS")}},{key:"audioTrack",get:function(){return this.tracks&&this.tracks.audioTrack?this.tracks.audioTrack:{samples:[],meta:{}}}},{key:"videoTrack",get:function(){return this.tracks&&this.tracks.videoTrack?this.tracks.videoTrack:{samples:[],meta:{}}}},{key:"dtsBase",get:function(){var t=this._context.getInstance("MP4_REMUXER");return t?t._dtsBase:0}},{key:"audioDtsBase",get:function(){var t=this._context.getInstance("MP4_REMUXER");return t&&t._audioDtsBase!==null?t._audioDtsBase:this.dtsBase}},{key:"videoDtsBase",get:function(){var t=this._context.getInstance("MP4_REMUXER");return t&&t._videoDtsBase!==null?t._videoDtsBase:this.dtsBase}}],[{key:"sortAudioSamples",value:function(t){return t.length===1?t:[].concat(hl(t)).sort(function(i,r){return i.dts-r.dts})}},{key:"isRefSampleDurationValid",value:function(t){return t&&t>0&&!Number.isNaN(t)}},{key:"findFirstAudioSample",value:function(t){return!t||t.length===0?null:h.sortAudioSamples(t)[0]}},{key:"findFirstVideoSample",value:function(t){if(!t.length)return null;for(var i=[].concat(hl(t)).sort(function(u,o){return u.dts-o.dts}),r=0,n=i.length;r<n;r++)if(i[r].isKeyframe)return i[r]}},{key:"detectVideoLargeGap",value:function(t,i){if(t!==null){var r=1e3;return t-i>=r||i-t>=r}}},{key:"detectAudioLargeGap",value:function(t,i){if(t!==null)return t-i>=1e3||i-t>=1e3}},{key:"doFixLargeGap",value:function(t,i){for(var r=0,n=t.length;r<n;r++){var u=t[r];u.dts+=i,u.pts&&(u.pts+=i)}var o=t[0];o&&o.dts===0&&(o.dts=o.pts=1)}},{key:"detectChangeStream",value:function(t,i){for(var r=!1,n=[],u=0,o=t.length;u<o;u++){var c=t[u];c.options&&c.options.meta&&!(i&&u===0)&&(r=!0,n.push(u))}return{changed:r,changedIdxes:n}}}]),h}(),pl=kd,gl={VISIBILITY_CHANGE:"VISIBILITY_CHANGE"},vl={SEEK:"SEEK"},yl={LADER_START:"LOADER_START",LOADER_DATALOADED:"LOADER_DATALOADED",LOADER_COMPLETE:"LOADER_COMPLETE",LOADER_RESPONSE_HEADERS:"LOADER_RESPONSE_HEADERS",LOADER_ERROR:"LOADER_ERROR",LOADER_RETRY:"LOADER_RETRY",LOADER_TTFB:"LOADER_TTFB"},ml={DEMUX_START:"DEMUX_START",DEMUX_COMPLETE:"DEMUX_COMPLETE",DEMUX_ERROR:"DEMUX_ERROR",METADATA_PARSED:"METADATA_PARSED",SEI_PARSED:"SEI_PARSED",VIDEO_METADATA_CHANGE:"VIDEO_METADATA_CHANGE",AUDIO_METADATA_CHANGE:"AUDIO_METADATA_CHANGE",MEDIA_INFO:"MEDIA_INFO",ISKEYFRAME:"ISKEYFRAME"},_l={REMUX_METADATA:"REMUX_METADATA",REMUX_MEDIA:"REMUX_MEDIA",MEDIA_SEGMENT:"MEDIA_SEGMENT",REMUX_ERROR:"REMUX_ERROR",INIT_SEGMENT:"INIT_SEGMENT",DETECT_CHANGE_STREAM:"DETECT_CHANGE_STREAM",DETECT_CHANGE_STREAM_DISCONTINUE:"DETECT_CHANGE_STREAM_DISCONTINUE",DETECT_AUDIO_GAP:"DETECT_AUDIO_GAP",DETECT_LARGE_GAP:"DETECT_LARGE_GAP",DETECT_AUDIO_OVERLAP:"DETECT_AUDIO_OVERLAP",RANDOM_ACCESS_POINT:"RANDOM_ACCESS_POINT",DETECT_FRAG_ID_DISCONTINUE:"DETECT_FRAG_ID_DISCONTINUE"},xl={SOURCE_UPDATE_END:"SOURCE_UPDATE_END",MSE_ERROR:"MSE_ERROR",MSE_WRONG_TRACK_ADD:"MSE_WRONG_TRACK_ADD"},El={RETRY_TIME_EXCEEDED:"RETRY_TIME_EXCEEDED"},Ad={START_DECRYPTOO:"START_DECRYPTO",DECRYPTED:"DECRYPTED"},Dr=Object.assign({},yl,ml,_l,xl,El,vl,gl),bl=[],wl=[];for(var Tl in Dr)Dr.hasOwnProperty(Tl)&&bl.push(Dr[Tl]);for(var Sl in Dr)Dr.hasOwnProperty(Sl)&&wl.push(Dr[Sl]);var Ka={ALLEVENTS:Dr,HLS_EVENTS:El,REMUX_EVENTS:_l,DEMUX_EVENTS:ml,MSE_EVENTS:xl,LOADER_EVENTS:yl,FlvAllowedEvents:bl,HlsAllowedEvents:wl,CRYPTO_EVENTS:Ad,PLAYER_EVENTS:vl,BROWSER_EVENTS:gl},Cd=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Dd(h){if(Array.isArray(h)){for(var a=0,t=Array(h.length);a<h.length;a++)t[a]=h[a];return t}else return Array.from(h)}function Rd(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Ud=function(){function h(){var a=this;Rd(this,h);try{var t=/xgd=(\d)/.exec(document.cookie);this._status=!!t,this._level=t&&t[1]}catch(i){this._status=!1}["group","groupEnd","log","warn","error"].forEach(function(i){a[i]=function(r,n,u,o,c,g,v,p,e,s){var l;if(!!a._status){var f=r,d=[n,u,o,c,g,v,p,e,s].filter(function(y){return y!==void 0});(l=console)[i].apply(l,["["+f+"]:"].concat(Dd(d)))}}})}return Cd(h,[{key:"enable",get:function(){return this._status}},{key:"long",get:function(){return this._level==="2"}}]),h}(),_i=new Ud,Ld=function(){function h(a,t){var i=[],r=!0,n=!1,u=void 0;try{for(var o=a[Symbol.iterator](),c;!(r=(c=o.next()).done)&&(i.push(c.value),!(t&&i.length===t));r=!0);}catch(g){n=!0,u=g}finally{try{!r&&o.return&&o.return()}finally{if(n)throw u}}return i}return function(a,t){if(Array.isArray(a))return a;if(Symbol.iterator in Object(a))return h(a,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},kl=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Fd(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}function Bd(h,a){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:h}function Od(h,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);h.prototype=Object.create(a&&a.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(h,a):h.__proto__=a)}var Al=Zo,Id=tl,Md={1:["video","MPEG-1"],2:["video","MPEG-2"],27:["video","AVC.H264"],36:["video","HVC.H265"],234:["video","VC-1"],3:["audio","MPEG-1"],4:["audio","MPEG-2"],15:["audio","MPEG-2.AAC"],17:["audio","MPEG-4.AAC"],128:["audio","LPCM"],129:["audio","AC3"],6:["audio","AC3"],130:["audio","DTS"],131:["audio","Dolby TrueHD"],132:["audio","AC3-Plus"],133:["audio","DTS-HD"],134:["audio","DTS-MA"],161:["audio","AC3-Plus-SEC"],162:["audio","DTS-HD-SEC"]},Nd=function(h){Od(a,h),kl(a,null,[{key:"EVENTS",get:function(){return{DEMUX_COMPLETE:"DEMUX_COMPLETE",METADATA_PARSED:"METADATA_PARSED",VIDEO_SAMPLE_PARSED:"VIDEO_SAMPLE_PARSED",AUDIO_SAMPLE_PARSED:"AUDIO_SAMPLES_PARSED",SEI_PARSED:"SEI_PARSED"}}}]);function a(t){var i=t.videoTrack,r=t.audioTrack;Fd(this,a);var n=Bd(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return n.TAG="TsDemuxer",n.demuxing=!1,n.videoTrack=i,n.audioTrack=r,n.pat=[],n.pmt=[],n._hasVideoMeta=!1,n._hasAudioMeta=!1,n.gopId=0,n}return kl(a,[{key:"demux",value:function(i,r,n){if(i&&_i.log(this.TAG,"do demux: id="+i.id+",demuxing="+this.demuxing),!this.demuxing){for(var u={pat:[],pmt:[]},o={};r.length>=188;){if(r.length>=1&&r.array[0][r.offset]!==71)throw new Error("Untrust sync code: "+r.array[0][r.offset]+", try to recover;");for(;r.length>=1&&r.array[0][r.offset]!==71;)r.shift(1);if(!(r.length<188)){var c=r.shift(188),g=new _n(c.buffer),v={};a.read(g,v,u);var p=o[v.header.pid];v.pes?(v.pes.codec=v.header.codec,v.pes.streamType=v.header.streamType,o[v.header.pid]||(o[v.header.pid]=[]),o[v.header.pid].push(v.pes),v.pes.ES.buffer=[v.pes.ES.buffer]):p&&p[p.length-1].ES.buffer.push(v.payload.stream)}}for(var e=Object.assign({},i),s=Object.assign({},i),l=n&&this._hasVideoMeta&&!this._hasAudioMeta,f=n&&this._hasAudioMeta&&!this._hasVideoMeta,d=0;d<Object.keys(o).length;d++)for(var y=o[Object.keys(o)[d]],m=0;m<y.length;m++){var _=y[m];_.id=Object.keys(o)[d];var E=_.streamType===15||_.streamType===17;_.type==="audio"&&!l&&E?(_.ES.buffer=a.mergeAudioES(_.ES.buffer),this.pushAudioSample(_,e),e={}):_.type==="video"&&!f&&(_.ES.buffer=a.mergeVideoES(_.ES.buffer),_.codec==="HVC.H265"?this.pushVideoSampleHEVC(y[m],s):this.pushVideoSample(y[m],s),s={spsFound:!!s.spsFound})}}}},{key:"pushAudioSample",value:function(i,r){var n=new Kf({audioSampleRate:i.ES.frequence,sampleRate:i.ES.frequence,channelCount:i.ES.channel,codec:"mp4a.40."+i.ES.audioObjectType,originCodec:"mp4a.40."+i.ES.originAudioObjectType,originObjectType:i.ES.originAudioObjectType,config:i.ES.audioConfig,id:2,sampleRateIndex:i.ES.frequencyIndex});n.refSampleDuration=Math.floor(1024/n.audioSampleRate*n.timescale);var u=a.compareMeta(this.audioTrack.meta,n,!0);(!this._hasAudioMeta||!u)&&(this._hasAudioMeta=!0,r?r.meta=Object.assign({},n):r={meta:Object.assign({},n)},this.emit(a.EVENTS.METADATA_PARSED,"audio",n));var o=0;i.ES.buffer.skip(i.pesHeaderLength+9);for(var c=!1;i.ES.buffer.position<i.ES.buffer.length;)if(Xo.isHeader(new Uint8Array(i.ES.buffer.buffer),i.ES.buffer.position)&&i.ES.buffer.position+5<i.ES.buffer.length){var g=Xo.appendFrame(this.audioTrack.meta.sampleRate,new Uint8Array(i.ES.buffer.buffer),i.ES.buffer.position,i.pts,o);if(g&&g.sample){i.ES.buffer.skip(g.length);var v=new qf({dts:g.sample.dts,pts:g.sample.pts,data:g.sample.unit,options:c?{}:r});r.meta&&(c=!0),v.dts=v.pts=Math.ceil(v.pts/90),this.emit(a.EVENTS.AUDIO_SAMPLE_PARSED,v),o++}else break}else i.ES.buffer.skip(1)}},{key:"pushVideoSample",value:function(i,r){for(var n=this,u=Al.getNalunits(i.ES.buffer),o=new Bo,c=r.spsFound,g=0,v=!1,p=!1,e=[],s=0;s<u.length;s++){var l=u[s];if(l.type<9&&!l.sei&&(g+=4+l.body.byteLength),l.sps){v=l,o.sps=l.body,o.chromaFormat=v.sps.chroma_format,o.codec="avc1.";for(var f=1;f<4;f++){var d=v.body[f].toString(16);d.length<2&&(d="0"+d),o.codec+=d}o.codecHeight=v.sps.codec_size.height,o.codecWidth=v.sps.codec_size.width,o.frameRate=v.sps.frame_rate,o.id=1,o.level=v.sps.level_string,o.presentHeight=v.sps.present_size.height,o.presentWidth=v.sps.present_size.width,o.profile=v.sps.profile_string,o.refSampleDuration=Math.floor(o.timescale*(v.sps.frame_rate.fps_den/v.sps.frame_rate.fps_num)),o.sarRatio=v.sps.sar_ratio?v.sps.sar_ratio:v.sps.par_ratio}else l.pps?(o.pps=l.body,p=l):l.sei&&e.push(l.sei)}if(v&&p){o.avcc=Al.getAvcc(v.body,p.body);var y=a.compareMeta(this.videoTrack.meta,o,!0);(!this._hasVideoMeta||!y)&&(r?r.meta=Object.assign({},o):r={meta:Object.assign({},o)},c||this.emit(a.EVENTS.METADATA_PARSED,"video",o),r.spsFound=!0,this._hasVideoMeta=!0)}for(var m=new Uint8Array(g),_=0,E=!1,w=0;w<u.length;w++){var k=u[w];if(!(k.type&&k.type>=9)){var x=k.body.byteLength;k.idr&&(E=!0),k.sei||(m.set(new Uint8Array([x>>>24&255,x>>>16&255,x>>>8&255,x&255]),_),_+=4,m.set(k.body,_),_+=x)}}var S=parseInt(i.dts/90),P=parseInt(i.pts/90);e.length&&e.forEach(function(R){R.dts=S,n.emit(a.EVENTS.SEI_PARSED,R)});var U=new Mo({dts:S,pts:P,cts:P-S,originDts:i.dts,purePts:i.purePts,isKeyframe:E,data:m,nals:u,options:r,firstInGop:E,gopId:E?++this.gopId:this.gopId});this.emit(a.EVENTS.VIDEO_SAMPLE_PARSED,U)}},{key:"pushVideoSampleHEVC",value:function(i,r){var n=this,u=Id.getNalunits(i.ES.buffer);u=u.filter(function(A){return A.body&&A.body.length});var o=new Bo;o.streamType=36;for(var c=0,g=!1,v=!1,p=!1,e=[],s=!1,l=!1,f=!1,d=!1,y=0;y<u.length;y++){var m=u[y];if(m.vps){if(s)continue;s=!0}else if(m.sps){if(l)continue;l=!0}else if(m.pps){if(f)continue;f=!0}else if(m.key)(m.type===20||m.type===19)&&(d=!0);else if(m.type!==0){if(m.type===35)continue}m.sps?(v=m,o.sps=m.body,o.presentWidth=v.sps.width,o.presentHeight=v.sps.height,o.general_profile_space=v.sps.general_profile_space,o.general_tier_flag=v.sps.general_tier_flag,o.general_profile_idc=v.sps.general_profile_idc,o.general_level_idc=v.sps.general_level_idc,o.codec="hev1.1.6.L93.B0",o.chromaFormatIdc=v.sps.chromaFormatIdc,o.bitDepthLumaMinus8=v.sps.bitDepthLumaMinus8,o.bitDepthChromaMinus8=v.sps.bitDepthChromaMinus8):m.pps?(o.pps=m.body,p=m):m.vps?(o.vps=m.body,g=m):m.sei&&e.push(m.sei),m.type<=40&&(c+=4+m.body.byteLength)}if(v&&p&&g){var _=a.compareMeta(this.videoTrack.meta,o,!0);(!this._hasVideoMeta||!_)&&(r?r.meta=Object.assign({},o):r={meta:Object.assign({},o)},o.streamType=36,this.videoTrack.meta=o,this._hasVideoMeta=!0,this.emit(a.EVENTS.METADATA_PARSED,"video",o))}var E=new Uint8Array(c),w=0,k=!1;s=!1,l=!1,f=!1;for(var x=0;x<u.length;x++){var S=u[x];if(!(S.type&&S.type>40)){if(S.vps){if(s)continue;s=!0}else if(S.sps){if(l)continue;l=!0}else if(S.pps){if(f)continue;f=!0}else if(!S.key){if(S.type!==0){if(S.type===35)continue}}var P=S.body.byteLength;S.key&&(k=!0),E.set(new Uint8Array([P>>>24&255,P>>>16&255,P>>>8&255,P&255]),w),w+=4,E.set(S.body,w),w+=P}}var U=parseInt(i.dts/90),R=parseInt(i.pts/90);e&&e.forEach(function(A){A.dts=U,n.emit(a.EVENTS.SEI_PARSED,A)});var C=new Mo({dts:U,pts:R,cts:R-U,originDts:i.dts,purePts:i.purePts,isKeyframe:k,data:E,nals:u,options:r,firstInGop:d,gopId:d?++this.gopId:this.gopId});this.emit(a.EVENTS.VIDEO_SAMPLE_PARSED,C)}},{key:"destroy",value:function(){this.removeAllListeners(),this.configs={},this.demuxing=!1,this.pat=[],this.pmt=[],this._hasVideoMeta=!1,this._hasAudioMeta=!1}}],[{key:"compareArray",value:function(i,r,n){var u=0,o=0;if(n==="Uint8Array"?(u=i.byteLength,o=r.byteLength):n==="Array"&&(u=i.length,o=r.length),u!==o)return!1;for(var c=0;c<u;c++)if(i[c]!==r[c])return!1;return!0}},{key:"compareMeta",value:function(i,r,n){if(!i||!r)return!1;for(var u=0,o=Object.keys(i).length;u<o;u++){var c=i[Object.keys(i)[u]],g=r[Object.keys(i)[u]];if(!c&&!g)return!0;if(c==null&&g||c&&g===void 0)return!1;if((typeof c=="undefined"?"undefined":Pd(c))!=="object"){if(n&&Object.keys(i)[u]!=="duration"&&Object.keys(i)[u]!=="refSampleDuration"&&Object.keys(i)[u]!=="refSampleDurationFixed"&&c!==g)return!1}else if(c.byteLength!==void 0){if(g.byteLength===void 0||!a.compareArray(c,g,"Uint8Array"))return!1}else if(c.length!==void 0){if(g.length===void 0||!a.compareArray(c,g,"Array"))return!1}else if(!a.compareMeta(c,g))return!1}return!0}},{key:"mergeVideoES",value:function(i){for(var r=void 0,n=0,u=0,o=0;o<i.length;o++)n+=i[o].length-i[o].position;r=new Uint8Array(n);for(var c=0;c<i.length;c++){var g=i[c];r.set(new Uint8Array(g.buffer,g.position),u),u+=g.length-g.position}return new _n(r.buffer)}},{key:"mergeAudioES",value:function(i){for(var r=void 0,n=0,u=0,o=0;o<i.length;o++)n+=i[o].length;r=new Uint8Array(n);for(var c=0;c<i.length;c++){var g=i[c];r.set(new Uint8Array(g.buffer),u),u+=g.length}return new _n(r.buffer)}},{key:"read",value:function(i,r,n){a.readHeader(i,r),a.readPayload(i,r,n),r.header.packet==="MEDIA"&&r.header.payload===1&&!r.unknownPIDs&&(r.pes=a.PES(r))}},{key:"readPayload",value:function(i,r,n){var u=r.header,o=u.pid;switch(o){case 0:a.PAT(i,r,n);break;case 1:a.CAT(i,r,n);break;case 2:a.TSDT(i,r,n);break;case 8191:break;default:for(var c=!1,g=0,v=n.pat.length;g<v;g++)if(n.pat[g].pid===o){c=!0;break}if(c)a.PMT(i,r,n);else{for(var p=[],e=0,s=n.pmt.length;e<s;e++)if(n.pmt[e].pid===o){p.push(n.pmt[e]);break}if(p.length>0){var l=p[0].streamType;a.Media(i,r,l)}else r.unknownPIDs=!0}}}},{key:"readHeader",value:function(i,r){var n={};n.sync=i.readUint8();var u=i.readUint16();n.error=u>>>15,n.payload=u>>>14&1,n.priority=u>>>13&1,n.pid=u&8191,u=i.readUint8(),n.scrambling=u>>6&3,n.adaptation=u>>4&3,n.continuity=u&15,n.packet=n.pid===0?"PAT":"MEDIA",r.header=n}},{key:"PAT",value:function(i,r,n){var u={},o=i.readUint8();i.skip(o),o=i.readUint8(),u.tabelID=o,o=i.readUint16(),u.error=o>>>7,u.zero=o>>>6&1,u.sectionLength=o&4095,u.streamID=i.readUint16(),u.current=i.readUint8()&1,u.sectionNumber=i.readUint8(),u.lastSectionNumber=i.readUint8();for(var c=(u.sectionLength-9)/4,g=[],v=0;v<c;v++){var p=i.readUint16(),e=i.readUint16()&8191;g.push({program:p,pid:e,type:p===0?"network":"mapPID"})}g.length>0&&(n.pat=n.pat.concat(g)),u.list=g,u.program=i.readUint16(),u.pid=i.readUint16()&8191,r.payload=u}},{key:"PMT",value:function(i,r,n){var u=r.header;u.packet="PMT";var o=i.position;o+=i.getUint8(o),o+=1;var c=(i.getUint8(o+1)&15)<<8|i.getUint8(o+2),g=o+3+c-4,v=(i.getUint8(o+10)&15)<<8|i.getUint8(o+11);o+=12+v;for(var p=[];o<g;){var e=(i.getUint8(o+1)&31)<<8|i.getUint8(o+2);p.push({streamType:i.getUint8(o),pid:e}),o+=((i.getUint8(o+3)&15)<<8|i.getUint8(o+4))+5}n.pmt=p,i.skip(g+4)}},{key:"Media",value:function(i,r,n){var u=r.header,o={},c=Ld(Md[n],2),g=c[0],v=c[1];if(u.streamType=n,u.type=g,u.codec=v,u.adaptation===3&&(o.adaptationLength=i.readUint8(),o.adaptationLength>0)){var p=i.readUint8();o.discontinue=p>>>7,o.access=p>>>6&1,o.priority=p>>>5&1,o.PCR=p>>>4&1,o.OPCR=p>>>3&1,o.splicePoint=p>>>2&1,o.transportPrivate=p>>>1&1,o.adaptationField=p&1;var e=i.position;if(o.PCR===1&&(o.programClockBase=i.readUint32()<<1,p=i.readUint16(),o.programClockBase|=p>>>15,o.programClockExtension=p&511),o.OPCR===1&&(o.originProgramClockBase=i.readUint32()<<1,p=i.readUint16(),o.originProgramClockBase+=p>>>15,o.originProgramClockExtension=p&511),o.splicePoint===1&&(o.spliceCountdown=i.readUint8()),o.transportPrivate===1)for(var s=i.readUint8(),l=[],f=0;f<s;f++)l.push(i.readUint8());if(o.adaptationField===1){var d=i.readUint8(),y=i.readUint8(),m=i.position,_=y>>>7,E=y>>>6&1,w=y>>>5&1;_===1&&(y=i.readUint16(),o.ltwValid=y>>>15,o.ltwOffset=y&61439),E===1&&(y=i.readUint24(),o.piecewiseRate=y&4194303),w===1&&(y=i.readInt8(),o.spliceType=y>>>4,o.dtsNextAU1=y>>>1&7,o.marker1=y&1,y=i.readUint16(),o.dtsNextAU2=y>>>1,o.marker2=y&1,y=i.readUint16(),o.dtsNextAU3=y),i.skip(d-1-(i.position-m))}var k=o.adaptationLength-1-(i.position-e);i.skip(k)}o.stream=new _n(i.buffer.slice(i.position)),r.payload=o}},{key:"PES",value:function(i){var r={},n=i.payload.stream,u=n.readUint24();if(u!==1)r.ES={},r.ES.buffer=n;else{var o=n.readUint8();o>=224&&o<=239&&(r.type="video"),o>=192&&o<=223&&(r.type="audio");var c=n.readUint16();if(r.packetLength=c,r.type==="video"||r.type==="audio"){var g=n.readUint8(),v=g>>>6;if(v!==2)throw new Error("error when parse pes header");g=n.readUint8(),r.ptsDTSFlag=g>>>6,r.escrFlag=g>>>5&1,r.esRateFlag=g>>>4&1,r.dsmFlag=g>>>3&1,r.additionalFlag=g>>>2&1,r.crcFlag=g>>>1&1,r.extensionFlag=g&1,r.pesHeaderLength=n.readUint8();var p=r.pesHeaderLength,e=[];e.push(n.readUint8()),e.push(n.readUint8()),e.push(n.readUint8()),e.push(n.readUint8()),e.push(n.readUint8());var s=(e[0]&14)*536870912+(e[1]&255)*4194304+(e[2]&254)*16384+(e[3]&255)*128+(e[4]&254)/2;if(r.purePts=s,n.dataview.position-=5,e=[],g=n.readUint8(),e.push(g>>>1&7),g=n.readUint16(),e.push(g>>>1),g=n.readUint16(),e.push(g>>>1),r.pts=e[0]<<30|e[1]<<15|e[2],p-=5,r.type==="video"&&(r.dts=r.pts),r.ptsDTSFlag===3){var l=[];g=n.readUint8(),l.push(g>>>1&7),g=n.readUint16(),l.push(g>>>1),g=n.readUint16(),l.push(g>>>1),r.dts=l[0]<<30|l[1]<<15|l[2],p-=5}if(r.escrFlag===1){var f=[],d=[];g=n.readUint8(),f.push(g>>>3&7),f.push(g&3),g=n.readUint16(),f.push(g>>>13),f.push(g&3),g=n.readUint16(),f.push(g>>>13),d.push(g&3),g=n.readUint8(),d.push(g>>>1),r.escr=(f[0]<<30|f[1]<<28|f[2]<<15|f[3]<<13|f[4])*300+(d[0]<<7|d[1]),p-=6}if(r.esRateFlag===1&&(g=n.readUint24(),r.esRate=g>>>1&4194303,p-=3),r.dsmFlag===1)throw new Error("not support DSM_trick_mode");if(r.additionalFlag===1&&(g=n.readUint8(),r.additionalCopyInfo=g&127,p-=1),r.crcFlag===1&&(r.pesCRC=n.readUint16(),p-=2),r.extensionFlag===1)throw new Error("not support extension");p>0&&n.skip(p),r.dts>r.pts&&(r.dts=r.pts),r.ES=a.ES(n,r.type,i.header.streamType)}else throw new Error("format is not supported")}return r}},{key:"ES",value:function(i,r,n){var u={};if(r==="video")u.buffer=i;else if(r==="audio")(n===15||n===17)&&(u=a.parseADTSHeader(i)),u.buffer=i;else throw new Error("ES "+r+" is not supported");return u}},{key:"parseADTSHeader",value:function(i){var r={},n=i.readUint16();if(n>>>4!=4095)throw new Error("aac ES parse Error");var u=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];return r.id=(n>>>3&1)==0?"MPEG-4":"MPEG-2",r.layer=n>>>1&3,r.absent=n&1,n=i.readUint16(),r.audioObjectType=(n>>>14&3)+1,r.profile=r.audioObjectType-1,r.frequencyIndex=n>>>10&15,r.frequence=u[r.frequencyIndex],r.channel=n>>>6&7,r.frameLength=(n&3)<<11|i.readUint16()>>>5,a.getAudioConfig(r),i.skip(1),r.buffer=i,r}},{key:"TSDT",value:function(i,r,n){r.payload={}}},{key:"CAT",value:function(i,r,n){var u={};u.tableID=i.readUint8();var o=i.readUint16();u.sectionIndicator=o>>>7,u.sectionLength=o&4095,i.skip(2),o=i.readUint8(),u.version=o>>>3,u.currentNextIndicator=o&1,u.sectionNumber=i.readUint8(),u.lastSectionNumber=i.readUint8(),(this.sectionLength-9)/4,u.crc32=i.readUint32(),r.payload=u}},{key:"getAudioConfig",value:function(i){var r=navigator.userAgent.toLowerCase(),n=void 0,u=void 0;i.originAudioObjectType=i.audioObjectType,/firefox/i.test(r)?i.frequencyIndex>=8?(i.audioObjectType=5,n=new Array(4),u=i.frequencyIndex-3):(i.audioObjectType=2,n=new Array(2),u=i.frequencyIndex):r.indexOf("android")!==-1?(i.audioObjectType=2,n=new Array(2),u=i.frequencyIndex):(i.audioObjectType=5,n=new Array(4),i.frequencyIndex>=6?u=i.frequencyIndex-3:(i.channel===1&&(i.audioObjectType=2,n=new Array(2)),u=i.frequencyIndex)),n[0]=i.audioObjectType<<3,n[0]|=(i.frequencyIndex&14)>>1,n[1]=(i.frequencyIndex&1)<<7,n[1]|=i.channel<<3,i.audioObjectType===5&&(n[1]|=(u&14)>>1,n[2]=(u&1)<<7,n[2]|=2<<2,n[3]=0),i.audioConfig=n}}]),a}(Qn),En=Nd,zd=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Vd(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Rr=Ka.DEMUX_EVENTS,Hd=function(){function h(a){Vd(this,h),this.configs=Object.assign({},a),this.demuxer=null}return zd(h,[{key:"init",value:function(){this.on(Rr.DEMUX_START,this.demux.bind(this))}},{key:"initDemuxer",value:function(){this.demuxer.on(En.EVENTS.METADATA_PARSED,this.onMetaDataParsed.bind(this)),this.demuxer.on(En.EVENTS.VIDEO_SAMPLE_PARSED,this.onVideoSampleParsed.bind(this)),this.demuxer.on(En.EVENTS.AUDIO_SAMPLE_PARSED,this.onAudioSampleParsed.bind(this)),this.demuxer.on(En.EVENTS.SEI_PARSED,this.emit.bind(this,Rr.SEI_PARSED))}},{key:"demux",value:function(t,i){if(!!this._tracks){this._tracks.audioTrack||(this._tracks.audioTrack=new Gf),this._tracks.videoTrack||(this._tracks.videoTrack=new $f),this.demuxer||(this.demuxer=new En(this._tracks),this.initDemuxer());try{this.demuxer.demux(t,this.inputBuffer,i)}catch(u){this.emit(Rr.DEMUX_ERROR,this.TAG,u,!1)}var r=this._tracks.videoTrack&&this._tracks.videoTrack.samples.length?1:0,n=this._tracks.audioTrack&&this._tracks.audioTrack.samples.length?1:0;this.emit(Rr.DEMUX_COMPLETE,r,n)}}},{key:"onMetaDataParsed",value:function(t,i){var r=this._tracks,n=r.videoTrack,u=r.audioTrack,o=n;switch(t){case"video":o=n;break;case"audio":o=u;break;default:o=n}o.meta=i,this.emit(Rr.METADATA_PARSED,t,i)}},{key:"onVideoSampleParsed",value:function(t){t.isKeyframe&&this.emit(Rr.ISKEYFRAME,t.pts),this._tracks.videoTrack.samples.push(t)}},{key:"onAudioSampleParsed",value:function(t){this._tracks.audioTrack.samples.push(t)}},{key:"destroy",value:function(){this.off(Rr.DEMUX_START,this.demux),this.configs={},this.demuxer&&this.demuxer.destroy()}},{key:"inputBuffer",get:function(){return this._context.getInstance(this.configs.inputbuffer)}},{key:"_tracks",get:function(){return this._context.getInstance("TRACKS")}}]),h}(),qa=Hd,jd=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Gd(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var $d=/^(?:[a-zA-Z0-9+\-.]+:)?\/\//,Wd=/^((?:[a-zA-Z0-9+\-.]+:)?\/\/[^/?#]*)?([^?#]*\/)?/;function Yd(h,a){if(!a||!h||$d.test(h))return h;var t=Wd.exec(a);return t?h[0]==="/"?t[1]+h:t[1]+t[2]+h:h}var Xd=function(){function h(){Gd(this,h)}return jd(h,null,[{key:"parse",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",r={duration:0};if(!(!t||!t.split)){var n=t.split(/\r|\n/);n=n.filter(function(e){return e});var u=n.shift();if(!u.match("#EXTM3U"))throw new Error('Invalid m3u8 file: not "#EXTM3U"');u=n.shift();for(var o=!1,c=0;u;){var g=u.match(/#(.[A-Z|-]*):(.*)/),v=u.match(/#(.[A-Z|-]*)/);if(v&&g&&g.length>2)switch(g[1]){case"EXT-X-VERSION":r.version=parseInt(g[2]);break;case"EXT-X-MEDIA-SEQUENCE":r.sequence=parseInt(g[2]);break;case"EXT-X-TARGETDURATION":r.targetduration=parseFloat(g[2]);break;case"EXTINF":c=h.parseFrag(g,n,r,i,o,c),o=!1;break;case"EXT-X-KEY":h.parseDecrypt(g[2],r);break}if(v&&v.length>1)switch(v[1]){case"EXT-X-DISCONTINUITY":o=!0;break;case"EXT-X-ENDLIST":var p=r.frags[r.frags.length-1];p.isLast=!0,r.end=!0;break}u=n[c++]}return r}}},{key:"parseFrag",value:function(t,i,r,n,u,o){r.frags||(r.frags=[]);var c=new rc({start:r.duration,duration:parseInt(parseFloat(t[2])*1e3)});if(c.duration<200)return o;r.duration+=c.duration;var g=i[o++];if((g.match(/#(.*):(.*)/)||g.match(/^#/))&&(g=i[o++]),c.url=Yd(g,n),c.discontinue=u,r.frags.length){var v=r.frags[r.frags.length-1];c.id=v.id+1,c.cc=u?v.cc+1:v.cc}else c.id=r.sequence||1,c.cc=0;return r.frags.push(c),o}},{key:"parseDecrypt",value:function(t,i){i.encrypt={};var r=t.split(",");for(var n in r){var u=r[n];if(u.match(/METHOD=(.*)/)&&(i.encrypt.method=u.match(/METHOD=(.*)/)[1]),u.match(/URI="(.*)"/)&&(i.encrypt.uri=u.match(/URI="(.*)"/)[1]),u.match(/IV=0x(.*)/)){var o=u.match(/IV=0x(.*)/)[1],c=Math.ceil(o.length/2);i.encrypt.ivb=new Uint8Array(c);for(var g=c-1;g>=0;g--){var v=parseInt(o.substr(g*2,2),16);i.encrypt.ivb[g]=v}i.encrypt.iv=o}}}},{key:"isHTTPS",value:function(t){var i=/^https:\/\//i;return i.test(t)}}]),h}(),Za=Xd,Ja={};Object.defineProperty(Ja,"__esModule",{value:!0});Ja.default=function(h){for(var a=0,t=arguments.length,i=Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];var n=!0,u=!1,o=void 0;try{for(var c=i[Symbol.iterator](),g;!(n=(g=c.next()).done);n=!0){var v=g.value;a+=v.length}}catch(_){u=!0,o=_}finally{try{!n&&c.return&&c.return()}finally{if(u)throw o}}var p=new h(a),e=0,s=!0,l=!1,f=void 0;try{for(var d=i[Symbol.iterator](),y;!(s=(y=d.next()).done);s=!0){var m=y.value;p.set(m,e),e+=m.length}}catch(_){l=!0,f=_}finally{try{!s&&d.return&&d.return()}finally{if(l)throw f}}return p};var Kd=Ja,qd=Zd(Kd);function Zd(h){return h&&h.__esModule?h:{default:h}}var Jd=qd.default,Qd=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function eh(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var th=function(){function h(a){eh(this,h),this.buffer=a||new Uint8Array(0)}return Qd(h,[{key:"write",value:function(){for(var t=this,i=arguments.length,r=Array(i),n=0;n<i;n++)r[n]=arguments[n];r.forEach(function(u){t.buffer=Jd(Uint8Array,t.buffer,u)})}}],[{key:"writeUint32",value:function(t){return new Uint8Array([t>>24,t>>16&255,t>>8&255,t&255])}},{key:"readAsInt",value:function(t){var i="";function r(n){var u=n.toString(16);return u.padStart(2,"0")}return t.forEach(function(n){i+=r(n)}),parseInt(i,16)}}]),h}(),Dt=th,ih=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function rh(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Qa=function(){function h(){rh(this,h)}return ih(h,null,[{key:"size",value:function(t){return Dt.writeUint32(t)}},{key:"initBox",value:function(t,i){for(var r=new Dt,n=arguments.length,u=Array(n>2?n-2:0),o=2;o<n;o++)u[o-2]=arguments[o];return r.write.apply(r,[h.size(t),h.type(i)].concat(u)),r.buffer}},{key:"extension",value:function(t,i){return new Uint8Array([t,i>>16&255,i>>8&255,i&255])}},{key:"ftyp",value:function(){return h.initBox(24,"ftyp",new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]))}},{key:"ftypHEVC",value:function(){return h.initBox(24,"ftyp",new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,100,97,115,104]))}},{key:"moov",value:function(t){var i=t.type,r=t.meta,n=8,u=h.mvhd(r.duration,r.timescale),o=void 0;i==="video"?o=h.videoTrak(r):o=h.audioTrak(r);var c=h.mvex(r.duration,r.timescale||1e3,r.id);return[u,o,c].forEach(function(g){n+=g.byteLength}),h.initBox(n,"moov",u,o,c)}},{key:"mvhd",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3,r=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,i&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return h.initBox(8+r.length,"mvhd",new Uint8Array(r))}},{key:"videoTrak",value:function(t){var i=8,r=h.tkhd({id:1,duration:t.duration,timescale:t.timescale||1e3,width:t.presentWidth,height:t.presentHeight,type:"video"}),n=h.mdia({type:"video",timescale:t.timescale||1e3,duration:t.duration,avcc:t.avcc,parRatio:t.parRatio,width:t.presentWidth,height:t.presentHeight,streamType:t.streamType});return[r,n].forEach(function(u){i+=u.byteLength}),h.initBox(i,"trak",r,n)}},{key:"audioTrak",value:function(t){var i=8,r=h.tkhd({id:2,duration:t.duration,timescale:t.timescale||1e3,width:0,height:0,type:"audio"}),n=h.mdia({type:"audio",timescale:t.timescale||1e3,duration:t.duration,channelCount:t.channelCount,samplerate:t.sampleRate,config:t.config});return[r,n].forEach(function(u){i+=u.byteLength}),h.initBox(i,"trak",r,n)}},{key:"tkhd",value:function(t){var i=t.id,r=t.duration,n=t.width,u=t.height,o=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,i&255,0,0,0,0,r>>>24&255,r>>>16&255,r>>>8&255,r&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>>8&255,n&255,0,0,u>>>8&255,u&255,0,0]);return h.initBox(8+o.byteLength,"tkhd",o)}},{key:"edts",value:function(t){var i=new Dt,r=t.duration,n=t.mediaTime;return i.write(h.size(36),h.type("edts")),i.write(h.size(28),h.type("elst")),i.write(new Uint8Array([0,0,0,1,r>>24&255,r>>16&255,r>>8&255,r&255,n>>24&255,n>>16&255,n>>8&255,n&255,0,0,0,1])),i.buffer}},{key:"mdia",value:function(t){var i=8,r=h.mdhd(t.timescale,t.duration),n=h.hdlr(t.type),u=h.minf(t);return[r,n,u].forEach(function(o){i+=o.byteLength}),h.initBox(i,"mdia",r,n,u)}},{key:"mdhd",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1e3,i=arguments[1],r=new Uint8Array([0,0,0,0,0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,t&255,i>>>24&255,i>>>16&255,i>>>8&255,i&255,85,196,0,0]);return h.initBox(12+r.byteLength,"mdhd",h.extension(0,0),r)}},{key:"hdlr",value:function(t){var i=[0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0];return t==="audio"&&(i.splice.apply(i,[8,4].concat([115,111,117,110])),i.splice.apply(i,[24,13].concat([83,111,117,110,100,72,97,110,100,108,101,114,0]))),h.initBox(8+i.length,"hdlr",new Uint8Array(i))}},{key:"minf",value:function(t){var i=8,r=t.type==="video"?h.vmhd():h.smhd(),n=h.dinf(),u=h.stbl(t);return[r,n,u].forEach(function(o){i+=o.byteLength}),h.initBox(i,"minf",r,n,u)}},{key:"vmhd",value:function(){return h.initBox(20,"vmhd",new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]))}},{key:"smhd",value:function(){return h.initBox(16,"smhd",new Uint8Array([0,0,0,0,0,0,0,0]))}},{key:"dinf",value:function(){var t=new Dt,i=[0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1];return t.write(h.size(36),h.type("dinf"),h.size(28),h.type("dref"),new Uint8Array(i)),t.buffer}},{key:"stbl",value:function(t){var i=8,r=h.stsd(t),n=h.stts(),u=h.stsc(),o=h.stsz(),c=h.stco();return[r,n,u,o,c].forEach(function(g){i+=g.byteLength}),h.initBox(i,"stbl",r,n,u,o,c)}},{key:"stsd",value:function(t){var i=void 0;return t.type==="audio"?i=h.mp4a(t):t.streamType===36?i=h.hvc1(t):i=h.avc1(t),h.initBox(16+i.byteLength,"stsd",h.extension(0,0),new Uint8Array([0,0,0,1]),i)}},{key:"mp4a",value:function(t){var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,t.samplerate>>8&255,t.samplerate&255,0,0]),r=h.esds(t.config);return h.initBox(8+i.byteLength+r.byteLength,"mp4a",i,r)}},{key:"esds",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[43,146,8,0],i=t.length,r=new Dt,n=new Uint8Array([0,0,0,0,3,23+i,0,1,0,4,15+i,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([i]).concat(t).concat([6,1,2]));return r.write(h.size(8+n.byteLength),h.type("esds"),n),r.buffer}},{key:"avc1",value:function(t){var i=new Dt,r=40,n=t.width,u=t.height,o=t.parRatio.width,c=t.parRatio.height,g=t.avcc,v=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,n>>8&255,n&255,u>>8&255,u&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),p=new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]),e=new Uint8Array([o>>24,o>>16&255,o>>8&255,o&255,c>>24,c>>16&255,c>>8&255,c&255]);return i.write(h.size(r+v.byteLength+g.byteLength+p.byteLength),h.type("avc1"),v,h.size(8+g.byteLength),h.type("avcC"),g,h.size(20),h.type("btrt"),p,h.size(16),h.type("pasp"),e),i.buffer}},{key:"hvc1",value:function(t){var i=new Dt,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,t.width>>8&255,t.width&255,t.height>>8&255,t.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255,0,0,0,122,104,118,99,67,1,1,96,0,0,0,144,0,0,0,0,0,93,240,0,252,253,248,248,0,0,15,3,160,0,1,0,24,64,1,12,1,255,255,1,96,0,0,3,0,144,0,0,3,0,0,3,0,93,153,152,9,161,0,1,0,45,66,1,1,1,96,0,0,3,0,144,0,0,3,0,0,3,0,93,160,2,128,128,45,22,89,153,164,147,43,154,128,128,128,130,0,0,3,0,2,0,0,3,0,50,16,162,0,1,0,7,68,1,193,114,180,98,64]);return i.write(h.size(8+r.byteLength+10),h.type("hvc1"),r,h.size(10),h.type("fiel"),new Uint8Array([1,0])),i.buffer}},{key:"stts",value:function(){var t=new Uint8Array([0,0,0,0,0,0,0,0]);return h.initBox(16,"stts",t)}},{key:"stsc",value:function(){var t=new Uint8Array([0,0,0,0,0,0,0,0]);return h.initBox(16,"stsc",t)}},{key:"stco",value:function(){var t=new Uint8Array([0,0,0,0,0,0,0,0]);return h.initBox(16,"stco",t)}},{key:"stsz",value:function(){var t=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);return h.initBox(20,"stsz",t)}},{key:"mvex",value:function(t){var i=arguments[2],r=new Dt,n=Dt.writeUint32(t);return r.write(h.size(56),h.type("mvex"),h.size(16),h.type("mehd"),h.extension(0,0),n,h.trex(i)),r.buffer}},{key:"trex",value:function(t){var i=new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return h.initBox(8+i.byteLength,"trex",i)}},{key:"moof",value:function(t){var i=8,r=h.mfhd(),n=h.traf(t);return[r,n].forEach(function(u){i+=u.byteLength}),h.initBox(i,"moof",r,n)}},{key:"mfhd",value:function(){var t=Dt.writeUint32(h.sequence);return h.sequence+=1,h.initBox(16,"mfhd",h.extension(0,0),t)}},{key:"traf",value:function(t){var i=8,r=h.tfhd(t.id),n=h.tfdt(t.time),u=h.sdtp(t),o=h.trun(t,u.byteLength);return[r,n,o,u].forEach(function(c){i+=c.byteLength}),h.initBox(i,"traf",r,n,o,u)}},{key:"tfhd",value:function(t){var i=Dt.writeUint32(t);return h.initBox(16,"tfhd",h.extension(0,0),i)}},{key:"tfdt",value:function(t){return h.initBox(16,"tfdt",h.extension(0,0),Dt.writeUint32(t))}},{key:"trun",value:function(t,i){var r=new Dt,n=Dt.writeUint32(t.samples.length),u=Dt.writeUint32(8+8+16+8+16+16+12+4+4+16*t.samples.length+i);return r.write(h.size(20+16*t.samples.length),h.type("trun"),new Uint8Array([0,0,15,1]),n,u),t.samples.forEach(function(o){var c=o.flags;r.write(new Uint8Array([o.duration>>>24&255,o.duration>>>16&255,o.duration>>>8&255,o.duration&255,o.size>>>24&255,o.size>>>16&255,o.size>>>8&255,o.size&255,c.isLeading<<2|c.dependsOn,c.isDependedOn<<6|c.hasRedundancy<<4|c.isNonSync,0,0,o.cts>>>24&255,o.cts>>>16&255,o.cts>>>8&255,o.cts&255]))}),r.buffer}},{key:"sdtp",value:function(t){var i=new Dt;return i.write(h.size(12+t.samples.length),h.type("sdtp"),h.extension(0,0)),t.samples.forEach(function(r){var n=r.flags,u=n.isLeading<<6|n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;i.write(new Uint8Array([u]))}),i.buffer}},{key:"mdat",value:function(t){var i=new Dt,r=8;t.samples.forEach(function(o){r+=o.size}),i.write(h.size(r),h.type("mdat"));var n=new Uint8Array(r),u=0;return n.set(i.buffer,u),u+=8,t.samples.forEach(function(o){o.buffer.forEach(function(c){n.set(c,u),u+=c.byteLength})}),n}}]),h}();Qa.type=function(h){return new Uint8Array([h.charCodeAt(0),h.charCodeAt(1),h.charCodeAt(2),h.charCodeAt(3)])};Qa.sequence=1;var Ur=Qa,nh=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function ah(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}function sh(h,a){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:h}function oh(h,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);h.prototype=Object.create(a&&a.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(h,a):h.__proto__=a)}var lh=function(h){oh(a,h);function a(t){var i=t.videoMeta,r=t.audioMeta,n=t.curTime;ah(this,a);var u=sh(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return u.TAG="Fmp4Remuxer",u._dtsBase=n*1e3,u._videoMeta=i,u._audioMeta=r,u._audioDtsBase=null,u._videoDtsBase=null,u._isDtsBaseInited=!1,u.isFirstVideo=!0,u.isFirstAudio=!0,u.videoAllDuration=0,u.audioAllDuration=0,u.audioRemuxed=0,u.videoRemuxed=0,u.mp4Durations={keys:[]},u}return nh(a,[{key:"destroy",value:function(){this._dtsBase=-1,this._isDtsBaseInited=!1,this.mp4Durations={keys:[]},this.removeAllListeners()}},{key:"remux",value:function(i,r){!this._isDtsBaseInited&&this.calcDtsBase(i,r),this.remuxVideo(r),this.remuxAudio(i),_i.groupEnd()}},{key:"resetDtsBase",value:function(){this._dtsBase=0}},{key:"seek",value:function(i){_i.log(this.TAG,"set dtsBase for seek(),time=",i),this._isDtsBaseInited?(this._isDtsBaseInited=!1,this._dtsBase=i*1e3):this._dtsBase=i*1e3,this._audioDtsBase=this._videoDtsBase=null}},{key:"remuxInitSegment",value:function(i,r){_i.log(this.TAG,"remuxInitSegment: type=",i);var n=new Dt,u=r.streamType===36?Ur.ftypHEVC():Ur.ftyp(),o=Ur.moov({type:i,meta:r});return n.write(u,o),n}},{key:"calcDtsBase",value:function(i,r){if(!i&&r.samples.length){var n=r.samples[0],u=void 0;n.options&&n.options.start&&(u=n.options.start),this._videoDtsBase=n.dts-(u||this._dtsBase),this._isDtsBaseInited=!0;return}if(!((!i||!i.samples.length)&&(!r||!r.samples.length))){var o=null,c=null,g=null;if(i&&i.samples&&i.samples.length){var v=i.samples[0];o=v.dts,v.options&&v.options.start&&(g=v.options.start)}if(r&&r.samples&&r.samples.length){var p=r.samples[0];c=p.dts,p.options&&p.options.start&&(g=p.options.start)}var e=o-c;!!o&&e<0&&g!==null&&r.samples.forEach(function(s){s.dts-=e,s.pts&&(s.pts-=e)}),this._videoDtsBase=(c||o)-(g||this._dtsBase),this._audioDtsBase=(o||c)-(g||this._dtsBase),this._dtsBase=Math.min(c,o),this._isDtsBaseInited=!0,_i.log(this.TAG,"calcDtsBase"),_i.log(this.TAG,"video first dts: "+c+" , start:"+g+" , _videoDtsBase:"+this._videoDtsBase+" , _dtsBase:"+this._dtsBase),_i.log(this.TAG,"audio first dts: "+o+" , start:"+g+" , _audioDtsBase:"+this._audioDtsBase+", _dtsBase:"+this._dtsBase)}}},{key:"remuxVideo",value:function(i){var r=this,n=i||{};if(!(!i||!i.samples||!i.samples.length)){var u=n.samples,o=n.meta;if(!!o){for(var c=-1,g=null,v=[],p={samples:[]},e=1e4;u.length&&e-- >0;){var s=u.shift(),l=s.isKeyframe,f=s.options;if(!this.isFirstVideo&&f&&f.meta){g=this.remuxInitSegment("video",f.meta),f.meta=null,u.unshift(s),f.isContinue||(this._videoDtsBase=0);break}var d=Math.max(0,s.dts-this.videoDtsBase);c===-1&&(c=d);var y=void 0,m=void 0;s.pts!==void 0&&(m=s.pts-this._dtsBase,y=m-d),s.cts!==void 0&&(m=s.cts+d,y=s.cts);var _={buffer:[],size:0},E=0;if(s.duration)E=s.duration;else if(u.length>=1){var w=u[0].dts-this.videoDtsBase;E=w-d}else v.length>=1?E=v[v.length-1].duration:E=this._videoMeta.refSampleDuration;this.videoAllDuration+=E,_i.long&&_i.log(this.TAG,"video dts "+d,"pts "+m,"cts: "+y,l,"originDts "+s.originDts,"duration "+E),E>=0&&(p.samples.push(_),_.buffer.push(s.data),_.size+=s.data.byteLength,v.push({dts:d,cts:y,pts:m,data:s.data,size:s.data.byteLength,isKeyframe:l,duration:E,flags:{isLeading:0,dependsOn:l?2:1,isDependedOn:l?1:0,hasRedundancy:0,isNonSync:l?0:1},originDts:d,type:"video"}),this.mp4Durations[m]=E,this.mp4Durations.keys.push(m)),l&&this.emit(a.EVENTS.RANDOM_ACCESS_POINT,m)}if(this.mp4Durations.keys.length>1e4){var k=this.mp4Durations;this.mp4Durations={},this.mp4Durations.keys=k.keys.slice(-100),this.mp4Durations.keys.forEach(function(U){r.mp4Durations[U]=k[U]})}v.length&&_i.log(this.TAG,"remux to mp4 video:",[c/1e3,v[v.length-1].dts/1e3]);var x=new Dt;if(v.length&&n.meta){var S=Ur.moof({id:n.meta.id,time:c,samples:v}),P=Ur.mdat(p);x.write(S,P),this.segmentRemuxed("video",x,v[v.length-1].pts-v[0].pts)}if(g&&(this.segmentRemuxed("video",g),u.length))return n.samples=u,this.remuxVideo(n);this.isFirstVideo=!1,this.emit(a.EVENTS.TRACK_REMUXED,"video",x),n.samples=[],n.length=0}}}},{key:"remuxAudio",value:function(i){var r=i||{},n=r.samples,u=-1,o=[],c=null,g={samples:[]};if(!(!n||!n.length)){for(var v=1e4,p=!1;n.length&&v-- >0;){var e=n.shift(),s=e.data,l=e.options;if(!this.isFirstAudio&&l&&l.meta){c=this.remuxInitSegment("audio",l.meta),l.meta=null,n.unshift(e),l.isContinue||(this._audioDtsBase=0);break}var f=Math.max(0,e.dts-this.audioDtsBase),d=e.originDts;p||(u=f,p=!0);var y=0;if(e.duration)y=e.duration;else if(this._audioMeta.refSampleDurationFixed)y=this._audioMeta.refSampleDurationFixed;else if(n.length>=1){var m=n[0].dts-this.audioDtsBase;y=m-f}else o.length>=1?y=o[o.length-1].duration:y=this._audioMeta.refSampleDuration;_i.long,this.audioAllDuration+=y;var _={dts:f,pts:f,cts:0,size:s.byteLength,duration:e.duration?e.duration:y,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,isNonSync:0},isKeyframe:!0,originDts:d,type:"audio"},E={buffer:[],size:0};y>=0&&(E.buffer.push(s),E.size+=s.byteLength,g.samples.push(E),o.push(_))}var w=new Dt;if(o.length&&i.meta){_i.log(this.TAG,"remux to mp4 audio:",[u/1e3,o[o.length-1].dts/1e3]);var k=Ur.moof({id:i.meta.id,time:u,samples:o}),x=Ur.mdat(g);w.write(k,x),this.segmentRemuxed("audio",w,o[o.length-1].dts-o[0].dts)}if(c&&(this.segmentRemuxed("audio",c),n.length))return i.samples=n,this.remuxAudio(i);this.isFirstAudio=!1,this.emit(a.EVENTS.TRACK_REMUXED,"audio",w),i.samples=[],i.length=0}}},{key:"segmentRemuxed",value:function(i,r,n){this.emit(a.EVENTS.MEDIA_SEGMENT,i,r,n)}},{key:"videoDtsBase",get:function(){return this._videoDtsBase!==null?this._videoDtsBase:this._dtsBase},set:function(i){this._videoDtsBase=i}},{key:"audioDtsBase",get:function(){return this._audioDtsBase!==null?this._audioDtsBase:this._dtsBase}}],[{key:"EVENTS",get:function(){return{MEDIA_SEGMENT:"MEDIA_SEGMENT",INIT_SEGMENT:"INIT_SEGMENT",RANDOM_ACCESS_POINT:"RANDOM_ACCESS_POINT",TRACK_REMUXED:"TRACK_REMUXED"}}}]),a}(Qn),es=lh,uh=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function fh(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Xr=Ka.REMUX_EVENTS,ch=Ka.PLAYER_EVENTS,dh=function(){function h(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;fh(this,h),this.TAG="Mp4Remuxer",this._curTime=a,this.remuxer||this.initRemuxer()}return uh(h,[{key:"init",value:function(){this.on(Xr.REMUX_MEDIA,this.remux.bind(this)),this.on(Xr.REMUX_METADATA,this.onMetaDataReady.bind(this)),this.on(Xr.DETECT_CHANGE_STREAM,this.resetDtsBase.bind(this)),this.on(Xr.DETECT_FRAG_ID_DISCONTINUE,this.seek.bind(this)),this.on(ch.SEEK,this.seek.bind(this))}},{key:"initRemuxer",value:function(){this.remuxer=new es({audioMeta:null,videoMeta:null,curTime:this._curTime}),this.remuxer.on(es.EVENTS.MEDIA_SEGMENT,this.writeToSource.bind(this)),this.remuxer.on(es.EVENTS.TRACK_REMUXED,this.onTrackRemuxed.bind(this))}},{key:"remux",value:function(){this.remuxer._videoMeta||(this.remuxer._videoMeta=this.videoMeta,this.remuxer._audioMeta=this.audioMeta);var t=this._context.getInstance("TRACKS"),i=t.audioTrack,r=t.videoTrack;return this.remuxer.remux(i,r)}},{key:"resetDtsBase",value:function(){this.remuxer&&this.remuxer.resetDtsBase()}},{key:"seek",value:function(t){this.remuxer&&this.remuxer.seek(t)}},{key:"onMetaDataReady",value:function(t){this.remuxer||this.initRemuxer();var i=void 0;if(t==="audio"){var r=this._context.getInstance("TRACKS"),n=r.audioTrack;i=n}else{var u=this._context.getInstance("TRACKS"),o=u.videoTrack;i=o}var c=this._context.getInstance("PRE_SOURCE_BUFFER"),g=c.getSource(t);g||(g=c.createSource(t)),g.mimetype=i.meta.codec,g.init=this.remuxer.remuxInitSegment(t,i.meta),this.emit(Xr.INIT_SEGMENT,t)}},{key:"onTrackRemuxed",value:function(t){this.emit(Xr.MEDIA_SEGMENT,t)}},{key:"writeToSource",value:function(t,i,r){var n=this._context.getInstance("PRE_SOURCE_BUFFER"),u=n.getSource(t);u||(u=n.createSource(t)),u.data.push(i),r&&(u.bufferDuration=r+(u.bufferDuration||0))}},{key:"destroy",value:function(){this.remuxer&&this.remuxer.destroy(),this.remuxer=null}},{key:"videoMeta",get:function(){return this._context.getInstance("TRACKS").videoTrack.meta}},{key:"audioMeta",get:function(){return this._context.getInstance("TRACKS").audioTrack.meta}}]),h}(),Cl=dh,Dl={Mse:hc,Tracks:Ha,RemuxedBufferManager:Ro,XgBuffer:Yr,FetchLoader:Ya,Compatibility:pl,Mp4Remuxer:Cl,Crypto:$a,M3U8Parser:Za,TsDemuxer:qa,Playlist:Na},hh=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}(),ts=function h(a,t,i){a===null&&(a=Function.prototype);var r=Object.getOwnPropertyDescriptor(a,t);if(r===void 0){var n=Object.getPrototypeOf(a);return n===null?void 0:h(n,t,i)}else{if("value"in r)return r.value;var u=r.get;return u===void 0?void 0:u.call(i)}};function ph(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}function gh(h,a){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:h}function vh(h,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);h.prototype=Object.create(a&&a.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(h,a):h.__proto__=a)}var yh=Mt.HlsAllowedEvents,mh=Mt.REMUX_EVENTS,ea=Ct.util,is=function(h){vh(a,h);function a(t){ph(this,a);var i=gh(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,t));return i.hlsOps={},i.hlsOps=Object.assign(i.hlsOps,Dl),ea.deepCopy(i.hlsOps,t),i._played=!1,i}return hh(a,[{key:"_initEvents",value:function(){var i=this;this.__core__.once(mh.INIT_SEGMENT,function(){var r=i._context.getInstance("MSE");if(!i.started){var n=ea.createDom("xg-live","\u6B63\u5728\u76F4\u64AD",{},"xgplayer-live");ea.addClass(i.root,"xgplayer-is-live"),i.controls.appendChild(n)}i.started=!0,ts(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"start",i).call(i,r.url)})}},{key:"start",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.url;!i||this.started||(this._context||(this._context=new Ga(this,this.hlsOps,yh)),this.hlsOps||(this.hlsOps={},this.hlsOps=Object.assign(this.hlsOps,Dl),ea.deepCopy(this.hlsOps,this.config),this._played=!1),this.__core__=this._context.registry("HLS_LIVE_CONTROLLER",Dc)({player:this,container:this.video,preloadTime:this.config.preloadTime}),this._context.init(),this.url=i,this.__core__.load(i),this._initEvents(),this.started=!0)}},{key:"play",value:function(){var i=this;if(this._played){this.src=this.config.url,this.once("canplay",function(){i.video.play()});return}this._played=!0,ts(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"play",this).call(this)}},{key:"destroy",value:function(){var i=this;this._context&&this._context.destroy();var r=new Promise(function(n){i.__core__&&i.__core__.mse?i.__core__.mse.destroy().then(function(){setTimeout(function(){n()},50)}):setTimeout(function(){n()},50)});return ts(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"destroy",this).call(this),r}},{key:"src",set:function(i){var r=this;this.onWaiting=this.onWaiting.bind(this),this.__core__.mse.destroy().then(function(){r._context.destroy(),r._context=null,r.started=!1,r.video.currentTime=0,r.start(i)})}}],[{key:"isSupported",value:function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')}},{key:"install",value:function(i,r){return Ct.install(i,r)}}]),a}(Ct);is.install=Ct.install.bind(Ct);var _h=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function xh(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Eh=tl,bh=Zo,qi=Mt.LOADER_EVENTS,dr=Mt.DEMUX_EVENTS,rs=Mt.HLS_EVENTS,Rl=Mt.CRYTO_EVENTS,wh="HLS_ERROR",Th=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,Ul=function(){function h(a){xh(this,h),this.configs=Object.assign({},a),this.url="",this.sequence=0,this._playlist=null,this.retrytimes=this.configs.retrytimes||3,this.preloadTime=this.configs.preloadTime,this.container=this.configs.container,this._m3u8lasttime=0,this._timmer=setInterval(this._checkStatus.bind(this),50),this._lastCheck=0,this.m3u8Text=null}return _h(h,[{key:"init",value:function(){var t=this._player.hlsOps,i=t.XgBuffer,r=t.Tracks,n=t.Playlist,u=t.FetchLoader,o=t.TsDemuxer;this._context.registry("M3U8_BUFFER",i),this._context.registry("TS_BUFFER",i),this._context.registry("TRACKS",r),this._playlist=this._context.registry("PLAYLIST",n)({autoclear:!0}),this._m3u8loader=this._context.registry("M3U8_LOADER",u)({buffer:"M3U8_BUFFER",readtype:1}),this._tsloader=this._context.registry("TS_LOADER",u)({buffer:"TS_BUFFER",readtype:3}),this._context.registry("TS_DEMUXER",o)({inputbuffer:"TS_BUFFER"}),this.initEvents()}},{key:"initEvents",value:function(){this.on(qi.LOADER_COMPLETE,this._onLoadComplete.bind(this)),this.on(dr.METADATA_PARSED,this._onMetadataParsed.bind(this)),this.on(dr.SEI_PARSED,this._handleSEIParsed.bind(this)),this.on(dr.DEMUX_COMPLETE,this._onDemuxComplete.bind(this)),this.on(qi.LOADER_ERROR,this._onLoadError.bind(this)),this.on(dr.DEMUX_ERROR,this._onDemuxError.bind(this))}},{key:"_onError",value:function(t,i,r,n){var u={errorType:t,errorDetails:"["+i+"]: "+(r?r.message:""),errorFatal:n};this._player.emit(wh,u)}},{key:"_onDemuxComplete",value:function(){var t=this;if(this._player.video){var i=this._context.getInstance("TRACKS"),r=i.videoTrack,n=i.audioTrack;r.samples.forEach(function(u){if(!u.analyzed){u.analyzed=!0;var o=new _n(u.data.buffer),c=void 0;t._isHEVC(r.meta)?c=Eh.getHvccNals(o):c=bh.getNalunits(o);var g=c.reduce(function(e,s){return e+4+s.body.byteLength},0),v=new Uint8Array(g),p=0;c.forEach(function(e){v.set([0,0,0,1],p),p+=4,v.set(new Uint8Array(e.body),p),p+=e.body.byteLength}),u.data=v}}),this._player.video.onDemuxComplete(r,n)}}},{key:"_onMetadataParsed",value:function(t){if(t==="audio"){var i=this._context.getInstance("TRACKS"),r=i.audioTrack;r&&r.meta&&this._setMetaToAudio(r.meta)}else{var n=this._context.getInstance("TRACKS"),u=n.videoTrack;u&&u.meta&&this._setMetaToVideo(u.meta)}}},{key:"_setMetaToAudio",value:function(t){this._player.video&&this._player.video.setAudioMeta(t)}},{key:"_setMetaToVideo",value:function(t){this._player.video&&this._player.video.setVideoMeta(t)}},{key:"_onLoadError",value:function(t,i){!this._tsloader.loading&&!this._m3u8loader.loading&&this.retrytimes>1?(this.retrytimes--,this._onError(qi.LOADER_ERROR,t,i,!1)):this.retrytimes<=1&&(this._onError(qi.LOADER_ERROR,t,i,!0),this.emit(rs.RETRY_TIME_EXCEEDED),this._player.video&&this._player.video.handleEnded())}},{key:"_onDemuxError",value:function(t,i,r){r===void 0&&(r=!0),this._onError(qi.LOADER_ERROR,t,i,r)}},{key:"_handleSEIParsed",value:function(t){this._player.emit("SEI_PARSED",t)}},{key:"_onLoadComplete",value:function(t){if(t.TAG==="M3U8_BUFFER"){var i=void 0;try{this.m3u8Text=t.shift();var r=Th.exec(this.m3u8Text);r&&r[2]?this.load(r[2]):i=this._player.hlsOps.M3U8Parser.parse(this.m3u8Text,this.url)}catch(g){this._onError("M3U8_PARSER_ERROR","M3U8_PARSER",g,!1)}if(!i){this.retrytimes>0?(this.retrytimes--,this._preload()):(this.emit(rs.RETRY_TIME_EXCEEDED),this._player.video&&this._player.video.handleEnded());return}try{this._playlist.pushM3U8(i,!0)}catch(g){this._onError("M3U8_PARSER_ERROR","PLAYLIST",g,!1)}if(this._playlist.encrypt&&this._playlist.encrypt.uri&&!this._playlist.encrypt.key){var n=this._player.hlsOps,u=n.XgBuffer,o=n.FetchLoader;this._context.registry("DECRYPT_BUFFER",u)(),this._context.registry("KEY_BUFFER",u)(),this._tsloader.buffer="DECRYPT_BUFFER",this._keyLoader=this._context.registry("KEY_LOADER",o)({buffer:"KEY_BUFFER",readtype:3}),this.emitTo("KEY_LOADER",qi.LADER_START,this._playlist.encrypt.uri)}else this._m3u8Loaded(i)}else if(t.TAG==="TS_BUFFER")this.retrytimes=this.configs.retrytimes||3,this._playlist.downloaded(this._tsloader.url,!0),this.emit(dr.DEMUX_START);else if(t.TAG==="DECRYPT_BUFFER")this.retrytimes=this.configs.retrytimes||3,this._playlist.downloaded(this._tsloader.url,!0),this.emitTo("CRYPTO",Rl.START_DECRYPT);else if(t.TAG==="KEY_BUFFER"){var c=this._player.hlsOps.Crypto;this.retrytimes=this.configs.retrytimes||3,this._playlist.encrypt.key=t.shift(),this._crypto=this._context.registry("CRYPTO",c)({key:this._playlist.encrypt.key,iv:this._playlist.encrypt.ivb,method:this._playlist.encrypt.method,inputbuffer:"DECRYPT_BUFFER",outputbuffer:"TS_BUFFER"}),this._crypto.on(Rl.DECRYPTED,this._onDcripted.bind(this))}}},{key:"_onDcripted",value:function(){this.emit(dr.DEMUX_START)}},{key:"_m3u8Loaded",value:function(t){this.preloadTime||(this.preloadTime=this._playlist.targetduration?this._playlist.targetduration:5),this._playlist.fragLength>0&&this._playlist.sequence<t.sequence?this.retrytimes=this.configs.retrytimes||3:this.retrytimes>0?(this.retrytimes--,this._preload()):(this.emit(rs.RETRY_TIME_EXCEEDED),this._player.video&&this._player.video.handleEnded())}},{key:"_checkStatus",value:function(){if(!(this.retrytimes<1&&new Date().getTime()-this._lastCheck<1e4))if(this._lastCheck=new Date().getTime(),this.container.buffered.length<1)this._preload();else{var t=this.container.currentTime;this.container.readyState<=2&&this._preload();var i=this.container.buffered.end(this.container.buffered.length-1);t>i-this.preloadTime&&this._preload()}}},{key:"_preload",value:function(){if(!(this._tsloader.loading||this._m3u8loader.loading)){var t=this._playlist.getTs();if(t&&!t.downloaded&&!t.downloading)this._playlist.downloading(t.url,!0),this.emitTo("TS_LOADER",qi.LADER_START,t.url);else{var i=this.preloadTime?this.preloadTime:0,r=new Date().getTime();(!t||t.downloaded)&&(r-this._m3u8lasttime)/1e3>i&&(this._m3u8lasttime=r,this.emitTo("M3U8_LOADER",qi.LADER_START,this.url))}}}},{key:"_isHEVC",value:function(t){return t&&t.codec==="hev1.1.6.L93.B0"}},{key:"load",value:function(t){this.url=t,this._preload()}},{key:"destroy",value:function(){clearInterval(this._timmer),this.off(qi.LOADER_COMPLETE,this._onLoadComplete),this.off(dr.METADATA_PARSED,this._onMetadataParsed),this.off(dr.DEMUX_COMPLETE,this._onDemuxComplete),this.m3u8Text=null}}]),h}(),Sh={Tracks:Ha,XgBuffer:Yr,FetchLoader:Ya,Crypto:$a,M3U8Parser:Za,TsDemuxer:qa,Playlist:Na},ta=function h(a,t,i){a===null&&(a=Function.prototype);var r=Object.getOwnPropertyDescriptor(a,t);if(r===void 0){var n=Object.getPrototypeOf(a);return n===null?void 0:h(n,t,i)}else{if("value"in r)return r.value;var u=r.get;return u===void 0?void 0:u.call(i)}},Ll=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function kh(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}function Ah(h,a){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:h}function Ch(h,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);h.prototype=Object.create(a&&a.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(h,a):h.__proto__=a)}var Pl=Mt.HlsAllowedEvents,ns=function(h){Ch(a,h),Ll(a,null,[{key:"isSupported",value:function(){var i="WebAssembly"in window,r="customElements"in window&&window.customElements.define,n=!1;return r&&(n=window.customElements.get("live-video")),i&&n}}]);function a(t){kh(this,a),t.mediaType||(t.mediaType="live-video",t.videoConfig?t.videoConfig.preloadtime=t.preloadTime||5:t.videoConfig={preloadtime:t.preloadTime||5});var i=Ah(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,t));return i.hlsOps={},i.util=Ct.util,i.hlsOps=Object.assign(i.hlsOps,Sh),i.util.deepCopy(i.hlsOps,t),i.playerInited||i.initPlayer(),i}return Ll(a,[{key:"initPlayer",value:function(){this.video.width=Number.parseInt(this.hlsOps.width||600),this.video.height=Number.parseInt(this.hlsOps.height||337.5),this.video.style.outline="none",this.playerInited=!0}},{key:"_initEvents",value:function(){var i=this;this.once("canplay",function(){i.video.play()})}},{key:"start",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hlsOps.url;!i||this.started||(this.playerInited||this.initPlayer(),this._context||(this._context=new Ga(Pl)),this.__core__=this._context.registry("HLS_LIVE_CONTROLLER",Ul)({player:this,container:this.video,preloadTime:this.config.preloadTime}),this._context.init(),this.url=i,this.__core__.load(i),ta(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"start",this).call(this,i),this._initEvents(),this.started=!0,this.addLiveFlag())}},{key:"play",value:function(){this.started&&(this._context.destroy(),this._context=new Ga(Pl),this.__core__=this._context.registry("HLS_LIVE_CONTROLLER",Ul)({player:this,container:this.video,preloadTime:this.config.preloadTime}),this._context.init(),this._initEvents(),this.__core__.load(this.url)),ta(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"play",this).call(this)}},{key:"addLiveFlag",value:function(){var i=this;if(Ct.util.addClass(i.root,"xgplayer-is-live"),!Ct.util.findDom(this.root,"xg-live")){var r=Ct.util.createDom("xg-live","\u6B63\u5728\u76F4\u64AD",{},"xgplayer-live");i.controls.appendChild(r)}}},{key:"destroy",value:function(){var i=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return new Promise(function(n){ta(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"destroy",i).call(i);var u=i.video,o=i.root;ta(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"destroy",i).call(i,r),u&&u.remove?u.remove():o&&o.removeChild(u),u&&u.destroy(),setTimeout(function(){n()},50)})}},{key:"src",set:function(i){this.onWaiting=this.onWaiting.bind(this),this._context.destroy(),this._context=null,this.started=!1,this.video.currentTime=0,this.start(i)}}],[{key:"install",value:function(i,r){return Ct.install(i,r)}}]),a}(Ct);ns.install=Ct.install.bind(Ct);var Dh=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Rh(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Fl=function(){function h(a){return Rh(this,h),ns.isSupported()&&a.useWASM?new ns(a):is.isSupported()?new is(a):new Ct(a)}return Dh(h,null,[{key:"install",value:function(t,i){return Ct.install(t,i)}}]),h}();Fl.EVENTS=Mt;var Uh=function(h,a){var t=Date.now(),i=null,r=!0;return function(){for(var n=arguments.length,u=Array(n),o=0;o<n;o++)u[o]=arguments[o];var c=Date.now();r&&(t=Date.now(),r=!1,h.apply(void 0,u)),c-t>a?(t=c,h.apply(void 0,u)):(i&&window.clearTimeout(i),i=setTimeout(function(){h.apply(void 0,u)},a))}},Bl={VISIBILITY_CHANGE:"VISIBILITY_CHANGE"},Ol={SEEK:"SEEK"},Il={LADER_START:"LOADER_START",LOADER_DATALOADED:"LOADER_DATALOADED",LOADER_COMPLETE:"LOADER_COMPLETE",LOADER_RESPONSE_HEADERS:"LOADER_RESPONSE_HEADERS",LOADER_ERROR:"LOADER_ERROR",LOADER_RETRY:"LOADER_RETRY",LOADER_TTFB:"LOADER_TTFB"},Ml={DEMUX_START:"DEMUX_START",DEMUX_COMPLETE:"DEMUX_COMPLETE",DEMUX_ERROR:"DEMUX_ERROR",METADATA_PARSED:"METADATA_PARSED",SEI_PARSED:"SEI_PARSED",VIDEO_METADATA_CHANGE:"VIDEO_METADATA_CHANGE",AUDIO_METADATA_CHANGE:"AUDIO_METADATA_CHANGE",MEDIA_INFO:"MEDIA_INFO",ISKEYFRAME:"ISKEYFRAME"},Nl={REMUX_METADATA:"REMUX_METADATA",REMUX_MEDIA:"REMUX_MEDIA",MEDIA_SEGMENT:"MEDIA_SEGMENT",REMUX_ERROR:"REMUX_ERROR",INIT_SEGMENT:"INIT_SEGMENT",DETECT_CHANGE_STREAM:"DETECT_CHANGE_STREAM",DETECT_CHANGE_STREAM_DISCONTINUE:"DETECT_CHANGE_STREAM_DISCONTINUE",DETECT_AUDIO_GAP:"DETECT_AUDIO_GAP",DETECT_LARGE_GAP:"DETECT_LARGE_GAP",DETECT_AUDIO_OVERLAP:"DETECT_AUDIO_OVERLAP",RANDOM_ACCESS_POINT:"RANDOM_ACCESS_POINT",DETECT_FRAG_ID_DISCONTINUE:"DETECT_FRAG_ID_DISCONTINUE"},zl={SOURCE_UPDATE_END:"SOURCE_UPDATE_END",MSE_ERROR:"MSE_ERROR",MSE_WRONG_TRACK_ADD:"MSE_WRONG_TRACK_ADD"},Vl={RETRY_TIME_EXCEEDED:"RETRY_TIME_EXCEEDED"},Lh={START_DECRYPTOO:"START_DECRYPTO",DECRYPTED:"DECRYPTED"},Lr=Object.assign({},Il,Ml,Nl,zl,Vl,Ol,Bl),Hl=[],jl=[];for(var Gl in Lr)Lr.hasOwnProperty(Gl)&&Hl.push(Lr[Gl]);for(var $l in Lr)Lr.hasOwnProperty($l)&&jl.push(Lr[$l]);var Xt={ALLEVENTS:Lr,HLS_EVENTS:Vl,REMUX_EVENTS:Nl,DEMUX_EVENTS:Ml,MSE_EVENTS:zl,LOADER_EVENTS:Il,FlvAllowedEvents:Hl,HlsAllowedEvents:jl,CRYPTO_EVENTS:Lh,PLAYER_EVENTS:Ol,BROWSER_EVENTS:Bl},Wl=function h(a,t,i){a===null&&(a=Function.prototype);var r=Object.getOwnPropertyDescriptor(a,t);if(r===void 0){var n=Object.getPrototypeOf(a);return n===null?void 0:h(n,t,i)}else{if("value"in r)return r.value;var u=r.get;return u===void 0?void 0:u.call(i)}},Yl=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Ph(h,a){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:h}function Fh(h,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);h.prototype=Object.create(a&&a.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(h,a):h.__proto__=a)}function Xl(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var bn="__TO__",Bh=function(){function h(a,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];Xl(this,h),this._emitter=new Qn,this._emitter.off||(this._emitter.off=this._emitter.removeListener),this.mediaInfo=new No,this._instanceMap={},this._clsMap={},this._inited=!1,this.allowedEvents=i,this._configs=t,this._player=a,this._hooks={}}return Yl(h,[{key:"getInstance",value:function(t){var i=this._instanceMap[t];return i||null}},{key:"initInstance",value:function(t){for(var i=arguments.length,r=Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];var u=r[0],o=r[1],c=r[2],g=r[3];if(this._clsMap[t]){var v=new this._clsMap[t](u,o,c,g);return this._instanceMap[t]=v,v.init&&v.init(),v}else throw new Error(t+"\u672A\u5728context\u4E2D\u6CE8\u518C")}},{key:"init",value:function(t){if(!this._inited){for(var i in this._clsMap)this._clsMap.hasOwnProperty(i)&&!this._instanceMap[i]&&this.initInstance(i,t);this._inited=!0}}},{key:"registry",value:function(t,i){var r=this,n=this._emitter,u=this._isMessageNameValid.bind(this),o=this,c=function(g){Fh(v,g);function v(p,e,s){Xl(this,v);var l=Ph(this,(v.__proto__||Object.getPrototypeOf(v)).call(this,p,e,s));return l.listeners={},l.onceListeners={},l.TAG=t,l._context=o,l}return Yl(v,[{key:"on",value:function(e,s){return u(e),this.listeners[e]?this.listeners[e].push(s):this.listeners[e]=[s],n.on(""+e+bn+t,s),n.on(e,s)}},{key:"before",value:function(e,s){u(e),o._hooks[e]?o._hooks[e].push(s):o._hooks[e]=[s]}},{key:"once",value:function(e,s){return u(e),this.onceListeners[e]?this.onceListeners[e].push(s):this.onceListeners[e]=[s],n.once(""+e+bn+t,s),n.once(e,s)}},{key:"emit",value:function(e){u(e);for(var s=o._hooks?o._hooks[e]:null,l=arguments.length,f=Array(l>1?l-1:0),d=1;d<l;d++)f[d-1]=arguments[d];if(s)for(var y=0,m=s.length;y<m;y++){var _=s[y];_.apply(void 0,f)}return n.emit.apply(n,[e].concat(f))}},{key:"emitTo",value:function(e,s){u(s);for(var l=arguments.length,f=Array(l>2?l-2:0),d=2;d<l;d++)f[d-2]=arguments[d];return n.emit.apply(n,[""+s+bn+e].concat(f))}},{key:"off",value:function(e,s){return u(e),n.off(e,s)}},{key:"removeListeners",value:function(){var e=Object.prototype.hasOwnProperty.bind(this.listeners);for(var s in this.listeners)if(e(s))for(var l=this.listeners[s]||[],f=0;f<l.length;f++){var d=l[f];n.off(s,d),n.off(""+s+bn+t,d)}for(var y in this.onceListeners)if(e(y))for(var m=this.onceListeners[y]||[],_=0;_<m.length;_++){var E=m[_];n.off(y,E),n.off(""+y+bn+t,E)}}},{key:"destroy",value:function(){if(this.removeListeners(),this.listeners={},delete o._instanceMap[t],Wl(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"destroy",this))return Wl(v.prototype.__proto__||Object.getPrototypeOf(v.prototype),"destroy",this).call(this);this._context=null}},{key:"_player",get:function(){return this._context?this._context._player:null},set:function(e){this._context&&(this._context._player=e)}},{key:"_pluginConfig",get:function(){return this._context?this._context._configs:null}}]),v}(i);return this._clsMap[t]=c,function(){for(var g=arguments.length,v=Array(g),p=0;p<g;p++)v[p]=arguments[p];return r.initInstance.apply(r,[t].concat(v))}}},{key:"seek",value:function(t){this._emitter.emit(Xt.PLAYER_EVENTS.SEEK,t)}},{key:"destroyInstances",value:function(){var t=this;Object.keys(this._instanceMap).forEach(function(i){t._instanceMap[i].destroy&&t._instanceMap[i].destroy()})}},{key:"destroy",value:function(){this.destroyInstances(),this._emitter&&this._emitter.removeAllListeners(),this._emitter=null,this.allowedEvents=[],this._clsMap=null,this._hooks=null,this._player=null,this._configs=null}},{key:"_isMessageNameValid",value:function(t){if(!this.allowedEvents.indexOf(t)<0)throw new Error("unregistered message name: "+t)}}]),h}(),Kl=Bh,Oh=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Ih(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var ql=Xt.CRYPTO_EVENTS,Mh=function(){function h(a){Ih(this,h),this.inputBuffer=a.inputbuffer,this.outputBuffer=a.outputbuffer,this.key=a.key,this.iv=a.iv,this.method=a.method,this.crypto=window.crypto||window.msCrypto}return Oh(h,[{key:"init",value:function(){this.on(ql.START_DECRYPTO,this.decrypto.bind(this))}},{key:"decrypto",value:function(){var t=this;if(this.aeskey)this.decryptoData();else{var i=this.crypto.subtle.importKey("raw",this.key.buffer,{name:"AES-CBC"},!1,["encrypt","decrypt"]);i.then(function(r){t.aeskey=r,t.decryptoData()})}}},{key:"decryptoData",value:function(){var t=this,i=this._context.getInstance(this.inputBuffer),r=this._context.getInstance(this.outputBuffer),n=i.shift();n&&this.crypto.subtle.decrypt({name:"AES-CBC",iv:this.iv.buffer},this.aeskey,n).then(function(u){r.push(new Uint8Array(u)),t.emit(ql.DECRYPTED),t.decryptoData(n)})}}]),h}(),Nh=Mh,zh=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Vh(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var as=Xt.MSE_EVENTS,Hh=function(){function h(a,t){Vh(this,h),t&&(this._context=t,this.emit=t._emitter.emit.bind(t._emitter)),this.TAG="MSE",this.configs=Object.assign({},a),this.container=this.configs.container,this.format=this.configs.format,this.mediaSource=null,this.sourceBuffers={},this.preloadTime=this.configs.preloadTime||1,this.onSourceOpen=this.onSourceOpen.bind(this),this.onTimeUpdate=this.onTimeUpdate.bind(this),this.onUpdateEnd=this.onUpdateEnd.bind(this),this.onWaiting=this.onWaiting.bind(this),this.opened=!1}return zh(h,[{key:"init",value:function(){this.mediaSource=new self.MediaSource,this.mediaSource.addEventListener("sourceopen",this.onSourceOpen),this._url=null,this.container.addEventListener("timeupdate",this.onTimeUpdate),this.container.addEventListener("waiting",this.onWaiting)}},{key:"resetContext",value:function(t,i){if(this._context=t,this.emit=t._emitter.emit.bind(t._emitter),!i)for(var r=0;r<Object.keys(this.sourceBuffers).length;r++){var n=this.sourceBuffers[Object.keys(this.sourceBuffers)[r]];n.updating||h.clearBuffer(n)}}},{key:"onTimeUpdate",value:function(){this.emit("TIME_UPDATE",this.container)}},{key:"onWaiting",value:function(){this.emit("WAITING",this.container)}},{key:"onSourceOpen",value:function(){this.opened=!0,this.addSourceBuffers()}},{key:"onUpdateEnd",value:function(){this.emit(as.SOURCE_UPDATE_END),this.doAppend()}},{key:"addSourceBuffers",value:function(){if(!(!this.mediaSource||this.mediaSource.readyState!=="open"||!this.opened)){var t=this._context.getInstance("PRE_SOURCE_BUFFER"),i=this._context.getInstance("TRACKS"),r=void 0;if(!(!t||!i)){t=t.sources;for(var n=!1,u=0,o=Object.keys(t).length;u<o;u++){var c=Object.keys(t)[u];n=!1,c==="audio"?r=i.audioTrack:c==="video"&&(r=i.videoTrack),r&&t[c].init!==null&&t[c].data.length&&(n=!0)}if(n){if(Object.keys(this.sourceBuffers).length>1)return;for(var g=0,v=Object.keys(t).length;g<v;g++){var p=Object.keys(t)[g];if(!this.sourceBuffers[p]){var e=t[p],s=p==="video"?"video/mp4;codecs="+e.mimetype:"audio/mp4;codecs="+e.mimetype;try{var l=this.mediaSource.addSourceBuffer(s);this.sourceBuffers[p]=l,l.addEventListener("updateend",this.onUpdateEnd)}catch(f){if(f.code===22&&Object.keys(this.sourceBuffers).length>0)return this.emit(as.MSE_WRONG_TRACK_ADD,p);this.emit(as.MSE_ERROR,this.TAG,new Error(f.message))}}}Object.keys(this.sourceBuffers).length===this.sourceBufferLen&&this.doAppend()}}}}},{key:"doAppend",value:function(){if(!(!this.mediaSource||this.mediaSource.readyState==="closed")){this._doCleanupSourceBuffer();var t=this._context.getInstance("PRE_SOURCE_BUFFER");if(!!t&&!(Object.keys(this.sourceBuffers).length<this.sourceBufferLen))for(var i=0;i<Object.keys(this.sourceBuffers).length;i++){var r=Object.keys(this.sourceBuffers)[i],n=this.sourceBuffers[r];if(!n.updating){var u=t.sources[r];if(this["no"+r]){u.data=[],u.init.buffer=null;continue}if(u&&!u.inited)try{n.appendBuffer(u.init.buffer.buffer),u.inited=!0}catch(c){}else if(u){var o=u.data.shift();if(o)try{n.appendBuffer(o.buffer.buffer)}catch(c){u.data.unshift(o)}}}}}}},{key:"endOfStream",value:function(){try{var t=this.mediaSource.readyState;t==="open"&&this.mediaSource.endOfStream()}catch(i){}}},{key:"remove",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;try{for(var r=0;r<Object.keys(this.sourceBuffers).length;r++){var n=this.sourceBuffers[Object.keys(this.sourceBuffers)[r]];n.updating||t>i&&n.remove(i,t)}}catch(u){}}},{key:"_doCleanupSourceBuffer",value:function(){for(var t=this.container.currentTime,i=60*3,r={video:[],audio:[]},n=0;n<Object.keys(this.sourceBuffers).length;n++){for(var u=Object.keys(this.sourceBuffers)[n],o=this.sourceBuffers[u],c=o.buffered,g=!1,v=0;v<c.length;v++){var p=c.start(v),e=c.end(v);if(p<=t&&t<e+3){if(t-p>=i){g=!0;var s=t-i;r[u].push({start:p,end:s})}}else e<t&&t-p>=i&&(g=!0,r[u].push({start:p,end:e}))}g&&!o.updating&&this._doRemoveRanges(r)}}},{key:"_doRemoveRanges",value:function(t){for(var i in t)if(!(!this.sourceBuffers[i]||this.sourceBuffers[i].updating))for(var r=this.sourceBuffers[i],n=t[i];n.length&&!r.updating;){var u=n.shift();try{u&&u.end>u.start&&r.remove(u.start,u.end)}catch(o){}}}},{key:"cleanBuffers",value:function(){for(var t=this,i=[],r=function(o){var c=t.sourceBuffers[Object.keys(t.sourceBuffers)[o]],g=void 0;c.updating?g=new Promise(function(v){var p=function e(){var s=3,l=function f(){c.updating?s>0?(setTimeout(f,200),s--):v():(h.clearBuffer(c),c.addEventListener("updateend",function(){v()}))};setTimeout(l,200),c.removeEventListener("updateend",e)};c.addEventListener("updateend",p)}):g=new Promise(function(v){h.clearBuffer(c),c.addEventListener("updateend",function(){v()})}),i.push(g)},n=0;n<Object.keys(this.sourceBuffers).length;n++)r(n);return Promise.all(i)}},{key:"removeBuffers",value:function(){for(var t=this,i=[],r=function(o){var c=t.sourceBuffers[Object.keys(t.sourceBuffers)[o]];c.removeEventListener("updateend",t.onUpdateEnd);var g=void 0;c.updating?g=new Promise(function(v){var p=function e(){var s=3,l=function f(){c.updating?s>0?(setTimeout(f,200),s--):v():(h.clearBuffer(c),c.addEventListener("updateend",function(){v()}))};setTimeout(l,200),c.removeEventListener("updateend",e)};c.addEventListener("updateend",p)}):g=new Promise(function(v){h.clearBuffer(c),c.addEventListener("updateend",function(){v()})}),i.push(g)},n=0;n<Object.keys(this.sourceBuffers).length;n++)r(n);return Promise.all(i)}},{key:"destroy",value:function(){var t=this;return this.container?(this.container.removeEventListener("timeupdate",this.onTimeUpdate),this.container.removeEventListener("waiting",this.onWaiting),this.mediaSource.removeEventListener("sourceopen",this.onSourceOpen),this.removeBuffers().then(function(){for(var i=Object.keys(t.sourceBuffers),r=0;r<i.length;r++){var n=t.sourceBuffers[i[r]];delete t.sourceBuffers[i[r]],t.mediaSource.readyState==="open"&&t.mediaSource.removeSourceBuffer(n)}t.endOfStream();try{window.URL.revokeObjectURL(t.url)}catch(u){}t.url=null,t.configs={},t.container=null,t.mediaSource=null,t.sourceBuffers={},t.preloadTime=1,t.onSourceOpen=null,t.onTimeUpdate=null,t.onUpdateEnd=null,t.onWaiting=null,t.noaudio=void 0,t.novideo=void 0})):Promise.resolve()}},{key:"sourceBufferLen",get:function(){return this._context.mediaInfo?(!!this._context.mediaInfo.hasVideo&&!this.novideo)+(!!this._context.mediaInfo.hasAudio&&!this.noaudio):this.noaudio||this.novideo?1:2}},{key:"url",set:function(t){this._url=t},get:function(){if(!this._url)try{this._url=window.URL.createObjectURL(this.mediaSource)}catch(t){}return this._url}}],[{key:"clearBuffer",value:function(t){try{for(var i=t.buffered,r=.1,n=0,u=i.length;n<u;n++)r=i.end(n);t.remove(0,r)}catch(o){}}}]),h}(),jh=Hh,Gh=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function $h(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Wh=function(){function h(){$h(this,h),this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._lastSamplingBytes=0,this._now=Date.now}return Gh(h,[{key:"reset",value:function(){this._firstCheckpoint=this._lastCheckpoint=0,this._intervalBytes=0,this._lastSamplingBytes=0}},{key:"addBytes",value:function(t){var i=this._now()-this._lastCheckpoint;this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=t):i<5e3?this._intervalBytes+=t:(this._lastSamplingBytes=this._intervalBytes/(i/1e3),this._intervalBytes=t,this._lastCheckpoint=this._now())}},{key:"currentKBps",get:function(){this.addBytes(0);var t=(this._now()-this._lastCheckpoint)/1e3;return t===0&&(t=1),this._intervalBytes/t/1024}},{key:"lastSamplingKBps",get:function(){return this.addBytes(0),this._lastSamplingBytes!==0?this._lastSamplingBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0}}]),h}(),Yh=Wh,Zl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},Xh=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function Kh(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var Gt=Xt.LOADER_EVENTS,qh=0,Zh=1,Jh=2,Qh=3,ep=function(){function h(a){Kh(this,h),this.configs=Object.assign({},a),this.url=null,this.status=0,this.error=null,this._reader=null,this._canceled=!1,this._destroyed=!1,this.readtype=this.configs.readtype,this.buffer=this.configs.buffer||"LOADER_BUFFER",this._loaderTaskNo=0,this._ttfb=0,this._speed=new Yh,window.AbortController&&(this.abortControllerEnabled=!0)}return Xh(h,[{key:"init",value:function(){this.on(Gt.LADER_START,this.load.bind(this))}},{key:"fetch",value:function(a){function t(i,r,n){return a.apply(this,arguments)}return t.toString=function(){return a.toString()},t}(function(a,t,i){var r=this,n=null;this.abortControllerEnabled&&(this.abortController=new window.AbortController),Object.assign(t,{signal:this.abortController?this.abortController.signal:void 0});var u=new Date().getTime();return Promise.race([fetch(a,t),new Promise(function(o,c){n=setTimeout(function(){c({code:999,message:"fetch timeout"}),r.abortController&&r.abortController.abort()},i||1e4)})]).then(function(o){n&&(clearTimeout(n),n=null);var c=new Date().getTime();return r.emit(Gt.LOADER_TTFB,{start:u,end:c,elapsed:c-u}),o})})},{key:"internalLoad",value:function(t,i,r,n){var u=this,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,c=arguments[5];if(!this._destroyed)return this.loading=!0,this.fetch(this.url,i,c).then(function(g){if(!u._destroyed&&u.emit(Gt.LOADER_RESPONSE_HEADERS,u.TAG,g.headers),g.ok)return u.status=g.status,Promise.resolve().then(function(){u._onFetchResponse(g)}),Promise.resolve(g);r-- >0?u._retryTimer=setTimeout(function(){return u.emit(Gt.LOADER_RETRY,u.TAG,{response:g,reason:"response not ok",retryTime:n-r}),u.internalLoad(t,i,r,n,o,c)},o):(u.loading=!1,u.emit(Gt.LOADER_ERROR,u.TAG,{code:g.status||21,message:g.status+" ("+g.statusText+")"}))}).catch(function(g){if(u._destroyed){u.loading=!1;return}if(r-- >0)u._retryTimer=setTimeout(function(){return u.emit(Gt.LOADER_RETRY,u.TAG,{error:g,reason:"fetch error",retryTime:n-r}),u.internalLoad(t,i,r,n,o,c)},o);else{if(u.loading=!1,g&&g.name==="AbortError")return;u.emit(Gt.LOADER_ERROR,u.TAG,Object.assign({code:21},g))}})}},{key:"load",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=r.retryCount,u=r.retryDelay,o=r.loadTimeout;n=n===void 0?3:n,this.url=t,this._canceled=!1;var c=this.getParams(i);return this.internalLoad(t,c,n,n,u,o)}},{key:"_onFetchResponse",value:function(t){var i=this,r=this,n=this._context.getInstance(this.buffer);this._loaderTaskNo++;var u=this._loaderTaskNo;if(t.ok===!0)switch(this.readtype){case Jh:t.json().then(function(o){r.loading=!1,!r._canceled&&!r._destroyed&&(n?(n.push(o),r.emit(Gt.LOADER_COMPLETE,n)):r.emit(Gt.LOADER_COMPLETE,o))});break;case Zh:t.text().then(function(o){r.loading=!1,!r._canceled&&!r._destroyed&&(n?(n.push(o),r.emit(Gt.LOADER_COMPLETE,n)):r.emit(Gt.LOADER_COMPLETE,o))});break;case Qh:t.arrayBuffer().then(function(o){r.loading=!1,!r._canceled&&!r._destroyed&&(n?(n.push(new Uint8Array(o)),i._speed.addBytes(o.byteLength),r.emit(Gt.LOADER_COMPLETE,n)):r.emit(Gt.LOADER_COMPLETE,o))}).catch(function(){});break;case qh:default:return this._onReader(t.body.getReader(),u)}}},{key:"_onReader",value:function(t,i){var r=this,n=this._context.getInstance(this.buffer);if(!n&&this._reader||this._destroyed)try{this._reader.cancel()}catch(u){}this._reader=t,this.loading!==!1&&(this._noDataTimer=setTimeout(function(){r.loading!==!1&&r.emit(Gt.LOADER_COMPLETE)},3e3),this._reader&&this._reader.read().then(function(u){if(clearTimeout(r._noDataTimer),r._canceled||r._destroyed){if(r._reader)try{r._reader.cancel()}catch(o){}return}if(u.done){r.loading=!1,r.status=0,Promise.resolve().then(function(){r.emit(Gt.LOADER_COMPLETE,n)});return}return n.push(u.value),r._speed.addBytes(u.value.byteLength),Promise.resolve().then(function(){r.emit(Gt.LOADER_DATALOADED,n)}),r._onReader(t,i)}).catch(function(u){clearTimeout(r._noDataTimer),r.loading=!1,!(u&&u.name==="AbortError")&&r.emit(Gt.LOADER_ERROR,r.TAG,u)}))}},{key:"getParams",value:function(t){var i=Object.assign({},t),r=new Headers,n={method:"GET",headers:r,mode:"cors",cache:"default"};if(Zl(this.configs.headers)==="object"){var u=this.configs.headers;for(var o in u)u.hasOwnProperty(o)&&r.append(o,u[o])}if(Zl(i.headers)==="object"){var c=i.headers;for(var g in c)c.hasOwnProperty(g)&&r.append(g,c[g])}return i.cors===!1&&(n.mode="same-origin"),i.withCredentials&&(n.credentials="include"),n}},{key:"cancel",value:function(){if(this._reader){try{this._reader.cancel()}catch(t){}this._reader=null,this.loading=!1}clearTimeout(this._noDataTimer),this._canceled=!0,this.abortController&&this.abortController.abort()}},{key:"destroy",value:function(){this._destroyed=!0,clearTimeout(this._retryTimer),clearTimeout(this._noDataTimer),this.cancel(),this._speed.reset()}},{key:"currentSpeed",get:function(){return this._speed.lastSamplingKBps}}],[{key:"isSupported",value:function(){return!!window.fetch}},{key:"type",get:function(){return"loader"}}]),h}(),ia=ep,tp=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function ip(h){if(Array.isArray(h)){for(var a=0,t=Array(h.length);a<h.length;a++)t[a]=h[a];return t}else return Array.from(h)}function rp(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var np=function(){function h(){var a=this;rp(this,h);try{var t=/xgd=(\d)/.exec(document.cookie);this._status=!!t,this._level=t&&t[1]}catch(i){this._status=!1}["group","groupEnd","log","warn","error"].forEach(function(i){a[i]=function(r,n,u,o,c,g,v,p,e,s){var l;if(!!a._status){var f=r,d=[n,u,o,c,g,v,p,e,s].filter(function(y){return y!==void 0});(l=console)[i].apply(l,["["+f+"]:"].concat(ip(d)))}}})}return tp(h,[{key:"enable",get:function(){return this._status}},{key:"long",get:function(){return this._level==="2"}}]),h}(),Kr=new np,ap=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function sp(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var ii=Xt.LOADER_EVENTS,hr=Xt.REMUX_EVENTS,Pr=Xt.DEMUX_EVENTS,Jl=Xt.CRYTO_EVENTS,ra=Xt.MSE_EVENTS,op="HLS_ERROR",Ql=function(){function h(a){sp(this,h),this.TAG="HlsVodController",this.configs=Object.assign({},a),this.url="",this.sequence=0,this._playlist=null,this.retrytimes=this.configs.retrytimes||3,this.container=this.configs.container,this.preloadTime=this.configs.preloadTime||5,this.mse=this.configs.mse,this._lastSeekTime=0,this.m3u8Text=null}return ap(h,[{key:"init",value:function(){this._context.registry("M3U8_BUFFER",Yr),this._tsBuffer=this._context.registry("TS_BUFFER",Yr)(),this._tracks=this._context.registry("TRACKS",Ha)(),this._playlist=this._context.registry("PLAYLIST",Na)({autoclear:!1}),this._presource=this._context.registry("PRE_SOURCE_BUFFER",Ro)(),this._compat=this._context.registry("COMPATIBILITY",pl)(),this._context.registry("M3U8_LOADER",ia)({buffer:"M3U8_BUFFER",readtype:1}),this._tsloader=this._context.registry("TS_LOADER",ia)({buffer:"TS_BUFFER",readtype:3}),this._demuxer=this._context.registry("TS_DEMUXER",qa)({inputbuffer:"TS_BUFFER"}),this._context.registry("MP4_REMUXER",Cl)(this._player.currentTime),this.mse||(this.mse=new jh({container:this.container,preloadTime:this.preloadTime},this._context),this.mse.init()),this.initEvents()}},{key:"initEvents",value:function(){this._onLoaderCompete=this._onLoaderCompete.bind(this),this._onLoadError=this._onLoadError.bind(this),this._onInitSegment=this._onInitSegment.bind(this),this._handleSEIParsed=this._handleSEIParsed.bind(this),this._onMediaSegment=this._onMediaSegment.bind(this),this._onMetadataParsed=this._onMetadataParsed.bind(this),this._onDemuxComplete=this._onDemuxComplete.bind(this),this._onDemuxError=this._onDemuxError.bind(this),this._onRemuxError=this._onRemuxError.bind(this),this._handleMseError=this._handleMseError.bind(this),this._onUpdateEnd=this._onUpdateEnd.bind(this),this._onTimeUpdate=this._onTimeUpdate.bind(this),this._onWaiting=this._onWaiting.bind(this),this.on(ii.LOADER_COMPLETE,this._onLoaderCompete),this.on(ii.LOADER_ERROR,this._onLoadError),this.on(hr.INIT_SEGMENT,this._onInitSegment),this.on(Pr.SEI_PARSED,this._handleSEIParsed),this.on(hr.MEDIA_SEGMENT,this._onMediaSegment),this.on(Pr.METADATA_PARSED,this._onMetadataParsed),this.on(Pr.DEMUX_COMPLETE,this._onDemuxComplete),this.on(Pr.DEMUX_ERROR,this._onDemuxError),this.on(hr.REMUX_ERROR,this._onRemuxError),this.on(ra.MSE_ERROR,this._handleMseError),this.on(ra.SOURCE_UPDATE_END,this._onUpdateEnd),this.on("TIME_UPDATE",this._onTimeUpdate),this.on(ra.SOURCE_UPDATE_END,this._onTimeUpdate),this.on("WAITING",this._onWaiting)}},{key:"_onError",value:function(t,i,r,n){var u={errorType:t,errorDetails:"["+i+"]: "+(r?r.message:""),errorFatal:n};this._player&&this._player.emit(op,u)}},{key:"_onLoadError",value:function(t,i){this._player.emit("error",{errorType:"network",ex:"["+t+"]: "+i.message,errd:{}}),this._onError(ii.LOADER_ERROR,t,i,!0)}},{key:"_onDemuxError",value:function(t,i,r){r===void 0&&(r=!0),this._player.emit("error",{errorType:"parse",ex:"["+t+"]: "+i.message,errd:{}}),this._onError(ii.LOADER_ERROR,t,i,r)}},{key:"_onRemuxError",value:function(t,i,r){r===void 0&&(r=!0),this._player.emit("error",{errorType:"parse",ex:"["+t+"]: "+i.message,errd:{}}),this._onError(hr.REMUX_ERROR,t,i,r)}},{key:"_handleMseError",value:function(t,i,r){r===void 0&&(r=!1),this._player.emit("error",{errorType:"format",ex:"["+t+"]: "+i.message,errd:{}}),this._onError(ra.MSE_ERROR,t,i,r)}},{key:"_onWaiting",value:function(t){var i=!0;Kr.log(this.TAG,"waiting.......",this._player.video.currentTime),this._seekToBufferStart();var r=Object.keys(this._playlist.list),n=r.length;if(!!n){for(var u=0;u<n;u++)this.container.currentTime*1e3<parseInt(r[u])&&(i=!1);if(i){var o=this._playlist.getTs(this.container.currentTime*1e3);o?o.downloaded&&(this._player.emit("ended"),this.mse.endOfStream()):(this._player.emit("ended"),this.mse.endOfStream())}}}},{key:"_seekToBufferStart",value:function(){var t=this._player.video,i=t.buffered,r=[0,0],n=t.currentTime;if(i){for(var u=0,o=i.length;u<o;u++)if(r[0]=i.start(u),r[1]=i.end(u),r[0]<=n&&n<=r[1])return}var c=r[0];n===0&&n<c&&Math.abs(n-c)<5&&(t.currentTime=c)}},{key:"_checkEnd",value:function(){var t=this._player.video,i=t.buffered,r=i.length;if(!!r){var n=i.end(r-1);Math.abs(n-t.duration)<1&&this.mse.endOfStream()}}},{key:"_onUpdateEnd",value:function(){this._checkEnd(),this._seekToBufferStart(),this._preload(this._player.currentTime)}},{key:"_onTimeUpdate",value:function(){this._seekToBufferStart(),this._preload(this._player.currentTime)}},{key:"_onDemuxComplete",value:function(){this.emit(hr.REMUX_MEDIA,"ts")}},{key:"_handleSEIParsed",value:function(t){this._player.emit("SEI_PARSED",t)}},{key:"_onMetadataParsed",value:function(t){try{var i=this._tracks[t+"Track"].meta;Kr.warn(this.TAG,"meta detect or changed , ",t,Object.assign({},i))}catch(n){}var r=parseInt(this._playlist.duration);t==="video"?(this._context.mediaInfo.hasVideo=!0,this._tracks.videoTrack.meta.duration=r):t==="audio"&&(this._context.mediaInfo.hasAudio=!0,this._tracks.audioTrack.meta.duration=r),this.emit(hr.REMUX_METADATA,t)}},{key:"_onMediaSegment",value:function(){Object.keys(this.mse.sourceBuffers).length<1&&this.mse.addSourceBuffers(),this.mse.doAppend()}},{key:"_onInitSegment",value:function(){this.mse.addSourceBuffers()}},{key:"_onLoaderCompete",value:function(t){if(t.TAG==="M3U8_BUFFER"){this.m3u8Text=t.shift();try{var i=Za.parse(this.m3u8Text,this.url);this._playlist.pushM3U8(i)}catch(u){this._onError("M3U8_PARSER_ERROR","PLAYLIST",u,!0)}if(this._playlist.encrypt&&this._playlist.encrypt.uri&&!this._playlist.encrypt.key)this._context.registry("DECRYPT_BUFFER",Yr)(),this._context.registry("KEY_BUFFER",Yr)(),this._tsloader.buffer="DECRYPT_BUFFER",this._keyLoader=this._context.registry("KEY_LOADER",ia)({buffer:"KEY_BUFFER",readtype:3}),this.emitTo("KEY_LOADER",ii.LADER_START,this._playlist.encrypt.uri);else{this.preloadTime||(this._playlist.targetduration?(this.preloadTime=this._playlist.targetduration,this.mse.preloadTime=this._playlist.targetduration):(this.preloadTime=5,this.mse.preloadTime=5));var r=this._playlist.getTs((this._player.currentTime+.5)*1e3);r?(this._logDownSegment(r),this._playlist.downloading(r.url,!0),this.emitTo("TS_LOADER",ii.LADER_START,r.url)):this.retrytimes>0&&(this.retrytimes--,this.emitTo("M3U8_LOADER",ii.LADER_START,this.url))}}else if(t.TAG==="TS_BUFFER")this._playlist.downloaded(this._tsloader.url,!0),this._demuxer.demux(Object.assign({url:this._tsloader.url},this._playlist._ts[this._tsloader.url]),!0),this._preload(this.mse.container.currentTime);else if(t.TAG==="DECRYPT_BUFFER")this.retrytimes=this.configs.retrytimes||3,this._playlist.downloaded(this._tsloader.url,!0),this.emitTo("CRYPTO",Jl.START_DECRYPT,Object.assign({url:this._tsloader.url},this._playlist._ts[this._tsloader.url]));else if(t.TAG==="KEY_BUFFER"){this.retrytimes=this.configs.retrytimes||3,this._playlist.encrypt.key=t.shift(),this._crypto=this._context.registry("CRYPTO",Nh)({key:this._playlist.encrypt.key,iv:this._playlist.encrypt.ivb,method:this._playlist.encrypt.method,inputbuffer:"DECRYPT_BUFFER",outputbuffer:"TS_BUFFER"}),this._crypto.on(Jl.DECRYPTED,this._onDcripted.bind(this));var n=this._playlist.getTs();n?(this._playlist.downloading(n.url,!0),this.emitTo("TS_LOADER",ii.LADER_START,n.url)):this.retrytimes>0&&(this.retrytimes--,this.emitTo("M3U8_LOADER",ii.LADER_START,this.url))}}},{key:"_onDcripted",value:function(){this.emit(Pr.DEMUX_START)}},{key:"seek",value:function(t){for(var i=this._player.video,r=0;r<i.buffered.length;r++)if(t>=i.buffered.start(r)&&t<i.buffered.end(r))return;Kr.warn(this.TAG,"seek: ",t,"tsloading:",this._tsloader.loading);var n=this._playlist.getTs((t+.5)*1e3);n&&this._tsloader.loading&&this._tsloader.url===n.url||(this._lastSeekTime=t,this._tsloader.destroy(),this._tsloader=this._context.registry("TS_LOADER",ia)({buffer:"TS_BUFFER",readtype:3}),this._presource.sources.video&&(this._presource.sources.video.data=[]),this._presource.sources.audio&&(this._presource.sources.audio.data=[]),this._tracks.audioTrack&&(this._tracks.audioTrack.samples=[]),this._tracks.videoTrack&&(this._tracks.videoTrack.samples=[]),this._compat&&this._compat.reset(),this._tsBuffer&&(this._tsBuffer.array=[],this._tsBuffer.length=0,this._tsBuffer.offset=0),this._playlist.clearDownloaded(),this._context.seek(t),this._preload(t))}},{key:"replay",value:function(){this._compat.reset(),this._playlist.clearDownloaded()}},{key:"load",value:function(t){this.url=t,this.emitTo("M3U8_LOADER",ii.LADER_START,t,null,0)}},{key:"_preload",value:function(t){if(t=Math.floor(t),!this._tsloader.loading){Kr.log(this.TAG,"preload: time=",t);var i=this.mse.container,r=-1;!t&&i.buffered.length&&(t=i.buffered.start(0));for(var n=0;n<i.buffered.length;n++)t>=Math.floor(i.buffered.start(n))&&t<=Math.ceil(i.buffered.end(n))&&(r=i.buffered.end(n));if(r<0){var u=this._playlist.getTs((t+.5)*1e3);u&&u.downloaded&&(u=this._playlist.getTs(u.time+u.duration)),u&&!u.downloading&&!u.downloaded&&(this._logDownSegment(u),this._playlist.downloading(u.url,!0),this.emitTo("TS_LOADER",ii.LADER_START,u.url))}else if(r<t+this.preloadTime){var o=this._playlist.getLastDownloadedTs()||this._playlist.getTs(r*1e3);if(!o)return;var c=o.time+o.duration,g=o.time;if(o.downloaded)for(var v=1e3;v-- >0&&(c+=10,o=this._playlist.getTs(c),!(!o||o.time>g)););o&&!o.downloading&&!o.downloaded&&(this._logDownSegment(o),this._playlist.downloading(o.url,!0),this.emitTo("TS_LOADER",ii.LADER_START,o.url))}}}},{key:"cleanBuffer",value:function(){var t=this,i=this._player.currentTime,r=this._player.video,n=r.buffered;if(!(!n||!n.length)){var u=[0,0],o=r.currentTime;if(n)for(var c=0,g=n.length;c<g&&(u[0]=n.start(c),u[1]=n.end(c),!(u[0]<=o&&o<=u[1]));c++);var v=u[0],p=u[1];(i-v>10||n.length>1)&&(this.mse.remove(Math.max(Math.min(i-10,p-10),.1),0),this.bufferClearTimer=setTimeout(function(){t.bufferClearTimer=null},5e3))}}},{key:"destory",value:function(){this.configs={},this.url="",this.sequence=0,this._playlist=null,this.retrytimes=3,this.container=void 0,this.preloadTime=5,this._lastSeekTime=0,this.m3u8Text=null,this.mse=null,this.off(ii.LOADER_COMPLETE,this._onLoaderCompete),this.off(ii.LOADER_ERROR,this._onLoadError),this.off(hr.INIT_SEGMENT,this._onInitSegment),this.off(hr.MEDIA_SEGMENT,this._onMediaSegment),this.off(Pr.METADATA_PARSED,this._onMetadataParsed),this.off(Pr.DEMUX_COMPLETE,this._onDemuxComplete),this.off("TIME_UPDATE",this._onTimeUpdate),this.off("WAITING",this._onWaiting)}},{key:"_logDownSegment",value:function(t){!t||(Kr.groupEnd(),Kr.group(this.TAG,"load "+t.id+": ["+t.time/1e3+" , "+(t.time+t.duration)/1e3+"], downloading: "+t.downloading+" , donwloaded: "+t.downloaded))}}]),h}(),lp=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}(),up=function h(a,t,i,r){var n=Object.getOwnPropertyDescriptor(a,t);if(n===void 0){var u=Object.getPrototypeOf(a);u!==null&&h(u,t,i,r)}else if("value"in n&&n.writable)n.value=i;else{var o=n.set;o!==void 0&&o.call(r,i)}return i},qr=function h(a,t,i){a===null&&(a=Function.prototype);var r=Object.getOwnPropertyDescriptor(a,t);if(r===void 0){var n=Object.getPrototypeOf(a);return n===null?void 0:h(n,t,i)}else{if("value"in r)return r.value;var u=r.get;return u===void 0?void 0:u.call(i)}};function fp(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}function cp(h,a){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a&&(typeof a=="object"||typeof a=="function")?a:h}function dp(h,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof a);h.prototype=Object.create(a&&a.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(h,a):h.__proto__=a)}var hp=Uh,eu=Xt.HlsAllowedEvents,tu=Xt.REMUX_EVENTS,pp=Xt.HLS_EVENTS,gp=Xt.MSE_EVENTS,vp=function(h){dp(a,h);function a(t){fp(this,a);var i=cp(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,t));return i.hlsOps={},i.util=Ct.util,i.util.deepCopy(i.hlsOps,t),i._handleSetCurrentTime=hp(i._handleSetCurrentTime.bind(i),200),i.onWaiting=i.onWaiting.bind(i),i}return lp(a,[{key:"_handleSetCurrentTime",value:function(i){i=parseFloat(i),i!==this.currentTime&&(up(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"currentTime",i,this),this._context&&this.__core__.seek(i))}},{key:"play",value:function(){var i=this;return this.video.play().catch(function(r){r&&r.code===20&&i.once("canplay",function(){i.video.play()})})}},{key:"replay",value:function(){var i=this;this.__core__.mse.cleanBuffers().then(function(){i.__core__.replay(),qr(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"replay",i).call(i)})}},{key:"_initEvents",value:function(){var i=this;this.__core__.once(tu.INIT_SEGMENT,function(){var r=i.__core__.mse;qr(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"start",i).call(i,r.url)}),this.__core__.once(pp.RETRY_TIME_EXCEEDED,function(){i.emit("error",new Ct.Errors("network",i.config.url))}),this.__core__.on(gp.SOURCE_UPDATE_END,function(){i._onSourceUpdateEnd()}),this.once("canplay",function(){i.config.autoplay&&i.play()})}},{key:"initHlsBackupEvents",value:function(i,r){var n=this;i.once(tu.INIT_SEGMENT,function(){if(!n.video.src){console.log("\u6302\u8F7D src blob");var u=i.mse;qr(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"start",n).call(n,u.url)}}),i.once(Xt.REMUX_EVENTS.MEDIA_SEGMENT,function(){n.__core__=i,n.__core__.mse.cleanBuffers().then(function(){n.__core__.mse.resetContext(r),n.__core__.mse.doAppend(),n._context=r})}),i.once(Xt.LOADER_EVENTS.LOADER_ERROR,function(){r.destroy()})}},{key:"_onSourceUpdateEnd",value:function(){if(this.video.readyState===1||this.video.readyState===2){var i=this.detectBufferGap(),r=i.gap,n=i.start,u=i.method;r&&(u==="ceil"&&this.currentTime<Math[u](n)?this.currentTime=Math[u](n):u==="floor"&&this.currentTime>Math[u](n)&&(this.currentTime=Math[u](n)))}}},{key:"start",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.config.url;!i||this.started||(this._context||(this._context=new Kl(this,this.hlsOps,eu)),this.__core__=this._context.registry("HLS_VOD_CONTROLLER",Ql)({player:this,container:this.video,preloadTime:this.config.preloadTime}),this._context.init(),this.__core__.load(i),this._initEvents(),this.started=!0)}},{key:"switchURL",value:function(i){this.config.url=i;var r=new Kl(this,this.hlsOps,eu),n=r.registry("HLS_VOD_CONTROLLER",Ql)({player:this,container:this.video,mse:this.__core__.mse,preloadTime:this.config.preloadTime});this.newContext=r,this.newHls=n,r.init(),this._context.destroy(),this.initHlsBackupEvents(n,r),this.__core__.mse.cleanBuffers().then(function(){n.load(i)})}},{key:"destroy",value:function(){var i=this;return new Promise(function(r){i.__core__&&i.__core__.mse?(i.__core__.mse.destroy().then(function(){i._context&&i._context.destroy(),qr(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"destroy",i).call(i),r()}),setTimeout(function(){r()},100)):(qr(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"destroy",i).call(i),setTimeout(function(){r()},50))})}},{key:"detectBufferGap",value:function(){for(var i=this.video,r={gap:!1,start:-1},n=this.currentTime===0,u=0;u<i.buffered.length;u++){var o=i.buffered.start(u),c=i.buffered.end(u);if((!i.played.length||o<=this.currentTime&&c-this.currentTime>=.5)&&!n)break;var g=o-this.currentTime,v=this.currentTime-c;if(g>.01&&(g<=2||n)){r={gap:!0,start:o,method:"ceil"};break}else v>.1&&(v<=2||n)?r={gap:!0,start:c,method:"floor"}:r={gap:!1,start:-1}}return r}},{key:"currentTime",get:function(){return qr(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"currentTime",this)},set:function(i){this._handleSetCurrentTime(i)}},{key:"src",get:function(){return this.currentSrc},set:function(i){var r=this;this.onWaiting=this.onWaiting.bind(this),this.__core__.mse.destroy().then(function(){r._context.destroy(),r._context=null,r.video.src="",r.video.load(),r.started=!1,r.video.currentTime=0,r.paused?r.play():(r.pause(),r.once("canplay",function(){r.play()})),r.start(i)})}},{key:"context",get:function(){return this._context}}],[{key:"isSupported",value:function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')}},{key:"install",value:function(i,r){return Ct.install(i,r)}}]),a}(Ct),yp=function(){function h(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,r.key,r)}}return function(a,t,i){return t&&h(a.prototype,t),i&&h(a,i),a}}();function mp(h,a){if(!(h instanceof a))throw new TypeError("Cannot call a class as a function")}var _p=function(){function h(a){return mp(this,h),a.isLive?new Fl(a):new vp(a)}return yp(h,null,[{key:"isSupported",value:function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')}},{key:"install",value:function(t,i){return Ct.install(t,i)}}]),h}(),xp=_p;const Ep=(h,a)=>{for(let t=0;t<h.length;t++){const i=h.start(t),r=h.end(t);if(a>=i&&a<=r)return!0}return!1};class bp{constructor(){ve(this,"emitter",Zn());ve(this,"loopMode","listloop");ve(this,"playHistory",[]);ve(this,"playList",[]);ve(this,"playInfo",null);ve(this,"playInfoIdKey","id");ve(this,"playHandler",a=>oe(this,null,function*(){return a}));ve(this,"silentMediaEl",new Audio(tf));ve(this,"currentMediaRes",null);ve(this,"xgplayer");ve(this,"videoEl");ve(this,"audioEl",new Pf);ve(this,"mixedMediaSource");ve(this,"customAudioMediaSource");ve(this,"customVideoMediaSource");ve(this,"audioElStatus","waiting");ve(this,"isVideoShow",!1);ve(this,"isVideoPlaying",!1);ve(this,"isVideoWaiting",!1);ve(this,"setCurrentTimeRateBebounce");ve(this,"setCurrentTimeRateing",!1);ve(this,"httpAxios",hn.create());this.silentMediaEl.loop=!0,this.silentMediaEl.autoplay=!1,this.silentMediaEl.volume=.1,this.setCurrentTimeRateBebounce=to(a=>{this.setCurrentTimeRateing=!1;let t=this.audioEl.duration*(a/100);t>this.audioEl.duration&&(t=this.audioEl.duration),this.audioEl.currentTime=t},500,!1)}selectToPlay(a){return oe(this,null,function*(){console.log("silentAudioEl play"),this.silentMediaEl.play(),this.reset(),this.emitter.emit("changePlayInfo",a);let t=yield this.playHandler(a);this.currentMediaRes=t,this.playInfo=a;let i=this.playHistory.findIndex(r=>r[this.playInfoIdKey]==a[this.playInfoIdKey]);i>=0&&this.playHistory.splice(i,1),this.playHistory.push(Ti({},a)),t.type==="url"?this.audioEl.src=t.data.audio:t.type==="arraybuffer"?this.audioEl.src=URL.createObjectURL(new Blob([t.data.audio])):t.type==="rangeurl"?(this.customAudioMediaSource=new go(this.getMediaAxios(t.data.audio),t.data.audio,'audio/mp4; codecs="mp4a.40.2"'),this.audioEl.src=URL.createObjectURL(this.customAudioMediaSource.mediaSource)):t.type==="mixedurl"?(this.mixedMediaSource=new Rf(this.getMediaAxios(t.data.url),t.data.url),this.mixedMediaSource.on("error",r=>{alert(r)}),this.audioEl.src=this.mixedMediaSource.audioUrl,this.videoEl.src=this.mixedMediaSource.videoUrl):t.type==="hlsurl"&&(this.audioEl.src=t.data.url),this.audioEl.load(),this.audioEl.play(),this.isVideoShow&&this.syncVideoPlayByMediaRes(),this.audioEl.addEventListener("canplay",()=>{console.log("silentMediaEl pause"),setTimeout(()=>{this.silentMediaEl.pause()},0),document.pictureInPictureElement&&(this.isVideoPlaying&&document.pictureInPictureElement!=this.videoEl?this.videoEl.requestPictureInPicture():this.xgplayer.root.style.display!="none"&&document.pictureInPictureElement!=this.xgplayer.video&&this.xgplayer.video.requestPictureInPicture())},{once:!0})})}bind(a,t){this.videoEl=a,this.videoEl.muted=!0,this.videoEl.controls=!1,this.videoEl.autoplay=!1,this.xgplayer=new xp({el:t,url:"",autoplay:!0,playsinline:!0,width:"100%",height:"100%",controls:!1,volume:1,keyShortcut:"off",ignores:["time","definition","error","fullscreen","i18n","loading","mobile","pc","play","poster","progress","replay","volume"]}),this.audioEl.bindXgplayer(this.xgplayer),this.audioEl.addEventListener("seeking",i=>{console.log("audioEl seeking",this.audioEl.currentTime),this.mixedMediaSource&&this.mixedMediaSource.onMediaSeeking(this.audioEl)}),this.audioEl.addEventListener("waiting",i=>{console.log("audioEl waiting",this.audioEl.currentTime),this.audioElStatus="waiting",this.customAudioMediaSource&&this.customAudioMediaSource.onMediaWaiting(this.audioEl.currentTime),this.mixedMediaSource&&this.mixedMediaSource.onMediaWaiting(this.audioEl)}),this.audioEl.addEventListener("loadedmetadata",i=>{console.log("audioEl loadedmetadata")}),this.audioEl.addEventListener("canplay",i=>{console.log("audioEl canplay",this.audioEl.currentTime),this.audioElStatus="canplay"}),this.audioEl.addEventListener("timeupdate",i=>{console.log("audioEl timeupdate",this.audioEl.currentTime),this.emitter.emit("timeupdate",{setCurrentTimeRateing:this.setCurrentTimeRateing,audioEl:this.audioEl}),this.customAudioMediaSource&&this.customAudioMediaSource.onMediaTimeupdate(this.audioEl.currentTime),this.mixedMediaSource&&this.mixedMediaSource.onMediaTimeupdate(this.audioEl)}),this.audioEl.addEventListener("play",i=>{console.log("audioEl play",this.audioEl.currentTime),this.emitter.emit("play",this.audioEl)}),this.audioEl.addEventListener("pause",i=>{console.log("audioEl pause",this.audioEl.currentTime),this.emitter.emit("pause",this.audioEl),this.mixedMediaSource&&this.mixedMediaSource.onMediaPause(this.audioEl)}),this.audioEl.addEventListener("ended",i=>{console.log("audioEl ended",this.audioEl.currentTime),this.playNextAduio()}),this.videoEl.addEventListener("waiting",i=>{console.log("videoEl waiting",this.videoEl.currentTime),this.isVideoWaiting=!0,this.customVideoMediaSource&&this.customVideoMediaSource.onMediaWaiting(this.videoEl.currentTime)}),this.videoEl.addEventListener("loadedmetadata",i=>{console.log("videoEl loadedmetadata")}),this.videoEl.addEventListener("canplay",i=>{console.log("videoEl canplay",this.videoEl.currentTime),this.isVideoWaiting=!1}),this.videoEl.addEventListener("timeupdate",i=>{console.log("videoEl timeupdate",this.videoEl.currentTime),this.customVideoMediaSource&&this.customVideoMediaSource.onMediaTimeupdate(this.videoEl.currentTime)}),this.videoEl.addEventListener("play",i=>{console.log("videoEl play",this.videoEl.currentTime)}),this.videoEl.addEventListener("pause",i=>{console.log("videoEl pause",this.videoEl.currentTime)}),this.videoEl.addEventListener("ended",i=>{console.log("videoEl ended",this.videoEl.currentTime)}),this.bindSyncVideoByAudio()}bindBridgeIframe(a){this.audioEl.bindBrigeIframe(a)}play(){return oe(this,null,function*(){this.audioEl.play()})}pause(){return oe(this,null,function*(){setTimeout(()=>{this.audioEl.pause()},0)})}setCurrentTimeRate(a){return oe(this,null,function*(){this.setCurrentTimeRateing=!0,this.setCurrentTimeRateBebounce(a)})}reset(){this.customAudioMediaSource&&(this.customAudioMediaSource.destory(),this.customAudioMediaSource=null),this.mixedMediaSource&&(this.mixedMediaSource.destory(),this.mixedMediaSource=null),this.resetVideoPlayer(),this.audioEl.setMuted(!1),URL.revokeObjectURL(this.audioEl.src),this.audioEl.src="",this.audioEl.load()}setPlayHandler(a){this.playHandler=a}setPlayList(a){this.playList=a}setLoopMode(a){this.loopMode=a}setPlayInfoIdKey(a){this.playInfoIdKey=a}setAxios(a){this.httpAxios=a}getMediaAxios(a){return Ai.isOssMediaUrl(a)?Ai.getAxios():this.httpAxios}playNextAduio(){let a=-1;if(this.playInfo&&(a=this.playList.findIndex(t=>t[this.playInfoIdKey]==this.playInfo[this.playInfoIdKey])),this.loopMode=="random"){let t=[...this.playList];t.length>1&&t.splice(a,1);let i=Math.floor(t.length*Math.random());if(t.length>0)this.selectToPlay(t[i]);else return}else if(this.loopMode=="listloop")if(a+1<this.playList.length)this.selectToPlay(this.playList[a+1]);else if(this.playList.length>=1)this.selectToPlay(this.playList[0]);else return;else if(this.loopMode=="oneloop")this.audioEl.currentTime=0,this.audioEl.play();else if(this.loopMode=="listplay")if(a+1<this.playList.length)this.selectToPlay(this.playList[a+1]);else return}playPrevAudio(){if(this.playHistory.length<2)throw new Error("\u6CA1\u6709\u4E0A\u4E00\u9996\u53EF\u64AD\u653E\u54E6");let a=this.playHistory.splice(-2,2)[0];this.selectToPlay(a)}setVideoShow(a){var t;if(a!==this.isVideoShow){if(this.isVideoShow=a,((t=this.currentMediaRes)==null?void 0:t.type)==="mixedurl"){this.isVideoShow===!1?(this.isVideoPlaying=!1,this.videoEl.currentTime=0,this.videoEl.pause()):this.audioEl.paused||(this.isVideoPlaying=!0,this.videoEl.play());return}this.isVideoShow===!1?this.resetVideoPlayer():this.audioEl.paused||this.syncVideoPlayByMediaRes()}}syncVideoPlayByMediaRes(){const a=this.currentMediaRes;if(this.isVideoPlaying=!0,a.type==="url"){if(!a.data.video){this.isVideoPlaying=!1;return}this.videoEl.src=a.data.video}else if(a.type==="arraybuffer"){if(!a.data.video){this.isVideoPlaying=!1;return}this.videoEl.src=URL.createObjectURL(new Blob([a.data.video])),this.videoEl.muted=!1,this.audioEl.setMuted(!0)}else if(a.type==="rangeurl"){if(!a.data.video){this.isVideoPlaying=!1;return}this.customVideoMediaSource=new go(this.getMediaAxios(a.data.video),a.data.video,'video/mp4; codecs="avc1.640032"'),this.videoEl.src=URL.createObjectURL(this.customVideoMediaSource.mediaSource)}else{if(a.type==="mixedurl")return;if(a.type==="hlsurl"){this.xgplayer.root.style.display=this.isVideoShow?"":"none",this.isVideoPlaying=!1;return}}this.videoEl.load()}syncVideoCurrentStatus(a){if(a&&this.videoEl.paused)return this.currentMediaRes.type==="arraybuffer"&&(this.videoEl.currentTime=this.audioEl.currentTime),this.videoEl.play(),!0;if(!a&&!this.videoEl.paused)return setTimeout(()=>{this.videoEl.pause()},0),!0}syncVideoCurrentTime(a){if(Math.abs(a-this.videoEl.currentTime)>.15){if(this.currentMediaRes.type=="arraybuffer")return!1;if(this.currentMediaRes.type=="rangeurl"){if(this.isVideoWaiting)return!1}else if(Ep(this.videoEl.buffered,a)==!1)return!1;return this.videoEl.currentTime=a,!0}else return!1}resetVideoPlayer(){this.customVideoMediaSource&&(this.customVideoMediaSource.destory(),this.customVideoMediaSource=null),this.xgplayer.root.style.display="none",this.isVideoPlaying=!1,this.isVideoWaiting=!1,this.videoEl&&(this.videoEl.muted=!0,URL.revokeObjectURL(this.videoEl.src),this.videoEl.src="",this.videoEl.poster="",this.videoEl.load())}bindSyncVideoByAudio(){this.audioEl.addEventListener("play",()=>{}),this.audioEl.addEventListener("pause",()=>{!this.isVideoPlaying||this.videoEl.pause()}),this.audioEl.addEventListener("seeking",t=>{this.currentMediaRes.type=="arraybuffer"&&(this.videoEl.currentTime=this.audioEl.currentTime)}),this.audioEl.addEventListener("waiting",()=>{if(!this.isVideoPlaying||document.visibilityState==="hidden"&&!document.pictureInPictureElement)return;this.syncVideoCurrentTime(this.audioEl.currentTime)&&console.log("\u97F3\u753B\u65F6\u95F4\u4FEE\u6B63")}),this.audioEl.addEventListener("timeupdate",()=>{if(this.currentMediaRes.type=="arraybuffer"&&(document.visibilityState=="hidden"?this.audioEl.setMuted(!1):this.audioEl.setMuted(!0)),!this.isVideoPlaying||document.visibilityState==="hidden"&&!document.pictureInPictureElement)return;this.syncVideoCurrentTime(this.audioEl.currentTime)&&console.log("\u97F3\u753B\u65F6\u95F4\u4FEE\u6B63"),a()}),this.videoEl.addEventListener("timeupdate",()=>{!this.isVideoPlaying||a()});const a=rf(()=>{if(!!this.isVideoPlaying)if(document.visibilityState==="hidden"&&!document.pictureInPictureElement)this.syncVideoCurrentStatus(!1);else{let t=!this.audioEl.paused;t&&this.audioElStatus=="waiting"&&(t=!1),this.syncVideoCurrentStatus(t)&&console.log("\u97F3\u753B\u72B6\u6001\u4FEE\u6B63")}},350,{leading:!1,trailing:!0})}on(a,t){this.emitter.on(a,t)}once(a,t){let i=r=>{this.emitter.off(a,i),t(r)};this.emitter.on(a,i)}}var iu={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(h,a){(function(t){h.exports=t()})(function(){return function t(i,r,n){function u(g,v){if(!r[g]){if(!i[g]){var p=typeof jn=="function"&&jn;if(!v&&p)return p(g,!0);if(o)return o(g,!0);var e=new Error("Cannot find module '"+g+"'");throw e.code="MODULE_NOT_FOUND",e}var s=r[g]={exports:{}};i[g][0].call(s.exports,function(l){var f=i[g][1][l];return u(f||l)},s,s.exports,t,i,r,n)}return r[g].exports}for(var o=typeof jn=="function"&&jn,c=0;c<n.length;c++)u(n[c]);return u}({1:[function(t,i,r){var n=t("./utils"),u=t("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(c){for(var g,v,p,e,s,l,f,d=[],y=0,m=c.length,_=m,E=n.getTypeOf(c)!=="string";y<c.length;)_=m-y,p=E?(g=c[y++],v=y<m?c[y++]:0,y<m?c[y++]:0):(g=c.charCodeAt(y++),v=y<m?c.charCodeAt(y++):0,y<m?c.charCodeAt(y++):0),e=g>>2,s=(3&g)<<4|v>>4,l=1<_?(15&v)<<2|p>>6:64,f=2<_?63&p:64,d.push(o.charAt(e)+o.charAt(s)+o.charAt(l)+o.charAt(f));return d.join("")},r.decode=function(c){var g,v,p,e,s,l,f=0,d=0,y="data:";if(c.substr(0,y.length)===y)throw new Error("Invalid base64 input, it looks like a data url.");var m,_=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===o.charAt(64)&&_--,c.charAt(c.length-2)===o.charAt(64)&&_--,_%1!=0)throw new Error("Invalid base64 input, bad content length.");for(m=u.uint8array?new Uint8Array(0|_):new Array(0|_);f<c.length;)g=o.indexOf(c.charAt(f++))<<2|(e=o.indexOf(c.charAt(f++)))>>4,v=(15&e)<<4|(s=o.indexOf(c.charAt(f++)))>>2,p=(3&s)<<6|(l=o.indexOf(c.charAt(f++))),m[d++]=g,s!==64&&(m[d++]=v),l!==64&&(m[d++]=p);return m}},{"./support":30,"./utils":32}],2:[function(t,i,r){var n=t("./external"),u=t("./stream/DataWorker"),o=t("./stream/Crc32Probe"),c=t("./stream/DataLengthProbe");function g(v,p,e,s,l){this.compressedSize=v,this.uncompressedSize=p,this.crc32=e,this.compression=s,this.compressedContent=l}g.prototype={getContentWorker:function(){var v=new u(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),p=this;return v.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),v},getCompressedWorker:function(){return new u(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},g.createWorkerFrom=function(v,p,e){return v.pipe(new o).pipe(new c("uncompressedSize")).pipe(p.compressWorker(e)).pipe(new c("compressedSize")).withStreamInfo("compression",p)},i.exports=g},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,i,r){var n=t("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},r.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,i,r){var n=t("./utils"),u=function(){for(var o,c=[],g=0;g<256;g++){o=g;for(var v=0;v<8;v++)o=1&o?3988292384^o>>>1:o>>>1;c[g]=o}return c}();i.exports=function(o,c){return o!==void 0&&o.length?n.getTypeOf(o)!=="string"?function(g,v,p,e){var s=u,l=e+p;g^=-1;for(var f=e;f<l;f++)g=g>>>8^s[255&(g^v[f])];return-1^g}(0|c,o,o.length,0):function(g,v,p,e){var s=u,l=e+p;g^=-1;for(var f=e;f<l;f++)g=g>>>8^s[255&(g^v.charCodeAt(f))];return-1^g}(0|c,o,o.length,0):0}},{"./utils":32}],5:[function(t,i,r){r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(t,i,r){var n=null;n=typeof Promise!="undefined"?Promise:t("lie"),i.exports={Promise:n}},{lie:37}],7:[function(t,i,r){var n=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",u=t("pako"),o=t("./utils"),c=t("./stream/GenericWorker"),g=n?"uint8array":"array";function v(p,e){c.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=e,this.meta={}}r.magic="\b\0",o.inherits(v,c),v.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(g,p.data),!1)},v.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},v.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},v.prototype._createPako=function(){this._pako=new u[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(e){p.push({data:e,meta:p.meta})}},r.compressWorker=function(p){return new v("Deflate",p)},r.uncompressWorker=function(){return new v("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,i,r){function n(s,l){var f,d="";for(f=0;f<l;f++)d+=String.fromCharCode(255&s),s>>>=8;return d}function u(s,l,f,d,y,m){var _,E,w=s.file,k=s.compression,x=m!==g.utf8encode,S=o.transformTo("string",m(w.name)),P=o.transformTo("string",g.utf8encode(w.name)),U=w.comment,R=o.transformTo("string",m(U)),C=o.transformTo("string",g.utf8encode(U)),A=P.length!==w.name.length,b=C.length!==U.length,O="",W="",K="",G=w.dir,B=w.date,j={crc32:0,compressedSize:0,uncompressedSize:0};l&&!f||(j.crc32=s.crc32,j.compressedSize=s.compressedSize,j.uncompressedSize=s.uncompressedSize);var z=0;l&&(z|=8),x||!A&&!b||(z|=2048);var $=0,J=0;G&&($|=16),y==="UNIX"?(J=798,$|=function(ne,Ee){var we=ne;return ne||(we=Ee?16893:33204),(65535&we)<<16}(w.unixPermissions,G)):(J=20,$|=function(ne){return 63&(ne||0)}(w.dosPermissions)),_=B.getUTCHours(),_<<=6,_|=B.getUTCMinutes(),_<<=5,_|=B.getUTCSeconds()/2,E=B.getUTCFullYear()-1980,E<<=4,E|=B.getUTCMonth()+1,E<<=5,E|=B.getUTCDate(),A&&(W=n(1,1)+n(v(S),4)+P,O+="up"+n(W.length,2)+W),b&&(K=n(1,1)+n(v(R),4)+C,O+="uc"+n(K.length,2)+K);var Q="";return Q+=`
\0`,Q+=n(z,2),Q+=k.magic,Q+=n(_,2),Q+=n(E,2),Q+=n(j.crc32,4),Q+=n(j.compressedSize,4),Q+=n(j.uncompressedSize,4),Q+=n(S.length,2),Q+=n(O.length,2),{fileRecord:p.LOCAL_FILE_HEADER+Q+S+O,dirRecord:p.CENTRAL_FILE_HEADER+n(J,2)+Q+n(R.length,2)+"\0\0\0\0"+n($,4)+n(d,4)+S+O+R}}var o=t("../utils"),c=t("../stream/GenericWorker"),g=t("../utf8"),v=t("../crc32"),p=t("../signature");function e(s,l,f,d){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=l,this.zipPlatform=f,this.encodeFileName=d,this.streamFiles=s,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(e,c),e.prototype.push=function(s){var l=s.meta.percent||0,f=this.entriesCount,d=this._sources.length;this.accumulate?this.contentBuffer.push(s):(this.bytesWritten+=s.data.length,c.prototype.push.call(this,{data:s.data,meta:{currentFile:this.currentFile,percent:f?(l+100*(f-d-1))/f:100}}))},e.prototype.openedSource=function(s){this.currentSourceOffset=this.bytesWritten,this.currentFile=s.file.name;var l=this.streamFiles&&!s.file.dir;if(l){var f=u(s,l,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:f.fileRecord,meta:{percent:0}})}else this.accumulate=!0},e.prototype.closedSource=function(s){this.accumulate=!1;var l=this.streamFiles&&!s.file.dir,f=u(s,l,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(f.dirRecord),l)this.push({data:function(d){return p.DATA_DESCRIPTOR+n(d.crc32,4)+n(d.compressedSize,4)+n(d.uncompressedSize,4)}(s),meta:{percent:100}});else for(this.push({data:f.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},e.prototype.flush=function(){for(var s=this.bytesWritten,l=0;l<this.dirRecords.length;l++)this.push({data:this.dirRecords[l],meta:{percent:100}});var f=this.bytesWritten-s,d=function(y,m,_,E,w){var k=o.transformTo("string",w(E));return p.CENTRAL_DIRECTORY_END+"\0\0\0\0"+n(y,2)+n(y,2)+n(m,4)+n(_,4)+n(k.length,2)+k}(this.dirRecords.length,f,s,this.zipComment,this.encodeFileName);this.push({data:d,meta:{percent:100}})},e.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},e.prototype.registerPrevious=function(s){this._sources.push(s);var l=this;return s.on("data",function(f){l.processChunk(f)}),s.on("end",function(){l.closedSource(l.previous.streamInfo),l._sources.length?l.prepareNextSource():l.end()}),s.on("error",function(f){l.error(f)}),this},e.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},e.prototype.error=function(s){var l=this._sources;if(!c.prototype.error.call(this,s))return!1;for(var f=0;f<l.length;f++)try{l[f].error(s)}catch(d){}return!0},e.prototype.lock=function(){c.prototype.lock.call(this);for(var s=this._sources,l=0;l<s.length;l++)s[l].lock()},i.exports=e},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,i,r){var n=t("../compressions"),u=t("./ZipFileWorker");r.generateWorker=function(o,c,g){var v=new u(c.streamFiles,g,c.platform,c.encodeFileName),p=0;try{o.forEach(function(e,s){p++;var l=function(m,_){var E=m||_,w=n[E];if(!w)throw new Error(E+" is not a valid compression method !");return w}(s.options.compression,c.compression),f=s.options.compressionOptions||c.compressionOptions||{},d=s.dir,y=s.date;s._compressWorker(l,f).withStreamInfo("file",{name:e,dir:d,date:y,comment:s.comment||"",unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions}).pipe(v)}),v.entriesCount=p}catch(e){v.error(e)}return v}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,i,r){function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var u=new n;for(var o in this)typeof this[o]!="function"&&(u[o]=this[o]);return u}}(n.prototype=t("./object")).loadAsync=t("./load"),n.support=t("./support"),n.defaults=t("./defaults"),n.version="3.10.1",n.loadAsync=function(u,o){return new n().loadAsync(u,o)},n.external=t("./external"),i.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,i,r){var n=t("./utils"),u=t("./external"),o=t("./utf8"),c=t("./zipEntries"),g=t("./stream/Crc32Probe"),v=t("./nodejsUtils");function p(e){return new u.Promise(function(s,l){var f=e.decompressed.getContentWorker().pipe(new g);f.on("error",function(d){l(d)}).on("end",function(){f.streamInfo.crc32!==e.decompressed.crc32?l(new Error("Corrupted zip : CRC32 mismatch")):s()}).resume()})}i.exports=function(e,s){var l=this;return s=n.extend(s||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),v.isNode&&v.isStream(e)?u.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",e,!0,s.optimizedBinaryString,s.base64).then(function(f){var d=new c(s);return d.load(f),d}).then(function(f){var d=[u.Promise.resolve(f)],y=f.files;if(s.checkCRC32)for(var m=0;m<y.length;m++)d.push(p(y[m]));return u.Promise.all(d)}).then(function(f){for(var d=f.shift(),y=d.files,m=0;m<y.length;m++){var _=y[m],E=_.fileNameStr,w=n.resolve(_.fileNameStr);l.file(w,_.decompressed,{binary:!0,optimizedBinaryString:!0,date:_.date,dir:_.dir,comment:_.fileCommentStr.length?_.fileCommentStr:null,unixPermissions:_.unixPermissions,dosPermissions:_.dosPermissions,createFolders:s.createFolders}),_.dir||(l.file(w).unsafeOriginalName=E)}return d.zipComment.length&&(l.comment=d.zipComment),l})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,i,r){var n=t("../utils"),u=t("../stream/GenericWorker");function o(c,g){u.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(g)}n.inherits(o,u),o.prototype._bindStream=function(c){var g=this;(this._stream=c).pause(),c.on("data",function(v){g.push({data:v,meta:{percent:0}})}).on("error",function(v){g.isPaused?this.generatedError=v:g.error(v)}).on("end",function(){g.isPaused?g._upstreamEnded=!0:g.end()})},o.prototype.pause=function(){return!!u.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,i,r){var n=t("readable-stream").Readable;function u(o,c,g){n.call(this,c),this._helper=o;var v=this;o.on("data",function(p,e){v.push(p)||v._helper.pause(),g&&g(e)}).on("error",function(p){v.emit("error",p)}).on("end",function(){v.push(null)})}t("../utils").inherits(u,n),u.prototype._read=function(){this._helper.resume()},i.exports=u},{"../utils":32,"readable-stream":16}],14:[function(t,i,r){i.exports={isNode:typeof Buffer!="undefined",newBufferFrom:function(n,u){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(n,u);if(typeof n=="number")throw new Error('The "data" argument must not be a number');return new Buffer(n,u)},allocBuffer:function(n){if(Buffer.alloc)return Buffer.alloc(n);var u=new Buffer(n);return u.fill(0),u},isBuffer:function(n){return Buffer.isBuffer(n)},isStream:function(n){return n&&typeof n.on=="function"&&typeof n.pause=="function"&&typeof n.resume=="function"}}},{}],15:[function(t,i,r){function n(w,k,x){var S,P=o.getTypeOf(k),U=o.extend(x||{},v);U.date=U.date||new Date,U.compression!==null&&(U.compression=U.compression.toUpperCase()),typeof U.unixPermissions=="string"&&(U.unixPermissions=parseInt(U.unixPermissions,8)),U.unixPermissions&&16384&U.unixPermissions&&(U.dir=!0),U.dosPermissions&&16&U.dosPermissions&&(U.dir=!0),U.dir&&(w=y(w)),U.createFolders&&(S=d(w))&&m.call(this,S,!0);var R=P==="string"&&U.binary===!1&&U.base64===!1;x&&x.binary!==void 0||(U.binary=!R),(k instanceof p&&k.uncompressedSize===0||U.dir||!k||k.length===0)&&(U.base64=!1,U.binary=!0,k="",U.compression="STORE",P="string");var C=null;C=k instanceof p||k instanceof c?k:l.isNode&&l.isStream(k)?new f(w,k):o.prepareContent(w,k,U.binary,U.optimizedBinaryString,U.base64);var A=new e(w,C,U);this.files[w]=A}var u=t("./utf8"),o=t("./utils"),c=t("./stream/GenericWorker"),g=t("./stream/StreamHelper"),v=t("./defaults"),p=t("./compressedObject"),e=t("./zipObject"),s=t("./generate"),l=t("./nodejsUtils"),f=t("./nodejs/NodejsStreamInputAdapter"),d=function(w){w.slice(-1)==="/"&&(w=w.substring(0,w.length-1));var k=w.lastIndexOf("/");return 0<k?w.substring(0,k):""},y=function(w){return w.slice(-1)!=="/"&&(w+="/"),w},m=function(w,k){return k=k!==void 0?k:v.createFolders,w=y(w),this.files[w]||n.call(this,w,null,{dir:!0,createFolders:k}),this.files[w]};function _(w){return Object.prototype.toString.call(w)==="[object RegExp]"}var E={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(w){var k,x,S;for(k in this.files)S=this.files[k],(x=k.slice(this.root.length,k.length))&&k.slice(0,this.root.length)===this.root&&w(x,S)},filter:function(w){var k=[];return this.forEach(function(x,S){w(x,S)&&k.push(S)}),k},file:function(w,k,x){if(arguments.length!==1)return w=this.root+w,n.call(this,w,k,x),this;if(_(w)){var S=w;return this.filter(function(U,R){return!R.dir&&S.test(U)})}var P=this.files[this.root+w];return P&&!P.dir?P:null},folder:function(w){if(!w)return this;if(_(w))return this.filter(function(P,U){return U.dir&&w.test(P)});var k=this.root+w,x=m.call(this,k),S=this.clone();return S.root=x.name,S},remove:function(w){w=this.root+w;var k=this.files[w];if(k||(w.slice(-1)!=="/"&&(w+="/"),k=this.files[w]),k&&!k.dir)delete this.files[w];else for(var x=this.filter(function(P,U){return U.name.slice(0,w.length)===w}),S=0;S<x.length;S++)delete this.files[x[S].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(w){var k,x={};try{if((x=o.extend(w||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:u.utf8encode})).type=x.type.toLowerCase(),x.compression=x.compression.toUpperCase(),x.type==="binarystring"&&(x.type="string"),!x.type)throw new Error("No output type specified.");o.checkSupport(x.type),x.platform!=="darwin"&&x.platform!=="freebsd"&&x.platform!=="linux"&&x.platform!=="sunos"||(x.platform="UNIX"),x.platform==="win32"&&(x.platform="DOS");var S=x.comment||this.comment||"";k=s.generateWorker(this,x,S)}catch(P){(k=new c("error")).error(P)}return new g(k,x.type||"string",x.mimeType)},generateAsync:function(w,k){return this.generateInternalStream(w).accumulate(k)},generateNodeStream:function(w,k){return(w=w||{}).type||(w.type="nodebuffer"),this.generateInternalStream(w).toNodejsStream(k)}};i.exports=E},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,i,r){i.exports=t("stream")},{stream:void 0}],17:[function(t,i,r){var n=t("./DataReader");function u(o){n.call(this,o);for(var c=0;c<this.data.length;c++)o[c]=255&o[c]}t("../utils").inherits(u,n),u.prototype.byteAt=function(o){return this.data[this.zero+o]},u.prototype.lastIndexOfSignature=function(o){for(var c=o.charCodeAt(0),g=o.charCodeAt(1),v=o.charCodeAt(2),p=o.charCodeAt(3),e=this.length-4;0<=e;--e)if(this.data[e]===c&&this.data[e+1]===g&&this.data[e+2]===v&&this.data[e+3]===p)return e-this.zero;return-1},u.prototype.readAndCheckSignature=function(o){var c=o.charCodeAt(0),g=o.charCodeAt(1),v=o.charCodeAt(2),p=o.charCodeAt(3),e=this.readData(4);return c===e[0]&&g===e[1]&&v===e[2]&&p===e[3]},u.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,c},i.exports=u},{"../utils":32,"./DataReader":18}],18:[function(t,i,r){var n=t("../utils");function u(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}u.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var c,g=0;for(this.checkOffset(o),c=this.index+o-1;c>=this.index;c--)g=(g<<8)+this.byteAt(c);return this.index+=o,g},readString:function(o){return n.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},i.exports=u},{"../utils":32}],19:[function(t,i,r){var n=t("./Uint8ArrayReader");function u(o){n.call(this,o)}t("../utils").inherits(u,n),u.prototype.readData=function(o){this.checkOffset(o);var c=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,c},i.exports=u},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,i,r){var n=t("./DataReader");function u(o){n.call(this,o)}t("../utils").inherits(u,n),u.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},u.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},u.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},u.prototype.readData=function(o){this.checkOffset(o);var c=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,c},i.exports=u},{"../utils":32,"./DataReader":18}],21:[function(t,i,r){var n=t("./ArrayReader");function u(o){n.call(this,o)}t("../utils").inherits(u,n),u.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,c},i.exports=u},{"../utils":32,"./ArrayReader":17}],22:[function(t,i,r){var n=t("../utils"),u=t("../support"),o=t("./ArrayReader"),c=t("./StringReader"),g=t("./NodeBufferReader"),v=t("./Uint8ArrayReader");i.exports=function(p){var e=n.getTypeOf(p);return n.checkSupport(e),e!=="string"||u.uint8array?e==="nodebuffer"?new g(p):u.uint8array?new v(n.transformTo("uint8array",p)):new o(n.transformTo("array",p)):new c(p)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,i,r){r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,i,r){var n=t("./GenericWorker"),u=t("../utils");function o(c){n.call(this,"ConvertWorker to "+c),this.destType=c}u.inherits(o,n),o.prototype.processChunk=function(c){this.push({data:u.transformTo(this.destType,c.data),meta:c.meta})},i.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(t,i,r){var n=t("./GenericWorker"),u=t("../crc32");function o(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(o,n),o.prototype.processChunk=function(c){this.streamInfo.crc32=u(c.data,this.streamInfo.crc32||0),this.push(c)},i.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,i,r){var n=t("../utils"),u=t("./GenericWorker");function o(c){u.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}n.inherits(o,u),o.prototype.processChunk=function(c){if(c){var g=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=g+c.data.length}u.prototype.processChunk.call(this,c)},i.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(t,i,r){var n=t("../utils"),u=t("./GenericWorker");function o(c){u.call(this,"DataWorker");var g=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(v){g.dataIsReady=!0,g.data=v,g.max=v&&v.length||0,g.type=n.getTypeOf(v),g.isPaused||g._tickAndRepeat()},function(v){g.error(v)})}n.inherits(o,u),o.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,g=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,g);break;case"uint8array":c=this.data.subarray(this.index,g);break;case"array":case"nodebuffer":c=this.data.slice(this.index,g)}return this.index=g,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(t,i,r){function n(u){this.name=u||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(u){this.emit("data",u)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(u){this.emit("error",u)}return!0},error:function(u){return!this.isFinished&&(this.isPaused?this.generatedError=u:(this.isFinished=!0,this.emit("error",u),this.previous&&this.previous.error(u),this.cleanUp()),!0)},on:function(u,o){return this._listeners[u].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(u,o){if(this._listeners[u])for(var c=0;c<this._listeners[u].length;c++)this._listeners[u][c].call(this,o)},pipe:function(u){return u.registerPrevious(this)},registerPrevious:function(u){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=u.streamInfo,this.mergeStreamInfo(),this.previous=u;var o=this;return u.on("data",function(c){o.processChunk(c)}),u.on("end",function(){o.end()}),u.on("error",function(c){o.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var u=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),u=!0),this.previous&&this.previous.resume(),!u},flush:function(){},processChunk:function(u){this.push(u)},withStreamInfo:function(u,o){return this.extraStreamInfo[u]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var u in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,u)&&(this.streamInfo[u]=this.extraStreamInfo[u])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var u="Worker "+this.name;return this.previous?this.previous+" -> "+u:u}},i.exports=n},{}],29:[function(t,i,r){var n=t("../utils"),u=t("./ConvertWorker"),o=t("./GenericWorker"),c=t("../base64"),g=t("../support"),v=t("../external"),p=null;if(g.nodestream)try{p=t("../nodejs/NodejsStreamOutputAdapter")}catch(l){}function e(l,f){return new v.Promise(function(d,y){var m=[],_=l._internalType,E=l._outputType,w=l._mimeType;l.on("data",function(k,x){m.push(k),f&&f(x)}).on("error",function(k){m=[],y(k)}).on("end",function(){try{var k=function(x,S,P){switch(x){case"blob":return n.newBlob(n.transformTo("arraybuffer",S),P);case"base64":return c.encode(S);default:return n.transformTo(x,S)}}(E,function(x,S){var P,U=0,R=null,C=0;for(P=0;P<S.length;P++)C+=S[P].length;switch(x){case"string":return S.join("");case"array":return Array.prototype.concat.apply([],S);case"uint8array":for(R=new Uint8Array(C),P=0;P<S.length;P++)R.set(S[P],U),U+=S[P].length;return R;case"nodebuffer":return Buffer.concat(S);default:throw new Error("concat : unsupported type '"+x+"'")}}(_,m),w);d(k)}catch(x){y(x)}m=[]}).resume()})}function s(l,f,d){var y=f;switch(f){case"blob":case"arraybuffer":y="uint8array";break;case"base64":y="string"}try{this._internalType=y,this._outputType=f,this._mimeType=d,n.checkSupport(y),this._worker=l.pipe(new u(y)),l.lock()}catch(m){this._worker=new o("error"),this._worker.error(m)}}s.prototype={accumulate:function(l){return e(this,l)},on:function(l,f){var d=this;return l==="data"?this._worker.on(l,function(y){f.call(d,y.data,y.meta)}):this._worker.on(l,function(){n.delay(f,arguments,d)}),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(l){if(n.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},l)}},i.exports=s},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,i,r){if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",r.nodebuffer=typeof Buffer!="undefined",r.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")r.blob=!1;else{var n=new ArrayBuffer(0);try{r.blob=new Blob([n],{type:"application/zip"}).size===0}catch(o){try{var u=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);u.append(n),r.blob=u.getBlob("application/zip").size===0}catch(c){r.blob=!1}}}try{r.nodestream=!!t("readable-stream").Readable}catch(o){r.nodestream=!1}},{"readable-stream":16}],31:[function(t,i,r){for(var n=t("./utils"),u=t("./support"),o=t("./nodejsUtils"),c=t("./stream/GenericWorker"),g=new Array(256),v=0;v<256;v++)g[v]=252<=v?6:248<=v?5:240<=v?4:224<=v?3:192<=v?2:1;g[254]=g[254]=1;function p(){c.call(this,"utf-8 decode"),this.leftOver=null}function e(){c.call(this,"utf-8 encode")}r.utf8encode=function(s){return u.nodebuffer?o.newBufferFrom(s,"utf-8"):function(l){var f,d,y,m,_,E=l.length,w=0;for(m=0;m<E;m++)(64512&(d=l.charCodeAt(m)))==55296&&m+1<E&&(64512&(y=l.charCodeAt(m+1)))==56320&&(d=65536+(d-55296<<10)+(y-56320),m++),w+=d<128?1:d<2048?2:d<65536?3:4;for(f=u.uint8array?new Uint8Array(w):new Array(w),m=_=0;_<w;m++)(64512&(d=l.charCodeAt(m)))==55296&&m+1<E&&(64512&(y=l.charCodeAt(m+1)))==56320&&(d=65536+(d-55296<<10)+(y-56320),m++),d<128?f[_++]=d:(d<2048?f[_++]=192|d>>>6:(d<65536?f[_++]=224|d>>>12:(f[_++]=240|d>>>18,f[_++]=128|d>>>12&63),f[_++]=128|d>>>6&63),f[_++]=128|63&d);return f}(s)},r.utf8decode=function(s){return u.nodebuffer?n.transformTo("nodebuffer",s).toString("utf-8"):function(l){var f,d,y,m,_=l.length,E=new Array(2*_);for(f=d=0;f<_;)if((y=l[f++])<128)E[d++]=y;else if(4<(m=g[y]))E[d++]=65533,f+=m-1;else{for(y&=m===2?31:m===3?15:7;1<m&&f<_;)y=y<<6|63&l[f++],m--;1<m?E[d++]=65533:y<65536?E[d++]=y:(y-=65536,E[d++]=55296|y>>10&1023,E[d++]=56320|1023&y)}return E.length!==d&&(E.subarray?E=E.subarray(0,d):E.length=d),n.applyFromCharCode(E)}(s=n.transformTo(u.uint8array?"uint8array":"array",s))},n.inherits(p,c),p.prototype.processChunk=function(s){var l=n.transformTo(u.uint8array?"uint8array":"array",s.data);if(this.leftOver&&this.leftOver.length){if(u.uint8array){var f=l;(l=new Uint8Array(f.length+this.leftOver.length)).set(this.leftOver,0),l.set(f,this.leftOver.length)}else l=this.leftOver.concat(l);this.leftOver=null}var d=function(m,_){var E;for((_=_||m.length)>m.length&&(_=m.length),E=_-1;0<=E&&(192&m[E])==128;)E--;return E<0||E===0?_:E+g[m[E]]>_?E:_}(l),y=l;d!==l.length&&(u.uint8array?(y=l.subarray(0,d),this.leftOver=l.subarray(d,l.length)):(y=l.slice(0,d),this.leftOver=l.slice(d,l.length))),this.push({data:r.utf8decode(y),meta:s.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=p,n.inherits(e,c),e.prototype.processChunk=function(s){this.push({data:r.utf8encode(s.data),meta:s.meta})},r.Utf8EncodeWorker=e},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,i,r){var n=t("./support"),u=t("./base64"),o=t("./nodejsUtils"),c=t("./external");function g(f){return f}function v(f,d){for(var y=0;y<f.length;++y)d[y]=255&f.charCodeAt(y);return d}t("setimmediate"),r.newBlob=function(f,d){r.checkSupport("blob");try{return new Blob([f],{type:d})}catch(m){try{var y=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return y.append(f),y.getBlob(d)}catch(_){throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(f,d,y){var m=[],_=0,E=f.length;if(E<=y)return String.fromCharCode.apply(null,f);for(;_<E;)d==="array"||d==="nodebuffer"?m.push(String.fromCharCode.apply(null,f.slice(_,Math.min(_+y,E)))):m.push(String.fromCharCode.apply(null,f.subarray(_,Math.min(_+y,E)))),_+=y;return m.join("")},stringifyByChar:function(f){for(var d="",y=0;y<f.length;y++)d+=String.fromCharCode(f[y]);return d},applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch(f){return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch(f){return!1}}()}};function e(f){var d=65536,y=r.getTypeOf(f),m=!0;if(y==="uint8array"?m=p.applyCanBeUsed.uint8array:y==="nodebuffer"&&(m=p.applyCanBeUsed.nodebuffer),m)for(;1<d;)try{return p.stringifyByChunk(f,y,d)}catch(_){d=Math.floor(d/2)}return p.stringifyByChar(f)}function s(f,d){for(var y=0;y<f.length;y++)d[y]=f[y];return d}r.applyFromCharCode=e;var l={};l.string={string:g,array:function(f){return v(f,new Array(f.length))},arraybuffer:function(f){return l.string.uint8array(f).buffer},uint8array:function(f){return v(f,new Uint8Array(f.length))},nodebuffer:function(f){return v(f,o.allocBuffer(f.length))}},l.array={string:e,array:g,arraybuffer:function(f){return new Uint8Array(f).buffer},uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return o.newBufferFrom(f)}},l.arraybuffer={string:function(f){return e(new Uint8Array(f))},array:function(f){return s(new Uint8Array(f),new Array(f.byteLength))},arraybuffer:g,uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return o.newBufferFrom(new Uint8Array(f))}},l.uint8array={string:e,array:function(f){return s(f,new Array(f.length))},arraybuffer:function(f){return f.buffer},uint8array:g,nodebuffer:function(f){return o.newBufferFrom(f)}},l.nodebuffer={string:e,array:function(f){return s(f,new Array(f.length))},arraybuffer:function(f){return l.nodebuffer.uint8array(f).buffer},uint8array:function(f){return s(f,new Uint8Array(f.length))},nodebuffer:g},r.transformTo=function(f,d){if(d=d||"",!f)return d;r.checkSupport(f);var y=r.getTypeOf(d);return l[y][f](d)},r.resolve=function(f){for(var d=f.split("/"),y=[],m=0;m<d.length;m++){var _=d[m];_==="."||_===""&&m!==0&&m!==d.length-1||(_===".."?y.pop():y.push(_))}return y.join("/")},r.getTypeOf=function(f){return typeof f=="string"?"string":Object.prototype.toString.call(f)==="[object Array]"?"array":n.nodebuffer&&o.isBuffer(f)?"nodebuffer":n.uint8array&&f instanceof Uint8Array?"uint8array":n.arraybuffer&&f instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(f){if(!n[f.toLowerCase()])throw new Error(f+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(f){var d,y,m="";for(y=0;y<(f||"").length;y++)m+="\\x"+((d=f.charCodeAt(y))<16?"0":"")+d.toString(16).toUpperCase();return m},r.delay=function(f,d,y){setImmediate(function(){f.apply(y||null,d||[])})},r.inherits=function(f,d){function y(){}y.prototype=d.prototype,f.prototype=new y},r.extend=function(){var f,d,y={};for(f=0;f<arguments.length;f++)for(d in arguments[f])Object.prototype.hasOwnProperty.call(arguments[f],d)&&y[d]===void 0&&(y[d]=arguments[f][d]);return y},r.prepareContent=function(f,d,y,m,_){return c.Promise.resolve(d).then(function(E){return n.blob&&(E instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(E))!==-1)&&typeof FileReader!="undefined"?new c.Promise(function(w,k){var x=new FileReader;x.onload=function(S){w(S.target.result)},x.onerror=function(S){k(S.target.error)},x.readAsArrayBuffer(E)}):E}).then(function(E){var w=r.getTypeOf(E);return w?(w==="arraybuffer"?E=r.transformTo("uint8array",E):w==="string"&&(_?E=u.decode(E):y&&m!==!0&&(E=function(k){return v(k,n.uint8array?new Uint8Array(k.length):new Array(k.length))}(E))),E):c.Promise.reject(new Error("Can't read the data of '"+f+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,i,r){var n=t("./reader/readerFor"),u=t("./utils"),o=t("./signature"),c=t("./zipEntry"),g=t("./support");function v(p){this.files=[],this.loadOptions=p}v.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var e=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+u.pretty(e)+", expected "+u.pretty(p)+")")}},isSignature:function(p,e){var s=this.reader.index;this.reader.setIndex(p);var l=this.reader.readString(4)===e;return this.reader.setIndex(s),l},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),e=g.uint8array?"uint8array":"array",s=u.transformTo(e,p);this.zipComment=this.loadOptions.decodeFileName(s)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p,e,s,l=this.zip64EndOfCentralSize-44;0<l;)p=this.reader.readInt(2),e=this.reader.readInt(4),s=this.reader.readData(e),this.zip64ExtensibleData[p]={id:p,length:e,value:s}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,e;for(p=0;p<this.files.length;p++)e=this.files[p],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(p=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(p<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(p);var e=p;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===u.MAX_VALUE_16BITS||this.diskWithCentralDirStart===u.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===u.MAX_VALUE_16BITS||this.centralDirRecords===u.MAX_VALUE_16BITS||this.centralDirSize===u.MAX_VALUE_32BITS||this.centralDirOffset===u.MAX_VALUE_32BITS){if(this.zip64=!0,(p=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var s=this.centralDirOffset+this.centralDirSize;this.zip64&&(s+=20,s+=12+this.zip64EndOfCentralSize);var l=e-s;if(0<l)this.isSignature(e,o.CENTRAL_FILE_HEADER)||(this.reader.zero=l);else if(l<0)throw new Error("Corrupted zip: missing "+Math.abs(l)+" bytes.")},prepareReader:function(p){this.reader=n(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=v},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,i,r){var n=t("./reader/readerFor"),u=t("./utils"),o=t("./compressedObject"),c=t("./crc32"),g=t("./utf8"),v=t("./compressions"),p=t("./support");function e(s,l){this.options=s,this.loadOptions=l}e.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(s){var l,f;if(s.skip(22),this.fileNameLength=s.readInt(2),f=s.readInt(2),this.fileName=s.readData(this.fileNameLength),s.skip(f),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((l=function(d){for(var y in v)if(Object.prototype.hasOwnProperty.call(v,y)&&v[y].magic===d)return v[y];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+u.pretty(this.compressionMethod)+" unknown (inner file : "+u.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,l,s.readData(this.compressedSize))},readCentralPart:function(s){this.versionMadeBy=s.readInt(2),s.skip(2),this.bitFlag=s.readInt(2),this.compressionMethod=s.readString(2),this.date=s.readDate(),this.crc32=s.readInt(4),this.compressedSize=s.readInt(4),this.uncompressedSize=s.readInt(4);var l=s.readInt(2);if(this.extraFieldsLength=s.readInt(2),this.fileCommentLength=s.readInt(2),this.diskNumberStart=s.readInt(2),this.internalFileAttributes=s.readInt(2),this.externalFileAttributes=s.readInt(4),this.localHeaderOffset=s.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");s.skip(l),this.readExtraFields(s),this.parseZIP64ExtraField(s),this.fileComment=s.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var s=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),s==0&&(this.dosPermissions=63&this.externalFileAttributes),s==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var s=n(this.extraFields[1].value);this.uncompressedSize===u.MAX_VALUE_32BITS&&(this.uncompressedSize=s.readInt(8)),this.compressedSize===u.MAX_VALUE_32BITS&&(this.compressedSize=s.readInt(8)),this.localHeaderOffset===u.MAX_VALUE_32BITS&&(this.localHeaderOffset=s.readInt(8)),this.diskNumberStart===u.MAX_VALUE_32BITS&&(this.diskNumberStart=s.readInt(4))}},readExtraFields:function(s){var l,f,d,y=s.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});s.index+4<y;)l=s.readInt(2),f=s.readInt(2),d=s.readData(f),this.extraFields[l]={id:l,length:f,value:d};s.setIndex(y)},handleUTF8:function(){var s=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=g.utf8decode(this.fileName),this.fileCommentStr=g.utf8decode(this.fileComment);else{var l=this.findExtraFieldUnicodePath();if(l!==null)this.fileNameStr=l;else{var f=u.transformTo(s,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(f)}var d=this.findExtraFieldUnicodeComment();if(d!==null)this.fileCommentStr=d;else{var y=u.transformTo(s,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(y)}}},findExtraFieldUnicodePath:function(){var s=this.extraFields[28789];if(s){var l=n(s.value);return l.readInt(1)!==1||c(this.fileName)!==l.readInt(4)?null:g.utf8decode(l.readData(s.length-5))}return null},findExtraFieldUnicodeComment:function(){var s=this.extraFields[25461];if(s){var l=n(s.value);return l.readInt(1)!==1||c(this.fileComment)!==l.readInt(4)?null:g.utf8decode(l.readData(s.length-5))}return null}},i.exports=e},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,i,r){function n(l,f,d){this.name=l,this.dir=d.dir,this.date=d.date,this.comment=d.comment,this.unixPermissions=d.unixPermissions,this.dosPermissions=d.dosPermissions,this._data=f,this._dataBinary=d.binary,this.options={compression:d.compression,compressionOptions:d.compressionOptions}}var u=t("./stream/StreamHelper"),o=t("./stream/DataWorker"),c=t("./utf8"),g=t("./compressedObject"),v=t("./stream/GenericWorker");n.prototype={internalStream:function(l){var f=null,d="string";try{if(!l)throw new Error("No output type specified.");var y=(d=l.toLowerCase())==="string"||d==="text";d!=="binarystring"&&d!=="text"||(d="string"),f=this._decompressWorker();var m=!this._dataBinary;m&&!y&&(f=f.pipe(new c.Utf8EncodeWorker)),!m&&y&&(f=f.pipe(new c.Utf8DecodeWorker))}catch(_){(f=new v("error")).error(_)}return new u(f,d,"")},async:function(l,f){return this.internalStream(l).accumulate(f)},nodeStream:function(l,f){return this.internalStream(l||"nodebuffer").toNodejsStream(f)},_compressWorker:function(l,f){if(this._data instanceof g&&this._data.compression.magic===l.magic)return this._data.getCompressedWorker();var d=this._decompressWorker();return this._dataBinary||(d=d.pipe(new c.Utf8EncodeWorker)),g.createWorkerFrom(d,l,f)},_decompressWorker:function(){return this._data instanceof g?this._data.getContentWorker():this._data instanceof v?this._data:new o(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],e=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},s=0;s<p.length;s++)n.prototype[p[s]]=e;i.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,i,r){(function(n){var u,o,c=n.MutationObserver||n.WebKitMutationObserver;if(c){var g=0,v=new c(l),p=n.document.createTextNode("");v.observe(p,{characterData:!0}),u=function(){p.data=g=++g%2}}else if(n.setImmediate||n.MessageChannel===void 0)u="document"in n&&"onreadystatechange"in n.document.createElement("script")?function(){var f=n.document.createElement("script");f.onreadystatechange=function(){l(),f.onreadystatechange=null,f.parentNode.removeChild(f),f=null},n.document.documentElement.appendChild(f)}:function(){setTimeout(l,0)};else{var e=new n.MessageChannel;e.port1.onmessage=l,u=function(){e.port2.postMessage(0)}}var s=[];function l(){var f,d;o=!0;for(var y=s.length;y;){for(d=s,s=[],f=-1;++f<y;)d[f]();y=s.length}o=!1}i.exports=function(f){s.push(f)!==1||o||u()}}).call(this,typeof pn!="undefined"?pn:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],37:[function(t,i,r){var n=t("immediate");function u(){}var o={},c=["REJECTED"],g=["FULFILLED"],v=["PENDING"];function p(y){if(typeof y!="function")throw new TypeError("resolver must be a function");this.state=v,this.queue=[],this.outcome=void 0,y!==u&&f(this,y)}function e(y,m,_){this.promise=y,typeof m=="function"&&(this.onFulfilled=m,this.callFulfilled=this.otherCallFulfilled),typeof _=="function"&&(this.onRejected=_,this.callRejected=this.otherCallRejected)}function s(y,m,_){n(function(){var E;try{E=m(_)}catch(w){return o.reject(y,w)}E===y?o.reject(y,new TypeError("Cannot resolve promise with itself")):o.resolve(y,E)})}function l(y){var m=y&&y.then;if(y&&(typeof y=="object"||typeof y=="function")&&typeof m=="function")return function(){m.apply(y,arguments)}}function f(y,m){var _=!1;function E(x){_||(_=!0,o.reject(y,x))}function w(x){_||(_=!0,o.resolve(y,x))}var k=d(function(){m(w,E)});k.status==="error"&&E(k.value)}function d(y,m){var _={};try{_.value=y(m),_.status="success"}catch(E){_.status="error",_.value=E}return _}(i.exports=p).prototype.finally=function(y){if(typeof y!="function")return this;var m=this.constructor;return this.then(function(_){return m.resolve(y()).then(function(){return _})},function(_){return m.resolve(y()).then(function(){throw _})})},p.prototype.catch=function(y){return this.then(null,y)},p.prototype.then=function(y,m){if(typeof y!="function"&&this.state===g||typeof m!="function"&&this.state===c)return this;var _=new this.constructor(u);return this.state!==v?s(_,this.state===g?y:m,this.outcome):this.queue.push(new e(_,y,m)),_},e.prototype.callFulfilled=function(y){o.resolve(this.promise,y)},e.prototype.otherCallFulfilled=function(y){s(this.promise,this.onFulfilled,y)},e.prototype.callRejected=function(y){o.reject(this.promise,y)},e.prototype.otherCallRejected=function(y){s(this.promise,this.onRejected,y)},o.resolve=function(y,m){var _=d(l,m);if(_.status==="error")return o.reject(y,_.value);var E=_.value;if(E)f(y,E);else{y.state=g,y.outcome=m;for(var w=-1,k=y.queue.length;++w<k;)y.queue[w].callFulfilled(m)}return y},o.reject=function(y,m){y.state=c,y.outcome=m;for(var _=-1,E=y.queue.length;++_<E;)y.queue[_].callRejected(m);return y},p.resolve=function(y){return y instanceof this?y:o.resolve(new this(u),y)},p.reject=function(y){var m=new this(u);return o.reject(m,y)},p.all=function(y){var m=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=y.length,E=!1;if(!_)return this.resolve([]);for(var w=new Array(_),k=0,x=-1,S=new this(u);++x<_;)P(y[x],x);return S;function P(U,R){m.resolve(U).then(function(C){w[R]=C,++k!==_||E||(E=!0,o.resolve(S,w))},function(C){E||(E=!0,o.reject(S,C))})}},p.race=function(y){var m=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=y.length,E=!1;if(!_)return this.resolve([]);for(var w=-1,k=new this(u);++w<_;)x=y[w],m.resolve(x).then(function(S){E||(E=!0,o.resolve(k,S))},function(S){E||(E=!0,o.reject(k,S))});var x;return k}},{immediate:36}],38:[function(t,i,r){var n={};(0,t("./lib/utils/common").assign)(n,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),i.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,i,r){var n=t("./zlib/deflate"),u=t("./utils/common"),o=t("./utils/strings"),c=t("./zlib/messages"),g=t("./zlib/zstream"),v=Object.prototype.toString,p=0,e=-1,s=0,l=8;function f(y){if(!(this instanceof f))return new f(y);this.options=u.assign({level:e,method:l,chunkSize:16384,windowBits:15,memLevel:8,strategy:s,to:""},y||{});var m=this.options;m.raw&&0<m.windowBits?m.windowBits=-m.windowBits:m.gzip&&0<m.windowBits&&m.windowBits<16&&(m.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new g,this.strm.avail_out=0;var _=n.deflateInit2(this.strm,m.level,m.method,m.windowBits,m.memLevel,m.strategy);if(_!==p)throw new Error(c[_]);if(m.header&&n.deflateSetHeader(this.strm,m.header),m.dictionary){var E;if(E=typeof m.dictionary=="string"?o.string2buf(m.dictionary):v.call(m.dictionary)==="[object ArrayBuffer]"?new Uint8Array(m.dictionary):m.dictionary,(_=n.deflateSetDictionary(this.strm,E))!==p)throw new Error(c[_]);this._dict_set=!0}}function d(y,m){var _=new f(m);if(_.push(y,!0),_.err)throw _.msg||c[_.err];return _.result}f.prototype.push=function(y,m){var _,E,w=this.strm,k=this.options.chunkSize;if(this.ended)return!1;E=m===~~m?m:m===!0?4:0,typeof y=="string"?w.input=o.string2buf(y):v.call(y)==="[object ArrayBuffer]"?w.input=new Uint8Array(y):w.input=y,w.next_in=0,w.avail_in=w.input.length;do{if(w.avail_out===0&&(w.output=new u.Buf8(k),w.next_out=0,w.avail_out=k),(_=n.deflate(w,E))!==1&&_!==p)return this.onEnd(_),!(this.ended=!0);w.avail_out!==0&&(w.avail_in!==0||E!==4&&E!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(u.shrinkBuf(w.output,w.next_out))):this.onData(u.shrinkBuf(w.output,w.next_out)))}while((0<w.avail_in||w.avail_out===0)&&_!==1);return E===4?(_=n.deflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===p):E!==2||(this.onEnd(p),!(w.avail_out=0))},f.prototype.onData=function(y){this.chunks.push(y)},f.prototype.onEnd=function(y){y===p&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=u.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg},r.Deflate=f,r.deflate=d,r.deflateRaw=function(y,m){return(m=m||{}).raw=!0,d(y,m)},r.gzip=function(y,m){return(m=m||{}).gzip=!0,d(y,m)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,i,r){var n=t("./zlib/inflate"),u=t("./utils/common"),o=t("./utils/strings"),c=t("./zlib/constants"),g=t("./zlib/messages"),v=t("./zlib/zstream"),p=t("./zlib/gzheader"),e=Object.prototype.toString;function s(f){if(!(this instanceof s))return new s(f);this.options=u.assign({chunkSize:16384,windowBits:0,to:""},f||{});var d=this.options;d.raw&&0<=d.windowBits&&d.windowBits<16&&(d.windowBits=-d.windowBits,d.windowBits===0&&(d.windowBits=-15)),!(0<=d.windowBits&&d.windowBits<16)||f&&f.windowBits||(d.windowBits+=32),15<d.windowBits&&d.windowBits<48&&(15&d.windowBits)==0&&(d.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new v,this.strm.avail_out=0;var y=n.inflateInit2(this.strm,d.windowBits);if(y!==c.Z_OK)throw new Error(g[y]);this.header=new p,n.inflateGetHeader(this.strm,this.header)}function l(f,d){var y=new s(d);if(y.push(f,!0),y.err)throw y.msg||g[y.err];return y.result}s.prototype.push=function(f,d){var y,m,_,E,w,k,x=this.strm,S=this.options.chunkSize,P=this.options.dictionary,U=!1;if(this.ended)return!1;m=d===~~d?d:d===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof f=="string"?x.input=o.binstring2buf(f):e.call(f)==="[object ArrayBuffer]"?x.input=new Uint8Array(f):x.input=f,x.next_in=0,x.avail_in=x.input.length;do{if(x.avail_out===0&&(x.output=new u.Buf8(S),x.next_out=0,x.avail_out=S),(y=n.inflate(x,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&P&&(k=typeof P=="string"?o.string2buf(P):e.call(P)==="[object ArrayBuffer]"?new Uint8Array(P):P,y=n.inflateSetDictionary(this.strm,k)),y===c.Z_BUF_ERROR&&U===!0&&(y=c.Z_OK,U=!1),y!==c.Z_STREAM_END&&y!==c.Z_OK)return this.onEnd(y),!(this.ended=!0);x.next_out&&(x.avail_out!==0&&y!==c.Z_STREAM_END&&(x.avail_in!==0||m!==c.Z_FINISH&&m!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(_=o.utf8border(x.output,x.next_out),E=x.next_out-_,w=o.buf2string(x.output,_),x.next_out=E,x.avail_out=S-E,E&&u.arraySet(x.output,x.output,_,E,0),this.onData(w)):this.onData(u.shrinkBuf(x.output,x.next_out)))),x.avail_in===0&&x.avail_out===0&&(U=!0)}while((0<x.avail_in||x.avail_out===0)&&y!==c.Z_STREAM_END);return y===c.Z_STREAM_END&&(m=c.Z_FINISH),m===c.Z_FINISH?(y=n.inflateEnd(this.strm),this.onEnd(y),this.ended=!0,y===c.Z_OK):m!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(x.avail_out=0))},s.prototype.onData=function(f){this.chunks.push(f)},s.prototype.onEnd=function(f){f===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=u.flattenChunks(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg},r.Inflate=s,r.inflate=l,r.inflateRaw=function(f,d){return(d=d||{}).raw=!0,l(f,d)},r.ungzip=l},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,i,r){var n=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";r.assign=function(c){for(var g=Array.prototype.slice.call(arguments,1);g.length;){var v=g.shift();if(v){if(typeof v!="object")throw new TypeError(v+"must be non-object");for(var p in v)v.hasOwnProperty(p)&&(c[p]=v[p])}}return c},r.shrinkBuf=function(c,g){return c.length===g?c:c.subarray?c.subarray(0,g):(c.length=g,c)};var u={arraySet:function(c,g,v,p,e){if(g.subarray&&c.subarray)c.set(g.subarray(v,v+p),e);else for(var s=0;s<p;s++)c[e+s]=g[v+s]},flattenChunks:function(c){var g,v,p,e,s,l;for(g=p=0,v=c.length;g<v;g++)p+=c[g].length;for(l=new Uint8Array(p),g=e=0,v=c.length;g<v;g++)s=c[g],l.set(s,e),e+=s.length;return l}},o={arraySet:function(c,g,v,p,e){for(var s=0;s<p;s++)c[e+s]=g[v+s]},flattenChunks:function(c){return[].concat.apply([],c)}};r.setTyped=function(c){c?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,u)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,o))},r.setTyped(n)},{}],42:[function(t,i,r){var n=t("./common"),u=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(p){u=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(p){o=!1}for(var c=new n.Buf8(256),g=0;g<256;g++)c[g]=252<=g?6:248<=g?5:240<=g?4:224<=g?3:192<=g?2:1;function v(p,e){if(e<65537&&(p.subarray&&o||!p.subarray&&u))return String.fromCharCode.apply(null,n.shrinkBuf(p,e));for(var s="",l=0;l<e;l++)s+=String.fromCharCode(p[l]);return s}c[254]=c[254]=1,r.string2buf=function(p){var e,s,l,f,d,y=p.length,m=0;for(f=0;f<y;f++)(64512&(s=p.charCodeAt(f)))==55296&&f+1<y&&(64512&(l=p.charCodeAt(f+1)))==56320&&(s=65536+(s-55296<<10)+(l-56320),f++),m+=s<128?1:s<2048?2:s<65536?3:4;for(e=new n.Buf8(m),f=d=0;d<m;f++)(64512&(s=p.charCodeAt(f)))==55296&&f+1<y&&(64512&(l=p.charCodeAt(f+1)))==56320&&(s=65536+(s-55296<<10)+(l-56320),f++),s<128?e[d++]=s:(s<2048?e[d++]=192|s>>>6:(s<65536?e[d++]=224|s>>>12:(e[d++]=240|s>>>18,e[d++]=128|s>>>12&63),e[d++]=128|s>>>6&63),e[d++]=128|63&s);return e},r.buf2binstring=function(p){return v(p,p.length)},r.binstring2buf=function(p){for(var e=new n.Buf8(p.length),s=0,l=e.length;s<l;s++)e[s]=p.charCodeAt(s);return e},r.buf2string=function(p,e){var s,l,f,d,y=e||p.length,m=new Array(2*y);for(s=l=0;s<y;)if((f=p[s++])<128)m[l++]=f;else if(4<(d=c[f]))m[l++]=65533,s+=d-1;else{for(f&=d===2?31:d===3?15:7;1<d&&s<y;)f=f<<6|63&p[s++],d--;1<d?m[l++]=65533:f<65536?m[l++]=f:(f-=65536,m[l++]=55296|f>>10&1023,m[l++]=56320|1023&f)}return v(m,l)},r.utf8border=function(p,e){var s;for((e=e||p.length)>p.length&&(e=p.length),s=e-1;0<=s&&(192&p[s])==128;)s--;return s<0||s===0?e:s+c[p[s]]>e?s:e}},{"./common":41}],43:[function(t,i,r){i.exports=function(n,u,o,c){for(var g=65535&n|0,v=n>>>16&65535|0,p=0;o!==0;){for(o-=p=2e3<o?2e3:o;v=v+(g=g+u[c++]|0)|0,--p;);g%=65521,v%=65521}return g|v<<16|0}},{}],44:[function(t,i,r){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,i,r){var n=function(){for(var u,o=[],c=0;c<256;c++){u=c;for(var g=0;g<8;g++)u=1&u?3988292384^u>>>1:u>>>1;o[c]=u}return o}();i.exports=function(u,o,c,g){var v=n,p=g+c;u^=-1;for(var e=g;e<p;e++)u=u>>>8^v[255&(u^o[e])];return-1^u}},{}],46:[function(t,i,r){var n,u=t("../utils/common"),o=t("./trees"),c=t("./adler32"),g=t("./crc32"),v=t("./messages"),p=0,e=4,s=0,l=-2,f=-1,d=4,y=2,m=8,_=9,E=286,w=30,k=19,x=2*E+1,S=15,P=3,U=258,R=U+P+1,C=42,A=113,b=1,O=2,W=3,K=4;function G(D,fe){return D.msg=v[fe],fe}function B(D){return(D<<1)-(4<D?9:0)}function j(D){for(var fe=D.length;0<=--fe;)D[fe]=0}function z(D){var fe=D.state,ae=fe.pending;ae>D.avail_out&&(ae=D.avail_out),ae!==0&&(u.arraySet(D.output,fe.pending_buf,fe.pending_out,ae,D.next_out),D.next_out+=ae,fe.pending_out+=ae,D.total_out+=ae,D.avail_out-=ae,fe.pending-=ae,fe.pending===0&&(fe.pending_out=0))}function $(D,fe){o._tr_flush_block(D,0<=D.block_start?D.block_start:-1,D.strstart-D.block_start,fe),D.block_start=D.strstart,z(D.strm)}function J(D,fe){D.pending_buf[D.pending++]=fe}function Q(D,fe){D.pending_buf[D.pending++]=fe>>>8&255,D.pending_buf[D.pending++]=255&fe}function ne(D,fe){var ae,X,H=D.max_chain_length,q=D.strstart,ce=D.prev_length,he=D.nice_match,te=D.strstart>D.w_size-R?D.strstart-(D.w_size-R):0,Te=D.window,Le=D.w_mask,Se=D.prev,ze=D.strstart+U,Xe=Te[q+ce-1],it=Te[q+ce];D.prev_length>=D.good_match&&(H>>=2),he>D.lookahead&&(he=D.lookahead);do if(Te[(ae=fe)+ce]===it&&Te[ae+ce-1]===Xe&&Te[ae]===Te[q]&&Te[++ae]===Te[q+1]){q+=2,ae++;do;while(Te[++q]===Te[++ae]&&Te[++q]===Te[++ae]&&Te[++q]===Te[++ae]&&Te[++q]===Te[++ae]&&Te[++q]===Te[++ae]&&Te[++q]===Te[++ae]&&Te[++q]===Te[++ae]&&Te[++q]===Te[++ae]&&q<ze);if(X=U-(ze-q),q=ze-U,ce<X){if(D.match_start=fe,he<=(ce=X))break;Xe=Te[q+ce-1],it=Te[q+ce]}}while((fe=Se[fe&Le])>te&&--H!=0);return ce<=D.lookahead?ce:D.lookahead}function Ee(D){var fe,ae,X,H,q,ce,he,te,Te,Le,Se=D.w_size;do{if(H=D.window_size-D.lookahead-D.strstart,D.strstart>=Se+(Se-R)){for(u.arraySet(D.window,D.window,Se,Se,0),D.match_start-=Se,D.strstart-=Se,D.block_start-=Se,fe=ae=D.hash_size;X=D.head[--fe],D.head[fe]=Se<=X?X-Se:0,--ae;);for(fe=ae=Se;X=D.prev[--fe],D.prev[fe]=Se<=X?X-Se:0,--ae;);H+=Se}if(D.strm.avail_in===0)break;if(ce=D.strm,he=D.window,te=D.strstart+D.lookahead,Te=H,Le=void 0,Le=ce.avail_in,Te<Le&&(Le=Te),ae=Le===0?0:(ce.avail_in-=Le,u.arraySet(he,ce.input,ce.next_in,Le,te),ce.state.wrap===1?ce.adler=c(ce.adler,he,Le,te):ce.state.wrap===2&&(ce.adler=g(ce.adler,he,Le,te)),ce.next_in+=Le,ce.total_in+=Le,Le),D.lookahead+=ae,D.lookahead+D.insert>=P)for(q=D.strstart-D.insert,D.ins_h=D.window[q],D.ins_h=(D.ins_h<<D.hash_shift^D.window[q+1])&D.hash_mask;D.insert&&(D.ins_h=(D.ins_h<<D.hash_shift^D.window[q+P-1])&D.hash_mask,D.prev[q&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=q,q++,D.insert--,!(D.lookahead+D.insert<P)););}while(D.lookahead<R&&D.strm.avail_in!==0)}function we(D,fe){for(var ae,X;;){if(D.lookahead<R){if(Ee(D),D.lookahead<R&&fe===p)return b;if(D.lookahead===0)break}if(ae=0,D.lookahead>=P&&(D.ins_h=(D.ins_h<<D.hash_shift^D.window[D.strstart+P-1])&D.hash_mask,ae=D.prev[D.strstart&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=D.strstart),ae!==0&&D.strstart-ae<=D.w_size-R&&(D.match_length=ne(D,ae)),D.match_length>=P)if(X=o._tr_tally(D,D.strstart-D.match_start,D.match_length-P),D.lookahead-=D.match_length,D.match_length<=D.max_lazy_match&&D.lookahead>=P){for(D.match_length--;D.strstart++,D.ins_h=(D.ins_h<<D.hash_shift^D.window[D.strstart+P-1])&D.hash_mask,ae=D.prev[D.strstart&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=D.strstart,--D.match_length!=0;);D.strstart++}else D.strstart+=D.match_length,D.match_length=0,D.ins_h=D.window[D.strstart],D.ins_h=(D.ins_h<<D.hash_shift^D.window[D.strstart+1])&D.hash_mask;else X=o._tr_tally(D,0,D.window[D.strstart]),D.lookahead--,D.strstart++;if(X&&($(D,!1),D.strm.avail_out===0))return b}return D.insert=D.strstart<P-1?D.strstart:P-1,fe===e?($(D,!0),D.strm.avail_out===0?W:K):D.last_lit&&($(D,!1),D.strm.avail_out===0)?b:O}function Ae(D,fe){for(var ae,X,H;;){if(D.lookahead<R){if(Ee(D),D.lookahead<R&&fe===p)return b;if(D.lookahead===0)break}if(ae=0,D.lookahead>=P&&(D.ins_h=(D.ins_h<<D.hash_shift^D.window[D.strstart+P-1])&D.hash_mask,ae=D.prev[D.strstart&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=D.strstart),D.prev_length=D.match_length,D.prev_match=D.match_start,D.match_length=P-1,ae!==0&&D.prev_length<D.max_lazy_match&&D.strstart-ae<=D.w_size-R&&(D.match_length=ne(D,ae),D.match_length<=5&&(D.strategy===1||D.match_length===P&&4096<D.strstart-D.match_start)&&(D.match_length=P-1)),D.prev_length>=P&&D.match_length<=D.prev_length){for(H=D.strstart+D.lookahead-P,X=o._tr_tally(D,D.strstart-1-D.prev_match,D.prev_length-P),D.lookahead-=D.prev_length-1,D.prev_length-=2;++D.strstart<=H&&(D.ins_h=(D.ins_h<<D.hash_shift^D.window[D.strstart+P-1])&D.hash_mask,ae=D.prev[D.strstart&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=D.strstart),--D.prev_length!=0;);if(D.match_available=0,D.match_length=P-1,D.strstart++,X&&($(D,!1),D.strm.avail_out===0))return b}else if(D.match_available){if((X=o._tr_tally(D,0,D.window[D.strstart-1]))&&$(D,!1),D.strstart++,D.lookahead--,D.strm.avail_out===0)return b}else D.match_available=1,D.strstart++,D.lookahead--}return D.match_available&&(X=o._tr_tally(D,0,D.window[D.strstart-1]),D.match_available=0),D.insert=D.strstart<P-1?D.strstart:P-1,fe===e?($(D,!0),D.strm.avail_out===0?W:K):D.last_lit&&($(D,!1),D.strm.avail_out===0)?b:O}function De(D,fe,ae,X,H){this.good_length=D,this.max_lazy=fe,this.nice_length=ae,this.max_chain=X,this.func=H}function Ve(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=m,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new u.Buf16(2*x),this.dyn_dtree=new u.Buf16(2*(2*w+1)),this.bl_tree=new u.Buf16(2*(2*k+1)),j(this.dyn_ltree),j(this.dyn_dtree),j(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new u.Buf16(S+1),this.heap=new u.Buf16(2*E+1),j(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new u.Buf16(2*E+1),j(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ce(D){var fe;return D&&D.state?(D.total_in=D.total_out=0,D.data_type=y,(fe=D.state).pending=0,fe.pending_out=0,fe.wrap<0&&(fe.wrap=-fe.wrap),fe.status=fe.wrap?C:A,D.adler=fe.wrap===2?0:1,fe.last_flush=p,o._tr_init(fe),s):G(D,l)}function Me(D){var fe=Ce(D);return fe===s&&function(ae){ae.window_size=2*ae.w_size,j(ae.head),ae.max_lazy_match=n[ae.level].max_lazy,ae.good_match=n[ae.level].good_length,ae.nice_match=n[ae.level].nice_length,ae.max_chain_length=n[ae.level].max_chain,ae.strstart=0,ae.block_start=0,ae.lookahead=0,ae.insert=0,ae.match_length=ae.prev_length=P-1,ae.match_available=0,ae.ins_h=0}(D.state),fe}function Ge(D,fe,ae,X,H,q){if(!D)return l;var ce=1;if(fe===f&&(fe=6),X<0?(ce=0,X=-X):15<X&&(ce=2,X-=16),H<1||_<H||ae!==m||X<8||15<X||fe<0||9<fe||q<0||d<q)return G(D,l);X===8&&(X=9);var he=new Ve;return(D.state=he).strm=D,he.wrap=ce,he.gzhead=null,he.w_bits=X,he.w_size=1<<he.w_bits,he.w_mask=he.w_size-1,he.hash_bits=H+7,he.hash_size=1<<he.hash_bits,he.hash_mask=he.hash_size-1,he.hash_shift=~~((he.hash_bits+P-1)/P),he.window=new u.Buf8(2*he.w_size),he.head=new u.Buf16(he.hash_size),he.prev=new u.Buf16(he.w_size),he.lit_bufsize=1<<H+6,he.pending_buf_size=4*he.lit_bufsize,he.pending_buf=new u.Buf8(he.pending_buf_size),he.d_buf=1*he.lit_bufsize,he.l_buf=3*he.lit_bufsize,he.level=fe,he.strategy=q,he.method=ae,Me(D)}n=[new De(0,0,0,0,function(D,fe){var ae=65535;for(ae>D.pending_buf_size-5&&(ae=D.pending_buf_size-5);;){if(D.lookahead<=1){if(Ee(D),D.lookahead===0&&fe===p)return b;if(D.lookahead===0)break}D.strstart+=D.lookahead,D.lookahead=0;var X=D.block_start+ae;if((D.strstart===0||D.strstart>=X)&&(D.lookahead=D.strstart-X,D.strstart=X,$(D,!1),D.strm.avail_out===0)||D.strstart-D.block_start>=D.w_size-R&&($(D,!1),D.strm.avail_out===0))return b}return D.insert=0,fe===e?($(D,!0),D.strm.avail_out===0?W:K):(D.strstart>D.block_start&&($(D,!1),D.strm.avail_out),b)}),new De(4,4,8,4,we),new De(4,5,16,8,we),new De(4,6,32,32,we),new De(4,4,16,16,Ae),new De(8,16,32,32,Ae),new De(8,16,128,128,Ae),new De(8,32,128,256,Ae),new De(32,128,258,1024,Ae),new De(32,258,258,4096,Ae)],r.deflateInit=function(D,fe){return Ge(D,fe,m,15,8,0)},r.deflateInit2=Ge,r.deflateReset=Me,r.deflateResetKeep=Ce,r.deflateSetHeader=function(D,fe){return D&&D.state?D.state.wrap!==2?l:(D.state.gzhead=fe,s):l},r.deflate=function(D,fe){var ae,X,H,q;if(!D||!D.state||5<fe||fe<0)return D?G(D,l):l;if(X=D.state,!D.output||!D.input&&D.avail_in!==0||X.status===666&&fe!==e)return G(D,D.avail_out===0?-5:l);if(X.strm=D,ae=X.last_flush,X.last_flush=fe,X.status===C)if(X.wrap===2)D.adler=0,J(X,31),J(X,139),J(X,8),X.gzhead?(J(X,(X.gzhead.text?1:0)+(X.gzhead.hcrc?2:0)+(X.gzhead.extra?4:0)+(X.gzhead.name?8:0)+(X.gzhead.comment?16:0)),J(X,255&X.gzhead.time),J(X,X.gzhead.time>>8&255),J(X,X.gzhead.time>>16&255),J(X,X.gzhead.time>>24&255),J(X,X.level===9?2:2<=X.strategy||X.level<2?4:0),J(X,255&X.gzhead.os),X.gzhead.extra&&X.gzhead.extra.length&&(J(X,255&X.gzhead.extra.length),J(X,X.gzhead.extra.length>>8&255)),X.gzhead.hcrc&&(D.adler=g(D.adler,X.pending_buf,X.pending,0)),X.gzindex=0,X.status=69):(J(X,0),J(X,0),J(X,0),J(X,0),J(X,0),J(X,X.level===9?2:2<=X.strategy||X.level<2?4:0),J(X,3),X.status=A);else{var ce=m+(X.w_bits-8<<4)<<8;ce|=(2<=X.strategy||X.level<2?0:X.level<6?1:X.level===6?2:3)<<6,X.strstart!==0&&(ce|=32),ce+=31-ce%31,X.status=A,Q(X,ce),X.strstart!==0&&(Q(X,D.adler>>>16),Q(X,65535&D.adler)),D.adler=1}if(X.status===69)if(X.gzhead.extra){for(H=X.pending;X.gzindex<(65535&X.gzhead.extra.length)&&(X.pending!==X.pending_buf_size||(X.gzhead.hcrc&&X.pending>H&&(D.adler=g(D.adler,X.pending_buf,X.pending-H,H)),z(D),H=X.pending,X.pending!==X.pending_buf_size));)J(X,255&X.gzhead.extra[X.gzindex]),X.gzindex++;X.gzhead.hcrc&&X.pending>H&&(D.adler=g(D.adler,X.pending_buf,X.pending-H,H)),X.gzindex===X.gzhead.extra.length&&(X.gzindex=0,X.status=73)}else X.status=73;if(X.status===73)if(X.gzhead.name){H=X.pending;do{if(X.pending===X.pending_buf_size&&(X.gzhead.hcrc&&X.pending>H&&(D.adler=g(D.adler,X.pending_buf,X.pending-H,H)),z(D),H=X.pending,X.pending===X.pending_buf_size)){q=1;break}q=X.gzindex<X.gzhead.name.length?255&X.gzhead.name.charCodeAt(X.gzindex++):0,J(X,q)}while(q!==0);X.gzhead.hcrc&&X.pending>H&&(D.adler=g(D.adler,X.pending_buf,X.pending-H,H)),q===0&&(X.gzindex=0,X.status=91)}else X.status=91;if(X.status===91)if(X.gzhead.comment){H=X.pending;do{if(X.pending===X.pending_buf_size&&(X.gzhead.hcrc&&X.pending>H&&(D.adler=g(D.adler,X.pending_buf,X.pending-H,H)),z(D),H=X.pending,X.pending===X.pending_buf_size)){q=1;break}q=X.gzindex<X.gzhead.comment.length?255&X.gzhead.comment.charCodeAt(X.gzindex++):0,J(X,q)}while(q!==0);X.gzhead.hcrc&&X.pending>H&&(D.adler=g(D.adler,X.pending_buf,X.pending-H,H)),q===0&&(X.status=103)}else X.status=103;if(X.status===103&&(X.gzhead.hcrc?(X.pending+2>X.pending_buf_size&&z(D),X.pending+2<=X.pending_buf_size&&(J(X,255&D.adler),J(X,D.adler>>8&255),D.adler=0,X.status=A)):X.status=A),X.pending!==0){if(z(D),D.avail_out===0)return X.last_flush=-1,s}else if(D.avail_in===0&&B(fe)<=B(ae)&&fe!==e)return G(D,-5);if(X.status===666&&D.avail_in!==0)return G(D,-5);if(D.avail_in!==0||X.lookahead!==0||fe!==p&&X.status!==666){var he=X.strategy===2?function(te,Te){for(var Le;;){if(te.lookahead===0&&(Ee(te),te.lookahead===0)){if(Te===p)return b;break}if(te.match_length=0,Le=o._tr_tally(te,0,te.window[te.strstart]),te.lookahead--,te.strstart++,Le&&($(te,!1),te.strm.avail_out===0))return b}return te.insert=0,Te===e?($(te,!0),te.strm.avail_out===0?W:K):te.last_lit&&($(te,!1),te.strm.avail_out===0)?b:O}(X,fe):X.strategy===3?function(te,Te){for(var Le,Se,ze,Xe,it=te.window;;){if(te.lookahead<=U){if(Ee(te),te.lookahead<=U&&Te===p)return b;if(te.lookahead===0)break}if(te.match_length=0,te.lookahead>=P&&0<te.strstart&&(Se=it[ze=te.strstart-1])===it[++ze]&&Se===it[++ze]&&Se===it[++ze]){Xe=te.strstart+U;do;while(Se===it[++ze]&&Se===it[++ze]&&Se===it[++ze]&&Se===it[++ze]&&Se===it[++ze]&&Se===it[++ze]&&Se===it[++ze]&&Se===it[++ze]&&ze<Xe);te.match_length=U-(Xe-ze),te.match_length>te.lookahead&&(te.match_length=te.lookahead)}if(te.match_length>=P?(Le=o._tr_tally(te,1,te.match_length-P),te.lookahead-=te.match_length,te.strstart+=te.match_length,te.match_length=0):(Le=o._tr_tally(te,0,te.window[te.strstart]),te.lookahead--,te.strstart++),Le&&($(te,!1),te.strm.avail_out===0))return b}return te.insert=0,Te===e?($(te,!0),te.strm.avail_out===0?W:K):te.last_lit&&($(te,!1),te.strm.avail_out===0)?b:O}(X,fe):n[X.level].func(X,fe);if(he!==W&&he!==K||(X.status=666),he===b||he===W)return D.avail_out===0&&(X.last_flush=-1),s;if(he===O&&(fe===1?o._tr_align(X):fe!==5&&(o._tr_stored_block(X,0,0,!1),fe===3&&(j(X.head),X.lookahead===0&&(X.strstart=0,X.block_start=0,X.insert=0))),z(D),D.avail_out===0))return X.last_flush=-1,s}return fe!==e?s:X.wrap<=0?1:(X.wrap===2?(J(X,255&D.adler),J(X,D.adler>>8&255),J(X,D.adler>>16&255),J(X,D.adler>>24&255),J(X,255&D.total_in),J(X,D.total_in>>8&255),J(X,D.total_in>>16&255),J(X,D.total_in>>24&255)):(Q(X,D.adler>>>16),Q(X,65535&D.adler)),z(D),0<X.wrap&&(X.wrap=-X.wrap),X.pending!==0?s:1)},r.deflateEnd=function(D){var fe;return D&&D.state?(fe=D.state.status)!==C&&fe!==69&&fe!==73&&fe!==91&&fe!==103&&fe!==A&&fe!==666?G(D,l):(D.state=null,fe===A?G(D,-3):s):l},r.deflateSetDictionary=function(D,fe){var ae,X,H,q,ce,he,te,Te,Le=fe.length;if(!D||!D.state||(q=(ae=D.state).wrap)===2||q===1&&ae.status!==C||ae.lookahead)return l;for(q===1&&(D.adler=c(D.adler,fe,Le,0)),ae.wrap=0,Le>=ae.w_size&&(q===0&&(j(ae.head),ae.strstart=0,ae.block_start=0,ae.insert=0),Te=new u.Buf8(ae.w_size),u.arraySet(Te,fe,Le-ae.w_size,ae.w_size,0),fe=Te,Le=ae.w_size),ce=D.avail_in,he=D.next_in,te=D.input,D.avail_in=Le,D.next_in=0,D.input=fe,Ee(ae);ae.lookahead>=P;){for(X=ae.strstart,H=ae.lookahead-(P-1);ae.ins_h=(ae.ins_h<<ae.hash_shift^ae.window[X+P-1])&ae.hash_mask,ae.prev[X&ae.w_mask]=ae.head[ae.ins_h],ae.head[ae.ins_h]=X,X++,--H;);ae.strstart=X,ae.lookahead=P-1,Ee(ae)}return ae.strstart+=ae.lookahead,ae.block_start=ae.strstart,ae.insert=ae.lookahead,ae.lookahead=0,ae.match_length=ae.prev_length=P-1,ae.match_available=0,D.next_in=he,D.input=te,D.avail_in=ce,ae.wrap=q,s},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,i,r){i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,i,r){i.exports=function(n,u){var o,c,g,v,p,e,s,l,f,d,y,m,_,E,w,k,x,S,P,U,R,C,A,b,O;o=n.state,c=n.next_in,b=n.input,g=c+(n.avail_in-5),v=n.next_out,O=n.output,p=v-(u-n.avail_out),e=v+(n.avail_out-257),s=o.dmax,l=o.wsize,f=o.whave,d=o.wnext,y=o.window,m=o.hold,_=o.bits,E=o.lencode,w=o.distcode,k=(1<<o.lenbits)-1,x=(1<<o.distbits)-1;e:do{_<15&&(m+=b[c++]<<_,_+=8,m+=b[c++]<<_,_+=8),S=E[m&k];t:for(;;){if(m>>>=P=S>>>24,_-=P,(P=S>>>16&255)==0)O[v++]=65535&S;else{if(!(16&P)){if((64&P)==0){S=E[(65535&S)+(m&(1<<P)-1)];continue t}if(32&P){o.mode=12;break e}n.msg="invalid literal/length code",o.mode=30;break e}U=65535&S,(P&=15)&&(_<P&&(m+=b[c++]<<_,_+=8),U+=m&(1<<P)-1,m>>>=P,_-=P),_<15&&(m+=b[c++]<<_,_+=8,m+=b[c++]<<_,_+=8),S=w[m&x];i:for(;;){if(m>>>=P=S>>>24,_-=P,!(16&(P=S>>>16&255))){if((64&P)==0){S=w[(65535&S)+(m&(1<<P)-1)];continue i}n.msg="invalid distance code",o.mode=30;break e}if(R=65535&S,_<(P&=15)&&(m+=b[c++]<<_,(_+=8)<P&&(m+=b[c++]<<_,_+=8)),s<(R+=m&(1<<P)-1)){n.msg="invalid distance too far back",o.mode=30;break e}if(m>>>=P,_-=P,(P=v-p)<R){if(f<(P=R-P)&&o.sane){n.msg="invalid distance too far back",o.mode=30;break e}if(A=y,(C=0)===d){if(C+=l-P,P<U){for(U-=P;O[v++]=y[C++],--P;);C=v-R,A=O}}else if(d<P){if(C+=l+d-P,(P-=d)<U){for(U-=P;O[v++]=y[C++],--P;);if(C=0,d<U){for(U-=P=d;O[v++]=y[C++],--P;);C=v-R,A=O}}}else if(C+=d-P,P<U){for(U-=P;O[v++]=y[C++],--P;);C=v-R,A=O}for(;2<U;)O[v++]=A[C++],O[v++]=A[C++],O[v++]=A[C++],U-=3;U&&(O[v++]=A[C++],1<U&&(O[v++]=A[C++]))}else{for(C=v-R;O[v++]=O[C++],O[v++]=O[C++],O[v++]=O[C++],2<(U-=3););U&&(O[v++]=O[C++],1<U&&(O[v++]=O[C++]))}break}}break}}while(c<g&&v<e);c-=U=_>>3,m&=(1<<(_-=U<<3))-1,n.next_in=c,n.next_out=v,n.avail_in=c<g?g-c+5:5-(c-g),n.avail_out=v<e?e-v+257:257-(v-e),o.hold=m,o.bits=_}},{}],49:[function(t,i,r){var n=t("../utils/common"),u=t("./adler32"),o=t("./crc32"),c=t("./inffast"),g=t("./inftrees"),v=1,p=2,e=0,s=-2,l=1,f=852,d=592;function y(C){return(C>>>24&255)+(C>>>8&65280)+((65280&C)<<8)+((255&C)<<24)}function m(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function _(C){var A;return C&&C.state?(A=C.state,C.total_in=C.total_out=A.total=0,C.msg="",A.wrap&&(C.adler=1&A.wrap),A.mode=l,A.last=0,A.havedict=0,A.dmax=32768,A.head=null,A.hold=0,A.bits=0,A.lencode=A.lendyn=new n.Buf32(f),A.distcode=A.distdyn=new n.Buf32(d),A.sane=1,A.back=-1,e):s}function E(C){var A;return C&&C.state?((A=C.state).wsize=0,A.whave=0,A.wnext=0,_(C)):s}function w(C,A){var b,O;return C&&C.state?(O=C.state,A<0?(b=0,A=-A):(b=1+(A>>4),A<48&&(A&=15)),A&&(A<8||15<A)?s:(O.window!==null&&O.wbits!==A&&(O.window=null),O.wrap=b,O.wbits=A,E(C))):s}function k(C,A){var b,O;return C?(O=new m,(C.state=O).window=null,(b=w(C,A))!==e&&(C.state=null),b):s}var x,S,P=!0;function U(C){if(P){var A;for(x=new n.Buf32(512),S=new n.Buf32(32),A=0;A<144;)C.lens[A++]=8;for(;A<256;)C.lens[A++]=9;for(;A<280;)C.lens[A++]=7;for(;A<288;)C.lens[A++]=8;for(g(v,C.lens,0,288,x,0,C.work,{bits:9}),A=0;A<32;)C.lens[A++]=5;g(p,C.lens,0,32,S,0,C.work,{bits:5}),P=!1}C.lencode=x,C.lenbits=9,C.distcode=S,C.distbits=5}function R(C,A,b,O){var W,K=C.state;return K.window===null&&(K.wsize=1<<K.wbits,K.wnext=0,K.whave=0,K.window=new n.Buf8(K.wsize)),O>=K.wsize?(n.arraySet(K.window,A,b-K.wsize,K.wsize,0),K.wnext=0,K.whave=K.wsize):(O<(W=K.wsize-K.wnext)&&(W=O),n.arraySet(K.window,A,b-O,W,K.wnext),(O-=W)?(n.arraySet(K.window,A,b-O,O,0),K.wnext=O,K.whave=K.wsize):(K.wnext+=W,K.wnext===K.wsize&&(K.wnext=0),K.whave<K.wsize&&(K.whave+=W))),0}r.inflateReset=E,r.inflateReset2=w,r.inflateResetKeep=_,r.inflateInit=function(C){return k(C,15)},r.inflateInit2=k,r.inflate=function(C,A){var b,O,W,K,G,B,j,z,$,J,Q,ne,Ee,we,Ae,De,Ve,Ce,Me,Ge,D,fe,ae,X,H=0,q=new n.Buf8(4),ce=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!C||!C.state||!C.output||!C.input&&C.avail_in!==0)return s;(b=C.state).mode===12&&(b.mode=13),G=C.next_out,W=C.output,j=C.avail_out,K=C.next_in,O=C.input,B=C.avail_in,z=b.hold,$=b.bits,J=B,Q=j,fe=e;e:for(;;)switch(b.mode){case l:if(b.wrap===0){b.mode=13;break}for(;$<16;){if(B===0)break e;B--,z+=O[K++]<<$,$+=8}if(2&b.wrap&&z===35615){q[b.check=0]=255&z,q[1]=z>>>8&255,b.check=o(b.check,q,2,0),$=z=0,b.mode=2;break}if(b.flags=0,b.head&&(b.head.done=!1),!(1&b.wrap)||(((255&z)<<8)+(z>>8))%31){C.msg="incorrect header check",b.mode=30;break}if((15&z)!=8){C.msg="unknown compression method",b.mode=30;break}if($-=4,D=8+(15&(z>>>=4)),b.wbits===0)b.wbits=D;else if(D>b.wbits){C.msg="invalid window size",b.mode=30;break}b.dmax=1<<D,C.adler=b.check=1,b.mode=512&z?10:12,$=z=0;break;case 2:for(;$<16;){if(B===0)break e;B--,z+=O[K++]<<$,$+=8}if(b.flags=z,(255&b.flags)!=8){C.msg="unknown compression method",b.mode=30;break}if(57344&b.flags){C.msg="unknown header flags set",b.mode=30;break}b.head&&(b.head.text=z>>8&1),512&b.flags&&(q[0]=255&z,q[1]=z>>>8&255,b.check=o(b.check,q,2,0)),$=z=0,b.mode=3;case 3:for(;$<32;){if(B===0)break e;B--,z+=O[K++]<<$,$+=8}b.head&&(b.head.time=z),512&b.flags&&(q[0]=255&z,q[1]=z>>>8&255,q[2]=z>>>16&255,q[3]=z>>>24&255,b.check=o(b.check,q,4,0)),$=z=0,b.mode=4;case 4:for(;$<16;){if(B===0)break e;B--,z+=O[K++]<<$,$+=8}b.head&&(b.head.xflags=255&z,b.head.os=z>>8),512&b.flags&&(q[0]=255&z,q[1]=z>>>8&255,b.check=o(b.check,q,2,0)),$=z=0,b.mode=5;case 5:if(1024&b.flags){for(;$<16;){if(B===0)break e;B--,z+=O[K++]<<$,$+=8}b.length=z,b.head&&(b.head.extra_len=z),512&b.flags&&(q[0]=255&z,q[1]=z>>>8&255,b.check=o(b.check,q,2,0)),$=z=0}else b.head&&(b.head.extra=null);b.mode=6;case 6:if(1024&b.flags&&(B<(ne=b.length)&&(ne=B),ne&&(b.head&&(D=b.head.extra_len-b.length,b.head.extra||(b.head.extra=new Array(b.head.extra_len)),n.arraySet(b.head.extra,O,K,ne,D)),512&b.flags&&(b.check=o(b.check,O,ne,K)),B-=ne,K+=ne,b.length-=ne),b.length))break e;b.length=0,b.mode=7;case 7:if(2048&b.flags){if(B===0)break e;for(ne=0;D=O[K+ne++],b.head&&D&&b.length<65536&&(b.head.name+=String.fromCharCode(D)),D&&ne<B;);if(512&b.flags&&(b.check=o(b.check,O,ne,K)),B-=ne,K+=ne,D)break e}else b.head&&(b.head.name=null);b.length=0,b.mode=8;case 8:if(4096&b.flags){if(B===0)break e;for(ne=0;D=O[K+ne++],b.head&&D&&b.length<65536&&(b.head.comment+=String.fromCharCode(D)),D&&ne<B;);if(512&b.flags&&(b.check=o(b.check,O,ne,K)),B-=ne,K+=ne,D)break e}else b.head&&(b.head.comment=null);b.mode=9;case 9:if(512&b.flags){for(;$<16;){if(B===0)break e;B--,z+=O[K++]<<$,$+=8}if(z!==(65535&b.check)){C.msg="header crc mismatch",b.mode=30;break}$=z=0}b.head&&(b.head.hcrc=b.flags>>9&1,b.head.done=!0),C.adler=b.check=0,b.mode=12;break;case 10:for(;$<32;){if(B===0)break e;B--,z+=O[K++]<<$,$+=8}C.adler=b.check=y(z),$=z=0,b.mode=11;case 11:if(b.havedict===0)return C.next_out=G,C.avail_out=j,C.next_in=K,C.avail_in=B,b.hold=z,b.bits=$,2;C.adler=b.check=1,b.mode=12;case 12:if(A===5||A===6)break e;case 13:if(b.last){z>>>=7&$,$-=7&$,b.mode=27;break}for(;$<3;){if(B===0)break e;B--,z+=O[K++]<<$,$+=8}switch(b.last=1&z,$-=1,3&(z>>>=1)){case 0:b.mode=14;break;case 1:if(U(b),b.mode=20,A!==6)break;z>>>=2,$-=2;break e;case 2:b.mode=17;break;case 3:C.msg="invalid block type",b.mode=30}z>>>=2,$-=2;break;case 14:for(z>>>=7&$,$-=7&$;$<32;){if(B===0)break e;B--,z+=O[K++]<<$,$+=8}if((65535&z)!=(z>>>16^65535)){C.msg="invalid stored block lengths",b.mode=30;break}if(b.length=65535&z,$=z=0,b.mode=15,A===6)break e;case 15:b.mode=16;case 16:if(ne=b.length){if(B<ne&&(ne=B),j<ne&&(ne=j),ne===0)break e;n.arraySet(W,O,K,ne,G),B-=ne,K+=ne,j-=ne,G+=ne,b.length-=ne;break}b.mode=12;break;case 17:for(;$<14;){if(B===0)break e;B--,z+=O[K++]<<$,$+=8}if(b.nlen=257+(31&z),z>>>=5,$-=5,b.ndist=1+(31&z),z>>>=5,$-=5,b.ncode=4+(15&z),z>>>=4,$-=4,286<b.nlen||30<b.ndist){C.msg="too many length or distance symbols",b.mode=30;break}b.have=0,b.mode=18;case 18:for(;b.have<b.ncode;){for(;$<3;){if(B===0)break e;B--,z+=O[K++]<<$,$+=8}b.lens[ce[b.have++]]=7&z,z>>>=3,$-=3}for(;b.have<19;)b.lens[ce[b.have++]]=0;if(b.lencode=b.lendyn,b.lenbits=7,ae={bits:b.lenbits},fe=g(0,b.lens,0,19,b.lencode,0,b.work,ae),b.lenbits=ae.bits,fe){C.msg="invalid code lengths set",b.mode=30;break}b.have=0,b.mode=19;case 19:for(;b.have<b.nlen+b.ndist;){for(;De=(H=b.lencode[z&(1<<b.lenbits)-1])>>>16&255,Ve=65535&H,!((Ae=H>>>24)<=$);){if(B===0)break e;B--,z+=O[K++]<<$,$+=8}if(Ve<16)z>>>=Ae,$-=Ae,b.lens[b.have++]=Ve;else{if(Ve===16){for(X=Ae+2;$<X;){if(B===0)break e;B--,z+=O[K++]<<$,$+=8}if(z>>>=Ae,$-=Ae,b.have===0){C.msg="invalid bit length repeat",b.mode=30;break}D=b.lens[b.have-1],ne=3+(3&z),z>>>=2,$-=2}else if(Ve===17){for(X=Ae+3;$<X;){if(B===0)break e;B--,z+=O[K++]<<$,$+=8}$-=Ae,D=0,ne=3+(7&(z>>>=Ae)),z>>>=3,$-=3}else{for(X=Ae+7;$<X;){if(B===0)break e;B--,z+=O[K++]<<$,$+=8}$-=Ae,D=0,ne=11+(127&(z>>>=Ae)),z>>>=7,$-=7}if(b.have+ne>b.nlen+b.ndist){C.msg="invalid bit length repeat",b.mode=30;break}for(;ne--;)b.lens[b.have++]=D}}if(b.mode===30)break;if(b.lens[256]===0){C.msg="invalid code -- missing end-of-block",b.mode=30;break}if(b.lenbits=9,ae={bits:b.lenbits},fe=g(v,b.lens,0,b.nlen,b.lencode,0,b.work,ae),b.lenbits=ae.bits,fe){C.msg="invalid literal/lengths set",b.mode=30;break}if(b.distbits=6,b.distcode=b.distdyn,ae={bits:b.distbits},fe=g(p,b.lens,b.nlen,b.ndist,b.distcode,0,b.work,ae),b.distbits=ae.bits,fe){C.msg="invalid distances set",b.mode=30;break}if(b.mode=20,A===6)break e;case 20:b.mode=21;case 21:if(6<=B&&258<=j){C.next_out=G,C.avail_out=j,C.next_in=K,C.avail_in=B,b.hold=z,b.bits=$,c(C,Q),G=C.next_out,W=C.output,j=C.avail_out,K=C.next_in,O=C.input,B=C.avail_in,z=b.hold,$=b.bits,b.mode===12&&(b.back=-1);break}for(b.back=0;De=(H=b.lencode[z&(1<<b.lenbits)-1])>>>16&255,Ve=65535&H,!((Ae=H>>>24)<=$);){if(B===0)break e;B--,z+=O[K++]<<$,$+=8}if(De&&(240&De)==0){for(Ce=Ae,Me=De,Ge=Ve;De=(H=b.lencode[Ge+((z&(1<<Ce+Me)-1)>>Ce)])>>>16&255,Ve=65535&H,!(Ce+(Ae=H>>>24)<=$);){if(B===0)break e;B--,z+=O[K++]<<$,$+=8}z>>>=Ce,$-=Ce,b.back+=Ce}if(z>>>=Ae,$-=Ae,b.back+=Ae,b.length=Ve,De===0){b.mode=26;break}if(32&De){b.back=-1,b.mode=12;break}if(64&De){C.msg="invalid literal/length code",b.mode=30;break}b.extra=15&De,b.mode=22;case 22:if(b.extra){for(X=b.extra;$<X;){if(B===0)break e;B--,z+=O[K++]<<$,$+=8}b.length+=z&(1<<b.extra)-1,z>>>=b.extra,$-=b.extra,b.back+=b.extra}b.was=b.length,b.mode=23;case 23:for(;De=(H=b.distcode[z&(1<<b.distbits)-1])>>>16&255,Ve=65535&H,!((Ae=H>>>24)<=$);){if(B===0)break e;B--,z+=O[K++]<<$,$+=8}if((240&De)==0){for(Ce=Ae,Me=De,Ge=Ve;De=(H=b.distcode[Ge+((z&(1<<Ce+Me)-1)>>Ce)])>>>16&255,Ve=65535&H,!(Ce+(Ae=H>>>24)<=$);){if(B===0)break e;B--,z+=O[K++]<<$,$+=8}z>>>=Ce,$-=Ce,b.back+=Ce}if(z>>>=Ae,$-=Ae,b.back+=Ae,64&De){C.msg="invalid distance code",b.mode=30;break}b.offset=Ve,b.extra=15&De,b.mode=24;case 24:if(b.extra){for(X=b.extra;$<X;){if(B===0)break e;B--,z+=O[K++]<<$,$+=8}b.offset+=z&(1<<b.extra)-1,z>>>=b.extra,$-=b.extra,b.back+=b.extra}if(b.offset>b.dmax){C.msg="invalid distance too far back",b.mode=30;break}b.mode=25;case 25:if(j===0)break e;if(ne=Q-j,b.offset>ne){if((ne=b.offset-ne)>b.whave&&b.sane){C.msg="invalid distance too far back",b.mode=30;break}Ee=ne>b.wnext?(ne-=b.wnext,b.wsize-ne):b.wnext-ne,ne>b.length&&(ne=b.length),we=b.window}else we=W,Ee=G-b.offset,ne=b.length;for(j<ne&&(ne=j),j-=ne,b.length-=ne;W[G++]=we[Ee++],--ne;);b.length===0&&(b.mode=21);break;case 26:if(j===0)break e;W[G++]=b.length,j--,b.mode=21;break;case 27:if(b.wrap){for(;$<32;){if(B===0)break e;B--,z|=O[K++]<<$,$+=8}if(Q-=j,C.total_out+=Q,b.total+=Q,Q&&(C.adler=b.check=b.flags?o(b.check,W,Q,G-Q):u(b.check,W,Q,G-Q)),Q=j,(b.flags?z:y(z))!==b.check){C.msg="incorrect data check",b.mode=30;break}$=z=0}b.mode=28;case 28:if(b.wrap&&b.flags){for(;$<32;){if(B===0)break e;B--,z+=O[K++]<<$,$+=8}if(z!==(4294967295&b.total)){C.msg="incorrect length check",b.mode=30;break}$=z=0}b.mode=29;case 29:fe=1;break e;case 30:fe=-3;break e;case 31:return-4;case 32:default:return s}return C.next_out=G,C.avail_out=j,C.next_in=K,C.avail_in=B,b.hold=z,b.bits=$,(b.wsize||Q!==C.avail_out&&b.mode<30&&(b.mode<27||A!==4))&&R(C,C.output,C.next_out,Q-C.avail_out)?(b.mode=31,-4):(J-=C.avail_in,Q-=C.avail_out,C.total_in+=J,C.total_out+=Q,b.total+=Q,b.wrap&&Q&&(C.adler=b.check=b.flags?o(b.check,W,Q,C.next_out-Q):u(b.check,W,Q,C.next_out-Q)),C.data_type=b.bits+(b.last?64:0)+(b.mode===12?128:0)+(b.mode===20||b.mode===15?256:0),(J==0&&Q===0||A===4)&&fe===e&&(fe=-5),fe)},r.inflateEnd=function(C){if(!C||!C.state)return s;var A=C.state;return A.window&&(A.window=null),C.state=null,e},r.inflateGetHeader=function(C,A){var b;return C&&C.state?(2&(b=C.state).wrap)==0?s:((b.head=A).done=!1,e):s},r.inflateSetDictionary=function(C,A){var b,O=A.length;return C&&C.state?(b=C.state).wrap!==0&&b.mode!==11?s:b.mode===11&&u(1,A,O,0)!==b.check?-3:R(C,A,O,O)?(b.mode=31,-4):(b.havedict=1,e):s},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,i,r){var n=t("../utils/common"),u=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],g=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(v,p,e,s,l,f,d,y){var m,_,E,w,k,x,S,P,U,R=y.bits,C=0,A=0,b=0,O=0,W=0,K=0,G=0,B=0,j=0,z=0,$=null,J=0,Q=new n.Buf16(16),ne=new n.Buf16(16),Ee=null,we=0;for(C=0;C<=15;C++)Q[C]=0;for(A=0;A<s;A++)Q[p[e+A]]++;for(W=R,O=15;1<=O&&Q[O]===0;O--);if(O<W&&(W=O),O===0)return l[f++]=20971520,l[f++]=20971520,y.bits=1,0;for(b=1;b<O&&Q[b]===0;b++);for(W<b&&(W=b),C=B=1;C<=15;C++)if(B<<=1,(B-=Q[C])<0)return-1;if(0<B&&(v===0||O!==1))return-1;for(ne[1]=0,C=1;C<15;C++)ne[C+1]=ne[C]+Q[C];for(A=0;A<s;A++)p[e+A]!==0&&(d[ne[p[e+A]]++]=A);if(x=v===0?($=Ee=d,19):v===1?($=u,J-=257,Ee=o,we-=257,256):($=c,Ee=g,-1),C=b,k=f,G=A=z=0,E=-1,w=(j=1<<(K=W))-1,v===1&&852<j||v===2&&592<j)return 1;for(;;){for(S=C-G,U=d[A]<x?(P=0,d[A]):d[A]>x?(P=Ee[we+d[A]],$[J+d[A]]):(P=96,0),m=1<<C-G,b=_=1<<K;l[k+(z>>G)+(_-=m)]=S<<24|P<<16|U|0,_!==0;);for(m=1<<C-1;z&m;)m>>=1;if(m!==0?(z&=m-1,z+=m):z=0,A++,--Q[C]==0){if(C===O)break;C=p[e+d[A]]}if(W<C&&(z&w)!==E){for(G===0&&(G=W),k+=b,B=1<<(K=C-G);K+G<O&&!((B-=Q[K+G])<=0);)K++,B<<=1;if(j+=1<<K,v===1&&852<j||v===2&&592<j)return 1;l[E=z&w]=W<<24|K<<16|k-f|0}}return z!==0&&(l[k+z]=C-G<<24|64<<16|0),y.bits=W,0}},{"../utils/common":41}],51:[function(t,i,r){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,i,r){var n=t("../utils/common"),u=0,o=1;function c(H){for(var q=H.length;0<=--q;)H[q]=0}var g=0,v=29,p=256,e=p+1+v,s=30,l=19,f=2*e+1,d=15,y=16,m=7,_=256,E=16,w=17,k=18,x=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],S=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],P=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],R=new Array(2*(e+2));c(R);var C=new Array(2*s);c(C);var A=new Array(512);c(A);var b=new Array(256);c(b);var O=new Array(v);c(O);var W,K,G,B=new Array(s);function j(H,q,ce,he,te){this.static_tree=H,this.extra_bits=q,this.extra_base=ce,this.elems=he,this.max_length=te,this.has_stree=H&&H.length}function z(H,q){this.dyn_tree=H,this.max_code=0,this.stat_desc=q}function $(H){return H<256?A[H]:A[256+(H>>>7)]}function J(H,q){H.pending_buf[H.pending++]=255&q,H.pending_buf[H.pending++]=q>>>8&255}function Q(H,q,ce){H.bi_valid>y-ce?(H.bi_buf|=q<<H.bi_valid&65535,J(H,H.bi_buf),H.bi_buf=q>>y-H.bi_valid,H.bi_valid+=ce-y):(H.bi_buf|=q<<H.bi_valid&65535,H.bi_valid+=ce)}function ne(H,q,ce){Q(H,ce[2*q],ce[2*q+1])}function Ee(H,q){for(var ce=0;ce|=1&H,H>>>=1,ce<<=1,0<--q;);return ce>>>1}function we(H,q,ce){var he,te,Te=new Array(d+1),Le=0;for(he=1;he<=d;he++)Te[he]=Le=Le+ce[he-1]<<1;for(te=0;te<=q;te++){var Se=H[2*te+1];Se!==0&&(H[2*te]=Ee(Te[Se]++,Se))}}function Ae(H){var q;for(q=0;q<e;q++)H.dyn_ltree[2*q]=0;for(q=0;q<s;q++)H.dyn_dtree[2*q]=0;for(q=0;q<l;q++)H.bl_tree[2*q]=0;H.dyn_ltree[2*_]=1,H.opt_len=H.static_len=0,H.last_lit=H.matches=0}function De(H){8<H.bi_valid?J(H,H.bi_buf):0<H.bi_valid&&(H.pending_buf[H.pending++]=H.bi_buf),H.bi_buf=0,H.bi_valid=0}function Ve(H,q,ce,he){var te=2*q,Te=2*ce;return H[te]<H[Te]||H[te]===H[Te]&&he[q]<=he[ce]}function Ce(H,q,ce){for(var he=H.heap[ce],te=ce<<1;te<=H.heap_len&&(te<H.heap_len&&Ve(q,H.heap[te+1],H.heap[te],H.depth)&&te++,!Ve(q,he,H.heap[te],H.depth));)H.heap[ce]=H.heap[te],ce=te,te<<=1;H.heap[ce]=he}function Me(H,q,ce){var he,te,Te,Le,Se=0;if(H.last_lit!==0)for(;he=H.pending_buf[H.d_buf+2*Se]<<8|H.pending_buf[H.d_buf+2*Se+1],te=H.pending_buf[H.l_buf+Se],Se++,he===0?ne(H,te,q):(ne(H,(Te=b[te])+p+1,q),(Le=x[Te])!==0&&Q(H,te-=O[Te],Le),ne(H,Te=$(--he),ce),(Le=S[Te])!==0&&Q(H,he-=B[Te],Le)),Se<H.last_lit;);ne(H,_,q)}function Ge(H,q){var ce,he,te,Te=q.dyn_tree,Le=q.stat_desc.static_tree,Se=q.stat_desc.has_stree,ze=q.stat_desc.elems,Xe=-1;for(H.heap_len=0,H.heap_max=f,ce=0;ce<ze;ce++)Te[2*ce]!==0?(H.heap[++H.heap_len]=Xe=ce,H.depth[ce]=0):Te[2*ce+1]=0;for(;H.heap_len<2;)Te[2*(te=H.heap[++H.heap_len]=Xe<2?++Xe:0)]=1,H.depth[te]=0,H.opt_len--,Se&&(H.static_len-=Le[2*te+1]);for(q.max_code=Xe,ce=H.heap_len>>1;1<=ce;ce--)Ce(H,Te,ce);for(te=ze;ce=H.heap[1],H.heap[1]=H.heap[H.heap_len--],Ce(H,Te,1),he=H.heap[1],H.heap[--H.heap_max]=ce,H.heap[--H.heap_max]=he,Te[2*te]=Te[2*ce]+Te[2*he],H.depth[te]=(H.depth[ce]>=H.depth[he]?H.depth[ce]:H.depth[he])+1,Te[2*ce+1]=Te[2*he+1]=te,H.heap[1]=te++,Ce(H,Te,1),2<=H.heap_len;);H.heap[--H.heap_max]=H.heap[1],function(it,Je){var Ft,yt,Bt,ot,Ci,Nt,Wt=Je.dyn_tree,Di=Je.max_code,ci=Je.stat_desc.static_tree,vr=Je.stat_desc.has_stree,yr=Je.stat_desc.extra_bits,Ji=Je.stat_desc.extra_base,Kt=Je.stat_desc.max_length,qt=0;for(ot=0;ot<=d;ot++)it.bl_count[ot]=0;for(Wt[2*it.heap[it.heap_max]+1]=0,Ft=it.heap_max+1;Ft<f;Ft++)Kt<(ot=Wt[2*Wt[2*(yt=it.heap[Ft])+1]+1]+1)&&(ot=Kt,qt++),Wt[2*yt+1]=ot,Di<yt||(it.bl_count[ot]++,Ci=0,Ji<=yt&&(Ci=yr[yt-Ji]),Nt=Wt[2*yt],it.opt_len+=Nt*(ot+Ci),vr&&(it.static_len+=Nt*(ci[2*yt+1]+Ci)));if(qt!==0){do{for(ot=Kt-1;it.bl_count[ot]===0;)ot--;it.bl_count[ot]--,it.bl_count[ot+1]+=2,it.bl_count[Kt]--,qt-=2}while(0<qt);for(ot=Kt;ot!==0;ot--)for(yt=it.bl_count[ot];yt!==0;)Di<(Bt=it.heap[--Ft])||(Wt[2*Bt+1]!==ot&&(it.opt_len+=(ot-Wt[2*Bt+1])*Wt[2*Bt],Wt[2*Bt+1]=ot),yt--)}}(H,q),we(Te,Xe,H.bl_count)}function D(H,q,ce){var he,te,Te=-1,Le=q[1],Se=0,ze=7,Xe=4;for(Le===0&&(ze=138,Xe=3),q[2*(ce+1)+1]=65535,he=0;he<=ce;he++)te=Le,Le=q[2*(he+1)+1],++Se<ze&&te===Le||(Se<Xe?H.bl_tree[2*te]+=Se:te!==0?(te!==Te&&H.bl_tree[2*te]++,H.bl_tree[2*E]++):Se<=10?H.bl_tree[2*w]++:H.bl_tree[2*k]++,Te=te,Xe=(Se=0)===Le?(ze=138,3):te===Le?(ze=6,3):(ze=7,4))}function fe(H,q,ce){var he,te,Te=-1,Le=q[1],Se=0,ze=7,Xe=4;for(Le===0&&(ze=138,Xe=3),he=0;he<=ce;he++)if(te=Le,Le=q[2*(he+1)+1],!(++Se<ze&&te===Le)){if(Se<Xe)for(;ne(H,te,H.bl_tree),--Se!=0;);else te!==0?(te!==Te&&(ne(H,te,H.bl_tree),Se--),ne(H,E,H.bl_tree),Q(H,Se-3,2)):Se<=10?(ne(H,w,H.bl_tree),Q(H,Se-3,3)):(ne(H,k,H.bl_tree),Q(H,Se-11,7));Te=te,Xe=(Se=0)===Le?(ze=138,3):te===Le?(ze=6,3):(ze=7,4)}}c(B);var ae=!1;function X(H,q,ce,he){Q(H,(g<<1)+(he?1:0),3),function(te,Te,Le,Se){De(te),Se&&(J(te,Le),J(te,~Le)),n.arraySet(te.pending_buf,te.window,Te,Le,te.pending),te.pending+=Le}(H,q,ce,!0)}r._tr_init=function(H){ae||(function(){var q,ce,he,te,Te,Le=new Array(d+1);for(te=he=0;te<v-1;te++)for(O[te]=he,q=0;q<1<<x[te];q++)b[he++]=te;for(b[he-1]=te,te=Te=0;te<16;te++)for(B[te]=Te,q=0;q<1<<S[te];q++)A[Te++]=te;for(Te>>=7;te<s;te++)for(B[te]=Te<<7,q=0;q<1<<S[te]-7;q++)A[256+Te++]=te;for(ce=0;ce<=d;ce++)Le[ce]=0;for(q=0;q<=143;)R[2*q+1]=8,q++,Le[8]++;for(;q<=255;)R[2*q+1]=9,q++,Le[9]++;for(;q<=279;)R[2*q+1]=7,q++,Le[7]++;for(;q<=287;)R[2*q+1]=8,q++,Le[8]++;for(we(R,e+1,Le),q=0;q<s;q++)C[2*q+1]=5,C[2*q]=Ee(q,5);W=new j(R,x,p+1,e,d),K=new j(C,S,0,s,d),G=new j(new Array(0),P,0,l,m)}(),ae=!0),H.l_desc=new z(H.dyn_ltree,W),H.d_desc=new z(H.dyn_dtree,K),H.bl_desc=new z(H.bl_tree,G),H.bi_buf=0,H.bi_valid=0,Ae(H)},r._tr_stored_block=X,r._tr_flush_block=function(H,q,ce,he){var te,Te,Le=0;0<H.level?(H.strm.data_type===2&&(H.strm.data_type=function(Se){var ze,Xe=4093624447;for(ze=0;ze<=31;ze++,Xe>>>=1)if(1&Xe&&Se.dyn_ltree[2*ze]!==0)return u;if(Se.dyn_ltree[18]!==0||Se.dyn_ltree[20]!==0||Se.dyn_ltree[26]!==0)return o;for(ze=32;ze<p;ze++)if(Se.dyn_ltree[2*ze]!==0)return o;return u}(H)),Ge(H,H.l_desc),Ge(H,H.d_desc),Le=function(Se){var ze;for(D(Se,Se.dyn_ltree,Se.l_desc.max_code),D(Se,Se.dyn_dtree,Se.d_desc.max_code),Ge(Se,Se.bl_desc),ze=l-1;3<=ze&&Se.bl_tree[2*U[ze]+1]===0;ze--);return Se.opt_len+=3*(ze+1)+5+5+4,ze}(H),te=H.opt_len+3+7>>>3,(Te=H.static_len+3+7>>>3)<=te&&(te=Te)):te=Te=ce+5,ce+4<=te&&q!==-1?X(H,q,ce,he):H.strategy===4||Te===te?(Q(H,2+(he?1:0),3),Me(H,R,C)):(Q(H,4+(he?1:0),3),function(Se,ze,Xe,it){var Je;for(Q(Se,ze-257,5),Q(Se,Xe-1,5),Q(Se,it-4,4),Je=0;Je<it;Je++)Q(Se,Se.bl_tree[2*U[Je]+1],3);fe(Se,Se.dyn_ltree,ze-1),fe(Se,Se.dyn_dtree,Xe-1)}(H,H.l_desc.max_code+1,H.d_desc.max_code+1,Le+1),Me(H,H.dyn_ltree,H.dyn_dtree)),Ae(H),he&&De(H)},r._tr_tally=function(H,q,ce){return H.pending_buf[H.d_buf+2*H.last_lit]=q>>>8&255,H.pending_buf[H.d_buf+2*H.last_lit+1]=255&q,H.pending_buf[H.l_buf+H.last_lit]=255&ce,H.last_lit++,q===0?H.dyn_ltree[2*ce]++:(H.matches++,q--,H.dyn_ltree[2*(b[ce]+p+1)]++,H.dyn_dtree[2*$(q)]++),H.last_lit===H.lit_bufsize-1},r._tr_align=function(H){Q(H,2,3),ne(H,_,R),function(q){q.bi_valid===16?(J(q,q.bi_buf),q.bi_buf=0,q.bi_valid=0):8<=q.bi_valid&&(q.pending_buf[q.pending++]=255&q.bi_buf,q.bi_buf>>=8,q.bi_valid-=8)}(H)}},{"../utils/common":41}],53:[function(t,i,r){i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,i,r){(function(n){(function(u,o){if(!u.setImmediate){var c,g,v,p,e=1,s={},l=!1,f=u.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(u);d=d&&d.setTimeout?d:u,c={}.toString.call(u.process)==="[object process]"?function(E){process.nextTick(function(){m(E)})}:function(){if(u.postMessage&&!u.importScripts){var E=!0,w=u.onmessage;return u.onmessage=function(){E=!1},u.postMessage("","*"),u.onmessage=w,E}}()?(p="setImmediate$"+Math.random()+"$",u.addEventListener?u.addEventListener("message",_,!1):u.attachEvent("onmessage",_),function(E){u.postMessage(p+E,"*")}):u.MessageChannel?((v=new MessageChannel).port1.onmessage=function(E){m(E.data)},function(E){v.port2.postMessage(E)}):f&&"onreadystatechange"in f.createElement("script")?(g=f.documentElement,function(E){var w=f.createElement("script");w.onreadystatechange=function(){m(E),w.onreadystatechange=null,g.removeChild(w),w=null},g.appendChild(w)}):function(E){setTimeout(m,0,E)},d.setImmediate=function(E){typeof E!="function"&&(E=new Function(""+E));for(var w=new Array(arguments.length-1),k=0;k<w.length;k++)w[k]=arguments[k+1];var x={callback:E,args:w};return s[e]=x,c(e),e++},d.clearImmediate=y}function y(E){delete s[E]}function m(E){if(l)setTimeout(m,0,E);else{var w=s[E];if(w){l=!0;try{(function(k){var x=k.callback,S=k.args;switch(S.length){case 0:x();break;case 1:x(S[0]);break;case 2:x(S[0],S[1]);break;case 3:x(S[0],S[1],S[2]);break;default:x.apply(o,S)}})(w)}finally{y(E),l=!1}}}}function _(E){E.source===u&&typeof E.data=="string"&&E.data.indexOf(p)===0&&m(+E.data.slice(p.length))}})(typeof self=="undefined"?n===void 0?this:n:self)}).call(this,typeof pn!="undefined"?pn:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}]},{},[10])(10)})})(iu);var ss=iu.exports;const Zi=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:globalThis;function wp(h,a){return typeof a=="undefined"?a={autoBom:!1}:typeof a!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(h.type)?new Blob([String.fromCharCode(65279),h],{type:h.type}):h}function os(h,a,t){var i=new XMLHttpRequest;i.open("GET",h),i.responseType="blob",i.onload=function(){au(i.response,a,t,void 0)},i.onerror=function(){console.error("could not download file")},i.send()}function ru(h){var a=new XMLHttpRequest;a.open("HEAD",h,!1);try{a.send()}catch(t){}return a.status>=200&&a.status<=299}function wn(h){try{h.dispatchEvent(new MouseEvent("click"))}catch(t){var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),h.dispatchEvent(a)}}var nu=Zi.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),Tp=/SamsungBrowser/.test(navigator.userAgent);const au=(()=>"download"in HTMLAnchorElement.prototype&&!nu?function(h,a,t){var i=Zi.URL||Zi.webkitURL,r=document.createElement("a");a=a||h.name||"download",r.download=a,r.rel="noopener",typeof h=="string"?(r.href=h,r.origin!==location.origin?ru(r.href)?os(h,a,t):(r.target="_blank",wn(r)):wn(r)):(r.href=i.createObjectURL(h),setTimeout(function(){i.revokeObjectURL(r.href)},4e4),Tp?wn(r):setTimeout(function(){wn(r)},0))}:"msSaveOrOpenBlob"in navigator?function(h,a,t){if(a=a||h.name||"download",typeof h=="string")if(ru(h))os(h,a,t);else{var i=document.createElement("a");i.href=h,i.target="_blank",setTimeout(function(){wn(i)})}else Zi.navigator.msSaveOrOpenBlob(wp(h,t),a)}:function(h,a,t,i){if(i=i||open("","_blank"),i&&(i.document.title=i.document.body.innerText="downloading..."),typeof h=="string")return os(h,a,t);var r=h.type==="application/octet-stream",n=/constructor/i.test(Zi.HTMLElement)||Zi.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||r&&n||nu)&&typeof FileReader!="undefined"){var o=new FileReader;o.onloadend=function(){var v=o.result;v=u?v:v.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=v:Zi.location=v,i=null},o.readAsDataURL(h)}else{var c=Zi.URL||Zi.webkitURL,g=c.createObjectURL(h);i?i.location=g:location.href=g,i=null,setTimeout(function(){c.revokeObjectURL(g)},4e4)}})();function Sp(){const h=$e({start:void 0,end:void 0}),a=$e(!1),t={limitStart:null,limitEnd:null,confirmFn:null};return{rangeInputFormData:h,isshowRangeInputModal:a,openRangeInputModal:(n,u,o)=>oe(this,null,function*(){h.value.start=n,h.value.end=u,t.limitStart=n,t.limitEnd=u,t.confirmFn=o,a.value=!0}),beforeCloseRangeInputModal:n=>oe(this,null,function*(){if(n==="confirm"){let u=parseInt(h.value.start),o=parseInt(h.value.end);if(u!=u||o!=o)return Oe({message:"\u8BF7\u8F93\u5165",position:"top"}),!1;const{limitStart:c,limitEnd:g}=t;if(u<c||o>g||u>o)return Oe({message:"\u5DF2\u8D85\u51FA\u533A\u95F4\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165",position:"top"}),!1;t.confirmFn&&t.confirmFn(u,o)}return!0})}}function kp(){const h=$e({isShow:!1,data:[]});return{sheet:h,open:i=>{h.value.data=i,h.value.isShow=!0,gn().then(()=>{document.querySelector(".list-action-sheet-box .active").scrollIntoView()})},close:()=>{h.value.isShow=!1}}}class Ap{constructor(){ve(this,"axios")}getVsongData(){return oe(this,null,function*(){let a="/main/get-data",t=null;return Sr()?t=yield It.getBody(a):(t=yield this.axios.get(a),It.setBody(a,t,180*ur)),t.data||{collect:{\u559C\u6B22\u7684\u97F3\u4E50:[]},settings:{loopMode:"listloop",showVideo:!0,proxyUrl:"",alistConfig:{url:"",username:"",password:""}}}})}setVsongData(a){return oe(this,null,function*(){let t="/main/get-data";if(Sr()){let i=yield It.getBody(t);i.data=a,It.setBody(t,i,180*ur),Ma(!0);return}yield this.axios.post("/main/set-data",a)})}saveSettings(a){return oe(this,null,function*(){let t=yield this.getVsongData();Object.keys(a).forEach(i=>{t.settings[i]=a[i]}),yield this.setVsongData(t)})}syncVsongData(){return oe(this,null,function*(){let a="/main/get-data",t=yield It.getBody(a);!t||(yield this.setVsongData(t.data))})}getOssList(){return oe(this,null,function*(){return(yield this.axios.get("/vsong/oss-list")).data})}unbindAccount(a){return oe(this,null,function*(){yield this.axios.post("/vsong/unbind-account",{platform:a})})}setAxios(a){this.axios=a}getAxios(){return this.axios}}var lt=new Ap,Tn={},Cp=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},su={},fi={};let ls;const Dp=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];fi.getSymbolSize=function(a){if(!a)throw new Error('"version" cannot be null or undefined');if(a<1||a>40)throw new Error('"version" should be in range from 1 to 40');return a*4+17};fi.getSymbolTotalCodewords=function(a){return Dp[a]};fi.getBCHDigit=function(h){let a=0;for(;h!==0;)a++,h>>>=1;return a};fi.setToSJISFunction=function(a){if(typeof a!="function")throw new Error('"toSJISFunc" is not a valid function.');ls=a};fi.isKanjiModeEnabled=function(){return typeof ls!="undefined"};fi.toSJIS=function(a){return ls(a)};var na={};(function(h){h.L={bit:1},h.M={bit:0},h.Q={bit:3},h.H={bit:2};function a(t){if(typeof t!="string")throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return h.L;case"m":case"medium":return h.M;case"q":case"quartile":return h.Q;case"h":case"high":return h.H;default:throw new Error("Unknown EC Level: "+t)}}h.isValid=function(i){return i&&typeof i.bit!="undefined"&&i.bit>=0&&i.bit<4},h.from=function(i,r){if(h.isValid(i))return i;try{return a(i)}catch(n){return r}}})(na);function ou(){this.buffer=[],this.length=0}ou.prototype={get:function(h){const a=Math.floor(h/8);return(this.buffer[a]>>>7-h%8&1)==1},put:function(h,a){for(let t=0;t<a;t++)this.putBit((h>>>a-t-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(h){const a=Math.floor(this.length/8);this.buffer.length<=a&&this.buffer.push(0),h&&(this.buffer[a]|=128>>>this.length%8),this.length++}};var Rp=ou;function Sn(h){if(!h||h<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=h,this.data=new Uint8Array(h*h),this.reservedBit=new Uint8Array(h*h)}Sn.prototype.set=function(h,a,t,i){const r=h*this.size+a;this.data[r]=t,i&&(this.reservedBit[r]=!0)};Sn.prototype.get=function(h,a){return this.data[h*this.size+a]};Sn.prototype.xor=function(h,a,t){this.data[h*this.size+a]^=t};Sn.prototype.isReserved=function(h,a){return this.reservedBit[h*this.size+a]};var Up=Sn,lu={};(function(h){const a=fi.getSymbolSize;h.getRowColCoords=function(i){if(i===1)return[];const r=Math.floor(i/7)+2,n=a(i),u=n===145?26:Math.ceil((n-13)/(2*r-2))*2,o=[n-7];for(let c=1;c<r-1;c++)o[c]=o[c-1]-u;return o.push(6),o.reverse()},h.getPositions=function(i){const r=[],n=h.getRowColCoords(i),u=n.length;for(let o=0;o<u;o++)for(let c=0;c<u;c++)o===0&&c===0||o===0&&c===u-1||o===u-1&&c===0||r.push([n[o],n[c]]);return r}})(lu);var uu={};const Lp=fi.getSymbolSize,fu=7;uu.getPositions=function(a){const t=Lp(a);return[[0,0],[t-fu,0],[0,t-fu]]};var cu={};(function(h){h.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const a={N1:3,N2:3,N3:40,N4:10};h.isValid=function(r){return r!=null&&r!==""&&!isNaN(r)&&r>=0&&r<=7},h.from=function(r){return h.isValid(r)?parseInt(r,10):void 0},h.getPenaltyN1=function(r){const n=r.size;let u=0,o=0,c=0,g=null,v=null;for(let p=0;p<n;p++){o=c=0,g=v=null;for(let e=0;e<n;e++){let s=r.get(p,e);s===g?o++:(o>=5&&(u+=a.N1+(o-5)),g=s,o=1),s=r.get(e,p),s===v?c++:(c>=5&&(u+=a.N1+(c-5)),v=s,c=1)}o>=5&&(u+=a.N1+(o-5)),c>=5&&(u+=a.N1+(c-5))}return u},h.getPenaltyN2=function(r){const n=r.size;let u=0;for(let o=0;o<n-1;o++)for(let c=0;c<n-1;c++){const g=r.get(o,c)+r.get(o,c+1)+r.get(o+1,c)+r.get(o+1,c+1);(g===4||g===0)&&u++}return u*a.N2},h.getPenaltyN3=function(r){const n=r.size;let u=0,o=0,c=0;for(let g=0;g<n;g++){o=c=0;for(let v=0;v<n;v++)o=o<<1&2047|r.get(g,v),v>=10&&(o===1488||o===93)&&u++,c=c<<1&2047|r.get(v,g),v>=10&&(c===1488||c===93)&&u++}return u*a.N3},h.getPenaltyN4=function(r){let n=0;const u=r.data.length;for(let c=0;c<u;c++)n+=r.data[c];return Math.abs(Math.ceil(n*100/u/5)-10)*a.N4};function t(i,r,n){switch(i){case h.Patterns.PATTERN000:return(r+n)%2==0;case h.Patterns.PATTERN001:return r%2==0;case h.Patterns.PATTERN010:return n%3==0;case h.Patterns.PATTERN011:return(r+n)%3==0;case h.Patterns.PATTERN100:return(Math.floor(r/2)+Math.floor(n/3))%2==0;case h.Patterns.PATTERN101:return r*n%2+r*n%3==0;case h.Patterns.PATTERN110:return(r*n%2+r*n%3)%2==0;case h.Patterns.PATTERN111:return(r*n%3+(r+n)%2)%2==0;default:throw new Error("bad maskPattern:"+i)}}h.applyMask=function(r,n){const u=n.size;for(let o=0;o<u;o++)for(let c=0;c<u;c++)n.isReserved(c,o)||n.xor(c,o,t(r,c,o))},h.getBestMask=function(r,n){const u=Object.keys(h.Patterns).length;let o=0,c=1/0;for(let g=0;g<u;g++){n(g),h.applyMask(g,r);const v=h.getPenaltyN1(r)+h.getPenaltyN2(r)+h.getPenaltyN3(r)+h.getPenaltyN4(r);h.applyMask(g,r),v<c&&(c=v,o=g)}return o}})(cu);var aa={};const pr=na,sa=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],oa=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];aa.getBlocksCount=function(a,t){switch(t){case pr.L:return sa[(a-1)*4+0];case pr.M:return sa[(a-1)*4+1];case pr.Q:return sa[(a-1)*4+2];case pr.H:return sa[(a-1)*4+3];default:return}};aa.getTotalCodewordsCount=function(a,t){switch(t){case pr.L:return oa[(a-1)*4+0];case pr.M:return oa[(a-1)*4+1];case pr.Q:return oa[(a-1)*4+2];case pr.H:return oa[(a-1)*4+3];default:return}};var du={},la={};const kn=new Uint8Array(512),ua=new Uint8Array(256);(function(){let a=1;for(let t=0;t<255;t++)kn[t]=a,ua[a]=t,a<<=1,a&256&&(a^=285);for(let t=255;t<512;t++)kn[t]=kn[t-255]})();la.log=function(a){if(a<1)throw new Error("log("+a+")");return ua[a]};la.exp=function(a){return kn[a]};la.mul=function(a,t){return a===0||t===0?0:kn[ua[a]+ua[t]]};(function(h){const a=la;h.mul=function(i,r){const n=new Uint8Array(i.length+r.length-1);for(let u=0;u<i.length;u++)for(let o=0;o<r.length;o++)n[u+o]^=a.mul(i[u],r[o]);return n},h.mod=function(i,r){let n=new Uint8Array(i);for(;n.length-r.length>=0;){const u=n[0];for(let c=0;c<r.length;c++)n[c]^=a.mul(r[c],u);let o=0;for(;o<n.length&&n[o]===0;)o++;n=n.slice(o)}return n},h.generateECPolynomial=function(i){let r=new Uint8Array([1]);for(let n=0;n<i;n++)r=h.mul(r,new Uint8Array([1,a.exp(n)]));return r}})(du);const hu=du;function us(h){this.genPoly=void 0,this.degree=h,this.degree&&this.initialize(this.degree)}us.prototype.initialize=function(a){this.degree=a,this.genPoly=hu.generateECPolynomial(this.degree)};us.prototype.encode=function(a){if(!this.genPoly)throw new Error("Encoder not initialized");const t=new Uint8Array(a.length+this.degree);t.set(a);const i=hu.mod(t,this.genPoly),r=this.degree-i.length;if(r>0){const n=new Uint8Array(this.degree);return n.set(i,r),n}return i};var Pp=us,pu={},gr={},fs={};fs.isValid=function(a){return!isNaN(a)&&a>=1&&a<=40};var Bi={};const gu="[0-9]+",Fp="[A-Z $%*+\\-./:]+";let An="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";An=An.replace(/u/g,"\\u");const Bp="(?:(?![A-Z0-9 $%*+\\-./:]|"+An+`)(?:.|[\r
]))+`;Bi.KANJI=new RegExp(An,"g");Bi.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");Bi.BYTE=new RegExp(Bp,"g");Bi.NUMERIC=new RegExp(gu,"g");Bi.ALPHANUMERIC=new RegExp(Fp,"g");const Op=new RegExp("^"+An+"$"),Ip=new RegExp("^"+gu+"$"),Mp=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");Bi.testKanji=function(a){return Op.test(a)};Bi.testNumeric=function(a){return Ip.test(a)};Bi.testAlphanumeric=function(a){return Mp.test(a)};(function(h){const a=fs,t=Bi;h.NUMERIC={id:"Numeric",bit:1<<0,ccBits:[10,12,14]},h.ALPHANUMERIC={id:"Alphanumeric",bit:1<<1,ccBits:[9,11,13]},h.BYTE={id:"Byte",bit:1<<2,ccBits:[8,16,16]},h.KANJI={id:"Kanji",bit:1<<3,ccBits:[8,10,12]},h.MIXED={bit:-1},h.getCharCountIndicator=function(n,u){if(!n.ccBits)throw new Error("Invalid mode: "+n);if(!a.isValid(u))throw new Error("Invalid version: "+u);return u>=1&&u<10?n.ccBits[0]:u<27?n.ccBits[1]:n.ccBits[2]},h.getBestModeForData=function(n){return t.testNumeric(n)?h.NUMERIC:t.testAlphanumeric(n)?h.ALPHANUMERIC:t.testKanji(n)?h.KANJI:h.BYTE},h.toString=function(n){if(n&&n.id)return n.id;throw new Error("Invalid mode")},h.isValid=function(n){return n&&n.bit&&n.ccBits};function i(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"numeric":return h.NUMERIC;case"alphanumeric":return h.ALPHANUMERIC;case"kanji":return h.KANJI;case"byte":return h.BYTE;default:throw new Error("Unknown mode: "+r)}}h.from=function(n,u){if(h.isValid(n))return n;try{return i(n)}catch(o){return u}}})(gr);(function(h){const a=fi,t=aa,i=na,r=gr,n=fs,u=1<<12|1<<11|1<<10|1<<9|1<<8|1<<5|1<<2|1<<0,o=a.getBCHDigit(u);function c(e,s,l){for(let f=1;f<=40;f++)if(s<=h.getCapacity(f,l,e))return f}function g(e,s){return r.getCharCountIndicator(e,s)+4}function v(e,s){let l=0;return e.forEach(function(f){l+=g(f.mode,s)+f.getBitsLength()}),l}function p(e,s){for(let l=1;l<=40;l++)if(v(e,l)<=h.getCapacity(l,s,r.MIXED))return l}h.from=function(s,l){return n.isValid(s)?parseInt(s,10):l},h.getCapacity=function(s,l,f){if(!n.isValid(s))throw new Error("Invalid QR Code version");typeof f=="undefined"&&(f=r.BYTE);const d=a.getSymbolTotalCodewords(s),y=t.getTotalCodewordsCount(s,l),m=(d-y)*8;if(f===r.MIXED)return m;const _=m-g(f,s);switch(f){case r.NUMERIC:return Math.floor(_/10*3);case r.ALPHANUMERIC:return Math.floor(_/11*2);case r.KANJI:return Math.floor(_/13);case r.BYTE:default:return Math.floor(_/8)}},h.getBestVersionForData=function(s,l){let f;const d=i.from(l,i.M);if(Array.isArray(s)){if(s.length>1)return p(s,d);if(s.length===0)return 1;f=s[0]}else f=s;return c(f.mode,f.getLength(),d)},h.getEncodedBits=function(s){if(!n.isValid(s)||s<7)throw new Error("Invalid QR Code version");let l=s<<12;for(;a.getBCHDigit(l)-o>=0;)l^=u<<a.getBCHDigit(l)-o;return s<<12|l}})(pu);var vu={};const cs=fi,yu=1<<10|1<<8|1<<5|1<<4|1<<2|1<<1|1<<0,Np=1<<14|1<<12|1<<10|1<<4|1<<1,mu=cs.getBCHDigit(yu);vu.getEncodedBits=function(a,t){const i=a.bit<<3|t;let r=i<<10;for(;cs.getBCHDigit(r)-mu>=0;)r^=yu<<cs.getBCHDigit(r)-mu;return(i<<10|r)^Np};var _u={};const zp=gr;function Zr(h){this.mode=zp.NUMERIC,this.data=h.toString()}Zr.getBitsLength=function(a){return 10*Math.floor(a/3)+(a%3?a%3*3+1:0)};Zr.prototype.getLength=function(){return this.data.length};Zr.prototype.getBitsLength=function(){return Zr.getBitsLength(this.data.length)};Zr.prototype.write=function(a){let t,i,r;for(t=0;t+3<=this.data.length;t+=3)i=this.data.substr(t,3),r=parseInt(i,10),a.put(r,10);const n=this.data.length-t;n>0&&(i=this.data.substr(t),r=parseInt(i,10),a.put(r,n*3+1))};var Vp=Zr;const Hp=gr,ds=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function Jr(h){this.mode=Hp.ALPHANUMERIC,this.data=h}Jr.getBitsLength=function(a){return 11*Math.floor(a/2)+6*(a%2)};Jr.prototype.getLength=function(){return this.data.length};Jr.prototype.getBitsLength=function(){return Jr.getBitsLength(this.data.length)};Jr.prototype.write=function(a){let t;for(t=0;t+2<=this.data.length;t+=2){let i=ds.indexOf(this.data[t])*45;i+=ds.indexOf(this.data[t+1]),a.put(i,11)}this.data.length%2&&a.put(ds.indexOf(this.data[t]),6)};var jp=Jr,Gp=function(a){for(var t=[],i=a.length,r=0;r<i;r++){var n=a.charCodeAt(r);if(n>=55296&&n<=56319&&i>r+1){var u=a.charCodeAt(r+1);u>=56320&&u<=57343&&(n=(n-55296)*1024+u-56320+65536,r+=1)}if(n<128){t.push(n);continue}if(n<2048){t.push(n>>6|192),t.push(n&63|128);continue}if(n<55296||n>=57344&&n<65536){t.push(n>>12|224),t.push(n>>6&63|128),t.push(n&63|128);continue}if(n>=65536&&n<=1114111){t.push(n>>18|240),t.push(n>>12&63|128),t.push(n>>6&63|128),t.push(n&63|128);continue}t.push(239,191,189)}return new Uint8Array(t).buffer};const $p=Gp,Wp=gr;function Qr(h){this.mode=Wp.BYTE,typeof h=="string"&&(h=$p(h)),this.data=new Uint8Array(h)}Qr.getBitsLength=function(a){return a*8};Qr.prototype.getLength=function(){return this.data.length};Qr.prototype.getBitsLength=function(){return Qr.getBitsLength(this.data.length)};Qr.prototype.write=function(h){for(let a=0,t=this.data.length;a<t;a++)h.put(this.data[a],8)};var Yp=Qr;const Xp=gr,Kp=fi;function en(h){this.mode=Xp.KANJI,this.data=h}en.getBitsLength=function(a){return a*13};en.prototype.getLength=function(){return this.data.length};en.prototype.getBitsLength=function(){return en.getBitsLength(this.data.length)};en.prototype.write=function(h){let a;for(a=0;a<this.data.length;a++){let t=Kp.toSJIS(this.data[a]);if(t>=33088&&t<=40956)t-=33088;else if(t>=57408&&t<=60351)t-=49472;else throw new Error("Invalid SJIS character: "+this.data[a]+`
Make sure your charset is UTF-8`);t=(t>>>8&255)*192+(t&255),h.put(t,13)}};var qp=en,xu={exports:{}};(function(h){var a={single_source_shortest_paths:function(t,i,r){var n={},u={};u[i]=0;var o=a.PriorityQueue.make();o.push(i,0);for(var c,g,v,p,e,s,l,f,d;!o.empty();){c=o.pop(),g=c.value,p=c.cost,e=t[g]||{};for(v in e)e.hasOwnProperty(v)&&(s=e[v],l=p+s,f=u[v],d=typeof u[v]=="undefined",(d||f>l)&&(u[v]=l,o.push(v,l),n[v]=g))}if(typeof r!="undefined"&&typeof u[r]=="undefined"){var y=["Could not find a path from ",i," to ",r,"."].join("");throw new Error(y)}return n},extract_shortest_path_from_predecessor_list:function(t,i){for(var r=[],n=i;n;)r.push(n),n=t[n];return r.reverse(),r},find_path:function(t,i,r){var n=a.single_source_shortest_paths(t,i,r);return a.extract_shortest_path_from_predecessor_list(n,r)},PriorityQueue:{make:function(t){var i=a.PriorityQueue,r={},n;t=t||{};for(n in i)i.hasOwnProperty(n)&&(r[n]=i[n]);return r.queue=[],r.sorter=t.sorter||i.default_sorter,r},default_sorter:function(t,i){return t.cost-i.cost},push:function(t,i){var r={value:t,cost:i};this.queue.push(r),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};h.exports=a})(xu);(function(h){const a=gr,t=Vp,i=jp,r=Yp,n=qp,u=Bi,o=fi,c=xu.exports;function g(y){return unescape(encodeURIComponent(y)).length}function v(y,m,_){const E=[];let w;for(;(w=y.exec(_))!==null;)E.push({data:w[0],index:w.index,mode:m,length:w[0].length});return E}function p(y){const m=v(u.NUMERIC,a.NUMERIC,y),_=v(u.ALPHANUMERIC,a.ALPHANUMERIC,y);let E,w;return o.isKanjiModeEnabled()?(E=v(u.BYTE,a.BYTE,y),w=v(u.KANJI,a.KANJI,y)):(E=v(u.BYTE_KANJI,a.BYTE,y),w=[]),m.concat(_,E,w).sort(function(x,S){return x.index-S.index}).map(function(x){return{data:x.data,mode:x.mode,length:x.length}})}function e(y,m){switch(m){case a.NUMERIC:return t.getBitsLength(y);case a.ALPHANUMERIC:return i.getBitsLength(y);case a.KANJI:return n.getBitsLength(y);case a.BYTE:return r.getBitsLength(y)}}function s(y){return y.reduce(function(m,_){const E=m.length-1>=0?m[m.length-1]:null;return E&&E.mode===_.mode?(m[m.length-1].data+=_.data,m):(m.push(_),m)},[])}function l(y){const m=[];for(let _=0;_<y.length;_++){const E=y[_];switch(E.mode){case a.NUMERIC:m.push([E,{data:E.data,mode:a.ALPHANUMERIC,length:E.length},{data:E.data,mode:a.BYTE,length:E.length}]);break;case a.ALPHANUMERIC:m.push([E,{data:E.data,mode:a.BYTE,length:E.length}]);break;case a.KANJI:m.push([E,{data:E.data,mode:a.BYTE,length:g(E.data)}]);break;case a.BYTE:m.push([{data:E.data,mode:a.BYTE,length:g(E.data)}])}}return m}function f(y,m){const _={},E={start:{}};let w=["start"];for(let k=0;k<y.length;k++){const x=y[k],S=[];for(let P=0;P<x.length;P++){const U=x[P],R=""+k+P;S.push(R),_[R]={node:U,lastCount:0},E[R]={};for(let C=0;C<w.length;C++){const A=w[C];_[A]&&_[A].node.mode===U.mode?(E[A][R]=e(_[A].lastCount+U.length,U.mode)-e(_[A].lastCount,U.mode),_[A].lastCount+=U.length):(_[A]&&(_[A].lastCount=U.length),E[A][R]=e(U.length,U.mode)+4+a.getCharCountIndicator(U.mode,m))}}w=S}for(let k=0;k<w.length;k++)E[w[k]].end=0;return{map:E,table:_}}function d(y,m){let _;const E=a.getBestModeForData(y);if(_=a.from(m,E),_!==a.BYTE&&_.bit<E.bit)throw new Error('"'+y+'" cannot be encoded with mode '+a.toString(_)+`.
 Suggested mode is: `+a.toString(E));switch(_===a.KANJI&&!o.isKanjiModeEnabled()&&(_=a.BYTE),_){case a.NUMERIC:return new t(y);case a.ALPHANUMERIC:return new i(y);case a.KANJI:return new n(y);case a.BYTE:return new r(y)}}h.fromArray=function(m){return m.reduce(function(_,E){return typeof E=="string"?_.push(d(E,null)):E.data&&_.push(d(E.data,E.mode)),_},[])},h.fromString=function(m,_){const E=p(m,o.isKanjiModeEnabled()),w=l(E),k=f(w,_),x=c.find_path(k.map,"start","end"),S=[];for(let P=1;P<x.length-1;P++)S.push(k.table[x[P]].node);return h.fromArray(s(S))},h.rawSplit=function(m){return h.fromArray(p(m,o.isKanjiModeEnabled()))}})(_u);const fa=fi,hs=na,Zp=Rp,Jp=Up,Qp=lu,eg=uu,ps=cu,gs=aa,tg=Pp,ca=pu,ig=vu,rg=gr,vs=_u;function ng(h,a){const t=h.size,i=eg.getPositions(a);for(let r=0;r<i.length;r++){const n=i[r][0],u=i[r][1];for(let o=-1;o<=7;o++)if(!(n+o<=-1||t<=n+o))for(let c=-1;c<=7;c++)u+c<=-1||t<=u+c||(o>=0&&o<=6&&(c===0||c===6)||c>=0&&c<=6&&(o===0||o===6)||o>=2&&o<=4&&c>=2&&c<=4?h.set(n+o,u+c,!0,!0):h.set(n+o,u+c,!1,!0))}}function ag(h){const a=h.size;for(let t=8;t<a-8;t++){const i=t%2==0;h.set(t,6,i,!0),h.set(6,t,i,!0)}}function sg(h,a){const t=Qp.getPositions(a);for(let i=0;i<t.length;i++){const r=t[i][0],n=t[i][1];for(let u=-2;u<=2;u++)for(let o=-2;o<=2;o++)u===-2||u===2||o===-2||o===2||u===0&&o===0?h.set(r+u,n+o,!0,!0):h.set(r+u,n+o,!1,!0)}}function og(h,a){const t=h.size,i=ca.getEncodedBits(a);let r,n,u;for(let o=0;o<18;o++)r=Math.floor(o/3),n=o%3+t-8-3,u=(i>>o&1)==1,h.set(r,n,u,!0),h.set(n,r,u,!0)}function ys(h,a,t){const i=h.size,r=ig.getEncodedBits(a,t);let n,u;for(n=0;n<15;n++)u=(r>>n&1)==1,n<6?h.set(n,8,u,!0):n<8?h.set(n+1,8,u,!0):h.set(i-15+n,8,u,!0),n<8?h.set(8,i-n-1,u,!0):n<9?h.set(8,15-n-1+1,u,!0):h.set(8,15-n-1,u,!0);h.set(i-8,8,1,!0)}function lg(h,a){const t=h.size;let i=-1,r=t-1,n=7,u=0;for(let o=t-1;o>0;o-=2)for(o===6&&o--;;){for(let c=0;c<2;c++)if(!h.isReserved(r,o-c)){let g=!1;u<a.length&&(g=(a[u]>>>n&1)==1),h.set(r,o-c,g),n--,n===-1&&(u++,n=7)}if(r+=i,r<0||t<=r){r-=i,i=-i;break}}}function ug(h,a,t){const i=new Zp;t.forEach(function(c){i.put(c.mode.bit,4),i.put(c.getLength(),rg.getCharCountIndicator(c.mode,h)),c.write(i)});const r=fa.getSymbolTotalCodewords(h),n=gs.getTotalCodewordsCount(h,a),u=(r-n)*8;for(i.getLengthInBits()+4<=u&&i.put(0,4);i.getLengthInBits()%8!=0;)i.putBit(0);const o=(u-i.getLengthInBits())/8;for(let c=0;c<o;c++)i.put(c%2?17:236,8);return fg(i,h,a)}function fg(h,a,t){const i=fa.getSymbolTotalCodewords(a),r=gs.getTotalCodewordsCount(a,t),n=i-r,u=gs.getBlocksCount(a,t),o=i%u,c=u-o,g=Math.floor(i/u),v=Math.floor(n/u),p=v+1,e=g-v,s=new tg(e);let l=0;const f=new Array(u),d=new Array(u);let y=0;const m=new Uint8Array(h.buffer);for(let x=0;x<u;x++){const S=x<c?v:p;f[x]=m.slice(l,l+S),d[x]=s.encode(f[x]),l+=S,y=Math.max(y,S)}const _=new Uint8Array(i);let E=0,w,k;for(w=0;w<y;w++)for(k=0;k<u;k++)w<f[k].length&&(_[E++]=f[k][w]);for(w=0;w<e;w++)for(k=0;k<u;k++)_[E++]=d[k][w];return _}function cg(h,a,t,i){let r;if(Array.isArray(h))r=vs.fromArray(h);else if(typeof h=="string"){let g=a;if(!g){const v=vs.rawSplit(h);g=ca.getBestVersionForData(v,t)}r=vs.fromString(h,g||40)}else throw new Error("Invalid data");const n=ca.getBestVersionForData(r,t);if(!n)throw new Error("The amount of data is too big to be stored in a QR Code");if(!a)a=n;else if(a<n)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+n+`.
`);const u=ug(a,t,r),o=fa.getSymbolSize(a),c=new Jp(o);return ng(c,a),ag(c),sg(c,a),ys(c,t,0),a>=7&&og(c,a),lg(c,u),isNaN(i)&&(i=ps.getBestMask(c,ys.bind(null,c,t))),ps.applyMask(i,c),ys(c,t,i),{modules:c,version:a,errorCorrectionLevel:t,maskPattern:i,segments:r}}su.create=function(a,t){if(typeof a=="undefined"||a==="")throw new Error("No input text");let i=hs.M,r,n;return typeof t!="undefined"&&(i=hs.from(t.errorCorrectionLevel,hs.M),r=ca.from(t.version),n=ps.from(t.maskPattern),t.toSJISFunc&&fa.setToSJISFunction(t.toSJISFunc)),cg(a,r,i,n)};var Eu={},ms={};(function(h){function a(t){if(typeof t=="number"&&(t=t.toString()),typeof t!="string")throw new Error("Color should be defined as hex string");let i=t.slice().replace("#","").split("");if(i.length<3||i.length===5||i.length>8)throw new Error("Invalid hex color: "+t);(i.length===3||i.length===4)&&(i=Array.prototype.concat.apply([],i.map(function(n){return[n,n]}))),i.length===6&&i.push("F","F");const r=parseInt(i.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:r&255,hex:"#"+i.slice(0,6).join("")}}h.getOptions=function(i){i||(i={}),i.color||(i.color={});const r=typeof i.margin=="undefined"||i.margin===null||i.margin<0?4:i.margin,n=i.width&&i.width>=21?i.width:void 0,u=i.scale||4;return{width:n,scale:n?4:u,margin:r,color:{dark:a(i.color.dark||"#000000ff"),light:a(i.color.light||"#ffffffff")},type:i.type,rendererOpts:i.rendererOpts||{}}},h.getScale=function(i,r){return r.width&&r.width>=i+r.margin*2?r.width/(i+r.margin*2):r.scale},h.getImageWidth=function(i,r){const n=h.getScale(i,r);return Math.floor((i+r.margin*2)*n)},h.qrToImageData=function(i,r,n){const u=r.modules.size,o=r.modules.data,c=h.getScale(u,n),g=Math.floor((u+n.margin*2)*c),v=n.margin*c,p=[n.color.light,n.color.dark];for(let e=0;e<g;e++)for(let s=0;s<g;s++){let l=(e*g+s)*4,f=n.color.light;if(e>=v&&s>=v&&e<g-v&&s<g-v){const d=Math.floor((e-v)/c),y=Math.floor((s-v)/c);f=p[o[d*u+y]?1:0]}i[l++]=f.r,i[l++]=f.g,i[l++]=f.b,i[l]=f.a}}})(ms);(function(h){const a=ms;function t(r,n,u){r.clearRect(0,0,n.width,n.height),n.style||(n.style={}),n.height=u,n.width=u,n.style.height=u+"px",n.style.width=u+"px"}function i(){try{return document.createElement("canvas")}catch(r){throw new Error("You need to specify a canvas element")}}h.render=function(n,u,o){let c=o,g=u;typeof c=="undefined"&&(!u||!u.getContext)&&(c=u,u=void 0),u||(g=i()),c=a.getOptions(c);const v=a.getImageWidth(n.modules.size,c),p=g.getContext("2d"),e=p.createImageData(v,v);return a.qrToImageData(e.data,n,c),t(p,g,v),p.putImageData(e,0,0),g},h.renderToDataURL=function(n,u,o){let c=o;typeof c=="undefined"&&(!u||!u.getContext)&&(c=u,u=void 0),c||(c={});const g=h.render(n,u,c),v=c.type||"image/png",p=c.rendererOpts||{};return g.toDataURL(v,p.quality)}})(Eu);var bu={};const dg=ms;function wu(h,a){const t=h.a/255,i=a+'="'+h.hex+'"';return t<1?i+" "+a+'-opacity="'+t.toFixed(2).slice(1)+'"':i}function _s(h,a,t){let i=h+a;return typeof t!="undefined"&&(i+=" "+t),i}function hg(h,a,t){let i="",r=0,n=!1,u=0;for(let o=0;o<h.length;o++){const c=Math.floor(o%a),g=Math.floor(o/a);!c&&!n&&(n=!0),h[o]?(u++,o>0&&c>0&&h[o-1]||(i+=n?_s("M",c+t,.5+g+t):_s("m",r,0),r=0,n=!1),c+1<a&&h[o+1]||(i+=_s("h",u),u=0)):r++}return i}bu.render=function(a,t,i){const r=dg.getOptions(t),n=a.modules.size,u=a.modules.data,o=n+r.margin*2,c=r.color.light.a?"<path "+wu(r.color.light,"fill")+' d="M0 0h'+o+"v"+o+'H0z"/>':"",g="<path "+wu(r.color.dark,"stroke")+' d="'+hg(u,n,r.margin)+'"/>',v='viewBox="0 0 '+o+" "+o+'"',p=r.width?'width="'+r.width+'" height="'+r.width+'" ':"",e='<svg xmlns="http://www.w3.org/2000/svg" '+p+v+' shape-rendering="crispEdges">'+c+g+`</svg>
`;return typeof i=="function"&&i(null,e),e};const pg=Cp,xs=su,Tu=Eu,gg=bu;function Es(h,a,t,i,r){const n=[].slice.call(arguments,1),u=n.length,o=typeof n[u-1]=="function";if(!o&&!pg())throw new Error("Callback required as last argument");if(o){if(u<2)throw new Error("Too few arguments provided");u===2?(r=t,t=a,a=i=void 0):u===3&&(a.getContext&&typeof r=="undefined"?(r=i,i=void 0):(r=i,i=t,t=a,a=void 0))}else{if(u<1)throw new Error("Too few arguments provided");return u===1?(t=a,a=i=void 0):u===2&&!a.getContext&&(i=t,t=a,a=void 0),new Promise(function(c,g){try{const v=xs.create(t,i);c(h(v,a,i))}catch(v){g(v)}})}try{const c=xs.create(t,i);r(null,h(c,a,i))}catch(c){r(c)}}Tn.create=xs.create;Tn.toCanvas=Es.bind(null,Tu.render);Tn.toDataURL=Es.bind(null,Tu.renderToDataURL);Tn.toString=Es.bind(null,function(h,a,t){return gg.render(h,t)});function vg({listParam:h,currentList:a,currentListTitle:t,currentFolderList:i,addFolderToCollect:r,getListByCollect:n,addSongToCollect:u}){const o=$e({url:""}),c=$e(!1),g=$e(null);return{addFormData:o,isshowAddModal:c,addFieldRef:g,openAddModal:()=>oe(this,null,function*(){o.value={url:""},c.value=!0,yield gn(),g.value.focus()}),beforeCloseAddModal:e=>oe(this,null,function*(){if(e==="confirm"){let s=o.value;if(!s.url)return Oe({message:"\u8BF7\u8F93\u5165",position:"top"}),!1;let l=s.url.match(/(http|https):\/\/[A-Za-z0-9_\-\+.:?&@=/%#,;]*/g);if(!l)return Oe({message:"\u65E0\u6548\u8F93\u5165",position:"top"}),!1;l=Array.from(new Set(l));let f=l[0];if(f.startsWith("https://v.douyin.com")&&(f=yield Et.getRedirectInfo(f)),f.startsWith("https://www.douyin.com/user")||f.startsWith("https://www.iesdouyin.com/share/user")){let _=f.match(/user\/([^?\/]*)/);if(_)try{let E=_[1],w=yield ei.getUserInfo({sec_uid:E});yield r(t.value,{vsongFolderId:`dyAwemeFolder_${E}`,vsongFolderType:"dyAwemeFolder",title:w.name,sec_uid:E});let{folderList:k}=yield n(h.value);return i.value=k,!0}catch(E){return Oe({message:E.message,position:"top"}),!1}}f.startsWith("https://b23.tv/")&&(f=yield kt.parseShortUrl(f));let d=f.match(/video\/([^?\/]*)/);if(!d)return Oe({message:"\u5B58\u5728\u65E0\u6CD5\u89E3\u6790\u7684\u94FE\u63A5",position:"top"}),!1;let y=d[1];if(a.value.find(_=>_.bvid===y))return Oe({message:"\u5DF2\u5B58\u5728\u76F8\u540C\u8D44\u6E90",position:"top"}),!1;let m=`https://www.bilibili.com/video/${y}/`;try{yield u(t.value,m);let{songList:_}=yield n(h.value);a.value=_}catch(_){return!1}}return!0})}}function yg(){eo("$axios");const h=()=>oe(this,null,function*(){return{bilibiliUser:null,alipanUser:null}}),a=$e(!1),t=$e({bilibiliUser:null,alipanUser:null,playVideoInfo:null});return{isshowPersonalMgModal:a,personalMgModalInfo:t,openPersonalMgModal:()=>oe(this,null,function*(){let r=yield h();t.value.bilibiliUser=r.bilibiliUser,t.value.alipanUser=r.alipanUser;let n=Array.from(document.querySelectorAll("video")).find(u=>!u.paused);n?t.value.playVideoInfo={videoWidth:n.videoWidth,videoHeight:n.videoHeight}:t.value.playVideoInfo=null,a.value=!0})}}function mg({collectList:h,archiveList:a,listType:t,listParam:i}){const r=La(),n=$e({name:void 0}),u=$e(!1);let o=$e({isEdit:!1,orgName:void 0});return{addCollectFormData:n,isshowAddCollectModal:u,addCollectModalInfo:o,openAddCollectModal:v=>{n.value={name:v},o.value.isEdit=!!v,o.value.orgName=v,u.value=!0},beforeCloseAddCollectModal:v=>oe(this,null,function*(){if(v==="confirm"){let p=n.value.name;if(!p)return Oe({message:"\u8BF7\u8F93\u5165",position:"top"}),!1;if(o.value.isEdit){if(h.value.filter(l=>l!=o.value.orgName).includes(p))return Oe({message:"\u5DF2\u5B58\u5728\u76F8\u540C\u6536\u85CF\u5217\u8868",position:"top"}),!1;let e=yield lt.getVsongData(),s={};if(Object.keys(e.collect).forEach(l=>{l==o.value.orgName?s[p]=e.collect[l]:s[l]=e.collect[l]}),e.collect=s,a.value.includes(o.value.orgName)){let l=e.archive.find(d=>d.name=="\u5F52\u6863"),f=l.list.findIndex(d=>d.name==o.value.orgName);f>=0&&(l.list[f].name=p,a.value=l.list.map(d=>d.name))}yield lt.setVsongData(e),h.value=Object.keys(e.collect),t.value=="collect"&&i.value==o.value.orgName&&r.replace({path:"/home",query:{ltype:"collect",lparam:p}})}else{if(h.value.includes(p))return Oe({message:"\u5DF2\u5B58\u5728\u76F8\u540C\u6536\u85CF\u5217\u8868",position:"top"}),!1;let e=yield lt.getVsongData();e.collect[p]=[],yield lt.setVsongData(e),h.value.push(p)}}return!0})}}function _g({listType:h,alipanlistParams:a,listAlipanParam:t}){const i=La(),r=$e({keyword:""}),n=$e(!1),u=$e(null),o=()=>oe(this,null,function*(){h.value=="alipan"&&(r.value.keyword=a.value.keyword),n.value=!0,yield gn(),u.value.focus()}),c=v=>oe(this,null,function*(){if(v==="confirm"){let p=r.value.keyword;p||(p=""),h.value=="alipan"&&(t.value.keyword==p||(p?t.value.keyword?i.replace({path:"/home",query:{ltype:"alipan",lparam:`${t.value.folderId},${p}`}}):i.push({path:"/home",query:{ltype:"alipan",lparam:`${t.value.folderId},${p}`}}):i.back()))}return!0});return{keywordFormData:r,isshowKeywordModal:n,keywordFieldRef:u,openKeywordModal:o,beforeCloseKeywordModal:c,submitKeywordModal:()=>oe(this,null,function*(){n.value=!(yield c("confirm"))})}}function xg({loopMode:h,showVideo:a,proxyUrl:t}){const i=$e({loopMode:h.value,showVideo:a.value,proxyUrl:t.value}),r=$e(!1);return{psetFormData:i,isshowPsetModal:r,openPsetModal:()=>{i.value={loopMode:h.value,showVideo:a.value,proxyUrl:t.value},r.value=!0},beforeClosePsetModal:o=>oe(this,null,function*(){return o==="confirm"&&(h.value=i.value.loopMode,a.value=i.value.showVideo,t.value=i.value.proxyUrl,yield lt.saveSettings({loopMode:h.value,showVideo:a.value,proxyUrl:t.value})),!0})}}function Eg({pauseAudio:h}){let a=null;const t=$e({afterTime:void 0}),i=$e(!1);return{clockFormData:t,isshowClockModal:i,openClockModal:()=>{t.value={afterTime:void 0},i.value=!0},beforeCloseClockModal:u=>oe(this,null,function*(){return u==="confirm"&&(a&&clearTimeout(a),t.value.afterTime?(Oe({message:`\u5C06\u5728${t.value.afterTime}\u5206\u949F\u540E\u5173\u95ED`,position:"top"}),a=setTimeout(()=>{h(),location.replace("./close.html")},parseInt(t.value.afterTime)*6e4)):Oe({message:"\u5DF2\u53D6\u6D88\u5B9A\u65F6\u5173\u95ED",position:"top"})),!0})}}function bg(){const h=$e({}),a=$e(!1),t=$e({type:"",qrcode:"",key:"",bindSuccessCb:null}),i=(o,c)=>oe(this,null,function*(){h.value={},t.value.type=o,t.value.qrcode="",t.value.bindSuccessCb=c,a.value=!0;let g;if(o=="alipan")g=yield lt.getAxios().get("/vsong/alipan-qrcode");else if(o=="bilibili")g=yield lt.getAxios().get("/vsong/bilibili-qrcode");else throw new Error("unknow type!");t.value.key=g.data.key,t.value.qrcode=yield Tn.toDataURL(g.data.codeContent,{margin:0}),n=!0,u()}),r=o=>oe(this,null,function*(){return n=!1,!0});let n=!1;const u=()=>oe(this,null,function*(){let o;if(t.value.type=="alipan"?o=yield lt.getAxios().post("/vsong/try-bind-alipan",{key:t.value.key}):t.value.type=="bilibili"&&(o=yield lt.getAxios().post("/vsong/try-bind-bilibili",{key:t.value.key})),!!n){if(o.data.status=="expired"){n=!1,a.value=!1;return}else if(o.data.status=="success"){n=!1,a.value=!1,t.value.bindSuccessCb();return}setTimeout(()=>{!n||u()},1e3)}});return{bindQrcodeFormData:h,isshowBindQrcodeModal:a,bindQrcodeModalInfo:t,openBindQrcodeModal:i,beforeCloseBindQrcodeModal:r}}Zs("data-v-54feb97a");const wg={class:"listbar"},Tg={class:"listbar-num",tabxxindexxx:"1"},Sg={class:"listbar-action"},kg=Ye("div",{class:"listitem-idx"},"F",-1),Ag={class:"listitem-info"},Cg=["onClick","onKeydown"],Dg=Ye("div",{class:"listitem-idx"},"F",-1),Rg={class:"listitem-info"},Ug=["onClick","onKeydown"],Lg=Ye("div",{class:"listitem-idx"},"F",-1),Pg={class:"listitem-info"},Fg=["onClick","onKeydown"],Bg={class:"listitem-idx"},Og={class:"listitem-info"},Ig=["onClick","onKeydown"],Mg=Ye("div",null,null,-1),Ng=["onClick","onKeydown"],zg={key:0,class:"listitem-info-t2",style:{"margin-left":"12px",cursor:"default"}},Vg={key:1,class:"listitem-info-t2",style:{"margin-left":"12px",cursor:"default"}},Hg={class:"playbar"},jg=["src"],Gg={class:"playbar-title"},$g=Ye("div",{class:"playbar-button"},null,-1),Wg={key:0},Yg={class:"action-sheet-title"},Xg={class:"action-sheet-title-t1"},Kg={class:"action-sheet-item"},qg=Ye("div",{class:"action-sheet-item-title"},"\u52A0\u5165\u6536\u85CF",-1),Zg=Ye("div",{class:"action-sheet-item-title"},"\u79FB\u51FA\u6536\u85CF",-1),Jg={key:1},Qg={class:"action-sheet-title"},ev={class:"action-sheet-title-t1"},tv=Ye("div",{class:"action-sheet-item-title"},"\u79FB\u51FA\u5F52\u6863",-1),iv={key:2},rv={class:"action-sheet-title"},nv={class:"action-sheet-title-t1"},av=Ye("div",{class:"action-sheet-item-title"},"\u524D\u5F80\u5408\u96C6",-1),sv=Ye("div",{class:"action-sheet-item-title"},"\u524D\u5F80\u6E90\u7AD9",-1),ov={class:"action-sheet-item"},lv=Ye("div",{class:"action-sheet-item-title"},"\u52A0\u5165\u6536\u85CF",-1),uv=Ye("div",{class:"action-sheet-item-title"},"\u79FB\u51FA\u6536\u85CF",-1),fv=Ye("div",{class:"action-sheet-item-title"},"\u91CD\u65B0\u7F13\u5B58",-1),cv=Ye("div",{class:"action-sheet-item-title"},"\u7F13\u5B58\u8D44\u6E90",-1),dv=Ye("div",{class:"action-sheet-item-title"},"\u5220\u9664\u7F13\u5B58",-1),hv=Ye("div",{class:"action-sheet-item-title"},"\u590D\u5236\u4FE1\u606F",-1),pv={class:"list-action-sheet-box hide-scrollbar"},gv=["onClick"],vv={class:"action-sheet-item-idx"},yv={class:"action-sheet-item-title"},mv=["src"],_v=Ye("div",null,"\u5206\u949F\u540E\u5173\u95ED",-1),xv={style:{display:"flex","flex-flow":"column nowarp",width:"80%",margin:"0.5em auto"}},Ev=Yi("\u626B\u7801\u7ED1\u5B9A"),bv=Yi("\u89E3\u9664\u7ED1\u5B9A"),wv={key:0},Tv={key:1},Sv=Yi("\u626B\u7801\u7ED1\u5B9A"),kv=Yi("\u89E3\u9664\u7ED1\u5B9A"),Av={key:0},Cv={key:1},Dv=Yi("\u9000\u51FA\u767B\u5F55"),Rv={key:0},Uv=Ye("div",{style:{height:"0.5em"}},null,-1),Lv=["posterxxx"],Pv={key:0,class:"full-screen-tabactions"};Js();var Fv=Qs({setup(h){const a=eo("$axios"),t=La(),i=Zu(),r=Ju();let n=$e(i.query.ltype||"collect"),u=$e(i.query.lparam||"\u559C\u6B22\u7684\u97F3\u4E50"),o=$e({folderId:"",keyword:""}),c=$e({folderId:""}),g=$e({upmidList:[],dysecuidList:[]});const v=()=>[n.value,u.value];kr.setAxios(a),mi.setAxios(a),kt.setAxios(a),lt.setAxios(a),mn.setAxios(hn.create());const p=$e(location.search.includes("ossmg"));$e(location.search.includes("d=tv")).value&&document.body.classList.add("device-tv");const s=(N,re=null)=>oe(this,null,function*(){re||(re=yield lt.getVsongData());let ie=[],ue=[];return re.collect[N]&&re.collect[N].forEach(ye=>{ye.vsongFolderType?ue.push(ye):ie.push(ye)}),{songList:ie,folderList:ue}}),l=(N=null)=>oe(this,null,function*(){return N||(N=yield lt.getVsongData()),N.archive.find(ie=>ie.name=="\u5F52\u6863").list.map(ie=>ie.name)}),f=()=>K.value.filter(N=>!Ee.value.includes(N)),d=N=>oe(this,null,function*(){yield br.confirm({title:"\u63D0\u793A",message:"\u786E\u5B9A\u8981\u5C06\u8BE5\u6536\u85CF\u5F52\u6863\u5417\uFF1F",beforeClose:re=>oe(this,null,function*(){if(re==="cancel")return!0;try{let ie=yield lt.getVsongData(),ue=ie.archive.find(ye=>ye.name=="\u5F52\u6863");if(ue.list.some(ye=>ye.name==N))throw new Error("\u8BE5\u6536\u85CF\u5DF2\u7ECF\u5F52\u6863");return ue.list.push({name:N,list:[]}),yield lt.setVsongData(ie),Ee.value=ue.list.map(ye=>ye.name),Oe({message:"\u5F52\u6863\u6210\u529F",position:"top"}),!0}catch(ie){return Oe({message:ie.message,position:"top"}),!1}})})}),y=N=>oe(this,null,function*(){yield br.confirm({title:"\u63D0\u793A",message:"\u786E\u5B9A\u8981\u5C06\u8BE5\u6536\u85CF\u53D6\u6D88\u5F52\u6863\u5417\uFF1F",beforeClose:re=>oe(this,null,function*(){if(re==="cancel")return!0;try{let ie=yield lt.getVsongData(),ue=ie.archive.find(pe=>pe.name=="\u5F52\u6863"),ye=ue.list.findIndex(pe=>pe.name==N);if(ye==-1)throw new Error("\u8BE5\u6536\u85CF\u672A\u5F52\u6863");return ue.list.splice(ye,1),yield lt.setVsongData(ie),Ee.value=ue.list.map(pe=>pe.name),Oe({message:"\u53D6\u6D88\u6210\u529F",position:"top"}),n.value==="archive"&&(et.value.isShow=!1,R.value=Ee.value.map(pe=>({title:pe,name:pe}))),!0}catch(ie){return Oe({message:ie.message,position:"top"}),!1}})})}),m=N=>{let re={};if(N.vsongType==="biAweme")re={bvid:N.bvid,mid:N.mid};else if(N.vsongType==="dyAweme")re={sec_uid:N.sec_uid,aweme_id:N.aweme_id,min_cursor:N.min_cursor};else if(N.vsongType==="alipanAweme")re={fileId:N.fileId,parentId:N.parentId,category:N.category,mime_type:N.mime_type,audio_code_name:N.audio_code_name,video_code_name:N.video_code_name};else if(N.vsongType==="alistAweme")re={fileId:N.fileId,filePath:N.filePath,category:N.category,fileType:N.fileType,parentPath:N.parentPath};else if(N.vsongType==="localAweme")throw new Error("\u672C\u5730\u89C6\u9891\u6682\u4E0D\u652F\u6301\u6536\u85CF");return Ti({vsongId:N.vsongId,vsongType:N.vsongType,author:N.author,title:N.title,coverUrl:N.coverUrl,originUrl:N.originUrl},re)},_=N=>{let re={};return N.vsongFolderType==="biAwemeFolder"?re={mid:N.mid}:N.vsongFolderType==="dyAwemeFolder"?re={sec_uid:N.sec_uid}:N.vsongFolderType==="alipanAwemeFolder"?re={folderId:N.folderId}:N.vsongFolderType==="alistAwemeFolder"&&(re={folderId:N.folderId,folderPath:N.folderPath}),Ti({vsongFolderId:N.vsongFolderId,vsongFolderType:N.vsongFolderType,title:N.title},re)},E=(N,re)=>oe(this,null,function*(){let ie;if(typeof re=="string"?ie=(yield kt.parseUrl(re)).vsongItem:ie=re,ie.vsongType=="dyAweme"&&ie.min_cursor==0)throw new Error("\u6682\u65F6\u65E0\u6CD5\u6DFB\u52A0\u8BE5\u9879\u8FDB\u5165\u6536\u85CF");if(ie.vsongType=="localAweme")throw new Error("\u6682\u65F6\u65E0\u6CD5\u6DFB\u52A0\u8BE5\u9879\u8FDB\u5165\u6536\u85CF");let ue=yield lt.getVsongData();if(ue.collect[N]||(ue.collect[N]=[]),ue.collect[N].find(ye=>ye.vsongId==ie.vsongId))throw new Error("\u5DF2\u5B58\u5728\u76F8\u540C\u8D44\u6E90");ue.collect[N].push(m(ie)),yield lt.setVsongData(ue)}),w=(N,re)=>oe(this,null,function*(){let ie=yield lt.getVsongData();ie.collect[N]||(ie.collect[N]=[]);let ue=ie.collect[N].findIndex(pe=>pe.vsongId===re);if(ue==-1){Oe({message:"\u6B4C\u66F2\u4E0D\u5B58\u5728",position:"top"});return}ie.collect[N].splice(ue,1),yield lt.setVsongData(ie),Oe({message:"\u5DF2\u79FB\u51FA",position:"top"});let{songList:ye}=yield s(N,ie);U.value=ye,et.value.isShow=!1}),k=(N,re)=>oe(this,null,function*(){let ie=yield lt.getVsongData();if(ie.collect[N]||(ie.collect[N]=[]),ie.collect[N].find(ue=>ue.vsongFolderId==re.vsongFolderId))throw new Error("\u5DF2\u5B58\u5728\u76F8\u540C\u8D44\u6E90");ie.collect[N].push(_(re)),yield lt.setVsongData(ie)}),x=(N,re)=>oe(this,null,function*(){let ie=yield lt.getVsongData();ie.collect[N]||(ie.collect[N]=[]);let ue=ie.collect[N].findIndex(pe=>pe.vsongFolderId===re);if(ue==-1){Oe({message:"\u76EE\u5F55\u4E0D\u5B58\u5728",position:"top"});return}ie.collect[N].splice(ue,1),yield lt.setVsongData(ie),Oe({message:"\u5DF2\u79FB\u51FA",position:"top"});let{folderList:ye}=yield s(N,ie);R.value=ye,et.value.isShow=!1}),S=$e(null),P=$e(""),U=$e([]),R=$e([]),C=$e([]),A=$e({}),b=$e("random"),O=$e(!0);let W=$e(""),K=$e([]);const G=$e({order:"pubdate",page:1,count:50,forceRefresh:!1,isPageEnd:!1}),B=$e({order:"pubdate",max_cursor:"",count:50,forceRefresh:!1,isPageEnd:!1}),j=$e({nextMarker:"",keyword:"",forceRefresh:!1,isPageEnd:!1}),z=$e({nextMarker:"",forceRefresh:!1,isPageEnd:!1}),$=$e({page:1,count:250,forceRefresh:!1,isPageEnd:!1}),J=$e({order:"author"});let Q=[],ne={},Ee=$e([]);const we=kp(),Ae=we.sheet,{rangeInputFormData:De,isshowRangeInputModal:Ve,openRangeInputModal:Ce,beforeCloseRangeInputModal:Me}=Sp(),{addFormData:Ge,isshowAddModal:D,addFieldRef:fe,openAddModal:ae,beforeCloseAddModal:X}=vg({listParam:u,currentList:U,currentListTitle:P,currentFolderList:R,addFolderToCollect:k,addSongToCollect:E,getListByCollect:s}),{isshowPersonalMgModal:H,personalMgModalInfo:q,openPersonalMgModal:ce}=yg(),{addCollectFormData:he,isshowAddCollectModal:te,addCollectModalInfo:Te,openAddCollectModal:Le,beforeCloseAddCollectModal:Se}=mg({archiveList:Ee,collectList:K,listType:n,listParam:u}),{keywordFormData:ze,isshowKeywordModal:Xe,keywordFieldRef:it,openKeywordModal:Je,beforeCloseKeywordModal:Ft,submitKeywordModal:yt}=_g({listType:n,alipanlistParams:j,listAlipanParam:o}),{psetFormData:Bt,isshowPsetModal:ot,openPsetModal:Ci,beforeClosePsetModal:Nt}=xg({loopMode:b,showVideo:O,proxyUrl:W}),Wt=[{label:"\u968F\u673A\u64AD\u653E",key:"random"},{label:"\u5217\u8868\u5FAA\u73AF",key:"listloop"},{label:"\u5355\u66F2\u5FAA\u73AF",key:"oneloop"},{label:"\u5217\u8868\u64AD\u653E",key:"listplay"}],{clockFormData:Di,isshowClockModal:ci,openClockModal:vr,beforeCloseClockModal:yr}=Eg({pauseAudio:()=>Rt}),{bindQrcodeFormData:Ji,isshowBindQrcodeModal:Kt,bindQrcodeModalInfo:qt,openBindQrcodeModal:Oi,beforeCloseBindQrcodeModal:Qi}=bg(),Fr=$e(null),er=$e(null);Qu(()=>{pt.bind(ni.value,ai.value);var N=new Li.exports.Manager(Fr.value),re=new Li.exports.Pinch({event:"pinch",pointers:2}),ie=new Li.exports.Swipe({event:"swipe",pointers:1,direction:Li.exports.DIRECTION_ALL}),ue=new Li.exports.Tap({event:"doubleTap",pointers:1,taps:2,interval:600}),ye=new Li.exports.Press({event:"press",time:600});N.add([ie,ue,ye,re]),N.on("swipeleft",function(Ne){if(document.fullscreenElement){we.open(U.value);return}S.value&&M("song",S.value)}),N.on("swiperight",function(Ne){if(document.fullscreenElement){we.open(U.value);return}hi()}),N.on("swipeup",function(Ne){pt.playNextAduio()}),N.on("swipedown",function(Ne){try{pt.playPrevAudio()}catch(At){Oe({message:At.message,position:"top"})}}),N.on("doubleTap",function(Ne){!S.value||(S.value.isPlay?Rt():gi())}),N.on("press",function(Ne){document.pictureInPictureElement?document.exitPictureInPicture():ni.value.paused?ai.value.querySelector("video").paused||ai.value.querySelector("video").requestPictureInPicture():ni.value.requestPictureInPicture()});let pe=1,_e=1,ge=1,Pe=0,ke=0;N.on("pinchstart",function(Ne){ge=_e,ke=Pe}),N.on("pinch",function(Ne){let At=Ne.scale;_e=ge*At,_e<pe&&(_e=pe),Pe=ke+Ne.deltaX*.2,_e==pe&&(Pe=0),ni.value.style.transform=`scale(${_e}) translateX(${Pe}%)`}),N.on("pinchend",function(Ne){});var vt=new Li.exports.Manager(er.value),Ze=new Li.exports.Swipe({event:"swipe",pointers:1,direction:Li.exports.DIRECTION_HORIZONTAL});vt.add([Ze]),vt.on("swipeleft",function(Ne){hi()}),vt.on("swiperight",function(Ne){Gi.value.show=!0}),window.addEventListener("keydown",function(Ne){let At=Ne.target.nodeName.toLowerCase();if(!(At=="input"||At=="textarea"))if(Ne.keyCode==219)try{pt.playPrevAudio()}catch(Qt){Oe({message:Qt.message,position:"top"})}else Ne.keyCode==221?pt.playNextAduio():Ne.keyCode==32?(S.value&&!S.value.isPlay?gi():S.value&&S.value.isPlay&&Rt(),Ne.preventDefault()):Ne.keyCode==39||Ne.keyCode==37||Ne.keyCode==38||Ne.keyCode==40})});let Ii=!1,Br=0;const mr=N=>{gt.value.scrollTop==0?(Ii=!0,Br=N.touches[0].clientY):Ii=!1},xi=N=>{let{clientY:re}=N.touches[0];Ii&&gt.value.scrollTop==0&&re>Br&&N.preventDefault()};let ri=!1;const wt=N=>oe(this,null,function*(){!mt.value||ri||gt.value.scrollHeight-gt.value.clientHeight-gt.value.scrollTop>=gt.value.clientHeight||(ri=!0,yield Ei(),ri=!1)});let tr=!1;const ir=()=>oe(this,null,function*(){if(tr)return;if(rr().isPageEnd){Oe({message:"\u6CA1\u6709\u66F4\u591A\u6570\u636E\u4E86",position:"top"});return}tr=!0;let N=Oe.loading({message:"\u52A0\u8F7D\u4E2D...",forbidClick:!0,duration:0});yield Ei(),setTimeout(()=>{N.clear()}),tr=!1}),Ei=()=>oe(this,null,function*(){var N,re,ie,ue;if(n.value==="up"&&!G.value.isPageEnd){G.value.page+=1;let ye=yield kt.getAwemeList({mid:u.value},G.value);U.value=U.value.concat(ye),ye.length==0&&(G.value.isPageEnd=!0)}else if(n.value==="dy"&&!B.value.isPageEnd){let ye=yield ei.getAwemeList({sec_uid:u.value},B.value);U.value=U.value.concat(ye),dt(),ye.length==0&&(B.value.isPageEnd=!0)}else if(n.value==="alipan"&&!j.value.isPageEnd&&!o.value.keyword)try{let ye=yield kr.getAwemeList({folderId:o.value.folderId},j.value);U.value=U.value.concat(ye.awemeList),R.value=R.value.concat(ye.folderList)}catch(ye){((re=(N=ye==null?void 0:ye.response)==null?void 0:N.data)==null?void 0:re.msg)=="AlipanNoBind"&&Oe({message:"\u672A\u7ED1\u5B9A\u963F\u91CC\u4E91\u76D8",position:"top",duration:3e3})}else if(n.value==="alipan_open"&&!z.value.isPageEnd)try{let ye=yield mi.getAwemeList({folderId:c.value.folderId},z.value);U.value=U.value.concat(ye.awemeList),R.value=R.value.concat(ye.folderList)}catch(ye){((ue=(ie=ye==null?void 0:ye.response)==null?void 0:ie.data)==null?void 0:ue.msg)=="AlipanOpenNoBind"&&Oe({message:"\u672A\u7ED1\u5B9A\u963F\u91CC\u4E91\u76D8Open",position:"top",duration:3e3})}else if(n.value==="release"){g.value.upmidList.forEach(_e=>{_e.listParams.isPageEnd||(_e.listParams.page+=1)});let ye=yield Promise.all([].concat(g.value.upmidList.filter(_e=>!_e.isPageEnd).map(_e=>kt.getAwemeList(_e.listQuery,_e.listParams)),g.value.dysecuidList.filter(_e=>!_e.isPageEnd).map(_e=>ei.getAwemeList(_e.listQuery,_e.listParams)))),pe=[].concat(...ye).sort((_e,ge)=>_e.created<ge.created?1:-1);U.value=U.value.concat(pe)}else if(n.value==="alist"&&!$.value.isPageEnd)try{$.value.page+=1;let ye=yield mn.getAwemeList({path:u.value},$.value);U.value=U.value.concat(ye.awemeList),R.value=R.value.concat(ye.folderList),ye.awemeList.length+ye.folderList.length==0&&($.value.isPageEnd=!0)}catch(ye){Oe({message:ye.message,position:"top",duration:3e3})}}),rr=()=>n.value==="up"?{has:!0,isPageEnd:G.value.isPageEnd}:n.value==="dy"?{has:!0,isPageEnd:B.value.isPageEnd}:n.value==="alipan"&&!o.value.keyword?{has:!0,isPageEnd:j.value.isPageEnd}:n.value==="alipan_open"?{has:!0,isPageEnd:z.value.isPageEnd}:n.value==="release"?{has:!0,isPageEnd:!1}:n.value==="alist"?{has:!0,isPageEnd:$.value.isPageEnd}:{has:!1,isPageEnd:!0},Or=N=>oe(this,null,function*(){if(N.vsongType=="alipanAweme"&&N.category=="video"&&!kr.isSupportMime(N.mime_type,N.audio_code_name,N.video_code_name)){Oe({message:`\u6682\u4E0D\u652F\u6301\u7F13\u5B58\u6B64\u683C\u5F0F(${N.mime_type})`,position:"top",duration:3e3});return}et.value.isShow=!1,Oe({message:"\u6B63\u5728\u7F13\u5B58\u4E2D",position:"top"});let re=Date.now();yield st.addRow("vsong_cache",Hn(Ti({create_time:re},m(N)),{cacheStatus:"waiting"})),Ot()}),Mi=N=>oe(this,null,function*(){et.value.isShow=!1,Oe({message:"\u6B63\u5728\u7F13\u5B58\u4E2D",position:"top"});let re=yield st.getOneByIndex("vsong_cache","vsongId",N.vsongId);re.cacheStatus="waiting",yield st.updateRow("vsong_cache",re),Ot()}),Ni=N=>oe(this,null,function*(){let[re,ie,ue]=yield Promise.all([st.getOneByIndex("vsong_audio","vsongId",N.vsongId),st.getOneByIndex("vsong_video","vsongId",N.vsongId),st.getOneByIndex("vsong_cover","vsongId",N.vsongId)]),ye=Q.find(_e=>_e.vsongId==N.vsongId),pe=[st.delRow("vsong_cache",ye.id)];re&&pe.push(st.delRow("vsong_audio",re.id)),ie&&pe.push(st.delRow("vsong_video",ie.id)),ue&&pe.push(st.delRow("vsong_cover",ue.id)),yield Promise.all(pe),et.value.isShow=!1,Ot()}),Ir=N=>oe(this,null,function*(){let re,ie,ue;if(N.vsongType=="biAweme"){let Ne=yield xt(N,{video:!0,audio:!0,cover:!0});re=Ne.audioUrl,ie=Ne.coverUrl,ue=Ne.videoUrl}else if(N.vsongType=="dyAweme"){let Ne=yield xt(N,{video:!0,cover:!0});ie=Ne.coverUrl,ue=Ne.videoUrl}else if(N.vsongType=="alipanAweme"){let Ne=yield xt(N,{video:!0,audio:!0});N.category=="video"?ue=Ne.videoUrl:N.category=="audio"&&(re=Ne.audioUrl),ie=Ne.coverUrl}else if(N.vsongType=="alistAweme"){let Ne=yield xt(N,{video:!0,audio:!0});N.category=="video"?ue=Ne.videoUrl:N.category=="audio"&&(re=Ne.audioUrl),ie=Ne.coverUrl}const ye=()=>oe(this,null,function*(){if(!re)return null;console.log(`[${new Date().toLocaleString()}] \u5F00\u59CB\u4E0B\u8F7D\u97F3\u9891\u8D44\u6E90`);let Ne=yield Jt(re).get(re,{headers:{Range:"bytes=0-"},responseType:"arraybuffer"});return console.log(`[${new Date().toLocaleString()}] \u7ED3\u675F\u4E0B\u8F7D\u97F3\u9891\u8D44\u6E90 `),Ne.data}),pe=()=>oe(this,null,function*(){if(!ie)return null;console.log(`[${new Date().toLocaleString()}] \u5F00\u59CB\u4E0B\u8F7D\u5C01\u9762\u8D44\u6E90`);try{let Ne=yield Jt(ie).get(ie,{responseType:"arraybuffer",noErrorToast:!0});return console.log(`[${new Date().toLocaleString()}] \u7ED3\u675F\u4E0B\u8F7D\u5C01\u9762\u8D44\u6E90 `),Ne.data}catch(Ne){return console.log(`[${new Date().toLocaleString()}] \u5931\u8D25\u4E0B\u8F7D\u5C01\u9762\u8D44\u6E90 `),null}}),_e=()=>oe(this,null,function*(){if(!ue)return null;console.log(`[${new Date().toLocaleString()}] \u5F00\u59CB\u4E0B\u8F7D\u89C6\u9891\u8D44\u6E90`);let Ne=yield Jt(ue).get(ue,{headers:{Range:"bytes=0-"},responseType:"arraybuffer"});return console.log(`[${new Date().toLocaleString()}] \u7ED3\u675F\u4E0B\u8F7D\u89C6\u9891\u8D44\u6E90 `),Ne.data});let[ge,Pe,ke]=yield Promise.all([ye(),_e(),pe()]);if(!Q.find(Ne=>Ne.vsongId==N.vsongId))throw console.log("\u7F13\u5B58\u53EF\u80FD\u88AB\u5220\u9664\uFF0C\u53D6\u6D88\u5B58\u5165\u64CD\u4F5C\uFF01"),new Error("\u7F13\u5B58\u53EF\u80FD\u88AB\u5220\u9664\uFF0C\u53D6\u6D88\u5B58\u5165\u64CD\u4F5C\uFF01");let vt=Date.now();console.log(`[${new Date().toLocaleString()}] \u5F00\u59CB\u5B58\u5165indexDb`);let Ze=[];ge&&Ze.push(st.addRow("vsong_audio",{create_time:vt,vsongId:N.vsongId,arraybuffer:ge})),Pe&&Ze.push(st.addRow("vsong_video",{create_time:vt,vsongId:N.vsongId,arraybuffer:Pe})),ke&&Ze.push(st.addRow("vsong_cover",{create_time:vt,vsongId:N.vsongId,arraybuffer:ke})),yield Promise.all(Ze),console.log(`[${new Date().toLocaleString()}] \u7ED3\u675F\u5B58\u5165indexDb`)}),_r={waiting:"\u7B49\u5F85\u7F13\u5B58",cacheing:"\u7F13\u5B58\u4E2D",succeed:"\u5DF2\u7F13\u5B58",failed:"\u7F13\u5B58\u5931\u8D25"};let nr=!1;const Zt=()=>oe(this,null,function*(){if(nr)return;nr=!0;let N=yield st.getAll("vsong_cache");yield Promise.all(N.filter(ie=>ie.cacheStatus=="cacheing").map(ie=>oe(this,null,function*(){ie.cacheStatus="failed",yield st.updateRow("vsong_cache",ie)})));const re=()=>oe(this,null,function*(){let ue=(yield st.getAll("vsong_cache")).filter(pe=>pe.cacheStatus=="waiting");if(ue.length>0){let pe=ue[0];pe.cacheStatus="cacheing",yield st.updateRow("vsong_cache",pe),Ot();try{yield Ir(pe),pe.cacheStatus="succeed",yield st.updateRow("vsong_cache",pe)}catch(_e){if(!Q.find(ge=>ge.vsongId==pe.vsongId)){console.log("\u7F13\u5B58\u53EF\u80FD\u88AB\u5220\u9664\uFF0C\u53D6\u6D88\u5B58\u5165\u64CD\u4F5C\uFF01");return}pe.cacheStatus="failed",yield st.updateRow("vsong_cache",pe),ef({type:"danger",message:`\u7F13\u5B58\u5931\u8D25\uFF1A${pe.title}`})}Ot()}let ye=3e3;return ue.length>1&&(ye=0),setTimeout(re,ye)});setTimeout(re,3e3)}),Ot=()=>oe(this,null,function*(){if(Q=yield st.getAll("vsong_cache"),Q.sort((N,re)=>N.create_time-re.create_time),ne={},Q.forEach(N=>{ne[N.author]||(ne[N.author]=[]),ne[N.author].push(N)}),n.value=="cache"){let re=u.value.split(",")[0],ie=[],ue=[];re?ie=ne[re]||[]:J.value.order=="time"?ie=Q:Object.keys(ne).forEach(ye=>{ne[ye].length>=10?ue.push({title:ye,parent:"",vsongFolderType:"cachelistFolder"}):ie.push(...ne[ye])}),U.value=ie,R.value=ue}else r.proxy.$forceUpdate()}),di=N=>!Q.find(ie=>ie.vsongId==N),bi=N=>{let re=Q.find(ie=>ie.vsongId==N);return re==null?void 0:re.cacheStatus},ni=$e(null),Mr=$e(null),zi=$e(null),ai=$e(null),xt=(pe,_e)=>oe(this,[pe,_e],function*(N,{video:re=!1,audio:ie=!1,cover:ue=!1,makeCross:ye=!0}){let ge={videoUrl:null,audioUrl:null,coverUrl:null},Pe=!1;if(re&&(ge.videoUrl=yield Ai.getMediaUrl(N.vsongId,"video"),ge.videoUrl||(Pe=!0)),ie&&(ge.audioUrl=yield Ai.getMediaUrl(N.vsongId,"audio"),ge.audioUrl||(Pe=!0)),ue&&(ge.coverUrl=yield Ai.getMediaUrl(N.vsongId,"cover"),ge.coverUrl||(Pe=!0)),!Pe)return ge;if(N.vsongType=="biAweme"){let ke=yield kt.getMediaUrl({url:N.originUrl});ye&&(ke.audioUrl&&(ke.audioUrl=kt.makeCrossUrl(ke.audioUrl,{cache:"max-age=86400"})),ke.videoUrl&&(ke.videoUrl=kt.makeCrossUrl(ke.videoUrl,{cache:"max-age=86400"})),ke.coverUrl&&(ke.coverUrl=kt.makeCrossUrl(ke.coverUrl,{cache:"max-age=86400"}))),ie&&!ge.audioUrl&&(ge.audioUrl=ke.audioUrl),re&&!ge.videoUrl&&(ge.videoUrl=ke.videoUrl),ue&&!ge.coverUrl&&(ge.coverUrl=ke.coverUrl)}else if(N.vsongType=="dyAweme"){let ke=yield ei.getMediaUrl({sec_uid:N.sec_uid,min_cursor:N.min_cursor,aweme_id:N.aweme_id});ye&&(ke.videoUrl&&(ke.videoUrl=ei.makeCrossUrl(ke.videoUrl,{cache:"max-age=86400"})),ke.coverUrl&&(ke.coverUrl=ei.makeCrossUrl(ke.coverUrl,{cache:"max-age=86400"}))),re&&!ge.videoUrl&&(ge.videoUrl=ke.videoUrl),ue&&!ge.coverUrl&&(ge.coverUrl=ke.coverUrl)}else if(N.vsongType=="alipanAweme"){let ke=yield mi.getMediaUrl({fileId:N.fileId,category:N.category,fileName:N.title,mime_type:N.mime_type,audio_code_name:N.audio_code_name,video_code_name:N.video_code_name});ke.coverUrl=N.coverUrl,ye&&(ke.videoUrl&&(ke.videoUrl.includes(".m3u8")?ke.videoUrl=mi.makeCrossM3u8(ke.videoUrl,{}):ke.videoUrl=mi.makeCrossUrl(ke.videoUrl,{})),ke.audioUrl&&(ke.audioUrl=mi.makeCrossUrl(ke.audioUrl,{withToken:!0})),ke.coverUrl&&(ke.coverUrl=mi.makeCrossUrl(ke.coverUrl,{}))),ie&&!ge.audioUrl&&ke.audioUrl&&(ge.audioUrl=ke.audioUrl),re&&!ge.videoUrl&&ke.videoUrl&&(ge.videoUrl=ke.videoUrl),ue&&!ge.coverUrl&&N.coverUrl&&(ge.coverUrl=ke.coverUrl)}else if(N.vsongType=="alistAweme"){let ke=yield mn.getMediaUrl({fileName:N.title,filePath:N.filePath,category:N.category});ke.coverUrl=N.coverUrl,ye&&ke.videoUrl&&ke.videoUrl.includes(".m3u8")&&(ke.videoUrl=mi.makeCrossM3u8(ke.videoUrl,{})),ie&&!ge.audioUrl&&ke.audioUrl&&(ge.audioUrl=ke.audioUrl),re&&!ge.videoUrl&&ke.videoUrl&&(ge.videoUrl=ke.videoUrl),ue&&!ge.coverUrl&&N.coverUrl&&(ge.coverUrl=ke.coverUrl)}return ge}),Jt=N=>Ai.isOssMediaUrl(N)?Ai.getAxios():Et.getAxios(),zt=N=>oe(this,null,function*(){let re=yield Jt(N).get(N,{responseType:"blob",noErrorToast:!0});return io(re.data)}),si=N=>oe(this,null,function*(){let re=Oe.loading({message:"\u590D\u5236\u4E2D...",forbidClick:!0,duration:0}),ie=m(N),ue={vsongItem:ie,mediaUrl:yield xt(ie,{video:!0,audio:!0,cover:!0,makeCross:!1})},ye;ie.vsongType=="biAweme"?ye=kt.makeCrossUrl:ie.vsongType=="dyAweme"?ye=ei.makeCrossUrl:ie.vsongType=="alipanAweme"?ye=mi.makeCrossUrl:ie.vsongType=="alistAweme"?ye=null:ie.vsongType=="alipanAweme"&&(ye=kr.makeCrossUrl),ue.mediaUrl.videoUrl&&!Ai.isOssMediaUrl(ue.mediaUrl.videoUrl)&&(ue.mediaUrl.videoUrl=ye(ue.mediaUrl.videoUrl,{cache:"max-age=3600",withToken:!0})),ue.mediaUrl.audioUrl&&!Ai.isOssMediaUrl(ue.mediaUrl.audioUrl)&&(ue.mediaUrl.audioUrl=ye(ue.mediaUrl.audioUrl,{cache:"max-age=3600",withToken:!0})),ue.mediaUrl.coverUrl&&!Ai.isOssMediaUrl(ue.mediaUrl.coverUrl)&&(ue.mediaUrl.coverUrl=ye(ue.mediaUrl.coverUrl,{cache:"max-age=3600",withToken:!0})),yield af(JSON.stringify(ue,null,2)),Oe({message:"\u5DF2\u590D\u5236",position:"top"}),setTimeout(()=>{re.clear()}),et.value.isShow=!1}),mt=$e(!0);let Tt=0;const gt=$e(null),hi=()=>{mt.value&&(Tt=gt.value.scrollTop),mt.value=!mt.value,mt.value&&gn(()=>gt.value.scrollTop=Tt)};let ar;li(()=>mt.value,()=>{document.fullscreenElement||(mt.value==!1?ar=ro(()=>{mt.value||hi()}):ar&&ar())}),li(()=>[G.value.order],()=>{Tt=0,gt.value.scrollTop=Tt});const pt=new bp;li(()=>b.value,()=>{pt.setLoopMode(b.value)},{immediate:!0}),li(()=>U.value,()=>{pt.setPlayList(U.value)},{immediate:!0}),li(()=>O.value,()=>{pt.setVideoShow(O.value)},{immediate:!0}),pt.setPlayHandler(N=>oe(this,null,function*(){let re=Q.filter(ie=>ie.cacheStatus=="succeed").find(ie=>ie.vsongId==N.vsongId);if(re){let ie=yield st.getOneByIndex("vsong_audio","vsongId",re.vsongId),ue=yield st.getOneByIndex("vsong_video","vsongId",re.vsongId);if(N.vsongType=="biAweme")return{type:"arraybuffer",data:{audio:ie.arraybuffer,video:ue.arraybuffer}};if(N.vsongType=="dyAweme")return{type:"arraybuffer",data:{audio:ue.arraybuffer,video:ue.arraybuffer}};if(N.vsongType=="alipanAweme"){if(N.category=="video")return{type:"arraybuffer",data:{audio:ue.arraybuffer,video:ue.arraybuffer}};if(N.category=="audio")return{type:"arraybuffer",data:{audio:ie.arraybuffer,video:null}}}else if(N.vsongType=="alistAweme"){if(N.category=="video")return{type:"arraybuffer",data:{audio:ue.arraybuffer,video:ue.arraybuffer}};if(N.category=="audio")return{type:"arraybuffer",data:{audio:ie.arraybuffer,video:null}}}}else if(N.vsongType=="biAweme"){let{audioUrl:ie,videoUrl:ue}=yield xt(N,{video:!0,audio:!0});return{type:"rangeurl",data:{audio:ie,video:ue}}}else if(N.vsongType=="dyAweme"){let{videoUrl:ie}=yield xt(N,{video:!0});return{type:"mixedurl",data:{url:ie}}}else if(N.vsongType=="alipanAweme"){let{audioUrl:ie,videoUrl:ue}=yield xt(N,{video:!0,audio:!0});if(N.category=="video"&&ue.includes(".m3u8"))return{type:"hlsurl",data:{url:ue}};if(N.category=="video")return{type:"mixedurl",data:{url:ue}};if(N.category=="audio")return{type:"url",data:{audio:ie,video:""}}}else if(N.vsongType=="alistAweme"){let{audioUrl:ie,videoUrl:ue}=yield xt(N,{video:!0,audio:!0});if(N.category=="video"&&ue.includes(".m3u8"))return{type:"hlsurl",data:{url:ue}};if(N.category=="video")return{type:"mixedurl",data:{url:ue}};if(N.category=="audio")return{type:"url",data:{audio:ie,video:""}}}else if(N.vsongType=="localAweme"){let ie=yield N.originFile.arrayBuffer();return{type:"arraybuffer",data:{audio:ie,video:ie}}}})),pt.setPlayInfoIdKey("vsongId"),pt.on("changePlayInfo",N=>oe(this,null,function*(){document.title=`VOSNG-${N.title}`;const re=r.proxy.$assets("/default_cover.png");S.value=Hn(Ti({},N),{isPlay:!0,crossCoverUrl:re});let ie=Q.filter(ue=>ue.cacheStatus=="succeed").find(ue=>ue.vsongId==N.vsongId);if(ie){let ue=yield st.getOneByIndex("vsong_cover","vsongId",ie.vsongId);ue&&(S.value.crossCoverUrl=yield io(new Blob([ue.arraybuffer])))}if(S.value.crossCoverUrl==re&&S.value.coverUrl){let ue="";S.value.vsongType=="biAweme"?ue=kt.makeCrossUrl(S.value.coverUrl,{}):S.value.vsongType=="dyAweme"?ue=ei.makeCrossUrl(S.value.coverUrl,{}):S.value.vsongType=="alipanAweme"?ue=mi.makeCrossUrl(S.value.coverUrl,{}):S.value.vsongType=="alipanAweme"&&(ue=kr.makeCrossUrl(S.value.coverUrl,{}));let ye=yield zt(ue);S.value.crossCoverUrl=ye}})),pt.on("timeupdate",({audioEl:N,setCurrentTimeRateing:re})=>{re||On(N.duration,N.currentTime)}),pt.on("play",()=>{S.value.isPlay=!0}),pt.on("pause",()=>{S.value.isPlay=!1});let Vt=!0;const Vi=()=>oe(this,null,function*(){var re,ie,ue,ye;let N;if(Vt){Vt=!1,yield Zt(),Q=yield st.getAll("vsong_cache"),Q.sort((_e,ge)=>_e.create_time-ge.create_time),ne={},Q.forEach(_e=>{ne[_e.author]||(ne[_e.author]=[]),ne[_e.author].push(_e)}),yield Et.init("",_e=>{pt.setAxios(Et.getAxios()),_e==="default"?(Oe({message:"\u5728\u7EBF\u6A21\u5F0F",position:"top"}),lt.setAxios(Et.getAxios()),kt.setAxios(Et.getAxios()),ei.setAxios(Et.getAxios()),Sr(!1)):_e==="failed"&&(Oe({message:"\u79BB\u7EBF\u6A21\u5F0F",position:"top"}),Sr(!0))}),Sr()===!1&&Ma()===!0&&(yield br.confirm({title:"\u5728\u7EBF\u540C\u6B65",teleport:"html",message:"\u68C0\u6D4B\u5230\u672C\u5730\u79BB\u7EBF\u6570\u636E\u53D1\u751F\u53D8\u66F4\uFF0C\u662F\u5426\u4FDD\u5B58\u8BE5\u53D8\u66F4\uFF1F",beforeClose:_e=>oe(this,null,function*(){return console.log(_e),_e==="cancel"||(yield lt.syncVsongData()),!0})}).catch(_e=>{}),Ma(!1));let pe=yield lt.getVsongData();K.value=Object.keys(pe.collect),b.value=pe.settings.loopMode,O.value=pe.settings.showVideo,W.value=pe.settings.proxyUrl,Ee.value=yield l(pe),mn.setConfig(pe.settings.alistConfig),N=Ai.init("http://192.168.3.116:11180/moss/vsong").then(()=>oe(this,null,function*(){const _e=yield lt.getOssList();let ge=[],Pe={};_e.forEach(ke=>{ge.push(ke.vsongId),Pe[ke.vsongType]||(Pe[ke.vsongType]={}),Pe[ke.vsongType][ke.author]||(Pe[ke.vsongType][ke.author]=[]),Pe[ke.vsongType][ke.author].push(ke)}),A.value=Pe,C.value=ge}))}if(n.value==="up")try{G.value.page=1,G.value.forceRefresh=!1,G.value.isPageEnd=!1;let[pe,_e]=yield Promise.all([kt.getUserInfo({mid:u.value}),kt.getAwemeList({mid:u.value},G.value)]);P.value=pe.name,U.value=_e,R.value=[]}catch(pe){P.value="\u4E00\u4E00",U.value=[],R.value=[],Oe({message:"\u9519\u8BEF",position:"top",duration:3e3})}else if(n.value==="collect"){let{songList:pe,folderList:_e}=yield s(u.value);P.value=u.value,U.value=pe,R.value=_e}else if(n.value==="cache"){let _e=u.value.split(",")[0],ge=[],Pe=[];_e?ge=ne[_e]||[]:J.value.order=="time"?ge=Q:Object.keys(ne).forEach(ke=>{ne[ke].length>=10?Pe.push({title:ke,parent:"",vsongFolderType:"cachelistFolder"}):ge.push(...ne[ke])}),P.value="\u7F13\u5B58\u7BA1\u7406"+(_e?`-${_e}`:""),U.value=ge,R.value=Pe}else if(n.value==="release"){let pe=[],_e=[],{songList:ge,folderList:Pe}=yield s(u.value);ge.forEach(Ze=>{Ze.vsongType=="biAweme"?pe.push(Ze.mid.toString()):Ze.vsongType=="dyAweme"&&_e.push(Ze.sec_uid)}),Pe.forEach(Ze=>{Ze.vsongFolderType=="biAwemeFolder"?pe.push(Ze.mid.toString()):Ze.vsongFolderType=="dyAwemeFolder"&&_e.push(Ze.sec_uid)}),pe=Array.from(new Set(pe)),_e=Array.from(new Set(_e)),pe=pe.map(Ze=>({listQuery:{mid:Ze},listParams:{page:1,order:"pubdate",count:3,forceRefresh:!1,isPageEnd:!1}})),_e=_e.map(Ze=>({listQuery:{sec_uid:Ze},listParams:{count:3,max_cursor:"",forceRefresh:!1,isPageEnd:!1}})),g.value.upmidList=pe,g.value.dysecuidList=_e;let ke=yield Promise.all([].concat(g.value.upmidList.map(Ze=>kt.getAwemeList(Ze.listQuery,Ze.listParams)),g.value.dysecuidList.map(Ze=>ei.getAwemeList(Ze.listQuery,Ze.listParams)))),vt=[].concat(...ke).sort((Ze,Ne)=>Ze.created<Ne.created?1:-1);P.value=`\u52A8\u6001-${u.value}`,U.value=vt,R.value=[]}else if(n.value!=="custom"){if(n.value==="dy"){B.value.order="pubdate",B.value.max_cursor="",B.value.forceRefresh=!1,B.value.isPageEnd=!1;let pe=yield ei.getUserInfo({sec_uid:u.value}),_e=yield ei.getAwemeList({sec_uid:u.value},B.value);P.value=pe.name,U.value=_e,R.value=[],dt()}else if(n.value==="alipan"){let pe=u.value.split(",");o.value.folderId=pe[0],o.value.keyword=pe[1],j.value.nextMarker="",j.value.keyword=o.value.keyword,j.value.forceRefresh=!1,j.value.isPageEnd=!1;let _e=[],ge=[];try{let Pe=yield kr.getAwemeList({folderId:o.value.folderId},j.value);_e=Pe.awemeList,ge=Pe.folderList}catch(Pe){((ie=(re=Pe==null?void 0:Pe.response)==null?void 0:re.data)==null?void 0:ie.msg)=="AlipanNoBind"&&Oe({message:"\u672A\u7ED1\u5B9A\u963F\u91CC\u4E91\u76D8",position:"top",duration:3e3})}P.value="\u963F\u91CC\u4E91\u76D8",U.value=_e,R.value=ge}else if(n.value==="alipan_open"){let pe=u.value.split(",");c.value.folderId=pe[0],z.value.nextMarker="",z.value.forceRefresh=!1,z.value.isPageEnd=!1;let _e=[],ge=[];try{let Pe=yield mi.getAwemeList({folderId:c.value.folderId},z.value);_e=Pe.awemeList,ge=Pe.folderList}catch(Pe){((ye=(ue=Pe==null?void 0:Pe.response)==null?void 0:ue.data)==null?void 0:ye.msg)=="AlipanOpenNoBind"&&Oe({message:"\u672A\u7ED1\u5B9A\u963F\u91CC\u4E91\u76D8Open",position:"top",duration:3e3})}P.value="\u963F\u91CC\u4E91\u76D8Open",U.value=_e,R.value=ge}else if(n.value==="bilipage")try{let{title:pe,list:_e}=yield kt.getPageList({bvid:u.value},{forceRefresh:!1});P.value=`\u5408\u96C6-${pe}`,U.value=_e,R.value=[]}catch(pe){P.value="\u5408\u96C6",U.value=[],R.value=[],Oe({message:"\u9519\u8BEF",position:"top",duration:3e3})}else if(n.value==="bilidyn"){let pe=yield kt.getDynamicList();P.value="B\u7AD9\u52A8\u6001",U.value=pe,R.value=[]}else if(n.value==="alist"){$.value.page=1,$.value.isPageEnd=!1;let pe=[],_e=[];try{let ge=yield mn.getAwemeList({path:u.value},$.value);pe=ge.awemeList,_e=ge.folderList}catch(ge){Oe({message:ge.message,position:"top",duration:3e3})}P.value="Alist",U.value=pe,R.value=_e}else if(n.value==="archive")P.value="\u5F52\u6863\u5217\u8868",U.value=[],R.value=Ee.value.map(pe=>({title:pe,name:pe}));else if(n.value==="local")P.value="\u672C\u5730\u5217\u8868",U.value=[],R.value=[];else if(n.value==="osslist"){yield N;let pe=u.value.split(","),_e=pe[0],ge=pe[1],Pe=[],ke=[];ge?Pe=A.value[_e][ge]:_e?ke=Object.keys(A.value[_e]).map(vt=>({title:vt,parent:_e,vsongFolderType:"osslistFolder"})):ke=Object.keys(A.value).map(vt=>({title:vt,parent:"",vsongFolderType:"osslistFolder"})),P.value="OSS\u5217\u8868",U.value=Pe,R.value=ke}}gn(()=>{history.state.listScrollTop?gt.value.scrollTop=history.state.listScrollTop:gt.value.scrollTop=0})});let Hi=null;const ji=()=>{Hi=ro(()=>{Oe({message:"\u518D\u6309\u4E00\u904D\u5173\u95ED",position:"top",duration:2e3}),setTimeout(()=>{history.state.back===null?ji():Hi=null},2e3)})};li(()=>i.query,()=>oe(this,null,function*(){console.log("route.query change",i.query);let N=i.query.ltype||"collect",re=i.query.lparam;N=="collect"&&!re&&(re="\u559C\u6B22\u7684\u97F3\u4E50"),n.value=N,u.value=re,history.state.back===null&&!Hi&&ji()}),{immediate:!0}),li(v,()=>oe(this,null,function*(){console.log(n.value,u.value),console.log("listType,listParam change",i.query),mt.value=!0;let N=Oe.loading({message:"\u52A0\u8F7D\u4E2D...",forbidClick:!0,duration:0});try{yield Vi()}catch(re){}setTimeout(()=>{N.clear()})}),{immediate:!0});const pi=N=>oe(this,null,function*(){if(history.replaceState(Hn(Ti({},history.state),{listScrollTop:gt.value.scrollTop}),""),console.log(N),N.vsongFolderType=="alipanAwemeFolder")t.push({path:"/home",query:{ltype:"alipan_open",lparam:`${N.folderId}`}});else if(N.vsongFolderType=="biAwemeFolder")t.push({path:"/home",query:{ltype:"up",lparam:`${N.mid}`}});else if(N.vsongFolderType=="dyAwemeFolder")t.push({path:"/home",query:{ltype:"dy",lparam:`${N.sec_uid}`}});else if(N.vsongFolderType=="alistAwemeFolder")t.push({path:"/home",query:{ltype:"alist",lparam:`${N.folderPath}`}});else if(N.vsongFolderType=="cachelistFolder")t.push({path:"/home",query:{ltype:"cache",lparam:`${N.title},`}});else if(N.vsongFolderType=="osslistFolder"){let re="",ie="";N.parent?(re=N.parent,ie=N.title):re=N.title,t.push({path:"/home",query:{ltype:"osslist",lparam:`${re},${ie}`}})}else N.vsongFolderType==null&&t.push({path:"/home",query:{ltype:"collect",lparam:N.name}})}),Ri=N=>oe(this,null,function*(){pt.selectToPlay(N),we.close()}),gi=()=>oe(this,null,function*(){pt.play()}),Rt=()=>oe(this,null,function*(){pt.pause()}),tn=()=>oe(this,null,function*(){S.value.isPlay?Rt():gi()}),xr=()=>oe(this,null,function*(){pt.playNextAduio()}),oi=()=>oe(this,null,function*(){pt.playPrevAudio()}),sr=()=>oe(this,null,function*(){vi.value+=5,vi.value>100&&(vi.value=100),Er()}),Ht=()=>oe(this,null,function*(){vi.value-=5,vi.value<0&&(vi.value=0),Er()}),et=$e({isShow:!1,type:"",data:null}),M=(N,re)=>{et.value.type=N,et.value.data=re,et.value.isShow=!0};li(v,()=>oe(this,null,function*(){et.value.isShow=!1}));const V=N=>{!N||window.open(N)},Z=N=>{t.push({path:"/home",query:{ltype:"bilipage",lparam:N}})},le=N=>{if(et.value.isShow=!1,N.vsongType=="biAweme"){if(n.value=="up"&&u.value==N.mid)return;t.push({path:"/home",query:{ltype:"up",lparam:N.mid}})}else if(N.vsongType=="dyAweme"){if(n.value=="dy"&&u.value==N.sec_uid)return;t.push({path:"/home",query:{ltype:"dy",lparam:N.sec_uid}})}else if(N.vsongType=="alipanAweme"){if(!N.parentId||n.value=="alipan_open"&&u.value==`${N.parentId}`)return;t.push({path:"/home",query:{ltype:"alipan_open",lparam:`${N.parentId}`}})}else if(N.vsongType=="alistAweme"){if(n.value=="alist"&&u.value==`${N.parentPath}`)return;t.push({path:"/home",query:{ltype:"alist",lparam:`${N.parentPath}`}})}else N.vsongType=="localAweme"},be=$e({isShow:!1,iframeUrl:""}),Ue=()=>oe(this,null,function*(){G.value.order=="pubdate"?G.value.order="click":G.value.order="pubdate",G.value.page=1,G.value.isPageEnd=!1;let N=yield kt.getAwemeList({mid:u.value},G.value);U.value=N}),tt=()=>oe(this,null,function*(){B.value.order=="pubdate"?B.value.order="digg":B.value.order="pubdate",dt()}),ut=()=>oe(this,null,function*(){J.value.order=="time"?J.value.order="author":J.value.order="time";let N=[],re=[];J.value.order=="time"?N=Q:Object.keys(ne).forEach(ie=>{ne[ie].length>=10?re.push({title:ie,parent:"",vsongFolderType:"cachelistFolder"}):N.push(...ne[ie])}),U.value=N,R.value=re}),dt=()=>{B.value.order=="pubdate"?U.value.sort((N,re)=>re.created-N.created):U.value.sort((N,re)=>re.digg_count-N.digg_count)},St=()=>oe(this,null,function*(){var re,ie,ue,ye;let N=Oe.loading({message:"\u52A0\u8F7D\u4E2D...",forbidClick:!0,duration:0});if(n.value=="up")G.value.page=1,G.value.forceRefresh=!0,G.value.isPageEnd=!1,U.value=yield kt.getAwemeList({mid:u.value},G.value);else if(n.value=="bilipage")U.value=(yield kt.getPageList({bvid:u.value},{forceRefresh:!0})).list;else if(n.value=="release"){g.value.upmidList.forEach(ge=>{ge.listParams.page=1,ge.listParam.forceRefresh=!0,ge.listParams.isPageEnd=!1}),g.value.dysecuidList.forEach(ge=>{ge.listParams.max_cursor="",ge.listParams.forceRefresh=!0,ge.listParams.isPageEnd=!1});let pe=yield Promise.all([].concat(g.value.upmidList.map(ge=>kt.getAwemeList(ge.listQuery,ge.listParams)),g.value.dysecuidList.map(ge=>ei.getAwemeList(ge.listQuery,ge.listParams)))),_e=[].concat(...pe).sort((ge,Pe)=>ge.created<Pe.created?1:-1);U.value=_e}else if(n.value=="dy")B.value.max_cursor="",B.value.forceRefresh=!0,B.value.isPageEnd=!1,U.value=yield ei.getAwemeList({sec_uid:u.value},B.value),dt();else if(n.value=="alipan"){j.value.nextMarker="",j.value.forceRefresh=!0,j.value.isPageEnd=!1;try{let pe=yield kr.getAwemeList({folderId:o.value.folderId},j.value);U.value=pe.awemeList,R.value=pe.folderList}catch(pe){((ie=(re=pe==null?void 0:pe.response)==null?void 0:re.data)==null?void 0:ie.msg)=="AlipanNoBind"&&Oe({message:"\u672A\u7ED1\u5B9A\u963F\u91CC\u4E91\u76D8",position:"top",duration:3e3})}}else if(n.value=="alipan_open"){z.value.nextMarker="",z.value.forceRefresh=!0,z.value.isPageEnd=!1;try{let pe=yield mi.getAwemeList({folderId:c.value.folderId},z.value);U.value=pe.awemeList,R.value=pe.folderList}catch(pe){((ye=(ue=pe==null?void 0:pe.response)==null?void 0:ue.data)==null?void 0:ye.msg)=="AlipanOpenNoBind"&&Oe({message:"\u672A\u7ED1\u5B9A\u963F\u91CC\u4E91\u76D8Open",position:"top",duration:3e3})}}N.clear()}),Ut=$e({show:!1,actions:[{text:"\u64AD\u653E\u8BBE\u7F6E",icon:"more-o",key:"playSetting"},{text:"\u5B9A\u65F6\u5173\u95ED",icon:"clock-o",key:"clockSetting"},{text:"\u4E2A\u4EBA\u4E2D\u5FC3",icon:"user-circle-o",key:"personalMg"}]}),rn=re=>oe(this,[re],function*({key:N}){N=="playSetting"?Ci():N=="clockSetting"?vr():N=="personalMg"&&ce()});li(v,()=>oe(this,null,function*(){Ut.value.show=!1}));const Gi=$e({show:!1,actions:[]}),nn=()=>{let N=[...f().map(re=>({text:re,key:re})),{text:"B\u7AD9\u52A8\u6001",key:"bilidynList",isNeedOnline:!0},{text:"\u963F\u91CC\u4E91\u76D8",key:"aliyunOpenList",isNeedOnline:!0},{text:"Alist",key:"alistList",isNeedOnline:!0},{text:"\u5F52\u6863\u5217\u8868",key:"archiveList"},{text:"\u672C\u5730\u89C6\u9891",key:"localList"},{text:"\u7F13\u5B58\u7BA1\u7406",key:"cacheList"},{text:"\u521B\u5EFA",key:"createCollect"}];Gi.value.actions=N.filter(re=>!(Sr()&&re.isNeedOnline))},Nr=({key:N})=>{if(N=="createCollect")Le();else if(N=="bilidynList")t.push({path:"/home",query:{ltype:"bilidyn",lparam:""}});else if(N=="aliyunList")t.push({path:"/home",query:{ltype:"alipan",lparam:","}});else if(N=="aliyunOpenList")t.push({path:"/home",query:{ltype:"alipan_open",lparam:","}});else if(N=="alistList")t.push({path:"/home",query:{ltype:"alist",lparam:""}});else if(N=="archiveList")t.push({path:"/home",query:{ltype:"archive"}});else if(N=="localList")t.push({path:"/home",query:{ltype:"local"}});else if(N=="cacheList"){if(n.value=="cache")return;n.value=="collect"?t.push({path:"/home",query:{ltype:"cache",lparam:","}}):t.push({path:"/home",query:{ltype:"cache",lparam:","}})}else{if(n.value=="collect"&&u.value==N)return;n.value=="collect"||n.value=="cache"?t.push({path:"/home",query:{ltype:"collect",lparam:N}}):t.push({path:"/home",query:{ltype:"collect",lparam:N}})}};li(v,()=>oe(this,null,function*(){Gi.value.show=!1}));const wi=$e({show:!1,actions:[...K.value.map(N=>({text:N,key:N}))]}),Cn=()=>{wi.value.actions=[...K.value.map(N=>({text:N,key:N,disabled:!1}))]},Dn=re=>oe(this,[re],function*({key:N}){try{console.log(et.value.data),et.value.type=="folder"?yield k(N,et.value.data):et.value.type=="song"&&(yield E(N,et.value.data)),et.value.isShow=!1,Oe({message:"\u5DF2\u52A0\u5165\u6536\u85CF",position:"top"})}catch(ie){Oe({message:ie.message,position:"top"})}});li(v,()=>oe(this,null,function*(){wi.value.show=!1}));const $i=$e({show:!1,actions:[]}),Rn=()=>{let N=[];n.value=="collect"?(N.push({text:"\u6700\u65B0\u52A8\u6001",key:"toNewRelease"}),u.value!=="\u559C\u6B22\u7684\u97F3\u4E50"&&(N.push({text:"\u91CD\u547D\u540D\u6536\u85CF",key:"renameCollect"},{text:"\u5220\u9664\u6536\u85CF",key:"deleteCollect"}),Ee.value.includes(u.value)?N.push({text:"\u53D6\u6D88\u5F52\u6863",key:"moveoutArchive"}):N.push({text:"\u5F52\u6863",key:"moveinArchive"})),N.push({text:"\u7F13\u5B58\u5217\u8868",key:"cacheCurrentList"})):n.value=="up"?N=[{text:"\u521B\u5EFA\u4E3A\u6536\u85CF",key:"uplistBeCollect"},{text:"\u5237\u65B0\u5217\u8868",key:"froceRefreshList"},{text:"\u7F13\u5B58\u5217\u8868",key:"cacheCurrentList"},{text:"\u66F4\u591A\u64CD\u4F5C",key:"showMoreAction"}]:n.value=="bilipage"?N=[{text:"\u521B\u5EFA\u4E3A\u6536\u85CF",key:"uplistBeCollect"},{text:"\u5237\u65B0\u5217\u8868",key:"froceRefreshList"},{text:"\u7F13\u5B58\u5217\u8868",key:"cacheCurrentList"}]:n.value=="bilidyn"?N=[{text:"\u7F13\u5B58\u5217\u8868",key:"cacheCurrentList"}]:n.value=="dy"?N=[{text:"\u521B\u5EFA\u4E3A\u6536\u85CF",key:"uplistBeCollect"},{text:"\u5237\u65B0\u5217\u8868",key:"froceRefreshList"},{text:"\u7F13\u5B58\u5217\u8868",key:"cacheCurrentList"},{text:"\u66F4\u591A\u64CD\u4F5C",key:"showMoreAction"}]:n.value=="cache"?N=[{text:"\u7EDF\u8BA1\u7F13\u5B58",key:"statCacheList"},{text:"\u91CD\u65B0\u7F13\u5B58",key:"retryCacheList"},{text:"\u5BFC\u5165\u7F13\u5B58",key:"importCacheList"},{text:"\u5BFC\u51FA\u7F13\u5B58",key:"exportCacheList"},{text:"\u6E05\u7A7A\u7F13\u5B58",key:"clearCacheList"},{text:"OSS\u5217\u8868",key:"toOsslist"}]:n.value=="release"?N=[{text:"\u5237\u65B0\u5217\u8868",key:"froceRefreshList"},{text:"\u7F13\u5B58\u5217\u8868",key:"cacheCurrentList"}]:n.value=="custom"?N=[]:n.value=="alipan"?N=[{text:"\u5237\u65B0\u5217\u8868",key:"froceRefreshList"},{text:"\u7F13\u5B58\u5217\u8868",key:"cacheCurrentList"}]:n.value=="alipan_open"?N=[{text:"\u5237\u65B0\u5217\u8868",key:"froceRefreshList"},{text:"\u7F13\u5B58\u5217\u8868",key:"cacheCurrentList"}]:n.value=="alist"?N=[{text:"\u7F13\u5B58\u5217\u8868",key:"cacheCurrentList"}]:n.value=="local"?N=[{text:"\u5BFC\u5165\u89C6\u9891",key:"importLocalList"}]:n.value=="osslist"&&(N=[{text:"\u7F13\u5B58\u5217\u8868",key:"cacheCurrentList"}]),$i.value.actions=N},Un=re=>oe(this,[re],function*({key:N}){if(N==="renameCollect")Le(u.value);else if(N==="deleteCollect")yield br.confirm({title:"\u63D0\u793A",message:"\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u6536\u85CF\u5417\uFF1F",beforeClose:ie=>oe(this,null,function*(){if(ie==="cancel")return!0;try{let ue=u.value,ye=yield lt.getVsongData();if(delete ye.collect[ue],Ee.value.includes(ue)){let pe=ye.archive.find(ge=>ge.name=="\u5F52\u6863"),_e=pe.list.findIndex(ge=>ge.name==ue);_e>=0&&(pe.list.splice(_e,1),Ee.value=pe.list.map(ge=>ge.name))}return yield lt.setVsongData(ye),K.value=Object.keys(ye.collect),t.replace({path:"/home"}),Oe({message:"\u5220\u9664\u6210\u529F",position:"top"}),!0}catch(ue){return Oe({message:ue.message,position:"top"}),!1}})});else if(N==="moveinArchive")yield d(u.value);else if(N==="moveoutArchive")yield y(u.value);else if(N==="froceRefreshList")St();else if(N==="cacheCurrentList")Ce(1,U.value.length,(ie,ue)=>oe(this,null,function*(){try{let ye=0;for(let pe=ie-1;pe<ue;pe++){const _e=U.value[pe];di(_e.vsongId)&&(ye++,yield Or(_e))}return ye>0?Oe({message:"\u6B63\u5728\u7F13\u5B58\u4E2D",position:"top"}):Oe({message:"\u5F53\u524D\u5217\u8868\u5DF2\u7F13\u5B58",position:"top"}),!0}catch(ye){return Oe({message:ye.message,position:"top"}),!1}}));else if(N==="uplistBeCollect")yield br.confirm({title:"\u63D0\u793A",message:"\u786E\u5B9A\u8981\u5C06\u5F53\u524D\u5217\u8868\u521B\u5EFA\u65B0\u6536\u85CF\u5417\uFF1F",beforeClose:ie=>oe(this,null,function*(){if(ie==="cancel")return!0;try{let ue=P.value,ye=U.value.map(_e=>m(_e));if(K.value.includes(ue))throw new Error("\u5DF2\u5B58\u5728\u540C\u540D\u6536\u85CF\u5217\u8868");let pe=yield lt.getVsongData();return pe.collect[ue]=ye,yield lt.setVsongData(pe),K.value.push(ue),Oe({message:"\u521B\u5EFA\u6210\u529F",position:"top"}),!0}catch(ue){return Oe({message:ue.message,position:"top"}),!1}})});else if(N==="statCacheList"){let ie=Oe.loading({message:"\u7EDF\u8BA1\u4E2D...",forbidClick:!0,duration:0}),ue=[...U.value,...R.value.reduce((pe,_e)=>pe.concat(ne[_e.title]),[])].filter(pe=>pe.cacheStatus=="succeed"),ye=0;for(let pe=0;pe<ue.length;pe++){const _e=ue[pe];let[ge,Pe,ke]=yield Promise.all([st.getOneByIndex("vsong_audio","vsongId",_e.vsongId),st.getOneByIndex("vsong_video","vsongId",_e.vsongId),st.getOneByIndex("vsong_cover","vsongId",_e.vsongId)]);ge&&(ye+=ge.arraybuffer.byteLength),Pe&&(ye+=Pe.arraybuffer.byteLength),ke&&(ye+=ke.arraybuffer.byteLength)}setTimeout(()=>{ie.clear()},0),yield br.alert({title:"\u7EDF\u8BA1\u7F13\u5B58\u4FE1\u606F",message:`\u8D44\u6E90\u603B\u6570\uFF1A${ue.length}
\u8D44\u6E90\u603B\u5927\u5C0F\uFF1A${nf(ye)}`,messageAlign:"left"})}else if(N==="retryCacheList"){let ie=[...U.value,...R.value.reduce((ue,ye)=>ue.concat(ne[ye.title]),[])].filter(ue=>ue.cacheStatus=="failed");for(let ue=0;ue<ie.length;ue++)yield Mi(ie[ue]);Oe({message:`\u91CD\u65B0\u7F13\u5B58\uFF1A${ie.length}`,position:"top"})}else if(N==="importCacheList"){let ie=yield In(),ue=Oe.loading({message:"\u5BFC\u5165\u4E2D...",forbidClick:!0,duration:0});try{let ye=0,pe=0;const _e=yield ss.loadAsync(ie);for(const ge in _e.files){const Pe=_e.files[ge];if(Pe.dir){let ke=yield _e.files[`${Pe.name}vsong_cache.json`].async("string"),vt=JSON.parse(ke);if(Q.find(Ze=>Ze.vsongId==vt.vsongId))pe++;else{if(delete vt.id,yield st.addRow("vsong_cache",vt),_e.files[`${Pe.name}vsong_audio.json`]){let Ze=yield _e.files[`${Pe.name}vsong_audio.json`].async("string"),Ne=JSON.parse(Ze);delete Ne.id,Ne.arraybuffer=yield _e.files[`${Pe.name}vsong_audio.arraybuffer`].async("arraybuffer"),yield st.addRow("vsong_audio",Ne)}if(_e.files[`${Pe.name}vsong_video.json`]){let Ze=yield _e.files[`${Pe.name}vsong_video.json`].async("string"),Ne=JSON.parse(Ze);delete Ne.id,Ne.arraybuffer=yield _e.files[`${Pe.name}vsong_video.arraybuffer`].async("arraybuffer"),yield st.addRow("vsong_video",Ne)}if(_e.files[`${Pe.name}vsong_cover.json`]){let Ze=yield _e.files[`${Pe.name}vsong_cover.json`].async("string"),Ne=JSON.parse(Ze);delete Ne.id,Ne.arraybuffer=yield _e.files[`${Pe.name}vsong_cover.arraybuffer`].async("arraybuffer"),yield st.addRow("vsong_cover",Ne)}ye++}}}Ot(),setTimeout(()=>{ue.clear()},0),Oe({message:`\u5BFC\u5165\u5B8C\u6210\uFF0C\u65B0\u589E\uFF1A${ye}\uFF0C\u5FFD\u7565\uFF1A${pe}`,position:"top",duration:3e3})}catch(ye){throw Ot(),setTimeout(()=>{ue.clear()},0),Oe({message:`\u5BFC\u5165\u5F02\u5E38(${ye.message})`,position:"top"}),ye}}else if(N==="exportCacheList"){let ie=[...U.value];Ce(1,ie.length,(ue,ye)=>oe(this,null,function*(){let pe=Oe.loading({message:"\u5BFC\u51FA\u4E2D...",forbidClick:!0,duration:0}),_e=Date.now(),ge=new ss,Pe=1,ke=0;console.log(ye);for(let vt=ue-1;vt<ye;vt++){const Ze=ie[vt];let[Ne,At,Qt]=yield Promise.all([st.getOneByIndex("vsong_audio","vsongId",Ze.vsongId),st.getOneByIndex("vsong_video","vsongId",Ze.vsongId),st.getOneByIndex("vsong_cover","vsongId",Ze.vsongId)]);if(ge.folder(Ze.vsongId),ge.file(`${Ze.vsongId}/vsong_cache.json`,JSON.stringify(Ze,null,2)),Ne&&(ke+=Ne.arraybuffer.byteLength,ge.file(`${Ze.vsongId}/vsong_audio.arraybuffer`,Ne.arraybuffer),Ne.arraybuffer=null,ge.file(`${Ze.vsongId}/vsong_audio.json`,JSON.stringify(Ne,null,2))),At&&(ke+=At.arraybuffer.byteLength,ge.file(`${Ze.vsongId}/vsong_video.arraybuffer`,At.arraybuffer),At.arraybuffer=null,ge.file(`${Ze.vsongId}/vsong_video.json`,JSON.stringify(At,null,2))),Qt&&(ke+=Qt.arraybuffer.byteLength,ge.file(`${Ze.vsongId}/vsong_cover.arraybuffer`,Qt.arraybuffer),Qt.arraybuffer=null,ge.file(`${Ze.vsongId}/vsong_cover.json`,JSON.stringify(Qt,null,2))),ke/1024/1024>1024||vt==ye-1){let sn=yield ge.generateAsync({type:"blob"});au(sn,`vsong_cache_${_e}_part${Pe}.zip`),ge=new ss,Pe++,ke=0}}setTimeout(()=>{pe.clear()},0)}))}else if(N==="clearCacheList"){let ie=[...U.value];Ce(1,ie.length,(ue,ye)=>oe(this,null,function*(){yield br.confirm({title:"\u63D0\u793A",message:"\u786E\u5B9A\u8981\u6E05\u7A7A\u6240\u9009\u7F13\u5B58\u5417\uFF1F",beforeClose:pe=>oe(this,null,function*(){if(pe==="cancel")return!0;try{let _e=[...ie.slice(ue-1,ye)];for(let ge=0;ge<ie.length;ge++){const Pe=_e[ge];yield Ni(Pe)}return Oe({message:"\u5DF2\u6E05\u7A7A\u6240\u9009\u7F13\u5B58",position:"top"}),Ot(),!0}catch(_e){return Oe({message:_e.message,position:"top"}),Ot(),!1}})})}))}else if(N==="toOsslist")t.push({path:"/home",query:{ltype:"osslist",lparam:","}});else if(N==="toNewRelease")t.push({path:"/home",query:{ltype:"release",lparam:u.value}});else if(N==="showMoreAction"){let ie;n.value=="up"?ie={vsongFolderId:`biAwemeFolder_${u.value}`,vsongFolderType:"biAwemeFolder",title:P.value,mid:u.value}:n.value=="dy"&&(ie={vsongFolderId:`dyAwemeFolder_${u.value}`,vsongFolderType:"dyAwemeFolder",title:P.value,sec_uid:u.value}),M("folder",ie)}else if(N==="importLocalList"){let ie=document.createElement("input");ie.multiple=!0,ie.type="file",ie.accept="video/*",ie.click(),ie.addEventListener("change",ue=>{console.log(ie.files);let ye=[];for(let pe=0;pe<ie.files.length;pe++){let _e=ie.files[pe],ge={vsongId:`localAweme_${pe}`,vsongType:"localAweme",author:"\u4E00\u4E00",title:_e.name,coverUrl:"",originUrl:"",originFile:_e};ye.push(ge)}U.value=ye,ie.remove()},{once:!0}),ie.addEventListener("cancel",ue=>{console.log("cancel"),ie.remove()},{once:!0})}});li(v,()=>oe(this,null,function*(){$i.value.show=!1}));const Ln=()=>oe(this,null,function*(){Oe.loading({message:"\u9000\u51FA\u767B\u5F55\u4E2D...",forbidClick:!0,duration:0}),yield It.clear(),localStorage.removeItem("vsong_token"),location.reload()}),Pn=()=>oe(this,null,function*(){Oi("bilibili",()=>{Oe({message:"\u7ED1\u5B9A\u6210\u529F",position:"middle"}),H.value&&ce()})}),Fn=()=>oe(this,null,function*(){yield lt.unbindAccount("bilibili"),Oe({message:"\u89E3\u7ED1\u6210\u529F",position:"middle"}),H.value&&ce()}),Bn=()=>oe(this,null,function*(){Oi("alipan",()=>{Oe({message:"\u7ED1\u5B9A\u6210\u529F",position:"middle"}),H.value&&ce()})}),da=()=>oe(this,null,function*(){yield lt.unbindAccount("alipan"),Oe({message:"\u89E3\u7ED1\u6210\u529F",position:"middle"}),H.value&&ce()}),vi=$e(0),On=(N,re)=>{let ie=Math.round(re/N*100);ie>100&&(ie=100),ie!==ie&&(ie=0),vi.value=ie},Er=()=>{pt.setCurrentTimeRate(vi.value)},zr=$e(null),In=()=>oe(this,null,function*(){let N=zr.value;return N.value="",N.click(),new Promise((re,ie)=>{const ue=()=>{console.log("fileInputDom change"),N.removeEventListener("change",ue),window.removeEventListener("focus",focus),re(N.files[0])},ye=()=>{setTimeout(()=>{console.log("fileInputDom blur"),N.removeEventListener("change",ue),window.removeEventListener("focus",focus),ie(new Error("cancel"))},300)};N.addEventListener("change",ue,{once:!0}),window.addEventListener("focus",ye,{once:!0})})}),ha=N=>{if(N.keyCode==13){if(document.fullscreenElement)return;hi()}},pa=N=>{N.keyCode==13&&sr()};let an=!1;document.addEventListener("fullscreenchange",N=>{document.fullscreenElement==null&&an&&hi(),document.fullscreenElement==null&&we.close()});const Vr=N=>{an=mt.value,zi.value.requestFullscreen({navigationUI:"hide"}).then(()=>{mt.value&&hi()})};return(N,re)=>{const ie=$t("van-icon"),ue=$t("van-popover"),ye=$t("van-tag"),pe=$t("van-slider"),_e=$t("van-action-sheet"),ge=$t("van-dialog"),Pe=$t("van-field"),ke=$t("van-switch"),vt=$t("van-form"),Ze=$t("van-loading"),Ne=$t("van-image"),At=$t("van-button"),Qt=$t("van-cell"),sn=$t("van-cell-group");return nt(),ft(Wi,null,[Ye("div",{class:Gr(["listbox",{unexpand:!mt.value}]),ref:(me,ht)=>{ht.listBoxRef=me,gt.value=me},onScroll:wt},[Ye("div",wg,[We(ue,{show:Gi.value.show,"onUpdate:show":re[0]||(re[0]=me=>Gi.value.show=me),actions:Gi.value.actions,offset:[-8,8],onOpen:nn,onSelect:Nr,overlay:"",placement:"right-start","overlay-style":{backgroundColor:"rgba(0,0,0,0)"},class:"custom-popover"},{reference:at(()=>[We(ie,{class:"listbar-icon",name:"label-o",tabxxindexxx:"1"})]),_:1},8,["show","actions","overlay-style"]),Ye("div",{class:"listbar-title",onClick:re[1]||(re[1]=me=>$i.value.show=!0),tabxxindexxx:"1"},_t(P.value),1),We(ue,{show:$i.value.show,"onUpdate:show":re[2]||(re[2]=me=>$i.value.show=me),actions:$i.value.actions,offset:[0,8],onOpen:Rn,onSelect:Un,overlay:"",placement:"bottom","overlay-style":{backgroundColor:"rgba(0,0,0,0)"}},{reference:at(()=>[Ye("div",Tg,"("+_t(R.value.length)+"/"+_t(U.value.length)+")",1)]),_:1},8,["show","actions","overlay-style"]),Ye("div",Sg,[je(n)=="up"?(nt(),Si(ye,{key:0,style:{cursor:"pointer",background:"transparent"},color:"#ffffff",plain:"",onClick:Ue,tabxxindexxx:"1"},{default:at(()=>[Yi(_t(G.value.order=="pubdate"?"\u6700\u65B0":"\u6700\u70ED"),1)]),_:1})):Pt("",!0),je(n)=="dy"?(nt(),Si(ye,{key:1,style:{cursor:"pointer",background:"transparent"},color:"#ffffff",plain:"",onClick:tt,tabxxindexxx:"1"},{default:at(()=>[Yi(_t(B.value.order=="pubdate"?"\u6700\u65B0":"\u6700\u70ED"),1)]),_:1})):Pt("",!0),je(n)=="cache"&&je(u)==","?(nt(),Si(ye,{key:2,style:{cursor:"pointer",background:"transparent"},color:"#ffffff",plain:"",onClick:ut,tabxxindexxx:"1"},{default:at(()=>[Yi(_t(J.value.order=="time"?"\u5217\u5E8F":"\u5F52\u5408"),1)]),_:1})):Pt("",!0),rr().has?(nt(),Si(ie,{key:3,class:"listbar-action-icon",style:{transform:"rotateZ(180deg)"},onClick:ir,name:"back-top",tabxxindexxx:"1"})):Pt("",!0),je(n)=="alipan"?(nt(),Si(ie,{key:4,class:"listbar-action-icon",name:"search",onClick:je(Je),tabxxindexxx:"1"},null,8,["onClick"])):Pt("",!0),je(n)=="collect"?(nt(),Si(ie,{key:5,class:"listbar-action-icon",name:"add-o",onClick:je(ae),tabxxindexxx:"1"},null,8,["onClick"])):Pt("",!0),We(ue,{show:Ut.value.show,"onUpdate:show":re[3]||(re[3]=me=>Ut.value.show=me),actions:Ut.value.actions,offset:[-8,0],onSelect:rn,overlay:"",placement:"left-start","overlay-style":{backgroundColor:"rgba(0,0,0,0)"}},{reference:at(()=>[We(ie,{class:"listbar-action-icon",name:"setting-o",tabxxindexxx:"1"})]),_:1},8,["show","actions","overlay-style"]),We(ie,{class:"listbar-action-icon",name:"bars",onClick:hi,tabxxindexxx:"1"})])]),Gn(Ye("div",{ref:(me,ht)=>{ht.listboxListRef=me,er.value=me},style:{"min-height":"100%"},onTouchstart:mr,onTouchmove:xi},[(nt(!0),ft(Wi,null,Pa(R.value,(me,ht)=>(nt(),ft("div",{class:"listitem",key:ht},[je(n)=="archive"?(nt(),ft(Wi,{key:0},[kg,Ye("div",Ag,[Ye("div",{class:"listitem-info-t1",onClick:Yt=>pi(me),onKeydown:ki(Yt=>pi(me),["enter"]),tabxxindexxx:"1"},_t(me.title),41,Cg)]),We(ie,{class:"listitem-action",name:"ellipsis",onClick:Wn(Yt=>M("archiveFolder",me),["stop"]),tabxxindexxx:"1"},null,8,["onClick"])],64)):je(n)=="osslist"||je(n)=="cache"?(nt(),ft(Wi,{key:1},[Dg,Ye("div",Rg,[Ye("div",{class:"listitem-info-t1",onClick:Yt=>pi(me),onKeydown:ki(Yt=>pi(me),["enter"]),tabxxindexxx:"1"},_t(me.title),41,Ug)])],64)):(nt(),ft(Wi,{key:2},[Lg,Ye("div",Pg,[Ye("div",{class:"listitem-info-t1",onClick:Yt=>pi(me),onKeydown:ki(Yt=>pi(me),["enter"]),tabxxindexxx:"1"},_t(me.title),41,Fg)]),We(ie,{class:"listitem-action",name:"ellipsis",onClick:Wn(Yt=>M("folder",me),["stop"]),tabxxindexxx:"1"},null,8,["onClick"])],64))]))),128)),(nt(!0),ft(Wi,null,Pa(U.value,(me,ht)=>(nt(),ft("div",{class:Gr(["listitem",{active:S.value&&me.vsongId==S.value.vsongId}]),key:ht},[Ye("div",Bg,_t(ht+1),1),Ye("div",Og,[Ye("div",{class:"listitem-info-t1",onClick:Yt=>Ri(me),onKeydown:ki(Yt=>Ri(me),["enter"]),tabxxindexxx:"1"},_t(me.title||"\u65E0\u6807\u9898"),41,Ig),Mg,Ye("div",{class:"listitem-info-t2",onClick:Wn(Yt=>le(me),["stop"]),onKeydown:ki(Yt=>le(me),["enter"]),tabxxindexxx:"1"},_t(me.author),41,Ng),di(me.vsongId)?Pt("",!0):(nt(),ft("div",zg,_t(_r[bi(me.vsongId)]),1)),C.value.includes(me.vsongId)?(nt(),ft("div",Vg,"oss")):Pt("",!0)]),We(ie,{class:"listitem-action",name:"ellipsis",onClick:Wn(Yt=>M("song",me),["stop"]),tabxxindexxx:"1"},null,8,["onClick"])],2))),128))],544),[[$n,mt.value]])],34),Ye("div",Hg,[S.value?(nt(),ft(Wi,{key:0},[Ye("img",{class:Gr(["playbar-cover",{rotate:S.value.isPlay}]),src:S.value.crossCoverUrl,onClick:Vr,tabxxindexxx:"1"},null,10,jg),Ye("div",Gg,_t(S.value.title),1),Gn(We(ie,{class:"playbar-action",name:"play-circle-o",onClick:gi,tabxxindexxx:"1"},null,512),[[$n,!S.value.isPlay]]),Gn(We(ie,{class:"playbar-action",name:"pause-circle-o",onClick:Rt,tabxxindexxx:"1"},null,512),[[$n,S.value.isPlay]]),Ye("div",{class:"playbar-slider",onKeydown:pa,tabxxindexxx:"1"},[We(pe,{modelValue:vi.value,"onUpdate:modelValue":re[4]||(re[4]=me=>vi.value=me),"bar-height":"100%",onChange:Er},{button:at(()=>[$g]),_:1},8,["modelValue"])],32)],64)):Pt("",!0)]),We(_e,{show:et.value.isShow,"onUpdate:show":re[17]||(re[17]=me=>et.value.isShow=me),class:"action-sheet"},{default:at(()=>[et.value.type=="folder"?(nt(),ft("div",Wg,[Ye("div",Yg,[Ye("div",Xg,_t(et.value.data.title),1)]),We(ue,{show:wi.value.show,"onUpdate:show":re[5]||(re[5]=me=>wi.value.show=me),actions:wi.value.actions,onOpen:Cn,onSelect:Dn,overlay:"",placement:"right-end","overlay-style":{backgroundColor:"rgba(0,0,0,0)"},class:"custom-popover"},{reference:at(()=>[Ye("div",Kg,[We(ie,{class:"action-sheet-item-icon",name:"label-o"}),qg])]),_:1},8,["show","actions","overlay-style"]),je(n)==="collect"?(nt(),ft("div",{key:0,class:"action-sheet-item",onClick:re[6]||(re[6]=me=>x(P.value,et.value.data.vsongFolderId))},[We(ie,{class:"action-sheet-item-icon",name:"label-o"}),Zg])):Pt("",!0)])):et.value.type=="archiveFolder"?(nt(),ft("div",Jg,[Ye("div",Qg,[Ye("div",ev,_t(et.value.data.title),1)]),Ye("div",{class:"action-sheet-item",onClick:re[7]||(re[7]=me=>y(et.value.data.name))},[We(ie,{class:"action-sheet-item-icon",name:"label-o"}),tv])])):et.value.type=="song"?(nt(),ft("div",iv,[Ye("div",rv,[Ye("div",nv,"\u6B4C\u66F2\uFF1A"+_t(et.value.data.title),1),Ye("div",{class:"action-sheet-title-t2",onClick:re[8]||(re[8]=me=>le(et.value.data))},_t(et.value.data.author),1)]),je(n)!=="bilipage"&&et.value.data.vsongType==="biAweme"?(nt(),ft("div",{key:0,class:"action-sheet-item",onClick:re[9]||(re[9]=me=>Z(et.value.data.bvid))},[We(ie,{class:"action-sheet-item-icon",name:"label-o"}),av])):Pt("",!0),Ye("div",{class:"action-sheet-item",onClick:re[10]||(re[10]=me=>V(et.value.data.originUrl))},[We(ie,{class:"action-sheet-item-icon",name:"label-o"}),sv]),We(ue,{show:wi.value.show,"onUpdate:show":re[11]||(re[11]=me=>wi.value.show=me),actions:wi.value.actions,onOpen:Cn,onSelect:Dn,overlay:"",placement:"right-end","overlay-style":{backgroundColor:"rgba(0,0,0,0)"},class:"custom-popover"},{reference:at(()=>[Ye("div",ov,[We(ie,{class:"action-sheet-item-icon",name:"label-o"}),lv])]),_:1},8,["show","actions","overlay-style"]),je(n)==="collect"?(nt(),ft("div",{key:1,class:"action-sheet-item",onClick:re[12]||(re[12]=me=>w(P.value,et.value.data.vsongId))},[We(ie,{class:"action-sheet-item-icon",name:"label-o"}),uv])):Pt("",!0),bi(et.value.data.vsongId)=="failed"?(nt(),ft("div",{key:2,class:"action-sheet-item",onClick:re[13]||(re[13]=me=>Mi(et.value.data))},[We(ie,{class:"action-sheet-item-icon",name:"label-o"}),fv])):Pt("",!0),di(et.value.data.vsongId)?(nt(),ft("div",{key:3,class:"action-sheet-item",onClick:re[14]||(re[14]=me=>Or(et.value.data))},[We(ie,{class:"action-sheet-item-icon",name:"label-o"}),cv])):(nt(),ft("div",{key:4,class:"action-sheet-item",onClick:re[15]||(re[15]=me=>Ni(et.value.data))},[We(ie,{class:"action-sheet-item-icon",name:"label-o"}),dv])),p.value?(nt(),ft("div",{key:5,class:"action-sheet-item",onClick:re[16]||(re[16]=me=>si(et.value.data))},[We(ie,{class:"action-sheet-item-icon",name:"label-o"}),hv])):Pt("",!0)])):Pt("",!0)]),_:1},8,["show"]),zi.value?(nt(),Si(_e,{key:0,show:je(Ae).isShow,"onUpdate:show":re[18]||(re[18]=me=>je(Ae).isShow=me),class:"action-sheet",teleport:".full-screen-warpbox"},{default:at(()=>[Ye("div",pv,[(nt(!0),ft(Wi,null,Pa(je(Ae).data,(me,ht)=>(nt(),ft("div",{class:Gr(["action-sheet-item",{active:S.value&&me.vsongId==S.value.vsongId}]),onClick:Yt=>Ri(me),key:ht},[Ye("div",vv,_t(ht+1),1),Ye("div",yv,_t(me.title),1)],10,gv))),128))])]),_:1},8,["show"])):Pt("",!0),We(ge,{show:be.value.isShow,"onUpdate:show":re[19]||(re[19]=me=>be.value.isShow=me),"show-confirm-button":!1,"close-on-click-overlay":!0,class:"video-dialog","overlay-style":{background:"rgba(0,0,0,0.7)"}},{default:at(()=>[be.value.isShow?(nt(),ft("iframe",{key:0,width:"100%",height:"100%",src:be.value.iframeUrl,scrolling:"no",border:"0",frameborder:"no",framespacing:"0",allowfullscreen:"true"}," ",8,mv)):Pt("",!0)]),_:1},8,["show","overlay-style"]),We(ge,{show:je(D),"onUpdate:show":re[21]||(re[21]=me=>lr(D)?D.value=me:null),title:"\u6DFB\u52A0","show-cancel-button":"","close-on-click-overlay":"","before-close":je(X)},{default:at(()=>[We(Pe,{ref:(me,ht)=>{ht.addFieldRef=me},modelValue:je(Ge).url,"onUpdate:modelValue":re[20]||(re[20]=me=>je(Ge).url=me),rows:"4",autosize:"",type:"textarea",placeholder:"\u8F93\u5165\u94FE\u63A5(B\u7AD9\u89C6\u9891\u94FE\u63A5/\u6296\u97F3\u4E3B\u9875)"},null,8,["modelValue"])]),_:1},8,["show","before-close"]),We(ge,{show:je(ci),"onUpdate:show":re[23]||(re[23]=me=>lr(ci)?ci.value=me:null),title:"\u5B9A\u65F6\u5173\u95ED","show-cancel-button":"","close-on-click-overlay":"","before-close":je(yr)},{default:at(()=>[We(Pe,{modelValue:je(Di).afterTime,"onUpdate:modelValue":re[22]||(re[22]=me=>je(Di).afterTime=me),"input-align":"right",label:"\u65F6\u95F4",placeholder:"\u8BF7\u8F93\u5165",type:"digit","label-width":"4em"},{button:at(()=>[_v]),_:1},8,["modelValue"])]),_:1},8,["show","before-close"]),We(ge,{show:je(ot),"onUpdate:show":re[27]||(re[27]=me=>lr(ot)?ot.value=me:null),title:"\u64AD\u653E\u8BBE\u7F6E","show-cancel-button":"","close-on-click-overlay":"","before-close":je(Nt)},{default:at(()=>[We(Pe,{label:"\u5FAA\u73AF\u6A21\u5F0F","label-width":"4em","input-align":"right"},{input:at(()=>[We(ao,{modelValue:je(Bt).loopMode,"onUpdate:modelValue":re[24]||(re[24]=me=>je(Bt).loopMode=me),columns:Wt},{default:at(me=>[Yi(_t(me.label),1)]),_:1},8,["modelValue"])]),_:1}),We(Pe,{label:"\u5C55\u793A\u89C6\u9891","label-width":"4em","input-align":"right"},{input:at(()=>[We(ke,{modelValue:je(Bt).showVideo,"onUpdate:modelValue":re[25]||(re[25]=me=>je(Bt).showVideo=me),size:"20"},null,8,["modelValue"])]),_:1}),We(Pe,{modelValue:je(Bt).proxyUrl,"onUpdate:modelValue":re[26]||(re[26]=me=>je(Bt).proxyUrl=me),label:"\u4EE3\u7406\u94FE\u63A5","label-width":"4em","input-align":"left",rows:"2",autosize:"",type:"textarea",placeholder:"\u53EF\u63D0\u4F9B\u4EE3\u7406\uFF0C\u4F7F\u64AD\u653E\u66F4\u6D41\u7545"},null,8,["modelValue"])]),_:1},8,["show","before-close"]),We(ge,{show:je(te),"onUpdate:show":re[29]||(re[29]=me=>lr(te)?te.value=me:null),title:je(Te).isEdit?"\u91CD\u547D\u540D\u6536\u85CF":"\u521B\u5EFA\u6536\u85CF\u5217\u8868","show-cancel-button":"","close-on-click-overlay":"","before-close":je(Se)},{default:at(()=>[We(Pe,{modelValue:je(he).name,"onUpdate:modelValue":re[28]||(re[28]=me=>je(he).name=me),"input-align":"right",label:"\u540D\u79F0",placeholder:"\u8BF7\u8F93\u5165","label-width":"4em"},null,8,["modelValue"])]),_:1},8,["show","title","before-close"]),We(ge,{show:je(Xe),"onUpdate:show":re[31]||(re[31]=me=>lr(Xe)?Xe.value=me:null),title:"\u641C\u7D22","show-cancel-button":"","close-on-click-overlay":"","before-close":je(Ft)},{default:at(()=>[We(vt,{onSubmit:je(yt)},{default:at(()=>[We(Pe,{ref:(me,ht)=>{ht.keywordFieldRef=me},modelValue:je(ze).keyword,"onUpdate:modelValue":re[30]||(re[30]=me=>je(ze).keyword=me),"input-align":"center",label:"",placeholder:"\u8BF7\u8F93\u5165"},null,8,["modelValue"])]),_:1},8,["onSubmit"])]),_:1},8,["show","before-close"]),We(ge,{show:je(Kt),"onUpdate:show":re[32]||(re[32]=me=>lr(Kt)?Kt.value=me:null),title:je(qt).type=="alipan"?"\u7ED1\u5B9A\u963F\u91CC\u4E91\u76D8":"\u7ED1\u5B9AB\u7AD9","show-cancel-button":!1,"show-confirm-button":!1,"close-on-click-overlay":"","before-close":je(Qi)},{default:at(()=>[We(Ne,{class:"bind-qrcode",src:je(qt).qrcode},{loading:at(()=>[We(Ze,{type:"spinner",size:"20"})]),_:1},8,["src"])]),_:1},8,["show","title","before-close"]),We(ge,{show:je(Ve),"onUpdate:show":re[35]||(re[35]=me=>lr(Ve)?Ve.value=me:null),title:"\u9009\u62E9\u533A\u95F4","show-cancel-button":"","close-on-click-overlay":"","before-close":je(Me)},{default:at(()=>[We(vt,null,{default:at(()=>[Ye("div",xv,[We(Pe,{modelValue:je(De).start,"onUpdate:modelValue":re[33]||(re[33]=me=>je(De).start=me),type:"digit","input-align":"center","label-width":"1em",label:"\u4ECE",placeholder:"\u8BF7\u8F93\u5165"},null,8,["modelValue"]),We(Pe,{modelValue:je(De).end,"onUpdate:modelValue":re[34]||(re[34]=me=>je(De).end=me),type:"digit","input-align":"center","label-width":"1em",label:"\u81F3",placeholder:"\u8BF7\u8F93\u5165"},null,8,["modelValue"])])]),_:1})]),_:1},8,["show","before-close"]),We(ge,{show:je(H),"onUpdate:show":re[36]||(re[36]=me=>lr(H)?H.value=me:null),title:"\u4E2A\u4EBA\u4E2D\u5FC3","show-cancel-button":!1,"show-confirm-button":!1,"close-on-click-overlay":""},{default:at(()=>[We(sn,{border:!1},{default:at(()=>[We(Qt,{title:"B\u7AD9",center:""},{value:at(()=>[je(q).bilibiliUser?(nt(),Si(At,{key:1,onClick:Fn,plain:"",type:"danger",size:"mini",style:{border:"none",padding:"0"}},{default:at(()=>[bv]),_:1})):(nt(),Si(At,{key:0,onClick:Pn,plain:"",type:"primary",size:"mini",style:{border:"none",padding:"0"}},{default:at(()=>[Ev]),_:1}))]),label:at(()=>[je(q).bilibiliUser?(nt(),ft("span",Tv,"\u5DF2\u7ED1\u5B9A("+_t(je(q).bilibiliUser.name)+")",1)):(nt(),ft("span",wv,"\u672A\u7ED1\u5B9A"))]),_:1}),We(Qt,{title:"\u963F\u91CC\u4E91\u76D8",center:""},{value:at(()=>[je(q).alipanUser?(nt(),Si(At,{key:1,onClick:da,plain:"",type:"danger",size:"mini",style:{border:"none",padding:"0"}},{default:at(()=>[kv]),_:1})):(nt(),Si(At,{key:0,onClick:Bn,plain:"",type:"primary",size:"mini",style:{border:"none",padding:"0"}},{default:at(()=>[Sv]),_:1}))]),label:at(()=>[je(q).alipanUser?(nt(),ft("span",Cv,"\u5DF2\u7ED1\u5B9A("+_t(je(q).alipanUser.name)+")",1)):(nt(),ft("span",Av,"\u672A\u7ED1\u5B9A"))]),_:1}),We(Qt,{title:"VSONG",center:""},{value:at(()=>[We(At,{plain:"",type:"primary",size:"mini",onClick:Ln,style:{border:"none",padding:"0"}},{default:at(()=>[Dv]),_:1})]),label:at(()=>[Ye("div",null,[je(q).playVideoInfo?(nt(),ft("div",Rv,"\u89C6\u9891:"+_t(je(q).playVideoInfo.videoWidth)+"x"+_t(je(q).playVideoInfo.videoHeight),1)):Pt("",!0)])]),_:1})]),_:1}),Uv]),_:1},8,["show"]),Ye("div",{class:"full-screen-warpbox",ref:(me,ht)=>{ht.fullSreenWarpboxRef=me,zi.value=me}},[Ye("video",{class:Gr(["bg-video",{high:!mt.value}]),ref:(me,ht)=>{ht.bgVideoRef=me,ni.value=me},posterxxx:S.value&&S.value.crossCoverUrl,muted:""},null,10,Lv),Ye("div",{class:"bg-danmu",ref:(me,ht)=>{ht.bgDanmuRef=me,Mr.value=me}},null,512),Ye("div",{class:Gr(["bg-xgplayer",{high:!mt.value}])},[Ye("div",{ref:(me,ht)=>{ht.bgXgplayerRef=me,ai.value=me},style:{background:"transparent",display:"none"}},null,512)],2),S.value?(nt(),ft("div",Pv,[We(ie,{class:"tabaction-item",name:"arrow-up",onKeydown:ki(oi,["enter"]),tabxxindexxx:"1"},null,8,["onKeydown"]),We(ie,{class:"tabaction-item",name:"arrow-left",onKeydown:ki(Ht,["enter"]),tabxxindexxx:"1"},null,8,["onKeydown"]),We(ie,{class:"tabaction-item",name:S.value.isPlay?"pause-circle-o":"play-circle-o",onKeydown:ki(tn,["enter"]),tabxxindexxx:"1"},null,8,["name","onKeydown"]),We(ie,{class:"tabaction-item",name:"arrow",onKeydown:ki(sr,["enter"]),tabxxindexxx:"1"},null,8,["onKeydown"]),We(ie,{class:"tabaction-item",name:"arrow-down",onKeydown:ki(xr,["enter"]),tabxxindexxx:"1"},null,8,["onKeydown"]),We(ie,{class:"tabaction-item",name:"bars",onKeydown:re[37]||(re[37]=ki(me=>je(we).open(U.value),["enter"])),tabxxindexxx:"1"})])):Pt("",!0),Gn(Ye("div",{ref:(me,ht)=>{ht.listboxMaskRef=me,Fr.value=me},class:"listbox-mask",onKeydown:ha,tabxxindexxx:"1"},null,544),[[$n,!mt.value]])],512),Ye("input",{ref:(me,ht)=>{ht.fileInputRef=me,zr.value=me},type:"file",accept:".zip",hidden:""},null,512)],64)}}});Fv.__scopeId="data-v-54feb97a";export{Fv as default};
